А. П. Алферов, А. Ю. Зубов, А. С. Кузьмин,
А. В. Черемушкин
ОСНОВЫ
КРИПТОГРАФИИ
2-е издание
исправленное и дополненное
Допущено Министерством образования
Российской Федерации в качестве учебного пособия
для студентов высших учебных заведений,
обучающихся по группе специальностей
в области информационной безопасности
Москва
“Гелиос АРВ”
2002
ЬЬК 32 8 1 вб
А50
Р ец ен зен ты
Марков А И , главный ученый секретарь Академии криптографии РФ, доктор физ -
мат наук, профессор,
МалюкА А , декан факультета информационной безопасности МИФИ (ТУ), кандидат
техн наук, доцент,
Тювин Ю Д , проректор МИРЭА, кандидат техн наук, профессор
Алферов А. П,, Зубов А. Ю., Кузьмин А. С.,
Черемушкин А. В.
А50 Основы криптографии Учебное пособие, 2-е изд., испр. и
доп. — М.. Гелиос АРВ, 2002. — 480 с., ил.^
18ВК 5-85438-025-0
Написано ведущими специалистами в области криптографии, имеющими
многолетний опыт разработки криптографических средств защиты и преподавания
дисциплин криптографического цикла в ведущих вузах страны
Излагаются основные понятия и разделы, позволяющие получить представление
о задачах и проблемах современной криптографии В пособие вошли
как традиционные вопросы классификации и оценки надежности шифров, так
и системные вопросы использования криптографических методов защиты информации
Для студентов, аспирантов, изучающих дисциплины по криптографии и
компьютерной безопасности, преподавателей, а также широко! о круга специалистов,
задачами которых являются квалифицированный выбор и организация
использования криптографических средств защиты информации
БЬК 32.81в6
Учебное издание
Алферов Александр Павлович, Зубов Анатолий Юрьевич,
Кузьмин Алексей Сергеевич, Черемушкин Александр Васильевич
ОСНОВЫ КРИПТОГРАФИИ
Заведующая редакцией Т А Денисова
Корректор Л М Лисицына
Компьютерная верстка С Н Аничкина
Лицензия ЛР № 066255 от 29 12 98
Формат 84x108/32 Объем 15 п л Печать офсетная Тираж 3000 экз Заказ № 598
Издательство «Гелиос АРВ»
107140, г Москва Верхняя Красносельская у л , 16 Тел /факс (095) 264-44-39,
е-ша!11пГо@§е1юз-ап' ги, \у\у\у §е1ю$-агу ги
© Алферов А. П , Зубов А. Ю ,
Кузьмин А С., Черемушкин А. В . 2002
I8ВN 5-85438-025-0 © Обложка Авилкин С. Н., Резник Е Н . 2002
Вступительное слово
Без использования криптографии сегодня немыслимо решение
задач по обеспечению безопасности информации, связанных
с конфиденциальностью и целостностью, аутентификацией
и невозможностью отказа сторон от авторства. Если
до 1990 г. криптография обеспечивала закрытие исключительно
государственных линий связи, то в наши дни использование
криптографических методов получило широкое распространение
благодаря развитию компьютерных сетей и
электронного обмена данными в различных областях: финансах,
банковском деле, торговле и т. п. Представляется, что
значение криптографических методов в указанных областях
будет возрастать и далее.
Разработка и использование современных приложений
криптографии невозможны без изучения теоретических основ
криптографии, которые систематически и доступно излагаются
в этой книге.
Данное учебное пособие написано высококвалифицированными
специалистами-криптографами, имеющими большой
опыт преподавания в Институте криптографии, связи и
информатики Академии ФСБ России, который осуществляет
подготовку криптографов с 1949 г. Содержание полностью
соответствует Государственным образовательным стандартам
высшего профессионального образования по специальностям:
“Компьютерная безопасность”, “Комплексное обеспечение
информационной безопасности автоматизированных систем”,
а также “Информационная безопасность телекоммуникационных
систем”. Эти специальности в 2000 г. вошли в сформированную
новую группу специальностей “Информационная
безопасность”. В настоящее время более 80 вузов страны начали
или развертывают подготовку соответствующих специа3
листов. Поэтому выход в свет данного учебного пособия
весьма актуален.
Предлагаемая книга дополняет серию изданий, начатую в
1998 г. Учебно-методическим объединением вузов по образованию
в области информационной безопасности, в которую
вошли, в частности, следующие учебные пособия:
Белкин П.Ю., Михалъский О. О., Пергиаков А. С., Прави-
ков Д.И., Проскурин В.Г., Фоменков Г.В., Щербаков А.Ю.
Программно-аппаратные средства обеспечения информационной
безопасности. Защита программ и данных. — М.: Радио
и связь, 2000;
Проскурин В.Г., Крутов С.В., Мацкевич И В . Программноаппаратные
средства обеспечения информационной безопасности.
Защита в операционных системах. — М.: Радио и
связь, 2000;
Девянин П.Н., Михалъский О.О., Правиков Д.И., Щербаков
А.Ю. Теоретические основы компьютерной безопасности.
— М.: Радио и связь, 2000.
Книга “Основы криптографии” в отличие от многих книг
на русском языке по криптографии, вышедших в 90-е годы,
изначально была задумана как учебное пособие. Она характеризуется
цельностью и последовательностью изложения, четкостью
определения основных понятий, математической
строгостью и хорошей методической проработкой. Уверен,
что ее издание будет способствовать улучшению подготовки
специалистов по защите информации.
Б. А. Погорелое,
председатель Учебно-методического объединения вузов
по образованию в области информационной безопасности,
действительный член Академии криптографии РФ,
доктор физ.-мат. наук, профессор
4
Введение
Еще 20 лет назад криптография использовалась почти исключительно
для обеспечения безопасности военной и дипломатической
связи, а также для целей разведывательной и
контрразведывательной спецслужб. Вместе с тем начавшееся
в 80-е годы бурное развитие информационных технологий и
внедрение автоматизированных методов и средств обработки
информации практически во все сферы деятельности людей
привели к необходимости более широкого использования
криптографических средств защиты информации. При этом
использование таких средств невозможно без знания основных
принципов, лежащих в основе их функционирования и
определяющих возможности этих средств по защите информации.
Таким образом, к настоящему времени появилась необходимость
ознакомления с основными понятиями криптографии
широкого круга специалистов, задачей которых является
не собственно разработка средств защиты информации, а скорее
квалифицированный выбор этих средств и организация их
использования в системах закрытой связи, не принадлежащих
силовым структурам или специальным службам. Имеющиеся
в настоящее время многочисленные публикации по вопросам
криптографии не могут, по нашему мнению, обеспечить в
полной мере указанные потребности. Эти публикации адресованы
либо специалистам-криптографам, и поэтому оставляют
без должного внимания многие практические и системные
вопросы, не связанные непосредственно с математическими
аспектами указанной науки, либо посвящены, хотя и важным,
но отдельным аспектам обеспечения защиты информации
криптографическими методами, либо носят научно-популярный
характер в ущерб научной глубине излагаемых результатов.
5
Ьвебение
Пособие рассчитано, в основном, на студентов, в чей круг
обязанностей после окончания учебы должны входить вопросы
выбора и эксплуатации средств криптографической защиты
информации, используемых в системах засекреченной связи.
При этом опущен материал, связанный с детальным обоснованием
методов криптографического анализа, представляющих,
на наш взгляд, интерес только для специалистов в
области криптоанализа. Приводятся лишь общие описания
этих методов, позволяющие оценить их опасность и выработать
адекватные меры по их нейтрализации с привлечением,
при необходимости, специалистов в области криптографии.
Предлагаемое пособие представляет собой переработку
курсов, которые читались авторами в нескольких вариантах в
Институте криптографии, связи и информатики Академии
ФСБ России и Московском государственном институте радиотехники,
электроники и автоматики.
Учитывая возможность использования данного пособия
для изучения основ криптографии студентами-нематематика-
ми, авторы сознательно пошли на сохранение общего описательного
стиля изложения с четкой формулировкой основных
понятий и свойств, дополнив его включением теорем и
утверждений, для понимания доказательств которых необходима
соответствующая подготовка и которые при первоначальном
знакомстве рекомендуется опустить. Изложение материала
в необходимых случаях сопровождается примерами.
После глав приводятся вопросы для самоконтроля.
В пособии принята следующая организация текста: главы
разбиты на параграфы, которые имеют двойную нумерацию;
основные понятия выделяются в тексте курсивом; наиболее
важные определения имеют свой номер; теоремы, леммы, утверждения
и формулы имеют независимую нумерацию внутри
каждой главы. Для списка литературы выбрана символьная
индексация, составленная из трех букв фамилии первого автора
и года издания.
6
Обозначения
А*
А\
ым
а = Ь (той и)
а = Ь тос! п
(а*)
Ек{Ок)
Ек(х, У, г)
Н{х,у,г)
о т
§(М) (3„)
О)
г :
— множество слов в алфавите А ;
— мощность множества^;
— абсолютная величина числа а;
— целая часть числа а;
— ближайшее целое число, не меньшее а;
— сравнимость чисел а и Ъ по модулю п\
— остаток от деления числа Ь на число п\
— множество С с бинарной операцией “ *
правило зашифрования (расшифрования)
на ключе к;
правило зашифрования на ключе к сообщения,
образованного приписыванием
сообщений х ,у и 2 друг к другу,
значение хэш-функции к для последовательности,
образованной приписыванием
последовательностей х, у и г друг к
другу;
конечное поле из д элементов;
симметрическая группа подстановок на
множестве М{М~ {1,2,...,я}),
функция “след” из СР(дт) в СР{д),
1гчч" (а ) = а + а ч + а ч2 + ... + а ‘г ‘ ;
множество {0, 1, ..., п - 1}, образующее
кольцо относительно сложения и
умножения элементов по модулю п\
множество обратимых элементов коль-
Ца2„.
7
Г л а в а 1
Исторический очерк развития
криптографии
История криптографии насчитывает не одно тысячелетие.
Уже в исторических документах древних цивилизаций —
Индии, Египте, Китае, Месопотамии — имеются сведения о
системах и способах составления шифрованного письма. Видимо,
первые системы шифрования появились одновременно
с письменностью в четвертом тысячелетии до нашей эры.
В древнеиндийских рукописях приводится более шестидесяти
способов письма, среди которых есть и такие, которые
можно рассматривать как криптографические. Имеется описание
системы замены гласных букв согласными, и наоборот.
Один из сохранившихся шифрованных текстов Месопотамии
представляет собой табличку, написанную клинописью и содержащую
рецепт изготовления глазури для гончарных изделий.
В этом тексте использовались редко употребляемые
значки, игнорировались некогорые буквы, употреблялись
цифры вместо имен. В рукописях Древнего Египта шифровались
религиозные тексты и медицинские рецепты. Шифрование
использовалось в Библии. Некоторые фрагменты библейских
текстов зашифрованы с помощью шифра, который назывался
атбаги. Правило зашифрования состояло в замене 1-й
буквы алфавита ( / = 1 ,л ) буквой с номером л —/ + 1 , где
п — число букв алфавита. Происхождение слова атбаги
объясняется принципом замены букв. Это слово составлено из
букв Алеф, Тае, Бет и Шин, то есть первой и последней, второй
и предпоследней букв древнесемитского алфавита.
Развитию криптографии способствовал переход от идео-
графичекого письма, основанного на использовании огромно8
Краткий исторический очерк
го числа иероглифов, к фонетическому письму. В древнем
семитском алфавите во втором тысячелетии до нашей эры
было уже 30 знаков. Ими обозначались согласные звуки, а
также некоторые гласные и слоги. Упрощение письма стимулировало
развитие криптографии.
В Древней Греции криптография уже широко использовалась
в разных областях деятельности, в особенности в государственной
сфере. Плутарх сообщает, что жрецы, например,
хранили в форме тайнописи свои прорицания. В Спарте в
V — IV вв. до н. э. использовалось одно из первых шифровальных
приспособлений — Сцитала. Это был жезл цилиндрической
формы, на который наматывалась лента пергамента.
Кроме жезла могли использоваться рукоятки мечей, кинжалов
копий и т.д. Вдоль оси цилиндра на пергамент построчно записывался
текст, предназначенный для передачи. После записи
текста лента сматывалась с жезла и передавалась адресату,
который имел точно такую же Сциталу. Ясно, что такой способ
шифрования осуществлял перестановку букв сообщения.
Ключом шифра служит диаметр Сциталы. Известен также и
метод вскрытия такого шифра, приписываемый Аристотелю.
Предлагалось заточить на конус длинный брус и, обернув
вокруг него ленту, начать сдвигать ее по конусу от малого
диаметра до самого большого. В том месте, где диаметр конуса
совпадал с диаметром Сциталы, буквы текста сочетались в
слоги и слова. После этого оставалось лишь изготовить цилиндр
нужного диаметра.
Другим шифровальным приспособлением времен Спарты
была табличка Энея. На небольшой табличке горизонтально
располагался алфавит, а по ее боковым сторонам имелись
выемки для наматывания нити. При зашифровании нить закреплялась
у одной из сторон таблички и наматывалась на
нее. На нити делались отметки (например, узелки) в местах,
которые находились напротив букв данного текста. По алфавиту
можно было двигаться лишь в одну сторону, то есть делать
по одной отметке на каждом витке. После зашифрования
9
Гпава 1
нить сматывалась и передавалась адресату. Этот шифр представляет
собой шифр замены букв открытого текста знаками,
которые означали расстояния между отметками на нити.
Ключом являлись геометрические размеры таблички и порядок
расположения букв алфавита. Это был довольно надежный
шифр: история не сохранила документов, подтверждающих
сведения о методах его вскрытия.
Греческий писатель Полибий использовал систему сигнализации,
которая была широко принята как метод шифрования.
Он записывал буквы алфавита в квадратную таблицу и
заменял их координатами: парами чисел (/,у ), где г — номер
строки, у — номер столбца. Применительно к латинскому
алфавиту квадрат Полибия имеет следующий вид (см.
табл. 1).
Т аб л и ц а 1. Квадрат Полибия
1 2 3 4 5
1 А В с Э Е
2 Р О н У К
3 Ь м N О Р
4 <5 к 8 т 1]
5 V АУ X V Ъ
Пары (/,у) передавались с помощью факелов. Например,
для передачи буквы О нужно было взять 3 факела в правую
руку и 4 факела — в левую.
Подобные шифровальные приспособления с небольшими
изменениями просуществовали до эпохи военных походов
Юлия Цезаря. Положение меняется в эпоху расцвета Рима,
который первоначально представлял собой лишь небольшую
гражданскую общину, со временем он разросся, подчинив
себе сначала Италию, а затем и все Средиземноморье. Чтобы
управлять наместниками в многочисленных провинциях,
10
Краткий исторический очерк
шифрованная связь для римских органов власти стала жизненно
необходимой. Особую роль в сохранении тайны сыграл
способ шифрования, предложенный Юлием Цезарем и изложенный
им в “Записках о галльской войне” (I в. до н.э.). Вот
что пишет о нем Гай Светоний: “...существуют и его письма к
Цицерону и письма к близким о домашних делах: в них, если
нужно было сообщить что-нибудь негласно, он пользовался
тайнописью, то есть менял буквы так, чтобы из них не складывалось
ни одного слова. Чтобы разобрать и прочитать их,
нужно читать всякий раз четвертую букву вместо первой,
например, О вместо А и так далее” [КаЬ67]. Таким образом,
Цезарь заменял буквы в соответствии с подстановкой, нижняя
строка которой представляет собой алфавит открытого текста,
сдвинутый циклически на три буквы влево.
Со времен Цезаря до XV в. шифровальное дело претерпело
много изменений, однако нам мало известно о методах и
системах шифрования, применяемых в этот период времени.
В мрачные годы средневековья практика шифрования сохранялась
в строжайшей тайне. Так, в годы крестовых походов
шифровальщики, служившие у Папы Римского, после года
работы подлежали физическому уничтожению.
В эпоху Возрождения в итальянских городах-государствах
параллельно с расцветом культуры и науки активно развивается
криптография. Нередко ученые зашифровывали научные
гипотезы, чтобы не прослыть еретиками и не подвергнуться
преследованиям инквизиции.
Научные методы в криптографии впервые появились, по-
видимому, в арабских странах. Арабского происхождения и
само слово шифр. О тайнописи и ее значении говорится даже
в сказках “Тысячи и одной ночи”. Первая книга, специально
посвященная описанию некоторых шифров, появилась в
855 г., она называлась “Книга о большом стремлении человека
разгадать загадки древней письменности”. В 1412 г. издается
14-томная энциклопедия, содержащая систематический
обзор всех важнейших областей человеческого знания, —
11
I лава 1
“Шауба аль-Аща”. Ее автор — Шехаб аль-Кашканди. В этой
энциклопедии есть раздел о криптографии под заголовком
“Относительно сокрытия в буквах тайных сообщений”, в котором
приводятся семь способов шифрования. Там же дается
перечень букв в порядке частоты их употребления в арабском
языке на основе изучения текста Корана, а также приводятся
примеры раскрытия шифров методом частотного анализа
встречаемости букв.
В XIV в. появилась книга о системах тайнописи, написанная
сотрудником тайной канцелярии Папы Римского Чик-
ко Симонетти. В этой книге приводятся шифры замены, в
которых гласным буквам соответствуют несколько значковых
выражений. Такие шифры позже стали называться шифрами
многозначной замены или омофонами. Они получили развитие
в XV в. Так, в книге “Трактат о шифрах” Габриеля де Ла-
винды — секретаря папы Климентия XII — приводится описание
шифра пропорциональной замены, в котором каждой
букве ставится в соответствие несколько эквивалентов, число
которых пропорционально частоте встречаемости буквы в
открытом тексте. В 1469 г. был предложен подобный же
шифр, получивший название “миланский ключ”. Появление
омофонов свидетельствовало о том, что к этому времени уже
хорошо осознавали слабости шифров простой замены. Такая
модификация шифра разрушала статистику букв открытого
сообщения, что явилось заметным шагом в развитии криптографии.
Еще один значительный шаг вперед криптография сделала
благодаря труду Леона Альберти. Известный философ,
живописец, архитектор, он в 1466 г. написал труд о шифрах. В
этой работе был предложен шифр, основанный на использовании
шифровального диска. Сам Альберти назвал его шифром,
“достойным королей”.
Шифровальный диск представлял собой пару соосных
дисков разного диаметра (см. рис. 1). Больший из них — неподвижный,
его окружность разделена на 24 равных сектора,
12
Краткий исторический очерк
в которые вписаны 20 букв латинского алфавита в их естественном
порядке и 4 цифры (от 1 до 4). При этом из 24-
буквенного алфавита были удалены 4 буквы, без которых
можно было обойтись, подобно тому, как в русском языке
обходятся без Ъ, Ё, И. Меньший диск — подвижный, по его
окружности, разбитой также на 24 сектора, были вписаны все
буквы смешанного латинского алфавита.
Имея два таких прибора, корреспонденты договаривались
о первой индексной букве на подвижном диске. При шифровании
сообщения отправитель ставил индексную букву против
любой буквы большего диска. Он информировал корреспондента
о таком положении диска, записывая эту букву
внешнего диска в качестве первой буквы шифртекста. Очередная
буква открытого текста отыскивалась на неподвижном
диске и стоящая против нее буква меньшего диска являлась
результатом ее зашифрования. После того как были зашифрованы
несколько букв текста, положение индексной буквы
изменялось, о чем также каким-либо образом передавалось
корреспонденту.
Рис. 1. Диск Альберти
13
Iлава 1
Такой шифр имел две особенности, которые делают изобретение
Альберти событием в истории криптографии. Во-
первых, в отличие от шифров простой замены шифровальный
диск использовал не один, а несколько алфавитов для зашифрования.
Такие шифры получили названиъ многоалфавитных.
Во-вторых, шифровальный диск позволял использовать так
называемые коды с перешифрованием, которые получили
широкое распространение лишь в конце XIX в., то есть спустя
четыре столетия после изобретения Альберти. Для этой цели
на внешнем диске имелись цифры. Альберти составил код,
состоящий из 336 кодовых групп, занумерованных от 11 до
4444. Каждому кодовому обозначению соответствовала некоторая
законченная фраза. Когда такая фраза встречалась в
открытом сообщении, она заменялась соответствующим кодовым
обозначением, а с помощью диска цифры зашифровывались
как обычные знаки открытого текста, превращаясь в
буквы.
Богатым на новые идеи в криптографии оказался XVI в.
Многоалфавитные шифры получили развитие в вышедшей в
1518 г. первой печатной книге по криптографии под названием
“Полиграфия”. Автором книги был один из самых знаменитых
ученых того времени аббат Иоганнес Тритемий. В этой
книге впервые в криптографии появляется квадратная таблица.
Шифралфавиты записаны в строки таблицы один под другим,
причем каждый из них сдвинут на одну позицию влево
по сравнению с предыдущим (см. табл. 2).
Тритемий предлагал использовать эту таблицу для многоалфавитного
зашифрования самым простым из возможных
способов: первая буква текста шифруется первым алфавитом,
вторая буква — вторым и т. д. В этой таблице не было отдельного
алфавита открытого текста, для этой цели служил
алфавит первой строки. Таким образом, открытый текст, начинающийся
со слов Н1ЛЧС САУЕТО УПШМ ..., приобретал
вид НХРР ОРВМС2 РЦЕ1В ... .
14
Краткий исторический очерк
Преимущество этого метода шифрования по сравнению с
методом Альберти состоит в том, что с каждой буквой задействуется
новый алфавит. Альберти менял алфавиты лишь после
трех или четырех слов. Поэтому его шифртекст состоял из
отрезков, каждый из которых обладал закономерностями открытого
текста, которые помогали вскрыть криптограмму.
Побуквенное зашифрование не дает такого преимущества.
Шифр Тритемия является также первым нетривиальным
примером периодического шифра. Так называется многоалфавитный
шифр, правило зашифрования которого состоит в
использовании периодически повторяющейся последовательности
простых замен.
Т аб л и ц а 2. Таблица Тритемия
А в С в Е Р С Н I К В М N О Р О Я 8 т В X У 2 XV
В с В Е Р О Н I К Ь М N О р я 8 Т в X У 2 XV А
С О Е Р С Н I К В М N О Р <3 я 8 Т и X У 2 XV А В
Э Е Р О Н I К Е м N О Р 0 я 8 т В X У 2 XV' А В С
Е р О Н I К В М N О Р 0 я 8 Т в X У 2 XV А В С В
Р о Н I К в м N О Р (? я 8 Т В X У 2 XV А В С В Е
С н I К В м N О Р 0 Я 8 Т В X У 2 XV А В С В Е Р
н I К Ь М N О Р 9 я 8 Т и X У 2 XV А В С О Е Р С
I К Ь м N О Р 0 я 8 Т V X У 2 XV А В С Б Е Р О Н
К в М N О р 0 я 8 Т V X У 2 XV А В С Э Е Р С Н I
ь м N О Р 0 я 8 Т В X У 2 XV А В С В Е Р О Н I К
м N О Р 0 я 8 Т и X У 2 XV А В С В Е Р С Н I К В
N О Р Я 8 Т и X У 2 XV А В С В Е Р О Н I К В М
О р 0 я 8 Т V X У 2 XV А В С О Е Р О Н I К В М N
р 0 я 8 Т V X У 2 XV А В С В Е Р О Н I К В М N О
0 я 8 Т и X У 2 XV А В С В Е Р О Н I К В м N О Р
я 8 Т V X У 2 XV А В С В Е Р О Н I К Ь М N О Р Р
8 т В X У 2 XV А В С В Е Р С Н I К Ь М N О Р Я
Т V X У 2 XV А В С В Е Р О Н I К Ь М N О Р я 8
В X У 2 XV А В С Э Е Р О Н I К В м N О Р 0 я 8 Т
X У ъ \У А В С О Е Р О Н I К В М N О Р я 8 Т В
У 2 XV А В С В Е Р С Н I К Ь м N О Р 0 я 8 Т В X
г XV А В С Э Е Р С Н I К В м N О Р 0 я 8 Т и X У
ху А В С О Е Р С Н I К Ь м N О Р 0 я 8 Т В X У 2
15
[лава 1
В 1553 г. Джованни Баттиста Белазо предложил использовать
для многоалфавитного шифра буквенный, легко запоминаемый
ключ, который он назвал паролем. Паролем могло
служить слово или фраза. Пароль периодически записывался
над открытым текстом. Буква пароля, расположенная над буквой
текста, указывала на алфавит таблицы, который использовался
для зашифрования этой буквы. Например, это мог
быть алфавит из таблицы Тритемия, первой буквой которого
являлась буква пароля. Однако Белазо, как и Тритемий, использовал
в качестве шифралфавитов обычные алфавиты.
Воскресить смешанные алфавиты, которые применял
Альберти, и объединить идеи Альберти с идеями Тритемия и
Белазо в современную концепцию многоалфавитной замены
выпало на долю итальянца Джованни де ла Порта. Ему было
28 лет, когда он в 1563 г. опубликовал книгу “О тайной переписке”.
По сути, эта книга являлась учебником по криптографии,
содержащим криптографические познания того времени.
Порта предложил использовать квадратную таблицу с периодически
сдвигаемым смешанным алфавитом и паролем. Он
советовал выбирать длинный ключ. Впервые им был предложен
шифр простой биграммной замены, в котором пары букв
представлялись одним специальным графическим символом.
Они заполняли квадратную таблицу размером 20 х 20, строки
и столбцы которой занумерованы буквами алфавита
Например, биграмма ЕА заменялась символом , биграмма
ЬР — символом ? и т. д. В своей книге Порта ввел многоалфавитный
шифр, определяемый табл. 3.
АвсоЕРан1ьмкордк8ти2
16
Краткий исторический очерк
Т аб л и ц а 3. Таблица Порта
А а Ь с й е Г ё Ь 1 к 1 т
В п о р Я г 8 X и у 2 XV
С а Ь с а е Г ё Ь 1 к 1 т
В о Р я г 8 X и X 2 XV п
Е а Ь с й е г ё Ь 1 к 1 т
Р Р Я г 8 1 и X У п о
О а Ъ с а е Г ё ь 1 к 1 т
Н Я г 8 X и X У 2 XV п О Р
I а Ь С а е { ё ь 1 к 1 т
К г 8 X и X У 2 о Р Я
Ь а ь с а е Г ё Ь 1 к 1 т
М 5 * и X У 2 XV п Р Я г
N а ь с а е Г ё Ь 1 к 1 т
О X и X у 2 Т1 О Я г 8
Р а Ь с а е г ё Ь 1 к 1 т
9 и X У 2 \У п О Р г 8
я а Ь с а е Г ё Ь 1 к 1 т
8 X у 2 \У п о р Я 8 X и
Т а ь С а е Г ё ь 1 к 1 т
II у 2 \У п о Р Я г X и X
X а ь с а е Г ё Ь 1 к 1 ш
У 2 XV п О Р Я г 8 и X У
Ъ а Ь с а е Г ё ь 1 к 1 т
\У \У п О р Я г 8 1 и X У 2
Шифрование осуществляется при помощи лозунга, который
пишется над открытым текстом. Буква лозунга определяет
алфавит (заглавные буквы первого столбца), расположенная
под ней буква открытого текста ищется в верхнем или
нижнем полуалфавите и заменяется соответствующей ей буквой
второго полуалфавита. Например, фраза, начинающаяся
словами Н1ЖС САУЕТО УПШМ..., будет зашифрована при
помощи лозунга ЭЕ ЬА РОЯТА в ХРНР УТМООА РС2ЕА8.
Еще одно важное усовершенствование многоалфавитных
систем, состоящее в идее использования в качестве ключа
17
I лава 1
текста самого сообщения или же шифрованного текста, принадлежит
Джероламо Кардано и Блезу де Виженеру. Такой
шифр был назван самоключом. В книге Виженера 'Трактат о
шифрах” самоключ представлен следующим образом. В простейшем
случае за основу бралась таблица Тритемия с добавленными
к ней в качестве первой строки и первого столбца
алфавитами в их естественном порядке. Позже такая таблица
стала называться таблицей Виженера. Подчеркнем, что в
общем случае таблица Виженера состоит из циклически сдвигаемых
алфавитов, причем первая строка может быть произвольным
смешанным алфавитом (см. табл. 4).
Т аб л и ц а 4. Таблица Виженера
А в С О Е Р О Н I К Е М N О Р Р Я 8 т и X У 2 XV
А А в С В Е Р О Н I К 1 м N О Р Р я 8 т В X У 2 XV
В В с Э Е Р О Н I К Ь М N О Р Р Я 8 Т V X У 2 XVА
С С О Е Р О н I К Ь м N О Р Р Я 8 Т и X У 2 XVА В
О О Е Р С Н I К Ь М N О р Р Я 8 Т и X У 2 XV А В С
Е Е Р С Н I К Ь М N О Р р Я 8 Т II X У 7 XVА В С э
Р Р С Н I К ь М N О Р Р я 8 Т ЕГ X У 2 XVА В С В Е
О С Н I К Е м N О Р Р Я 8 Т В X У 2 XVА В С О Е Р
Н Н I К Ь М N О Р Р Я 8 Т В X У 2 XV А В С В Е Р О
I I К Ь М N О Р Р Я 8 Т В X У 2 XVА В С В Е Р С Н
К К Ь м N О р Р Я 8 Т В X У 2 XVА В С В Е Р О Н I
Е 1 м N О Р 0 Я 8 Т и X У 2 XVА В С В Е Р О Н I К
М М N О Р 0 я 8 Т 1] X У 2 XVА В С О Е Р С Н I К Е
N N О Р 0 я 8 Т V X У 2 XVА В С В Е Р О Н I К Е М
О О Р 0 я 8 т V X У 2 XVА В С О Е Р О Н I К Е М N
Р Р 0 я 8 Т В X У 2 XVА В С В Е Р С Н I К Е М N О
0 0 я 8 Т и X У 2 XVА В С в Е Р О Н I К Е М N О Р
я я 8 т и X У 2 XVА В С В Е Р С Н I К М N О Р Р
8 8 Т В X У ъ XVА В С В Е Р О Н I К 1 М N О Р Р Я
Т Т V X У 2 XVА В С О Е Р О Н I К 1 М N О Р Р Я 8
1] В X У 2 XVА В С О Е Р С Н I К Е М N О Р Р Я 8 Т
X X У г XVА В С В Е Р О Н I К Е М N О Р Р Я 8 Т В
У У 2 XV А В С э Е Р С Н I К 1 М N О Р Р Я 8 Т V X
2 2 \У А В С В Е Р С Н I К Е М N О Р Р Я 8 Т Е1 X У
XVXVА В С В Е Р С Н I К Е М N О Р Р Я 8 Т В X У 2
18
Краткий исторический очерк
Первая строка служит алфавитом открытого текста, а
первый столбец — алфавитом ключа. Для зашифрования открытого
сообщения (Тп ~ ^ 2...) Виженер предлагал в качестве
ключевой последовательности ( Г ) использовать само сообщение
( Т0) с добавленной к нему в качестве первой буквы
(70), известной отправителю и получателю (этим идея Виженера
отличалась от идеи Кардано, у которого не было начальной
буквы и система которого не обеспечивала однозначности
расшифрования). Последовательности букв подписывались
друг под другом:
г = /0 и ^2 ^/-1 •••
Тр = $] ^2 ••• *Г••
Тш = ■*! *2 - V "
При этом пара букв, стоящих друг под другом в Г и Т0, указывала,
соответственно, номера строк и столбцов таблицы, на
пресечении которых находится знак 5, шифрованного текста
(Тш ). Например, фраза Н1МС СДУЕТО УИШМ ..., использованная
в предыдущих примерах, и начальная буква Р дают
шифртекст УСНР ЕС1Ж2Н ЮАМО.
Во втором варианте Виженер предлагал в качестве ключевой
последовательности использовать шифрованный текст:
Г = ^1 $2-"$1-1 •••
Тр ~*[ ^2 ^3
Тш ~$\3233 •“ $/•••
Самоключ Виженера был незаслуженно забыт на долгое
время, а под шифром Виженера до сих пор понимают самый
простой вариант с коротким ключевым словом и с таблицей,
состоящей из обычных алфавитов.
19
Глава 1
Кардано принадлежит также идея поворотной решетки
как средства шифрования. Изначально обычная решетка
представляла собой лист из твердого материала, в котором
через неправильные интервалы сделаны прямоугольные вырезы
высотой для одной строчки и различной длины. Накладывая
эту решетку на лист писчей бумаги, можно было записывать
в вырезы секретное сообщение. После этого, сняв решетку,
нужно было заполнить оставшиеся свободные места на
листе бумаги неким текстом, маскирующим секретное сообщение.
Подобным стеганографическим методом маскировки
сообщения пользовались многие известные исторические лица,
например кардинал Ришелье во Франции и русский дипломат
и писатель А. Грибоедов. Так, Ришелье использовал
прямоугольник размера 7 x 1 0 . Для длинных сообщений прямоугольник
использовался несколько раз. Прорези трафарета
размещались в позициях:
(1,8), (2,9), (3,6), (4,5), (4,6), (5,1), (5,6),
(5,7), (5,9), (6,2), (6,10), (7,9),(7,10).
1 2 3 4 5 6 7 8 9 10
Рис. 2. Пример решетки (заимствован из [Сал96])
Следующий текст выглядит как невинное любовное письмо
(см. рис. 3).
20
Краткий исторический очерк
1 2 3 4 5 6 7 8 9 10
1 I Ь О V Е О V
2 I Н А V Е V ■ и
3 и Е Е Р ■ N Р Е Я
4 м V 8 И N М V
5 ■ О V Е ■ ■ 8 ■ з
67
р
н
■
V
КР
Е
Е
VК
Е8
К.Р А тЛ
Рис.З
Однако используя трафарет Ришелье, получим зловещую
команду:
УОТТ К11Х АТСЖЕ8
Кардано использовал квадратную решетку, которая своими
вырезами однократно покрывает всю площадь квадрата
при ее самосовмещениях. На основе такой решетки он построил
шифр перестановки.
Нельзя не упомянуть в историческом обзоре имени Матео
Ардженти, работавшего в области криптографии в начале
XVII в. Он составил руководство по криптографии на 135
листах, изданное в переплете из телячьей кожи. В этой книге
впервые предложено использовать некоторое слово в качестве
мнемонического ключа для смешанного алфавита. Началом
смешанного алфавита служило ключевое слово (как правило,
без повторяющихся букв), за которым следовали остальные
буквы в их естественном порядке. Например, ключевое слово
Р1ЕТКО дает смешанный латинский алфавит
Р 1 Е Т К О А В С О РО Н ЕМ К д 8 и 2
Такие смешанные алфавиты часто использовались в качестве
алфавитов шифртекста в шифрах простой замены.
21
(лава 1
С целью усложнения шифра простой замены Ардженти
вводил пустышки, которые добавлялись в шифрованное сообщение,
использовал шифробозначения разной значности,
для некоторых частых сочетаний букв текста вводил отдельные
обозначения, придавал частым буквам несколько обозначений.
Позже подобные идеи получили широкое распространение.
Приведем пример шифра Ардженти (см. табл. 5).
Т аб л и ц а 5. Шифр Ардженти
А В С В Е р О н I ь М N О
1 86 02 20
4С0 <) СОЧО
22 06 60 3 24 26 84 9
Р 0 К 8 Т В 2 ЕТ СОК КОК СНЕ 0
66 68 28 42 80
О^ тог
88 08 64 00 44 5
7
Слово АКХЗЕКТ1 может быть зашифровано многими способами,
например так:
5128068285480377
или же так:
172850675628455803
Наибольшим достижением Ардженти считается разработанный
им буквенный код — один из шифров замены, в котором
буквы, слоги, слова и целые фразы заменялись группами
букв. Необходимым количеством словарных величин в коде в
то время считалось 1200.
В истории криптографии XVII — XVIII в. называют эрой
“черных кабинетов”. В этот период во многих государствах
Европы, в первую очередь во Франции, получили развитие
дешифровальные подразделения, названные “черными кабинетами”.
Первый из них образован по инициативе кардинала
Ришелье при дворе короля Людовика XIII. Его возглавил первый
профессиональный криптограф Франции Антуан Рос-
22
Краткий исторический очерк
синьоль. Следует отметить, что некоторые оригинальные
идеи, возникшие в криптографии в этот период, связаны с
именем самого Ришелье, который использовал, например,
для секретной переписки с королем оригинальный шифр перестановки
с переменным ключом. Его использование становится
понятным из следующего примера:
Шифр Ришелье
Ключ: 2741635; 15243; 671852493; 07; 28615; 943;...
Открытый текст:
ЬЕТТЕК. 8Е1ЧТ ТО ТНЕ ЕМРЕКОК 01УГЫ0 Р1ЛХ ОЕТА1Ь
Ключ:
(2741635) (15243) (671852493) (07) (28615) (943) (27 41635)
Шифртекст:
ТЬКТ8ЕЕ ЕТОПМ ЕРОЕМТНЕК N1 ШСЮ УРК ТЫЕ 8АО
Известно, что Ришелье пользовался также кодами. Попутно
отметим, что свой несложный код был и у знаменитого
Наполеона:
Малый шифр Наполеона (РеШ СЫ//ге)
(реконструирован Базери)
А - 15, а г - 25, а1 - 39
В -3 7 , Ъи-3, Ь о -3 5 , Ы -2 9
С - 6, са - 32, се - 20
Э -2 3 , б е -5 2
Е - 53, ев - 82, е! - 50, еп - 68
Р - 55, Р а - 69, Ре- 58, Го- 71
0 - 81, § а - 51
Н - 85, Ы - 77
1 - 119, )а* - 122
1-87,ла1— 123
К - ?
Ь - 9 6 ,1и - 103,1е - 117,1а-1 0 6
М - 114, т а -107
N -1 1 5 , п е -9 4 , ш - 116
23
I лава 1
0 - 9 0 , 01-153
Р - 137, ро - 152
(2 - 173, - 136
Я - 169, га - 146, ге - 126, п - 148,
8 - 167, за - 171, з е - 177, 81- 134, з о - 168, з и - 174
Т - 176, й - 145,Ю- 157
11-138
V - 164, уе - 132, VI - 161, уо - 175
\У, X, V - ?
2 - 166
В то время в Европе получили широкое распространение
шифры, называемые номенклаторами, объединявшие в себе
простую замену и код. В простейших номенклаторах код состоял
из нескольких десятков слов или фраз с двухбуквенными
кодовыми обозначениями. Со временем списки заменяемых
слов в номенклаторах увеличились до двух или трех тысяч
эквивалентов слогов и слов. В царской России XVIII в.
закодированное открытое сообщение шифровалось далее простой
заменой.
Кстати, несколько слов о русской криптографии. Уже с
XIV в. в Новгороде существовала техника тайного письма.
Использовались в основном шифры простой замены. Благодаря
торговым связям Новгорода с Германией в России становятся
известными многие западные разработки, в том числе
новые системы шифрования. Учреждение постоянной почтовой
связи России с Европой дало возможность развитию
шифрованной переписки. Благодаря привлечению Петром I
для разработки проектов развития образования и государственного
устройства России знаменитого Готфрида Вильгельма
Лейбница, который известен и как криптограф, в Петербурге
появилась цифирная палата, задачами которой было
развитие и использование систем шифрования.
Когда Россиньоль начинал свою карьеру, в номенклаторах
как элементы открытого текста, так и элементы кода рас24
Краткий исторический очерк
полагались в алфавитном порядке (или в алфавитном и числовом
порядке, если код был цифровой). Россиньоль заметил,
что такой "‘параллелизм” открытого текста и кода облегчал
восстановление открытого текста. Если, например, он устанавливал,
что в английской депеше 137 заменяет РОК, а
168 — ПЧ, то он уже знал, что 21 не может заменять ТО, так
как цифровые кодовые обозначения для слов, начинающихся
с Т, должны быть больше, нежели для слов, начинающихся
с I. Обнаружив такую слабость, Россиньоль перемешивал кодовые
элементы по отношению к открытому тексту. На одном
листе он располагал элементы открытого текста в алфавитном
порядке, а кодовые элементы — вразброс, на другом листе
для облегчения расшифрования кодовые элементы стояли в
алфавитном порядке, тогда как их открытые эквиваленты были
разбросаны. Это явилось значительным усовершенствованием
подобных шифрсистем. Однако составление неалфавитных
номенклаторов обходилось очень дорого, и, таким образом,
по соображениям экономии и в ущерб надежности многие
номенклаторы регрессировали к упрощенному алфавитному
типу.
В Англии тоже был свой “черный кабинет”. В его работе
в XVII в. заметное место занимал Джон Валлис, известный
как крупнейший английский математик до Исаака Ньютона.
Работы по вскрытию шифров для парламента привели к назначению
Валлиса в 1649 г. в Оксфорд профессором геометрии
в возрасте 32 лет. В своем труде “Арифметика бесконечного”
он сделал выводы, которые послужили Ньютону стартовой
площадкой для разработки интегрального исчисления.
Валлис ввел знак оо для бесконечности и первый путем интерполяции
вычислил число тт. Кстати, само это обозначение
также принадежит ему.
В Германии начальником первого дешифровального отделения
был граф Гронсфельд, создавший один из вариантов
усовершенствования шифра Виженера. Он взял числовой,
легко запоминаемый лозунг. Вместо таблицы Виженера ис25
Iлава 1
пользовался один несмешанный алфавит. При шифровании
знаки открытого текста выписывались под цифрами лозунга.
Очередная буква открытого текста заменялась буквой алфавита,
отстоящей от нее вправо на количество букв, равное соответствующей
цифре лозунга.
Шифр Гронсфельда
Открытый текст: ОЕКМАМУ
Лозунг: 1 3 5 7 9
Алфавит: АВСОЕРОтЖЬШТОРдЯЗТ ЬТУ\УХУ2
Для удобства выпишем алфавит с порядковыми номерами
букв:
А В С В Е Р О Н I К Ь М
1 2 3 4 5 6 7 8 9 10 11 12 13
N О Р 0 К 8 Т II V X У 2
14 15 16 17 18 19 20 21 22 23 24 25 26
и лозунг над текстом:
1 3 5 7 9 1 3
О Е КМ А К У
Теперь легко получить шифрованный текст:
ННЧУТЛЭВ
Любопытен опыт использования криптографии при составлении
астрономических анаграмм. Одно из таких применений
связано с открытием колец Сатурна [Пер66]‘.
В годы жизни Галилео Галилея существовал обычай закреплять
за собой право на первенство в каком-либо открытии
своеобразным способом. Напав на открытие, которое нуждается
в дальнейшем подтверждении, ученый из опасения, чтобы
его не опередили другие, прибегал к помощи анаграммы
(перестановке букв); он кратко объявлял о сущности своего
26
Краткий исторический очерк
открытия в форме анаграммы, истинный смысл которой был
известен лишь ему одному. Это давало ученому возможность
не спеша проверить свое открытие, а в случае появления другого
претендента — доказать свое первенство. Когда же он
окончательно убеждался в правильности первоначальной догадки,
он раскрывал секрет анаграммы. Заметив в свою несовершенную
подзорную трубу, что Сатурн имеет по бокам
какие-то придатки, Галилей поспешил сделать заявку на это
открытие и опубликовал следующий набор букв:
8МА18МЯМ]ЕЬМЕР0ЕТАЬЕиМ1В1]\гКЕГ10ТТАУ1КА8
Задача восстановления открытого текста (без какой-либо дополнительной
информации об использованном преобразовании)
требует перебора
39!
3!5!4!4!2!2!5!3!3!2!2!
возможных перестановок букв криптограммы (это — число
перестановок с повторениями). Приведенное число имеет в
своей записи примерно 35 цифр.
Современник итальянского ученого Иоганн Кеплер с
присущим ему беспримерным терпением затратил немало
труда на то, чтобы проникнуть в сокровенный смысл заявки
Галилея, и ему казалось, что он добился этого, когда из опубликованных
букв (опустив две из них) составил такую латинскую
фразу:
8АЬУЕ, 1)МВ13ТШЕ11М СЕМП4А1М МАК.Т1А РКОЬЕ8
(Привет вам, близнецы, Марса порождение)
Кеплер был убежден, что Галилей открыл те два спутника
Марса, существование которых подозревал он сам (они в действительности
и были открыты, но спустя два с половиной
века). Однако остроумие Кеплера на этот раз не привело к
27
Л лава 1
цели. Когда Галилей раскрыл, наконец, секрет своей заявки,
оказалось, что фраза (если двумя буквами пренебречь) такова:
АЬТ1881М1ЛУ1 РЬАШТАМ ТЕКОЕМ1ММ ОВ8ЕКУАУ1
(Высочайшую планету тройною наблюдал)
Из-за слабости своей трубы Галилей не мог понять истинного
значения этого “тройного” образа Сатурна, а когда
спустя несколько лет боковые придатки планеты совершенно
“исчезли”, Галилей решил, что ошибся, и никаких придатков
у Сатурна нет. Открыть кольца Сатурна удалось только через
полвека Гюйгенсу. Подобно Галилею, он не сразу опубликовал
свое открытие, а скрыл догадку под тайнописью:
АААААААСССССОЕЕЕЕОШ1ИИ1ЬЕЕЕМ1У^>ГЫК]Ч]^1КЫК
ООООРРдКК8ТТТТТШ1ЛШ
Спустя три года, убедившись в правильности своей догадки,
Гюйгенс обнародовал смысл заявки:
Аппи1о ст§киг, 1епш, р1апо, пиациат соЬаегеп!:е,
ад есНрйсат тс1ша1о
(Кольцом окружен т о н к и м , п л о с к и м , нигде
не прикасающимся, к эклиптике наклоненном)
В целом можно сказать, что XVII и XVIII вв не дали новых
идей в криптографии. Эра “черных кабинетов” закончилась
в 40-х годах XIX в. в период революционно^ подъема.
Много новых идей в криптографии принес XIX в. Изобретение
в середине XIX в. телеграфа и других технических
видов связи дало новый толчок развитию криптографии. Информация
передавалась в виде токовых и бестоковых посылок,
то есть представлялась в двоичном виде. Поэтому возникла
проблема “рационального” представления информа28
Краткий исторический очерк
ции, которая решалась с помощью кодов. Коды позволяли
передать длинное слово или целую фразу двумя-тремя знаками.
Появилась потребность в высокоскоростных способах
шифрования и в корректирующих кодах, необходимых в связи
с неизбежными ошибками при передаче сообщений.
Однако еще до изобретения телеграфа появился ряд интересных
шифровальных устройств. Приблизительно в 1800 г.
была создана одна шифровальная система, занимающая особое
место в истории криптографии. Речь идет о “дисковом
шифре” Т. Джефферсона — первого государственного секретаря
США, ставшего позже третьим президентом.
Дисковый шифратор Т. Джефферсона состоял из 25 - 36
деревянных дисков одинакового размера, насаженных на общую
ось(см. рис. 4)
Рис. 4. Дисковый шифратор Т. Джефферсона
На одном конце оси имелась неподвижная головка, на
другом — резьба и гайка, с помощью которой все диски фиксировались
в любом нужном угловом положении. Имелась
также прямолинейная рейка, способная вращаться на оси и
позволяющая выделить строку букв на дисках, параллельную
оси. На боковой поверхности каждого диска, разделенной на
26 равных частей, наносились буквы смешанных английских
алфавитов. Для зашифрования части сообщения (длина которой
равнялась числу дисков на оси) под рейку, находящуюся в
фиксированном угловом положении, подводилась первая бук29
I лава 1
ва сообщения, найденная на первом диске, затем — вторая
буква сообщения, найденная на втором диске, и т. д., так, чтобы
все подобранные буквы оказались в одной строке. Положение
дисков фиксировалось гайкой, после чего рейка подводилась
под любую другую строку цилиндра, буквы которой
составляли шифрованный текст. При расшифровании буквы
шифрованного текста, набранные на последовательных дисках,
подводились аналогичным образом под рейку, положение
дисков фиксировалось гайкой, после чего с помощью рейки
просматривались образовавшиеся строки цилиндра, среди
которых несложно было найти открытое сообщение.
Кажущаяся некорректность, связанная с возможностью
неоднозначности расшифрования, устраняется достаточно
большим числом используемых дисков. Это замечание относится,
конечно, лишь к осмысленным текстам. При зашифровании
неосмысленных текстов требовалась дополнительная
информация о величине сдвига рейки, без чего однозначное
расшифрование невозможно.
Такая шифрсистема имеет огромное количество ключевых
элементов. К ним относятся: расположение букв алфавита
на дисках, расстановка дисков на оси, выбор набора дисков
из имеющегося запаса. Дисковый шифр можно отнести по
типу к многоалфавитной замене. Его особенностью является
поблочный характер зашифрования, при котором каждый
участок текста (блок) шифруется независимо от других. Позже
такие шифры стали называться блочными шифрами.
Вместо того чтобы (пользуясь служебным положением)
внедрить свое замечательное изобретение в практику, Джефферсон,
по-видимому, отложил его в архив и предал забвению.
Шифр был обнаружен в его бумагах в библиотеке конгресса
лишь в 1922 г., по иронии судьбы именно в том году,
когда в армии США начали применять почти аналогичную
систему, изобретенную независимо от Джефферсона.
В 1817 г. другой американец Десиус Уодсворт сконструировал
шифровальное устройство, которое также внесло но-
30
Краткий исторический очерк
вый принцип в криптографию. Его нововведение состояло в
гом, что он сделал алфавиты открытого и шифрованного текстов
различных длин. Устройство, с помощью которого он это
осуществил, представляло собой диск, на котором были расположены
два подвижных кольца с алфавитами. Внешний
алфавит состоял из 26 букв и 7 цифр (от 2 до 8). Внутренний
алфавит состоял лишь из 26 букв. Диск имел подобие
неподвижной часовой стрелки, в двух прорезях которой появлялись
расположенные друг под другом буквы алфавитов.
На внутреннем кольце указывалась буква открытого текста,
на внешнем кольце — соответствующая буква шифртекста.
Оба кольца могли вращаться и были связаны друг с другом с
помощью двух шестерен, одна из которых имела 33 зубца, а
другая — 26. Буквы и цифры внешнего кольца были съемными
и могли быть собраны в любом порядке. Перед зашифрованием
корреспонденты договаривались относительно взаимного
начального положения обоих колец. Для установки
дисков в такое положение шестерни можно было разъединить.
Проследим на примере слова “введение” процесс зашифрования.
Сначала внутреннее кольцо поворачивалось до тех пор,
пока в прорези стрелки не показывалась буква “в”. Стоящая
в другой прорези буква внешнего кольца записывалась в качестве
первой буквы шифртекста. Затем внутреннее кольцо
вращаюсь до тех пор, пока буква “в” вновь не показывалась
в прорези. Это вращение посредством шестерен передаваюсь
на внешнее кольцо, но из-за различия в числе букв алфавитов
оно совершало лишь 26^ полного оборота, в то время как
внутреннее кольцо совершало полный оборот. Значит, второй
знак шифртекста располагался во внешнем алфавите на расстоянии
семи мест вперед от первого знака, несмотря на то,
что оба знака представляли одну и ту же букву открытого
текста. Если этот процесс зашифрования осуществлять дальше,
то эквиваленты шифртекста для буквы “в” начнут повторяться
лишь после того, как будут использованы все 33 буквы
31
/ лава 1
и цифры внешнего алфавита. Это объясняется тем, что числа
26 и 33 не имеют общих делителей, благодаря которым такое
повторение могло бы произойти раньше. Следующие буквы
открытого текста шифровались аналогично.
Такая шифрсистема реализует периодическую многоалфавитную
замену. Различие чисел букв алфавитов открытого
и шифрованного текстов приводит к существенным отличиям
этой системы от предыдущих многоалфавитных систем. Так,
в устройстве Уодсворда используется 33 шифралфавита, а не
24 или 26, как в системах Тритемия или Виженера. Важнее то,
что эти алфавиты используются не непосредственно один за
другим, а в произвольном порядке, который зависит от букв
открытого текста. Этот произвольный порядок служит гораздо
более надежной защитой шифра, чем правильная последовательность
использования алфавитов, как в системе Тритемия.
Идея Уодсворда была незаслуженно забыта. Славу открытия
приписывают английскому ученому Чарлзу Уитстону,
который значительно позже и независимо изобрел свое устройство
на том же принципе (см. рис. 5). Основное отличие
заключалось в том, что в устройстве Уитстона алфавиты были
неподвижными, но зато имелась пара подвижных стрелок,
соединенных шестеренками.
Уитстон более известен как ученый, предложивший идею
электрического телеграфа, изобретатель концертино, автор
первых стереоскопических рисунков. Он высказал гипотезу о
создании говорящих машин, разработал метод точного измерения
электрического сопротивления, который называется
“мостик Уитстона”.
Впервые свое устройство Уитстон продемонстрировал на
Всемирной выставке в Париже в 1876 г. На внешнем кольце
находился алфавит открытого текста, состоящий из 27 элементов:
26 букв, расположенных в обычном порядке, и знака
пробела между словами. Внутренний алфавит состоял из 26
букв, расположенных в произвольном порядке.
32
Краткий исторический очерк
Рис. 5
Уитстон изобрел шифр, который позже стали называть
шифром Плейфера. Дело в том, что Лион Плейфер, заместитель
председателя Палаты общин, министр почт, председатель
Британской ассоциации развития науки, был другом Уитстона,
был похож на него, так что их часто путали. В 1854 г.
Плейфер продемонстрировал систему шифрования, которую
он назвал “недавно открытый симметричный шифр Уитстона”.
Это был первый из известных биграммых буквенных
шифров (напомним, что биграммный шифр Порта был значковым).
То обстоятельство, что Плейфер популяризировал
изобретение Уитстона, сохранило его имя в названии шифра.
Этот шифр использовался англичанами в период первой мировой
войны. Описание и обсуждение этого шифра будет
приведено в гл. 5.
Во второй половине XIX в. появился весьма устойчивый
способ усложнения числовых кодов — гаммироеание. Он
заключался в перешифровании закодированного сообщения с
33
I лава 1
помощью некоторого ключевого числа, которое и называлось
гаммой. Шифрование с помощью гаммы состояло в сложении
всех кодированных групп сообщения с одним и тем же ключевым
числом. Эту операцию стали называть “наложением
гаммъГ. Например, результатом наложения гаммы 6413 на
кодированный текст 3425 7102 8139 являлась числовая последовательность
9838 3515 4552:
3425 7102 8139
+ 6413 6413 6413
9838 3515 4552
Единицы переноса, появляющиеся при сложении между
кодовыми группами, опускались. “Снятие гаммы” являлось
обратной операцией:
9838 3515 4552
- 6413 6413 6413
3425 7102 8139
В 1888 г. француз маркиз де Виари в одной из своих научных
статей, посвященных криптографии, обозначил греческой
буквой X любую букву шифрованного текста, греческой
буквой Г любую букву гаммы и строчной буквой С
любую букву открытого текста. Он, по сути, доказал, что алгебраическая
формула
X = (с + Г)тос126 (1)
воспроизводит зашифрование по Виженеру при замене букв
алфавита числами согласно следующей таблице:
А В С Б Е Е О Н I I К Ь М
0 1 2 3 4 5 6 7 8 9 10 11 12
34
Краткий исторический очерк
N О Р 0 Я 8 Т V V X У Ъ
13 14 15 16 17 18 19 20 21 22 23 24 25
Тем самым была заложена алгебраическая основа для исследования
шифров замены типа шифра Виженера. Используя
уравнение шифрования, можно было отказаться от громоздкой
таблицы Виженера.
Позже лозунговая гамма стала произвольной последовательностью,
а шифр с уравнением шифрования (1) стал называться
шифром гоммирования.
Еще одним известным криптографом того времени был
голландец Керкгоффс. Его полным именем было Жан-
Вильгельм-Губерт-Виктор-Франсуа-Александр-Огюст Керкгоффс
ван Ньювенгоф. Разносторонний ученый, преподававший
6 иностранных языков, историю и математику, он в возрасте
47 лет написал книгу “Военная криптография”. В ней
сформулированы 6 конкретных требований к шифрам, два из
которых относятся к стойкости шифрования, а остальные — к
эксплуатационным качествам. Одно из них (“компрометация
системы не должна причинять неудобств корреспондентам”)
стало называться “правилом Керкгоффса”. Суть этого правила
состоит в том, что стойкость (или надежность) шифра определяется
лишь секретностью ключа. Другими словами, оценка
качества шифра (на основе некоторого шифрованного текста)
должна проводиться при условии, что о данном шифре известно
все, кроме использованного ключа.
XX в. “прославился” двумя мировыми войнами. Эти войны
оставили свой отпечаток на всех процессах, происходивших
в человеческом обществе. Они не могли не сказаться и на
развитии криптографии.
В период первой мировой войны в качестве полевых
шифров широко использовались ручные шифры, в первую
очередь шифры перестановки с различными усложнениями.
Это были вертикальные перестановки (см. гл. 4), усложнен-
2* 35
(лава 1
ные перекодировкой исходного алфавита, а также двойные
вертикальные перестановки.
Первая мировая война явилась поворотным пунктом в истории
криптографии: если до войны криптография представляла
собой достаточно узкую область, то после войны она
стала широким полем деятельности. Причина этого состояла в
необычайном росте объема шифрпереписки, передаваемой по
различным каналам связи. Криптоанализ стал важнейшим
элементом разведки.
Прогресс этой области криптографии характеризовался и
изменениями в самом криптоанализе. Эта наука переросла
методы индивидуальной работы криптоаналитика над криптограммой.
Системы секретной связи перестали быть настолько
малочисленными и однородными, что один специалист мог
овладеть всеми специализациями. Характер используемых
шифров потребовал для их вскрытия скрупулезного анализа
переписки, поиска ситуаций, благоприятствующих успешному
криптоанализу, знания соответствующей обстановки.
Кроме того, криптоанализ обогатился большим опытом использования
в годы войны ошибок неопытных или ленивых
шифровальщиков. Еще Ф. Бэкон писал, что “в результате
неловкости и неискусности тех рук, через которые проходят
величайшие секреты, эти секреты во многих случаях оказывались
обеспеченными слабейшими шифрами” [КаЬ67]. Этот
печальный опыт привел к необходимости введения строгой
дисциплины среди шифровальщиков.
Несмотря на указанные последствия, первая мировая война
не породила никаких новых научных идей в криптографии.
Наоборот, полностью исчерпали свои возможности ручное
шифрование, с одной стороны, и техническая сторона криптоанализа,
состоявшая в подсчете частот встречаемости знаков,
с другой.
В тот период проявились таланты целого ряда ставших
впоследствии известными криптографов. В их числе был
Г. О. Ярдли, который вскоре после вступления США в войну
36
Краткий исторический очерк
в 1917 г. убедил военное министерство в необходимости создания
криптографической службы. В 27 лет он был назначен
начальником криптографического отдела (М1-8) разведки
военного министерства. При отделе было создано учебное
отделение по подготовке криптоаналитиков для американской
армии. Отдел М1-8 добился больших успехов в дешифровании
дипломатической переписки многих развитых стран. В 1919 г.
отдел был преобразован в “черный кабинет” с совместным
финансированием от военного министерства и госдепартамента
в объеме 100 тыс. долларов в год. Одной из главных
задач “черного кабинета” было раскрытие японских кодов,
некоторые из которых содержали до 25 тысяч кодовых величин.
В период с 1917 по 1929 г. специалистам “черного кабинета”
удалось дешифровать более 45 тысяч криптограмм различных
стран, в том числе и Японии.
Ярдли, желая упрочить успехи, подготовил докладную
записку Президенту США о мерах по укреплению своей
службы. Однако ставший в то время Государственным секретарем
Г. Стимсон был шокирован, узнав о существовании
“черного кабинета”, и полностью осудил его деятельность.
Ему принадлежит знаменитая фраза: “Джентльмены не читают
писем друг друга”. Финансирование “черного кабинета”
было прекращено, и Ярдли лишился работы. Он написал книгу
“Американский черный кабинет” [Уаг31], в которой рассказал
о многих успехах по дешифрованию. Книга была издана
большими тиражами в ряде стран и произвела эффект разорвавшейся
бомбы. Позже он написал книгу “Японские дипломатические
секреты”, в которой приводились многие
японские телеграммы. Рукопись этой книги была конфискована
по решению суда. Последние годы жизни Ярдли не занимался
криптографией. Он умер в 1958 г. и был похоронен с
воинскими почестями на Арлингтонском национальном кладбище.
В некрологе он был назван “отцом американской криптографии”.
37
I лава 1
Значительный успех в криптографии связан с еще одним
американцем — Г. Вернамом. В 1917 г. он, будучи сотрудником
телеграфной компании, предложил идею автоматического
шифрования телеграфных сообщений. Речь шла о своеобразном
наложении гаммы на знаки алфавита, представленные в
соответствии с телетайпным кодом Бодо пятизначными “импульсными
комбинациями”. Например, буква а представлялась
комбинацией (+ н ), а комбинация ( + + - + + )
представляла символ перехода от букв к цифрам. На бумажной
ленте, используемой при работе телетайпа, знаку “ + ”
отвечало наличие отверстия, а знаку — его отсутствие.
При считывании с ленты металлические щупы проходили
через отверстия, замыкали электрическую цепь и тем самым
посылали в линию импульс тока.
Вернам предложил электромеханически покоординатно
складывать “импульсы” знаков открытого текста с “импульсами”
гаммы, предварительно нанесенными на ленту. Сложение
проводилось “по модулю 2 ”. Имеется в виду, что если
“+” отождествить с 1, а с 0, то сложение определяется
двоичной арифметикой:
+ 0 1
0 0 1
1 1 0
Например, наложение на знак открытого текста (11001)
знака гаммы (01111) давало знак шифртекста (10110 ). При
расшифровании нужно было произвести ту же операцию со
знаком шифртекста: ( 10110)Ф(01111) = (1 1001).
Вернам сконструировал и устройство для такого сложения.
Замечательно то, что процесс шифрования оказывался
полностью автоматизированным, в предложенной схеме исключался
шифровальщик. Кроме того, оказывались слитыми
воедино процессы шифрования-расшифрования и передачи по
каналу связи. Тем самым наряду с традиционной схемой
38
Краткий исторический очерк
предварительного шифрования, когда по каналу передается
предварительно зашифрованное сообщение, положено начало
линейному шифрованию.
В 1918 г. два комплекта соответствующей аппаратуры
были изготовлены и испытаны. Испытания дали положительные
результаты. Единственное неудовлетворение специали-
стов-криптографов было связано с гаммой. Дело в том, что
первоначально гамма была нанесена на ленту, склеенную в
кольцо. Несмотря на то, что знаки гаммы на ленте выбирались
случайно, при зашифровании длинных сообщений гамма регулярно
повторялась. Этот недостаток так же отчетливо осознавался,
как и для шифра Виженера. Уже тогда хорошо понимали,
что повторное использование гаммы недопустимо даже
в пределах одного сообщения. Хотя сам Вернам не был математиком,
он, может и неосознанно, предлагал однократное
использование гаммы. Попытки удлинить гамму приводили к
неудобствам в работе с длинным кольцом. Тогда был предложен
вариант с двумя лентами, одна из которых шифровала
другую, в результате чего получалась гамма, имеющая длину
периода, равную произведению длин исходных периодов.
Несмотря на то, что шифр Бернама обладал целым рядом
достоинств, он не получил широкого распространения. Трудности,
связанные с изготовлением, рассылкой и учетом использованной
гаммы, особенно в условиях военной связи, при
передаче больших объемов сообщений, стали непреодолимыми.
Вспомнили о шифре Вернама лишь накануне второй мировой
войны.
Почти половина XX в. была связана с использованием колесных
шифраторов. Различные их конструкции были запатентованы
примерно в одно и то же время (в период 1917 —
1919 гг.) в разных странах: американцем Э. X. Хеберном,
голландцем X. Ф. Кохом, немцем А. Шербиусом и шведом
А. Г. Даммом.
Чертежи своей схемы на основе шифрующего диска Хе-
берн представил в 1917 г., и уже в следующем году был по-
39
Iлава 1
строен первый дисковый аппарат, получивший одобрение
ВМС США. В 1921 г. Хеберн основал первую в США компанию
по производству шифрмашин, которую через десять лет
ждал бесславный конец, связанный с финансовыми трудностями.
Что представлял собой шифрующий диск? Корпус диска
(имевшего размеры хоккейной шайбы) состоял из изоляционного
материала, например твердой резины. По окружностям
каждой из его сторон были вмонтированы на равном расстоянии
друг от друга 26 электрических контактов (см. рис. 6).
Каждый контакт был соединен внутри корпуса с некоторым
контактом на другой стороне. Контакты на входной стороне
представляли буквы открытого текста, контакты на выходной
стороне — буквы шифртекста.
Диск устанавливался на оси между двумя неподвижными
пластинами (розетками), каждая из которых также была изготовлена
из изолятора и имела 26 контактов, соответствующих
расположению контактов на диске. Контакты входной розетки
соединялись с клавиатурой пишущей машинки, печатающей
буквы открытого текста. Контакты выходной розетки соединялись
с выходным устройством, указывающим буквы шифртекста,
например, с помощью лампочек. При фиксированном
угловом положении диска электрические цепи, соединяющие
входные и выходные контакты, реализовывали одноалфавитную
замену. При повороте же диска (на углы 271^/26) схема
реализовывала многоалфавитную замену (с 26 простыми заменами).
Рядом с одним диском можно было установить и другие
диски. Тем самым схема токопрохождения удлинялась и число
возможных простых замен, реализуемых многодисковой
схемой значительно возрастало. При движении к дисков по
простейшей схеме одометра получался период, равный 26*,
который можно было сделать астрономическим числом.
40
Краткий исторический очерк
Подобные шифрмашины обслуживали значительную
часть линий связи высшего командования ВМС США, начиная
с 20-х годов.
X. Ф. Кох предлагал конструкцию шифрующего диска, в
котором роль электричества выполняла пневматика. Речь
идет о каналах, соединяющих входные и выходные контакты,
по которым может проходить поток воздуха, водная или масляная
струя и т. п. Любопытно, что подобные дисковые системы
на основе пневматики были реально изготовлены и использовались
на практике.
Принцип шифрующего диска использовали и шифрмашины,
разработанные А. Шербиусом. Самой знаменитой из
них была “Энигма”, которая в двух отношениях отличалась от
других дисковых машин. Во-первых, после блока дисков была
расположена неподвижная обратимая розетка, контакты
которой были попарно соединены друг с другом. Импульс
тока, приходивший на этот контакт, заворачивался и вновь
проходил через блок дисков в противоположном направле41
I лава 1
нии. Это давало двойное шифрование каждой буквы. Другая
особенность “Энигмы” заключалась в неравномерном движении
дисков, которое управлялось зубчатыми колесами.
В 1923 г. “Энигма” выставлялась на конгрессе международного
почтового союза, однако это не способствовало ее
коммерческому успеху: она не раскупалась. За десять лет
фирма Шербиуса, производившая “Энигму”, не получила
прибыли и в 1934 г. была ликвидирована и передала свои активы
другой фирме. После прихода к власти в Германии Гит-
лера началось серьезное перевооружение армии, и немецкие
специалисты сочли “Энигму” достаточно удобной и надежной
шифрмашиной. В довоенный период и во время второй мировой
войны “Энигма” широко использовалась в германской
армии, ВМС и ВВС. Она была портативной (размером с пишущую
машинку), работала от батареи, имела деревянный
футляр. Ее серьезный недостаток состоял в том, что она не
печатала шифртекст (а имела лишь загорающиеся лампочки,
отвечающие буквам), и для быстрой работы требовались три
или даже четыре человека — для чтения и набора на клавиатуре
текста сообщения, диктовки высвечивающихся букв
шифртекста и их записи.
С “Энигмой” теснейшим образом связан ход многих событий
периода второй мировой войны. Дело в том, что она
являлась источником ценнейших сведений для английских
спецслужб, читавших переписку “Энигмы” (в рамках операции
“Ультра”). Эта информация стоила так дорого, что
У. Черчилль пожертвовал городом Ковентри, когда ему стал
известен план германской бомбардировки этого английского
города. С “Энигмой” связано также появление первой в истории
вычислительной машины, сконструированной в 1942 г.
для перебора ключевых элементов группой специалистов-
криптографов под руководством известного математика
А. Тьюринга.
Еще один патент на дисковую машину был выдан
А. Г. Дамму в 1919 г. Устройство этой машины было настоль42
Краткий исторический очерк
ко сложным, что никогда не было реализовано. Но его автор
основал компанию по производству шифрмашин, которая
впоследствии стала прибыльной. Среди вкладчиков капитала
были Э. Нобель, племянник знаменитого А. Нобеля, и
Ц. Хагелин, управляющий нефтедобывающей компанией
братьев Нобелей в России и некоторое время бывший генеральным
консулом Швеции в Санкт-Петербурге. До 1927 г.
эта компания не имела больших успехов. Их появление было
связано с именем сына Ц. Хагелина — Б. Хагелина, родившегося
на Кавказе, проучившегося несколько лет в Петербургском
университете и получившего позже диплом инженера-
механика в Швеции.
В 1925 г. Б. Хагелину удалось модернизировать одну из
машин Дамма, снабдив ее клавиатурой и индикаторными
лампочками, как у “Энигмы”. Это была также колесная машина,
работающая, однако, по иному, чем дисковые машины,
принципу. Она получила название В-21. Ее работа была основана
на матричном коммутаторе, в котором электрически
изменялось соединение строк и столбцов для преобразования
буквы открытого текста в букву шифртекста. Эти изменения
определялись группой ключевых колес, каждое из которых
имело по ободу выдвинутые или вдвинутые штифты. Колеса
имели различные числа штифтов, так что период многоалфавитного
шифра, реализуемого машиной, был равен произведению
чисел штифтов на всех колесах. В 1926 г. Б. Хагелин
предложил В-21 шведской армии, которая сделала на нее
большой заказ.
В 1927 г. Б. Хагелин возглавил фирму, выкупленную
семьей Хагелин. Свою следующую машину В-211 он снабдил
печатающим устройством, работавшим со скоростью около
200 знаков в минуту. Она была самой портативной печатающей
шифрмашиной в 1934 г.
В том же году французский генштаб заказал Б. Хагелину
карманную печатающую машину, которая могла бы обслуживаться
одним человеком. Через некоторое время такая машина
43
Глава 1
была изготовлена. Она реализовывала шифр гаммирования,
причем для выработки гаммы была использована идея суммирующего
устройства, состоящего из комбинационных линеек,
расположенных в цилиндрическом барабане. На линейках
рядами были расположены так называемые рейтеры. При
повороте барабана на 360° рейтеры, вступая во взаимодействие
с другими элементами схемы, могли выдвигать некоторые
линейки влево, причем число выдвинутых линеек и определяло
значение знака гаммы (от 0 до 25) в данный такт шифрования.
Во взаимодействие с рейтерами вступали штифты, расположенные
на колесах блока дисков, составляющего вторую
основную часть машины. Размеры и схема движения дисков
обеспечивали период, приблизительно равный 1,01*108. Как
расположение рейтеров, так и расположение штифтов могло
легко меняться, они являлись ключевыми элементами. Это
была машина С-36, ставшая впоследствии знаменитой. По
размерам она была меньше телефонного аппарата, весила
вместе с футляром около двух с половиной килограммов.
Французы сразу же сделали заказ на 5000 машин. Позднее
машина была существенно усовершенствована, ею заинтересовались
в США. В 1939 г. она была взята на вооружение армии
США. Под военным наименованием М-209 она использовалась
в качестве полевого шифра на протяжении всей второй
мировой войны. Всего было произведено около 140 000
таких машин. Позже фирма Хагелин стала производить широко
известные машины С-48, С-52, Т-55 и многие другие.
Среди заметных фигур в криптографии первой половины
XX в. выделяется У. Фридман, получивший серьезные теоретические
результаты в криптоанализе и ставший известным
благодаря своим заслугам по вскрытию военных шифров
Японии и Германии.
У. Фридман родился в 1891 г. в Кишиневе, в семье переводчика,
работавшего в русском почтовом ведомстве. В
1892 г. его семья эмигрировала в США, где отец стал заниматься
швейными машинами. У. Фридман в 1914 г. окончил
44
Краткий исторический очерк
Корнельский университет по специальности генетика. В городе
Итака, где проживала семья Фридмана, крупный бизнесмен
Д. Фабиан имел собственные лаборатории по акустике, генетике
и криптографии. Любопытно, что криптографией
Д. Фабиан увлекся, пытаясь доказать, что автором пьес
У. Шекспира являлся Ф. Бэкон.
В 1915 г. Д. Фабиан нанял на работу в свое поместье Ри-
вербэнк специалиста по генетике. Им стал У. Фридман. Вскоре
он увлекся криптографией и проявил себя в этом деле. Через
некоторое время У. Фридман уже возглавлял в Ривербэнк-
ских лабораториях два отдела — генетики и шифров.
Помимо криптоаналитической работы У. Фридман занимался
преподаванием в классе, состоявшем из армейских
офицеров, присланных в Ривербэнк для изучения криптографии.
До 1918 г. им был подготовлен цикл из семи лекций,
восьмую он написал после возвращения со службы в качестве
дешифровальщика в американских экспедиционных силах
(шла первая мировая война). Известные все вместе как Ривер-
бэнкские публикации, эти работы являются серьезным вкладом
в теоретическую криптографию.
Наибольший интерес с точки зрения современной криптографии
представляют лекции “Методы раскрытия шифров с
длинной связной гаммой” и “Индекс совпадения и его применения
в криптографии” [Рп20]. В первой из них предлагается
бесключевой метод чтения при использовании неравновероятной
гаммы. Во второй излагается так называемый к -тест,
позволяющий выяснить, можно ли подписать друг под другом
две (или более) криптограммы (или отрезки криптограмм) так,
чтобы буквы в каждой колонке оказались бы зашифрованы
одинаковыми знаками гаммы.
Поступив в 1921 г. на службу в войска связи, У. Фридман успешно
применял свои методы для вскрытия машинных шифров.
Когда была создана служба радиоразведки, У.Фридман стал ее
главой и продолжил свои разработки, самой значимой из которых
было вскрытие японской пурпурной шифрмагиины. В 1929 г.
45
[ лава 1
он стал широко известен как один из ведущих криптографов
мира, когда “Британская энциклопедия” поместила его статью
“О кодах и шифрах”. С основными результатами У. Фридмана
можно познакомиться в четырехтомнике “Военная криптография”
[Рп85].
Выдающиеся результаты в применении математических
методов в криптографии принадлежат Клоду Шеннону.
К. Шеннон получил образование по электронике и математике в
Мичиганском университете, где и начал проявлять интерес к
теории связи и теории шифров. В 1940 г. он получил степень
доктора по математике, в течение года обучался в Принстонском
институте усовершенствования, после чего был принят на
службу в лабораторию компании “Ве11 Те1ерЬопе”.
К 1944 г. К. Шеннон завершил разработку теории секретной
связи. В 1945 г. им был подготовлен секретный доклад “Математическая
теория криптографии”, который был рассекречен в
1949 г. и издан [ШенбЗ].
В данной работе излагается теория так называемых секретных
систем, служащих фактически математической моделью
шифров. Помимо основных алгебраических (или функциональных)
свойств шифров, постулируемых в модели, множества сообщений
и ключей наделяются соответствующими априорными
вероятностными свойствами, что позволяет формализовать многие
постановки задач синтеза и анализа шифров. Так, и сегодня
при разработке новых классов шифров широко используется
принцип Шеннона рассеивания и перемешивания, состоящий в
использовании при шифровании многих итераций “рассеивающих”
и “перемешивающих” преобразований.
Разработанные К. Шенноном концепции теоретической и
практической секретности (или стойкости) позволяют количественно
оценивать криптографические качества шифров и пытаться
строить в некотором смысле идеальные или совершенные
шифры. Моделируется также и язык открытых сообщений. А
именно, предлагается рассматривать язык как вероятностный
46
Краткий исторический очерк
процесс, который создает дискретную последовательность символов
в соответствии с некоторой вероятностной схемой.
Центральной в работах К. Шеннона является концепция избыточной
информации, содержащейся в текстовых сообщениях.
Избыточность означает, что в сообщении содержится больше
символов, чем в действительности требуется для передачи содержащейся
в нем информации. Например, всего лишь десять
английских слов — Й1е, оГ, апд, *о, а, ш, *Ьа*, й, 18,1 — составляют
более 25% любого (английского) текста. Легко понять, что
их можно изъять из текста без потери информации, так как их
легко восстановить по смыслу (или по контексту). Фактически
К.Шеннон показал, что успех криптоанализа определяется тем,
насколько избыточность, имеющаяся в сообщении, “переносится”
в шифрованный текст. Если шифрование “стирает” избыточность,
то восстановить текст сообщения по криптограмме становится
принципиально невозможно.
Задачу дешифрования К. Шеннон рассматривает как задачу
вычисления апостериорных знаний противника о шифре после
перехвата криптограммы. Дело в том, что вероятности сообщений
и ключей составляют априорные знания противника, которыми
он располагает в соответствии с правилом Керкгоффса.
После перехвата криптограммы он может (по крайней мере, в
принципе, поскольку множества сообщений и ключей конечны)
вычислить апостериорные вероятности возможных ключей и
сообщений, которые могли быть использованы при составлении
данной криптограммы. Вот эти вероятности и составляют апостериорные
знания противника. С этой точки зрения показателен
следующий пример.
Пусть для зашифрования нормативного английского языка
применяется шифр простой замены, в котором каждый из 26!
ключей может быть выбран с равной вероятностью. Пусть противник
знает об источнике сообщений лишь то, что он создает
английский текст. Тогда априорными вероятностями различных
сообщений из N букв являются их относительные частоты в
нормативном тексте. Если же противник перехватил крипто47
Гпава 1
грамму из N букв, то он может вычислить условные вероятности
открытых текстов и ключей, которые могут создать такую
криптограмму. Если N достаточно велико, скажем Л^ = 50, то
обычно имеется единственное сообщение (и единственный
ключ) с условной вероятностью, близкой к единице (это — само
сообщение, подвергнутое шифрованию), в то время как все другие
сообщения имеют суммарную вероятность, близкую к нулю.
Таким образом, имеется, по существу, единственное “решение”
такой криптограммы. Для меньших значений N , скажем
N = 10, обычно найдется несколько пар сообщений и ключей,
вероятности которых сравнимы друг с другом, то есть нет ни
одного сообщения (и ключа) с вероятностью, близкой к единице.
В этом случае “решение” криптограммы неоднозначно.
Понятие совершенной секретности К. Шеннон определяет
требованием, чтобы апостериорные знания противника в точности
совпадали бы с априорными знаниями. Он приводит пример
совершенного шифра, которым является шифр Вернама (со случайной
равновероятной гаммой). Следует подчеркнуть, что все
рассуждения о стойкости шифров К. Шеннон проводит лишь
для одной постановки задачи криптоанализа: когда противник
располагает лишь одной криптограммой и требуется найти текст
сообщения. Для других постановок задач требуются отдельные
исследования.
Теоретической мерой секретности (или стойкости) по
К.Шеннону является энтропийная характеристика — неопределенность
шифра по открытому сообщению, которая измеряет
(в статистическом смысле), насколько “близка” средняя криптограмма
из N букв к единственному “решению”. Он выводит
формулу для приближенного вычисления минимального N ,
при котором находится единственное “решение”. Такая величина
получила название расстояния единственности. Формула
для расстояния единственности связывает между собой неопределенность
шифра по открытому тексту и избыточность
текста. Чем большим оказывается расстояние единственности,
48
Краткий исторический очерк
тем более шифр приближается к совершенному шифру, для
которого формально расстояние единственности равно оо.
Наконец, К. Шеннон вводит понятие рабочей характеристики
шифра, подходя к практической оценке стойкости. Он
формулирует также основные критерии оценки качества секретных
систем с позиций практики их использования.
Как видим, К. Шеннону удалось решить фундаментальные
проблемы в теоретической криптографии. Его работы стимулировали
бурный рост научных исследований по теории информации
и криптографии.
В работах К. Шеннона по исследованию свойств языка важную
роль играет величина удельной энтропии Н на букву текста,
другими словами, среднее количество информации, передаваемой
буквой открытого текста. Предложенный им метод экспериментов
с угадыванием очередной буквы английского текста
по предыдущим буквам оказался неэффективным при получении
оценок величины Н для других языков. Метод “отгадывания”
развил в своих работах А. Н. Колмогоров. Достаточно точные
приближения параметра Н для русского и французского
языков получил Б. Б. Пиотровский. Он указал на существенную
разницу между значениями Н для текстов различного характера
(литературных, деловых, разговорной речи).
Понятие “количества информации”, содержащейся в тексте,
базировалось, по К. Шеннону, лишь на частотных характеристиках.
В своих фундаментальных работах 60-х годов А. Н. Колмогоров
подошел к определению количества информации с учетом
смыслового содержания текста, что позволило уточнить приближение
величины Н для литературных текстов. Необходимо
также отметить, что еще задолго до К. Шеннона частотные характеристики
языка изучал выдающийся русский ученый А. А.
Марков. Сегодня часто используются так называемые марковские
модели открытых текстов, учитывающие зависимости букв
текста от предыдущих букв.
Следующая страница в истории криптографии XX в. посвящена
телефонным шифраторам, которые были разработаны в 30-х
49
[ лава 1
годах и стали широко использоваться во время второй мировой
войны. В России разработка телефонного шифратора велась под
руководством В.А.Котельникова, ставшего впоследствии академиком,
ученым с мировым именем. Ему принадлежит знаменитая
теорема дискретизации (или теорема отсчетов), лежащая
в основе теории цифровой обработки сигналов.
Согласно [КаЬ67], идея телефонного шифратора была запатентована
Д.Х.Роджерсом еще в 1881 г., спустя пять лет после
изобретения Беллом телефона. Идея состояла в передаче телефонного
сообщения по нескольким (в простейшем случае — по
двум) цепям поочередными импульсами в некоторой быстро
изменяющейся последовательности. Предлагалось разнести такие
линии на значительное расстояние друг от друга с тем, чтобы
устранить возможность подключения сразу ко всем одновременно.
Подключение же к одной из них позволяло бы слышать
лишь отдельные неразборчивые сигналы.
В более поздних разработках предлагались различные преобразования
непосредственно самой речи. Звуки речи преобразуются
телефоном в непрерывный электрический сигнал, который
с помощью соответствующих устройств изменяется шифратором
по законам электричества. К числу возможных изменений
относятся: инверсия, смещение, или деление диапазона частот,
шумовые маскировки, временные перестановки частей сигнала, а
также различные комбинации перечисленных преобразований.
Естественно, каждое из указанных преобразований производится
под управлением ключа, который имеется у отправителя и
получателя. Наиболее просто реализуемым являлось преобразование
инверсии. Сложнее реализовались временные перестановки.
Для их осуществления речевой сигнал в некоторый промежуток
времени предварительно записывался на магнитофонной
ленте. Запись делилась на отрезки длительностью в доли секунд.
Отрезки с помощью нескольких магнитных головок разносились
и перемешивались, в результате чего в канале слышалась хаотическая
последовательность звуков. Использовалась также движущаяся
магнитная головка, которая в зависимости от направ50
Краткий исторический очерк
ления движения считывала сигналы быстрее или медленнее, чем
они были записаны на ленте. В результате тон сигналов становился
выше или ниже обычного, в канале быстро чередовались
высокие и низкие звуки, не воспринимаемые ухом. Следует отметить,
что одной из самых сложных проблем, которые возникали
при разработке телефонных шифраторов, была проблема
узнавания восстановленной после расшифрования речи.
В США первый телефонный шифратор, под названием АЗ,
был принят в эксплуатацию в 1937 г. Именно он доставил президенту
Рузвельту известие о начале второй мировой войны
утром 1 сентября 1939 г. по вызову американского посла в Париже.
АЗ осуществлял инверсию и перестановку 5 поддиапазонов
частот. Из 3840 возможных комбинаций (5!-25) фактически
использовались лишь 6, которые менялись 36 раз за каждые 20
секунд. Слабость используемой криптографии компенсировалась
регулярным изменением частот передачи.
В настоящее время аналоговая телефония уступает место
цифровой телефонии. Тем самым и многие технические проблемы,
связанные с криптографическими преобразованиями аналоговых
сигналов, отпадают за ненадобностью. Дело в том, что
оцифрованный сигнал является дискретным и, следовательно, к
нему можно применить хорошо разработанную надежную “дискретную
криптографию”.
Во второй половине XX в., вслед за развитием элементной
базы вычислительной техники, появились электронные шифраторы,
разработка которых потребовала серьезных теоретических
исследований во многих областях прикладной и фундаментальной
математики, в первую очередь алгебре, теории вероятностей
и математической статистике. Сегодня именно электронные
шифраторы составляют подавляющую долю средств шифрования.
Они удовлетворяют все возрастающим требованиям по
надежности и скорости шифрования. Прогресс в развитии вычислительной
техники сделал возможными программные реализации
криптографических алгоритмов, которые все увереннее
51
I лава 1
вытесняют во многих сферах традиционные аппаратные
средства.
В семидесятых годах произошло два события, серьезно
повлиявших на дальнейшее развитие криптографии. Во-
первых, был принят (и опубликован!) первый стандарт
шифрования данных (БЕ8), “легализовавший” принцип Керк-
гоффса в криптографии. Во-вторых, после работы американских
математиков У.Диффи и М.Хеллмана [Б1Г76] родилась
“новая криптография”— криптография с открытым ключом.
Оба этих события были рождены потребностями бурно
развивающихся средств коммуникаций, в том числе локальных
и глобальных компьютерных сетей, для защиты которых
потребовались легко доступные и достаточно надежные криптографические
средства. Криптография стала широко востре-
боваться не только в военной, дипломатической, государственной
сферах, но также в коммерческой, банковской и других
сферах.
Вслед за идеей Диффи и Хеллмана, связанной с гипотетическим
понятием однонаправленной (ши односторонней)
функции с секретом, появились “кандидат” на такую функцию
и реально осуществленная шифрсистема К8А с открытым
ключом. Такая система была предложена в 1978 г. Рай-
вестом, Шамиром и Адлеманом. Парадоксальным казалось то,
что в К8А для зашифрования и расшифрования используются
разные ключи, причем ключ зашифрования может быть открытым,
то есть всем известным. Вслед за К8А появился
целый ряд других систем. В связи с несимметричным использованием
ключей стал использоваться термин асимметричная
шифрсистема, в то время как традиционные шифрсистемы
стали называться симметричными.
Наряду с идеей открытого шифрования Диффи и Хеллман
предложили идею открытого распределения ключей, позволяющую
избавиться от защищенного канала связи при рассылке
криптографических ключей. Их идея основывалась на
сложности решения задачи дискретного логарифмирования,
52
Краткий исторический очерк
то есть задачи, являющейся обратной для задачи возведения в
степень в конечном поле большого порядка.
Позволим себе остановиться в нашем кратком историческом
обзоре на этом этапе развития криптографии, поскольку
рассказ о ее современных проблемах и приложениях заставил
бы нас приступить к изложению основного содержания книги.
Контрольные вопросы
1. Приведите примеры шифров, применявшихся еще до нашей
эры.
2. Приведите пример шифра, для которого сам открытый
текст является ключом.
3. Какие шифры называются омофонами? В чем их преимущество
перед шифрами простой замены?
4. Что является ключом шифра Виженера?
5. Являлись ли трафареты, которые использовали А.Грибое-
дов и Ришелье для передачи тайных сообщений, средствами
шифрования?
6. Приведите пример шифра, допускающего неоднозначное
зашифрование.
7. Какими шифрами пользовались Цезарь, Галилей, Наполеон,
Ришелье?
8. В чем состоит правило Керкгоффса? Почему это правило
является общепринятым в криптографии?
9. Чем отличаются принципы шифрования в аналоговой
телефонии от принципов шифрования телеграфных
сообщений?
10. Чем отличаются симметричные шифрсистемы от
асимметричных?
11. Когда родилась криптография с открытыми ключами и
первая реальная система шифрования?
12. Каких выдающихся криптографов XX в. Вы знаете?
53
Глава 2
Основные понятия
Целью настоящего раздела является определение основных
понятий и задач криптографии.
§ 2.1. Криптография
В переводе с греческого языка слово криптография означает
тайнопись. Смысл этого термина выражает основное
предназначение криптографии — защитить или сохранить в
тайне необходимую информацию.
Криптография дает средства для защиты информации, и
поэтому она является частью деятельности по обеспечению
безопасности информации.
Существуют различные методы защиты информации.
Можно, например, физически ограничить доступ к информации
путем хранения ее в надежном сейфе или строго охраняемом
помещении. При хранении информации такой метод
удобен, однако при ее передаче приходится использовать другие
средства.
Можно воспользоваться одним из известных методов сокрытия
информации:
— скрыть канал передачи информации, используя нестандартный
способ передачи сообщений;
— замаскировать канал передачи закрытой информации
в открытом канале связи, например спрятав информацию в
безобидном “контейнере” с использованием тех или других
стеганографических способов либо обмениваясь открытыми
сообщениями, смысл которых согласован заранее;
— существенно затруднить возможность перехвата противником
передаваемых сообщений, используя специальные
методы передачи по широкополосным каналам, сигнала под
54
Основные понятия
уровнем шумов, либо с использованием “прыгающих” несущих
частот и т. п.
В отличие от перечисленных методов криптография не
“прячет” передаваемые сообщения, а преобразует их в форму,
недоступную для понимания противником. При этом обычно
исходят из предположения о полном контроле противником
канала связи. Это означает, что противник может не только
пассивно перехватывать передаваемые сообщения для последующего
их анализа, но и активно изменять их, а также отправлять
поддельные сообщения от имени одного из абонентов.
Помимо сокрытия существуют и другие проблемы защиты
передаваемой информации. Например, при полностью открытом
информационном обмене возникает проблема достоверности
полученной информации. Для ее решения необходимо
обеспечить:
— проверку и подтверждение подлинности содержания
и источника сообщения,
а также
— предотвращение и обнаружение обмана и других
умышленных нарушений со стороны самих участников информационного
обмена.
Для решения этой проблемы обычные средства, применяемые
при построении систем передачи информации, подходят
далеко не всегда. Именно криптография дает средства
для обнаружения обмана в виде подлога или отказа от ранее
совершенных действий, а также других неправомерных действий.
Поэтому можно сказать, что современная криптография
является областью знаний, связанной с решением таких проблем
безопасности информации, как конфиденциальность,
целостность, аутентификация и невозможность отказа сторон
от авторства. Достижение этих требований безопасности информационного
взаимодействия и составляет основные цели
криптографии. Они определяются следующим образом.
Гпава 2
Обеспечение конфиденциальности — решение проблемы
защиты информации от ознакомления с ее содержанием
со стороны лиц, не имеющих права доступа к ней. В зависимости
от контекста вместо термина “конфиденциальная”
информация могут выступать термины “секретная”, “частная”,
“ограниченного доступа” информация.
Обеспечение целостности — гарантирование невозможности
несанкционированного изменения информации.
Для гарантии целостности необходим простой и надежный
критерий обнаружения любых манипуляций с данными.
Манипуляции с данными включают вставку, удаление и замену.
О
беспечение аутентификации — разработка методов
подтверждения подлинности сторон {идентификация) и самой
информации в процессе информационного взаимодействия.
Информация, передаваемая по каналу связи, должна
быть аутентифицирована по источнику, времени создания,
содержанию данных, времени пересылки и т. д.
Обеспечение невозможности отказа от авторства —
предотвращение возможности отказа субъектов от некоторых
из совершенных ими действий. Рассмотрим средства
для достижения этих целей более подробно.
Конфиденциальность
Традиционной задачей криптографии является проблема
обеспечения конфиденциальности информации при передаче
сообщений по контролируемому противником каналу
связи. В простейшем случае эта задача описывается взаимодействием
трех субъектов (сторон). Владелец информации,
называемый обычно отправителем, осуществляет преобразование
исходной {открытой) информации (сам процесс
преобразования называется шифрованием) в форму передаваемых
получателю по открытому каналу связи шифрованных
сообщений с целью ее защиты от противника.
56
Основные понятия
Отправитель Противник Получатель
Рис. 7. Передача шифрованной информации
Под противником понимается любой субъект, не имеющий
права ознакомления с содержанием передаваемой информации.
В качестве противника может выступать криптоаналитик,
владеющий методами раскрытия шифров. Законный
получатель информации осуществляет расшифрование
полученных сообщений. Противник пытается овладеть защищаемой
информацией (его действия обычно называют
атаками). При этом он может совершать как пассивные, так
и активные действия. Пассивные атаки связаны с прослушиванием,
анализом трафика, перехватом, записью передаваемых
шифрованных сообщений, дешифрованием, т. е. попытками
“взломать” защиту с целью овладения информацией.
При проведении активных атак противник может прерывать
процесс передачи сообщений, создавать поддельные
(сфабрикованные) или модифицировать передаваемые шифрованные
сообщения. Эти активные действия называют попытками
имитации и подмены соответственно.
Под шифром обычно понимается семейство обратимых
преобразований, каждое из которых определяется некоторым
параметром, называемым ключом, а также порядком применения
данного преобразования, называемым режимом шифрования
].
1 Формальное определение шифра будет дано ниже.
57
I лава 2
Ключ — это важнейший компонент шифра, отвечающий
за выбор преобразования, применяемого для зашифрования
конкретного сообщения. Обычно ключ представляет собой
некоторую буквенную или числовую последовательность.
Эта последовательность как бы “настраивает” алгоритм
шифрования.
Каждое преобразование однозначно определяется ключом
и описывается некоторым криптографическим алгоритмом.
Один и тот же криптографический алгоритм может
применяться для шифрования в различных режимах. Тем самым
реализуются различные способы шифрования (простая
замена, гаммирование 2 и т. п.). Каждый режим шифрования
имеет как свои преимущества, так и недостатки. Поэтому выбор
режима зависит от конкретной ситуации. При расшифровании
используется криптографический алгоритм, который в
общем случае может отличаться от алгоритма, применяемого
для зашифрования сообщения. Соответственно могут различаться
ключи зашифрования и расшифрования. Пару алгоритмов
зашифрования и расшифрования обычно называют
криптосистемой (шифрсистемой), а реализующие их устройства
— шифртехникой.
Если обозначить через М открытое, а через С шифрованное
сообщения, то процессы зашифрования и расшифрования
можно записать в виде равенств
^ ( М ) = С,
в которых алгоритмы зашифрования Е и расшифрования Л
должны удовлетворять равенству
Вкг (Е/с, (АО)= М.
2 Эти способы шифрования будут рассмотрены ниже.
58
Основные понятия
Различают симметричные и асимметричные криптосистемы.
В симметричных системах знание ключа зашифрования
кI позволяет легко найти ключ расшифрования к2 (в
большинстве случаев эти ключи просто совпадают). В асимметричных
криптосистемах знание ключа &/ не позволяет определить
ключ к2. Поэтому для симметричных криптосистем
оба ключа должны сохраняться в секрете, а для асимметричных
— только один — ключ расшифрования к2, а ключ А:/
можно сделать открытым (общедоступным). В связи с этим
их называют еще шифрами с открытым ключом.
Симметричные криптосистемы принято подразделять на
поточные и блочные системы. Поточные системы осуществляют
зашифрование отдельных символов открытого сообщения.
Блочные же системы производят зашифрование блоков
фиксированной длины, составленных из подряд идущих символов
сообщения.
Асимметричные криптосистемы, как правило, являются
блочными. При их использовании можно легко организовать
передачу конфиденциальной информации в сети с большим
числом пользователей. В самом деле, для того чтобы послать
сообщение, отправитель открыто связывается с получателем,
который либо передает свой ключ отправителю, либо помещает
его на общедоступный сервер. Отправитель зашифровывает
сообщение на открытом ключе получателя и отправляет
его получателю. При этом никто, кроме получателя, обладающего
ключом расшифрования, не сможет ознакомиться
с содержанием передаваемой информации. В результате такая
система шифрования с общедоступным ключом позволяет
существенно сократить объем хранимой каждым абонентом
секретной ключевой информации.
Возможна и другая симметричная ситуация, когда открытый
и секретный ключи меняются местами. Предположим,
например, что для проведения контроля соблюдения выполнения
каждой стороной договора об ограничении испытаний
ядерного оружия создаются пункты контроля, которые ведут
59
/ лава 2
запись и конфиденциальную передачу сторонам, участвую-
\ щим в договоре, сейсмологической информации. Поскольку
на каждом таком пункте контролируемая сторона одна, а участников
договора может быть очень много, то необходимо
обеспечить такое шифрование информации, при котором зашифровать
сообщение мог бы только один отправитель, а
расшифровать мог бы каждый.
Не существует единого шифра, подходящего для всех
случаев жизни. Выбор способа шифрования (то есть криптографического
алгоритма и режима его использования) зависит
от особенностей передаваемой информации (ее ценности,
объема, способа представления, необходимой скорости
передачи и т. д.), а также возможностей владельцев по защите
своей информации (стоимость применяемых технических
устройств, удобство использования, надежность функционирования
и т. п.). Имеется большое разнообразие видов защищаемой
информации: текстовая, телефонная, телевизионная,
компьютерная и т. д., причем у каждого вида информации
имеются свои существенные особенности, которые надо учитывать
при выборе способа шифрования. Большое значение
имеют объемы и требуемая скорость передачи шифрованной
информации, а также помехозащищенность используемого
канала связи. Все это существенным образом влияет на выбор
криптографического алгоритма и организацию защищенной
связи.
Наличие надежного криптографического алгоритма и
правильный выбор режима еще не гарантируют владельцу
защищенность передаваемой информации. Немаловажную
роль играет правильность их использования. Поскольку даже
самые стойкие шифры при неправильном использовании существенно
теряют свои качества, то конфиденциальность передаваемой
информации во многом зависит от того, какие
ошибки допускает ее владелец при использовании криптографической
защиты. А то, что все пользователи допускают
ошибки, — неизбежно и является непреложным и важным
60
Основные понятия
(для криптоаналитика) фактом, поскольку любые криптографические
средства, какими бы они ни были удобными и прозрачными,
всегда мешают пользователям в работе, а различные
тонкости известны только криптоаналитикам и, как правило,
непонятны пользователям этих средств. Более того, в
качестве субъектов взаимодействия могут выступать не только
люди, но и различные процессы, осуществляющие обработку
информации в автоматизированной системе без участия
человека. Поэтому защищенность информации в системе существенно
зависит от того, насколько правильно там реализована
криптографическая подсистема, отвечающая за выполнение
криптографических функций. Одно наличие такой
подсистемы еще ничего не гарантирует.
Подчеркнем разницу между терминами “расшифрование”
и “дешифрование”. При расшифровании действующий ключ
считается известным, в то время как при дешифровании ключ
неизвестен. Тем самым расшифрование должно осуществляться
столь же просто, как и зашифрование; дешифрование
представляет собой значительно более сложную задачу.
Именно в этом и состоит смысл шифрования.
Для разных шифров задача дешифрования имеет различную
сложность. Уровень сложности этой задачи и определяет
главное свойство шифра — способность противостоять попыткам
противника завладеть защищаемой информацией. В
связи с этим говорят о криптографической стойкости шифра
(или просто стойкости), различая более стойкие и менее
стойкие шифры. Методы вскрытия шифров разрабатывает
наука, носящая название криптоанализ. Согласно [КаЬ67],
термин криптоанализ ввел У. Фридман в 1920 г.
В иностранной литературе часто используется термин
криптология в качестве области знаний, объединяющей
криптографию и криптоанализ, при этом криптография понимается
как наука о создании шифров. Если следовать такому
толкованию, то можно прийти к тезису о том, что задачи
создания криптографической защиты и ее преодоления прин-
61
\
ципиально различаются. На самом деле было бы нелогично
считать защиту надежной без проведения детального криптоанализа.
В связи с этим, применительно к задаче обеспечения
конфиденциальности, мы будем считать термины криптография
и криптология синонимами, понимая их как название
науки о синтезе шифров и “взломе” шифров.
Целостность
Наряду с конфиденциальностью не менее важной задачей
является обеспечение целостности информации, другими
словами, — неизменности ее в процессе передачи или хранении.
Решение этой задачи предполагает разработку средств,
позволяющих обнаруживать не столько случайные искажения
(для этой цели вполне подходят методы теории кодирования с
обнаружением и исправлением ошибок), сколько целенаправленное
навязывание противником ложной информации. Для
этого в передаваемую информацию вносится избыточность.
Как правило, это достигается добавлением к сообщению некоторой
проверочной комбинации, вычисляемой с помощью
специального алгоритма и играющей роль контрольной суммы
для проверки целостности полученного сообщения. Главное
отличие такого метода от методов теории кодирования
состоит в том, что алгоритм выработки проверочной комбинации
является “криптографическим”, то есть зависящим от
секретного ключа. Без знания секретного ключа вероятность
успешного навязывания противником искаженной или ложной
информации мала. Такая вероятность служит мерой ими-
тостойкости шифра, то есть способности самого шифра
противостоять активным атакам со стороны противника.
Итак, для проверки целостности к сообщению М добавляется
проверочная комбинация 5 , называемая кодом аутентификации
сообщения (сокращенно — КАС) или ими-
товставкой. В этом случае по каналу связи передается пара
С = (М, 8 ). При получении сообщения М пользователь вычисляет
значение проверочной комбинации и сравнивает его
__________________________________________________________________ I лава 2
62
Основные понятия
с полученным контрольным значением 5\ Несовпадение говорит
о том, что данные были изменены.
Как правило, код аутентификации является значением
некоторой (зависящей от секретного ключа) криптографической
хэш-функции3 от данного сообщения: кк(М) = 8 . К кодам
аутентификации предъявляются определенные требования.
К ним относятся:
— невозможность вычисления значения Нк (М) = 5* для
заданного сообщения М без знания ключа к ;
— невозможность подбора для заданного сообщения М
с известным значением кк(М) = 8 другого сообщения М х с
известным значением кк (М х) = 5^ без знания ключа к .
Первое требование направлено против создания поддельных
(сфабрикованных) сообщений при атаках типа имитация;
второе — против модификации передаваемых сообщений
при атаках типа подмена.
Аутентификация
Аутентификация — установление подлинности. В общем
случае этот термин может относиться ко всем аспектам
информационного взаимодействия: сеансу связи, сторонам,
передаваемым сообщениям и т. д.
Установление подлинности (то есть проверка и подтверждение)
всех аспектов информационного взаимодействия является
важной составной частью проблемы обеспечения достоверности
получаемой информации. Особенно остро эта
проблема стоит в случае не доверяющих друг другу сторон,
когда источником угроз может служить не только третья сторона
(противник), но и сторона, с которой осуществляется
взаимодействие.
я Так обычно называется функция, принимающая значения некоторой
фиксированной размерности.
63
/ лава 2
Рассмотрим эти вопросы более подробно.
Применительно к сеансу связи (транзакции) аутентификация
означает проверку: целостности соединения, невозможности
повторной передачи данных противником и своевременности
передачи данных. Для этого, как правило, используют
дополнительные параметры, позволяющие “сцепить”
передаваемые данные в легко проверяемую последовательность.
Это достигается, например, путем вставки в сообщения
некоторых специальных чисел или меток времени.
Они позволяют предотвратить попытки повторной передачи,
изменения порядка следования или обратной отсылки части
переданных сообщений. При этом такие вставки в передаваемом
сообщении необходимо защищать (например, с помощью
шифрования) от возможных подделок и искажений.
Применительно к сторонам взаимодействия аутентификация
означает проверку одной из сторон того, что взаимодействующая
с ней сторона — именно та, за которую она себя
выдает. Часто аутентификацию сторон называют также
идентификацией4.
Основным средством для проведения идентификации являются
протоколы идентификации, позволяющие осуществлять
идентификацию (и аутентификацию) каждой из участвующих
во взаимодействии и не доверяющих друг другу сторон.
Различают протоколы односторонней и взаимной идентификации.
Протокол — это распределенный алгоритм, определяющий
последовательность действий каждой из сторон. В процессе
выполнения протокола идентификации каждая из сто4
Формально это некорректно, так как под идентификацией понимают
процедуру установления присвоенного данной стороне уникального системного
имени-идентификатора, которое позволяет отличать ее от других
сторон; обычно идентификация заключается в предъявлении этого имени и
предшествует процедуре аутентификации, то есть подтверждению правильности
идентификации.
64
Основные понятия
рон не передает никакой информации о своем секретном ключе,
а хранит его у себя и использует для формирования
ответных сообщений на запросы, поступающие при выполнении
протокола.
Наконец, применительно к самой информации аутентификация
означает проверку того, что информация, передаваемая
по каналу, является подлинной по содержанию, источнику,
времени создания, времени пересылки и т. д.
Проверка подлинности содержания информации сводится,
по сути, к проверке ее неизменности (с момента создания)
в процессе передачи или хранения, то есть проверке целостности.
Аутентификация источника данных означает подтверждение
того, что исходный документ был создан именно заявленным
источником.
Заметим, что если стороны доверяют друг другу и обладают
общим секретным ключом, то аутентификацию сторон
можно обеспечить применением кода аутентификации. Действительно,
каждое успешно декодированное получателем
сообщение может быть создано только отправителем, так как
только он знает их общий секретный ключ. Для не доверяющих
друг другу сторон решение подобных задач с использованием
общего секретного ключа становится невозможным.
Поэтому при аутентификации источника данных нужен механизм
цифровой подписи, который будет рассмотрен ниже.
В целом, аутентификация источника данных выполняет
ту же роль, что и протокол идентификации. Отличие заключается
только в том, что в первом случае имеется некоторая
передаваемая информация, авторство которой требуется установить,
а во втором требуется просто установить сторону, с
которой осуществляется взаимодействие.
Цифровая подпись
В некоторых ситуациях, например в силу изменившихся
обстоятельств, отдельные лица могут отказаться от ранее
65
I лава 2
принятых обязательств. В связи с этим необходим некоторый
механизм, препятствующий подобным попыткам.
Так как в данной ситуации предполагается, что стороны
не доверяют друг другу, то использование общего секретного
ключа для решения поставленной проблемы становится невозможным.
Отправитель может отказаться от факта передачи
сообщения, утверждая, что его создал сам получатель (отказ
от авторства). Получатель легко может модифицировать,
подменить или создать новое сообщение, а затем утверждать,
что оно получено от отправителя (приписывание авторства).
Ясно, что в такой ситуации арбитр при решении
спора не будет иметь возможность установить истину.
Основным механизмом решения этой проблемы является
так называемая цифровая подпись.
Хотя цифровая подпись и имеет существенные отличия,
связанные с возможностью отделения от документа и независимой
передачей, а также возможностью подписывания одной
подписью всех копий документа, она во многом аналогична
обычной “ручной” подписи.
Схема цифровой подписи включает два алгоритма,
один — для вычисления, а второй — для проверки подписи.
Вычисление подписи может быть выполнено только автором
подписи. Алгоритм проверки должен быть общедоступным,
чтобы проверить правильность подписи мог каждый.
Для создания схемы цифровой подписи можно использовать
симметричные шифрсистемы. В этом случае подписью
может служить само зашифрованное на секретном ключе сообщение.
Однако основной недостаток таких подписей состоит
в том, что они являются одноразовыми: после каждой
проверки секретный ключ становится известным. Единственный
выход из этой ситуации в рамках использования симметричных
шифрсистем - это введение доверенной третьей стороны,
выполняющей функции посредника, которому доверяют
обе стороны. В этом случае вся информация пересылается
через посредника, он осуществляет перешифрование сообще66
Основные понятия
ний с ключа одного из абонентов на ключ другого. Естественно,
эта схема является крайне неудобной.
При использовании шифрсистем с открытым ключом
возможны два подхода к построению системы цифровой подписи.
П
ервый подход состоит в преобразовании сообщения в
форму, по которой можно восстановить само сообщение и
тем самым проверить правильность “подписи”. В данном
случае подписанное сообщение имеет, как правило, ту же
длину, что и исходное сообщение. Для создания такого “подписанного
сообщения” можно, например, произвести зашифрование
исходного сообщения на секретном ключе автора
подписи. Тогда каждый может проверить правильность подписи
путем расшифрования подписанного сообщения на открытом
ключе автора подписи.
При втором подходе подпись вычисляется и передается
вместе с исходным сообщением. Вычисление подписи заключается
в преобразовании исходного сообщения в некоторую
цифровую комбинацию (которая и является подписью). Алгоритм
вычисления подписи должен зависеть от секретного
ключа пользователя. Это необходимо для того, чтобы воспользоваться
подписью мог бы только владелец ключа. В
свою очередь, алгоритм проверки правильности подписи
должен быть доступен каждому. Поэтому, как правило, этот
алгоритм зависит от открытого ключа пользователя. В данном
случае длина подписи не зависит от длины подписываемого
сообщения.
Одновременно с проблемой цифровой подписи возникла
проблема построения бесключевых криптографических хэш-
функций. Дело в том, что при вычислении цифровой подписи
оказывается более удобным осуществить сначала хэширование,
то есть свертку текста в некоторую комбинацию фиксированной
длины, а затем уже подписывать полученную комбинацию
с помощью секретного ключа. При этом функция
хэширования, хотя и не зависит от ключа и является откры67
Iлава 2
той, должна быть “криптографической”. Имеется в виду
свойство односторонности этой функции: по значению комбинации-
свертки никто не должен иметь возможность подобрать
соответствующее сообщение.
В настоящее время имеются стандарты на криптографические
хэш-функции, утверждаемые независимо от стандартов
на криптографические алгоритмы и схемы цифровой подписи.
§ 2.2. Управление секретными ключами
Порядок использования криптографической системы определяется
системами установки и управления ключами.
Система установки ключей определяет алгоритмы и
процедуры генерации, распределения, передачи и проверки
ключей.
Система управления ключами определяет порядок использования,
смены, хранения и архивирования, резервного
копирования и восстановления, замены или изъятия из обращения
скомпрометированных, а также уничтожения старых
ключей.
Предварительное распределение ключей
Для надежной защиты информации, передаваемой по открытому
каналу связи, применяют криптографические средства.
Чтобы воспользоваться ими, необходимо осуществить
первоначальный выбор и установку ключей. Для генерации
ключей могут применяться различные алгоритмы. Выбранные
ключи необходимо как-либо передать взаимодействующим
сторонам. Поэтому для первоначального распределения
ключей необходим защищенный канал связи.
Самый надежный способ первоначального распределения
ключей — это личная встреча всех взаимодействующих сторон.
Можно использовать также специальных курьеров, которые
будут развозить ключи. Однако при большом числе
68
Основные понятия
взаимодействующих сторон требуется предварительная рассылка
значительного объема ключевой информации и последующее
ее хранение. Поэтому на практике применяют специальные
системы предварительного распределения ключей,
предусматривающие распределение и хранение не самих
ключей, а некоторой меньшей по объему исходной информации,
на основе которой в дальнейшем каждая сторона может
вычислить ключ для взаимодействия с другой стороной. Система
предварительного распределения ключей включает два
алгоритма. С помощью первого алгоритма осуществляется
генерация исходной информации. Эта информация включает
открытую часть, которая будет передана всем сторонам или
помещена на общедоступном сервере, а также секретные части
каждой стороны. Второй алгоритм предназначен для вычисления
действующего значения ключа для взаимодействия
между абонентами по имеющейся у них секретной и общей
открытой части исходной ключевой информации.
Система предварительного распределения ключей должна
быть устойчивой, то есть учитывать возможность раскрытия
части ключей при компрометации, обмане или сговоре
абонентов, и гибкой — допускать возможность быстрого восстановления
путем исключения скомпрометированных и подключения
новых абонентов.
Пересылка ключей
После того как предварительное распределение ключей
произведено, может потребоваться передача ключей для
каждого конкретного сеанса взаимодействия. Передача этих
ключей может осуществляться с помощью шифрования с использованием
ранее полученных ключей.
Для передачи зашифрованных ключей по открытому каналу
связи между не доверяющими друг другу абонентами
требуется решение всего комплекса задач по установлению
подлинности различных аспектов взаимодействия, начиная от
подлинности субъектов взаимодействия, подлинности пере-
/:с\
/ лава 2
даваемых сообщений, подлинности самого сеанса связи и
кончая подтверждением правильности (идентичности) полученных
абонентами ключей.
Для централизованного управления пересылкой ключей
создаются специальные доверенные центры, выполняющие
функции центров распределения или перешифрования ключей.
Различие между этими центрами заключается в том, что
в первом случае генерация ключей осуществляется в центре
распределения, а во втором случае — самими абонентами.
Открытое распределение ключей
Наиболее просто распределение ключей осуществляется
в системах открытого распределения (секретных) ключей.
Для сетей связи с большим числом абонентов традиционные
подходы к построению системы распределения ключей оказываются
очень неудобными. Диффи и Хеллман впервые показали,
как можно решить эту задачу, используя незащищенный
канал связи.
В предложенной ими системе открытого распределения
ключей [Диф79] каждая из сторон изначально имеет свой
секретный параметр. Стороны реализуют определенный протокол
взаимодействия по открытому каналу связи. При этом
они обмениваются некоторыми сообщениями (образованными
с помощью своих секретных параметров) и по результатам
этого обмена вычисляют общий секретный связной ключ. В
более поздних работах такие протоколы стали называть протоколами
выработки общего ключа, поскольку изначально
ни одна из сторон не имеет ключа и как такового распределения
или пересылки ключей в нем не происходит.
В исходном виде система Диффи и Хеллмана имела существенные
недостатки, связанные с возможностью для
третьей стороны по осуществлению активного вхождения в
канал связи и проведению полного контроля передаваемой
информации. Однако после небольших модификаций и дополнений
их протокол уже позволяет осуществлять не только
ПС\
Основные понятия
выработку общего ключа, но и одновременно проверять и
подтверждать правильность вычислений, а также проводить
взаимную аутентификацию взаимодействующих сторон.
Схема разделения секрета
Еще одной задачей современной криптографии, тесно
связанной с проблемой распределения ключей и активно развивающейся
в последние годы, является задача построения
схем разделения секрета. Для многих практически важных
приложений, связанных с запуском или активизацией критических
процессов или определяющих порядок получения доступа
к значимым данным, ответственное лицо должно ввести
секретный ключ. Чтобы обезопасить процедуру принятия решения
и не отдавать все на волю одного человека, являющегося
обладателем ключа, используют метод разделения секрета.
Он состоит в назначении определенной группы лиц, которая
имеет право принимать решение. Каждый член группы
владеет определенной долей секрета (точнее, специально выбранным
набором данных), полная совокупность которых
позволяет восстановить секретный ключ. При этом схема разделения
секрета выбирается с таким условием, что для восстановления
секретного ключа требуется обязательное присутствие
всех членов группы, так как в случае отсутствия хотя
бы одного из участников объединение долей оставшихся
членов группы гарантированно не позволяет получить никакой
информации о секретном ключе. Таким образом, схема
разделения секрета определяется двумя алгоритмами, удовлетворяющими
сформулированному выше условию: первый
алгоритм определяет порядок вычисления значений долей по
заданному значению секретного ключа, а второй предназначен
для восстановления значения секрета по известным долям.
Задачу построения схемы разделения секрета можно
обобщить
71
I лава 2
— либо путем введения так называемой структуры доступа,
когда решение может приниматься не одной, а несколькими
различными группами, причем часть из участников
может наделяться правом “вето”,
— либо путем добавления механизмов, позволяющих
обнаружить обман или сговор участников,
— либо введением специального протокола распределения
долей между участниками с подтверждением правильности
полученной информации и аутентификацией сторон.
§ 2.3. Инфраструктура открытых ключей
Сертификаты
Создание цифровой подписи позволило решить проблему
сертификации открытых ключей. Она заключается в том,
что перед тем как использовать открытый ключ некоторого
абонента для отправки ему конфиденциального сообщения,
отправитель должен быть уверен, что открытый ключ действительно
принадлежит этому абоненту. Открытые ключи необходимо
очень тщательно обезопасить, в том смысле, что
если сервер, на котором они хранятся, не обеспечивает их целостность
и аутентичность, то злоумышленник имеет возможность,
подменив открытый ключ одного из абонентов,
выступать от его имени. Поэтому для защиты открытых ключей
создаются специальные центры сертификации, которые
играют роль доверенной третьей стороны и заверяют открытые
ключи каждого из абонентов своими цифровыми подписями.
С
ертификат представляет собой набор данных, заверенный
цифровой подписью центра и включающий открытый
ключ и список дополнительных атрибутов, принадлежащих
абоненту. К таким атрибутам относятся: имена пользователя
и центра сертификации, номер сертификата, время действия
сертификата, предназначение открытого ключа (цифровая
подпись, шифрование) и т. д.
7?
Основные понятия
Международный стандарт 180 Х.509 определяет общую
структуру сертификатов открытых ключей и протоколы их
использования для аутентификации в распределенных системах.
Центры сертификации
Центр сертификации предназначен для регистрации
абонентов, изготовления сертификатов открытых ключей,
хранения изготовленных сертификатов, поддержания в актуальном
состоянии справочника действующих сертификатов и
выпуска списка досрочно отозванных сертификатов.
Для сетей с большим числом абонентов создается несколько
центров сертификации. Центры сертификации объединяются
в древовидную структуру, в корне которой находится
главный центр сертификации, который выдает сертификаты
подчиненным ему отраслевым центрам, тем самым
обеспечивая доверие к открытым ключам этих центров. Каждый
центр вышестоящего уровня аналогичным образом делегирует
право выпуска сертификатов подчиненным ему центрам.
В результате доверие сертификату открытого ключа
каждого центра основано на заверении его сертификата ключом
вышестоящего центра. Сертификаты главного центра
подписывает сам главный центр.
Зная иерархию и подчиненность друг другу центров сертификации,
можно всегда точно установить, является ли абонент
владельцем данного открытого ключа.
Основная трудность при создании центров сертификации
заключается в их юридическом статусе и потенциальных финансовых
возможностях по выплате компенсаций за ущерб,
понесенный в результате невыполнения подписанных цифровыми
подписями с использованием сертификатов, выданных
этим центром, договоров и контрактов, сорванных по причине
отказов от цифровых подписей или их подделки.
73
Iлава 2
§ 2.4. Формальные модели шифров
Для того чтобы иметь возможность доказывать в криптографии
точные результаты, нужны математические модели
основных исследуемых объектов, к которым относятся в первую
очередь шифр и открытый текст. Введем сначала алгебраическую
модель шифра (шифрсистемы), предложенную, по
сути дела, К. Шенноном [ШенбЗ]. С моделями открытых текстов
мы познакомимся ниже.
Как мьг уже знаем, криптография защищает информацию
с помощью шифрования — процедуры, использующей некое
обратимое преобразование. При этом преобразование открытого
текста в шифрованный называется зашифрованием, а
обратный процесс — расшифрованием. Шифрование предполагает
наличие множества обратимых преобразований. Выбор
преобразования из указанного множества для зашифрования
данного сообщения осуществляется с помощью ключа.
Имеется однозначное соответствие между множеством ключей
и множеством преобразований.
Выбор ключа естественным образом определяет функцию
(вообще говоря, многозначную), отображающую множество
возможных открытых текстов в множество возможных
шифрованных текстов. Способ вычисления значения этой
функции для произвольного аргумента будем называть правилом
зашифрования. Выбранный ключ будем называть ключом
зашифрования. Требование однозначности расшифрования
определяет обратную функцию, отображающую множество
возможных (при выбранном ключе) шифрованных текстов
в множество возможных открытых текстов. Способ вычисления
значения этой функции для произвольного аргумента
будем называть правилом расшифрования. Ключ, определяющий
выбор правила расшифрования, будем называть ключом
расшифрования.
Формализуем сказанное.
74
Основные понятия
Пусть Х ,К ,У — конечные множества возможных открытых
текстов, ключей и шифрованных текстов соответственно;
Ек \ Х —» У — правило зашифрования на ключе
к е К . Множество {Ек : к е К\ обозначим через Е , а множество
{Ек ( х ) : х е Х } — через Ек ( X ) . Пусть В к :
Ек( Х ) —> X — правило расшифрования на ключе к е К , и
В — множество {В к : к е К ] .
Здесь и далее мы будем предполагать, что если к е К
представляется в виде к = (к3, А:р ), где к3 — ключ зашифрования,
а кр— ключ расшифрования (причем к3 Ф А:р), то Ек
понимается как функция Ек^, а О к — как функция В к .
Определение 1. Шифром (шифрсистемой) назовем совокупность
2 А = (Х 9К9У9Е9В)
введенных множеств, для которых выполняются следующие
свойства:
1) для любых х е X и к е К выполняется равенство
Е>к(Ек(х)) = х;
2) Г = 1 )Е, (Х) .
кеК
Неформально, шифр — это совокупность множеств возможных
открытых текстов (то, что шифруется), возможных
ключей (то, с помощью чего шифруется), возможных шифр-
текстов (то, во что шифруется), правил зашифрования и правил
расшифрования.
Отметим, что условие 1) отвечает требованию однозначности
расшифрования. Условие 2) означает, что любой элемент
у еУ может быть представлен в виде Ек( х ) для подходящих
элементов х е X и к е К . Отметим также, что в
75
/ лава 2
общем случае утверждение “для любых к е К и у е Ек (X )
выполняется равенство Ек (Ок (у)) = у ” является неверным.
Легко проверить, что из условия 1) следует свойство инъ-
ективности функции Ек. Другими словами, если х ]9х 2 е X ,
причем х х Ф х 2, то при любом к ^ К выполняется неравен-
ство Д ( х , ) * Ек(х2).
По сути дела определение 1 вводит математическую модель,
отражающую основные свойства реальных шифров. В
силу этого мы будем отождествлять реальный шифр с его моделью
ЕА, которую будем назвать алгебраической моделью
шифра. Для подавляющего большинства известных шифров
несложно составить такую модель, как это будет видно из
дальнейшего.
Введем теперь вероятностную модель шифра. Следуя
К. Шеннону [ШенбЗ], определим априорные распределения
вероятностей Р(Х), Р ( ^ ) на множествах X и К соответственно.
Тем самым для любого х е X определена вероятность
р х (х ) е Р (Х) и для любого к е К — вероятность
р К (к ) е Р (К) , причем выполняются равенства
2 Рх(х) = \ И ^ р К(к) = \ .
хеХ кеК
В тех случаях, когда нам требуется знание распределений
Р(X ) и Р(АГ), мы будем пользоваться вероятностной моделью
, состоящей из пяти множеств, связанных условиями
1) и 2) определения 1, и двух вероятностных распределений:
ЕВ = (Х ,К ,7 ,Е ,Д Р (Т ) ,Р (Ю ) .
Забегая вперед, отметим, что вероятностные характеристики
шифров используются лишь в криптоанализе — разде76
Основные понятия
ле криптографии, посвященном решению задач вскрытия
(или взлома) шифров.
В большинстве случаев множества X и У представляют
собой объединения декартовых степеней некоторых множеств
А и В соответственно, так что для некоторых натуральных
Ь и Ц
Х = ( ]Л' , У = 1 )В ‘ .
/=1 /=1
Множества А и В называют соответственно алфавитом
открытого текста и алфавитом шифрованного текста.
Другими словами, открытые и шифрованные тексты записываются
привычным образом в виде последовательностей
букв.
Введем шифр простой замены в алфавите А .
ь
Определение 2. Пусть X = У = А1, К с; 8(А), где
/ = 1
В(А) — симметрическая группа подстановок множества
А . Для любого ключа к ^ К , открытого текста
х = (х19...9х 1) и шифрованного текста у = ( у х правила
зашифрования и расшифрования шифра простой замены в
алфавите А определяются формулами:
Е1с(х) = (к(х{),...,к(х1)),
В(Су) = (*~'СУ|
где к~х —подстановка, обратная к к .
В более общей ситуации для шифра простой замены
/. I
X = \ ^ А \ У = \ ^ В 1, причем |д |= |5 |, а К представляет
/=1 1=\
собой множество биекций множества А на множество В .
Правила зашифрования и расшифрования определяются для
77
/ лава 2
к е К, х е X, у е У (и обратной к к биекции к 1) формулами
(1).
Определим еще один шифр, называемый шифром перестановки.
Определение 3. Пусть X = У = А 1 и пусть К с: 8 1, где
8 ( — симметрическая группа подстановок множества
М , . . . , 4 Для любого ключа к , открытого текста
х = (х1,...,х/ ) и шифрованного текста У = (У\9~-9У1 ) правша
зашифрования и расшифрованш шифра перестановки
определяются формулами:
Ек(х) = (хк( 1)>-,**(!)), Лк (У) =
где к 1 —подстановка, обратная к к .
Шифры, введенные определениями 2 и 3, являются представителями
двух наиболее важных классов симметричных
шифров, а именно шифров замены и шифров перестановки,
которые будут подробно рассматриваться ниже. Другими
симметричными шифрами являются композиции (или последовательные
применения) некоторых шифров замены и шифров
перестановки.
Приведем пример асимметричного шифра.
В следующем определении шифра К8А мы будем пользоваться
общепринятыми в алгебре терминологией и обозначениями
(см. Приложение 3).
Определение 4. Пусть п - р ^ , где р и ц — простые
числа. Пусть X = У = Ъп — кольцо вычетов по модулю п .
Положим
к= {(п ,р , д, а, Ь): а,Ь е 2„, п =рд, аЪ = 1(тос1$и))},
78
Основные понятия
где ф — функция Эгтера. Предстаешь ключ к е К в виде
к = (к3,кр) , где к3 =(п,Ь) и кр =(п ,р ,ц ,а )— ключи зашифрования
и расшифрования соответственно. Правила
зашифрования и расшифрования шифра К8А определим для
х е X и у формулами:
Екз(х) = х ь тойп, Ок^(у) = у а тойп. (2)
Аббревиатура К8А определяется начальными буквами
фамилий создателей этого шифра — Клуез!, 8Ьагтг, АсИетап.
Корректность формул (2) следует из малой теоремы Ферма
(подробнее это сделано в § 11.1).
Введенные определения и термины не исчерпывают полный
перечень необходимых нам понятий, которые будут вводиться
далее по необходимости.
§ 2.5. Модели открытых текстов
Введенная нами математическая модель шифра Ев (см.
§ 2.4) содержит вероятностные распределения Р (Х ) и Р(К)
на множествах открытых текстов и ключей соответственно.
Если Р(К) определяется свойствами устройств, служащих
для генерации ключей (которые могут быть случайными или
псевдослучайными), то Р(Х) определяется частотными характеристиками
самих текстов, подлежащих шифрованию.
Характер таких текстов может быть различный: это могут
быть обычные литературные тексты, формализованные данные
межмашинного обмена и т. д. Так или иначе, открытые
тексты обладают многими закономерностями, некоторые из
которых наследуются шифрованными текстами. Именно это
является определяющим фактором, влияющим на надежность
шифрования.
79
Г лава 2
Математические модели открытого текста
Потребность в математических моделях открытого текста
продиктована, прежде всего, следующими соображениями.
Во-первых, даже при отсутствии ограничений на временные и
материальные затраты по выявлению закономерностей,
имеющих место в открытых текстах, нельзя гарантировать
того, что такие свойства указаны с достаточной полнотой.
Например, хорошо известно, что частотные свойства текстов
в значительной степени зависят от их характера. Поэтому при
математических исследованиях свойств шифров прибегают к
упрощающему моделированию, в частности, реальный открытый
текст заменяется его моделью, отражающей наиболее
важные его свойства. Во-вторых, при автоматизации методов
криптоанализа, связанных с перебором ключей, требуется
“научить” ЭВМ отличать открытый текст от случайной последовательности
знаков. Ясно, что соответствующий критерий
может выявить лишь адекватность последовательности
знаков некоторой модели открытого текста.
Один из естественных подходов к моделированию открытых
текстов связан с учетом их частотных характеристик,
приближения для которых можно вычислить с нужной точностью,
исследуя тексты достаточной длины (см. Приложение
1). Основанием для такого подхода является устойчивость
частот А:-грамм или целых словоформ реальных языков человеческого
общения (то есть отдельных букв, слогов, слов и
некоторых словосочетаний). Основанием для построения модели
может служить также и теоретико-информационный
подход, развитый в работах К. Шеннона [ШенбЗ],
Учет частот к -грамм приводит к следующей модели открытого
текста. Пусть Р<"к){А) представляет собой массив,
состоящий из приближений для вероятностей р(Ь{Ь2--Ьк)
появления А;-грамм Ь]Ь2.,Ък в открытом тексте, АеЫ,
А = {а]9...9ап} — алфавит открытого текста, Ь1 е А, / = 1,Аг.
80
Основные понятия
Тогда источник “открытого текста” генерирует последовательность
сх,с2,...,ск,ск+],... знаков алфавита А , в которой
А;-грамма схс2...ск появляется с вероятностью
р(с хс2...ск) е Р (к)(А) , следующая А:-грамма с2с3...ск+] появляется
с вероятностью р (с 2съ...ск+х) е Р(к)(А) и т. д. Назовем
построенную модель открытого текста вероятностной
моделью к-го приближения.
Таким образом, простейшая модель открытого текста -
вероятностная модель первого приближения - представляет
собой последовательность знаков с1?с2,..., в которой каждый
знак с/ ?/ = 1,2,..., появляется с вероятностью
р(с () е Р^1)(А), независимо от других знаков. Будем называть
также эту модель позначной моделью открытого текста.
В такой модели открытый текст схс2...с1 имеет вероятность
р {с хс1...с1) = \ \ р { с , ) .
/ = 1
В вероятностной модели второго приближения первый
знак с, имеет вероятность р{сх) ^ Р {Х){А), а каждый следующий
знак с1 зависит от предыдущего и появляется с вероятностью
р(с,/с,_ ,) = -Ж - . О
где р(с1^ с 1) е Р {1\А ) , Ж , - Ж Рт (А), I = 2 Д .... Други-
ми словами, модель открытого текста второго приближения
представляет собой простую однородную цепь Маркова. В
такой модели открытый текст с]с2...с1 имеет вероятность
81
I лава 2
I
р ( с 1с2...с1) = р { с х) • ]~[ р(с, /с,_,) .
1=2
Модели открытого текста более высоких приближений
учитывают зависимость каждого знака от большего числа
предыдущих знаков. Ясно, что, чем выше степень приближения,
тем более “читаемыми” являются соответствующие модели.
Проводились эксперименты по моделированию открытых
текстов с помощью ЭВМ.
Приведем примеры “открытых текстов”, выработанных
компьютером на основе частотных характеристик (алфавита
со знаком пробела) собрания сочинений Р. Желязны объемом
10652970 байтов:
1. (Позначная модель) алисъ проситете пригнуть стречи
разве возникла
2. (Второе приближение) н умере данного отствии официант
простояло его то;
3. (Третье приближение) уэт быть как ты хоть а что я
спящихся фигурой куда п;
4. (Четвертое приближение) ество что ты и мы сдохнуть
пересовались ярким сторож;
5. (Пятое приближение) луну него словно него словно из ты
в его не полагаете помощи я д;
6. (Шестое приближение) о разведения которые звенел в
тонкостью огнем только.
Как видим, тексты вполне “читаемы”.
Отметим, что с более общих позиций открытый текст
может рассматриваться как реализация стационарного эрго-
дического случайного процесса с дискретным временем и конечным
числом состояний [Гне88].
82
Основные понятия
Критерии распознавания открытого текста
Заменив реальный открытый текст его моделью, мы можем
теперь построить критерий распознавания открытого
текста. При этом можно воспользоваться либо стандартными
методами различения статистических гипотез, либо наличием
в открытых текстах некоторых запретов, таких, например, как
биграмма ЪЪ в русском тексте. Проиллюстрируем первый
подход при распознавании позначной модели открытого текста.
Итак, согласно нашей договоренности, открытый текст
представляет собой реализацию независимых испытаний случайной
величины, значениями которой являются буквы алфавита
А = {ах,...,ап} , появляющиеся в соответствии с распределением
вероятностей Р (А ) = ( р ( а х) , . . . ,р ( а п) ) . Требуется
определить, является ли случайная последовательность
с]с2...с1 букв алфавита А открытым текстом или нет.
Пусть Н0 — гипотеза, состоящая в том, что данная последовательность
— открытый текст, Н х — альтернативная
гипотеза. В простейшем случае последовательность схс2...с1
можно рассматривать при гипотезе Н х как случайную и равновероятную.
Эта альтернатива отвечает субъективному
представлению о том, что при расшифровании криптограммы
с помощью ложного ключа получается “бессмысленная” последовательность
знаков. В более общем случае можно считать,
что при гипотезе Н, последовательность схс2...с1 представляет
собой реализацию независимых испытаний некоторой
случайной величины, значениями которой являются буквы
алфавита А = {а19...,аЛ}, появляющиеся в соответствии с
распределением вероятностей @ (А ) = (д(ах д(а„) ) . При
таких договоренностях можно применить, например, наибо83
(лава 2
лее мощный критерий различения двух простых гипотез, который
дает лемма Неймана—Пирсона [Кра75]
В силу своего вероятностного характера такой критерий
может совершать ошибки двух родов. Критерий может принять
открытый текст за случайный набор знаков. Такая ошибка
обычно называется ошибкой первого рода, ее вероятность
равна а = . Аналогично вводится ошибка второго
рода и ее вероятность /? = /?{Н0/Н ,} . Эти ошибки определяют
качество работы критерия. В криптографических исследованиях
естественно минимизировать вероятность ошибки
первого рода, чтобы не “пропустить” открытый текст. Лемма
Неймана—Пирсона при заданной вероятности первого рода
минимизирует также вероятность ошибки второго рода.
Критерии на открытый текст, использующие запретные
сочетания знаков, например к -граммы подряд идущих букв,
будем называть критериями запретных к -грамм. Они устроены
чрезвычайно просто. Отбирается некоторое число 5
редких А;-грамм, которые объявляются запретными. Теперь,
просматривая последовательно к -грамму за к -граммой анализируемой
последовательности с1с2...с/ , мы объявляем ее
случайной, как только в ней встретится одна из запретных к -
грамм, и открытым текстом в противном случае. Такие критерии
также могут совершать ошибки в принятии решения. В
простейших случаях их можно рассчитать. Несмотря на свою
простоту, критерии запретных к -грамм являются весьма эффективными.
Контрольные вопросы
1. Чем отличаются подходы к обеспечению безопасности
информации в криптографии и в методах сокрытия информации?
84
Основные понятия
2. Какими методами обеспечивается конфиденциальность
информации?
3. Что такое целостность информации?
4. Для каких аспектов информационного взаимодействия
необходима аутентификация?
5. Какие средства используются для обеспечения невозможности
отказа от авторства?
6. В чем суть предварительного распределения ключей?
7. В чем разница между обычным и открытым распределениями
ключей?
8. Для чего нужны схемы разделения секрета?
9. Что такое сертификат открытого ключа?
10. Каковы функции центра сертификации ключей?
11. Чем отличаются алгебраическая и вероятностная модели
шифра?
12. С какими целями в криптографии вводят модели открытых
текстов?
13. Как подсчитать вероятность данного открытого текста в
модели первого приближения?
14. Какие подходы используются для распознавания открытых
текстов?
15. Какая идея воплощена в расположении клавиш на клави-
туре пишущей машинке, компьютера, логотипа?
Глава 3
Классификация шифров
по различным признакам
В качестве первичного признака, по которому производится
классификация шифров, используется тип преобразования,
осуществляемого с открытым текстом при шифровании.
Если фрагменты открытого текста (отдельные буквы или
группы букв) заменяются некоторыми их эквивалентами в
шифртексте, то соответствующий шифр относится к классу
шифров замены. Если буквы открытого текста при шифровании
лишь меняются местами друг с другом, то мы имеем дело
с шифром перестановки. С целью повышения надежности
шифрования шифрованный текст, полученный применением
некоторого шифра, может быть еще раз зашифрован с помощью
другого шифра. Все возможные такие композиции различных
шифров приводят к третьему классу шифров, которые
обычно называют композиционными шифрами. Заметим, что
композиционный шифр может не входить ни в класс шифров
замены, ни в класс шифров перестановки. В результате получаем
первый уровень классификации шифров
(см. рис. 8).
Рис. 8
86
Классификация шифров
§ 3.1. Математическая модель шифра замены
Определим модель 2\А = (Х ,К ,У ,Е ,0 ) произвольного
шифра замены. Будем считать, что открытые и шифрованные
тексты являются словами в алфавитах А и В соответственно:
1 с # , У с 5 * ,|Д | = я, |2?| = /ю. Здесь и далее С*
обозначает множество слов конечной длины в алфавите С .
Перед зашифрованием открытый текст предварительно
представляется в виде последовательности подслов, называемых
шифрвеличинами. При зашифровании шифрвеличины
заменяются некоторыми их эквивалентами в шифртексте, которые
назовем шифробозначениями. Как шифрвеличины, так
и шифробозначения представляют собой слова из А * и В *
соответственно.
Пусть V = {и19...9им} — множество возможных шифрве-
личин, V = — множество возможных шифробо-
значений. Эти множества должны быть такими, чтобы любые
тексты х е Х , у еУ можно было представить словами из
соответственно. Требование однозначности расшифрования
влечет неравенства N >п 9 М >т, М > N .
Для определения правила зашифрования Ек (х) в общем
случае нам понадобится ряд обозначений и понятие распределителя,
который, по сути, и будет выбирать в каждом такте
шифрования замену соответствующей шифрвеличине.
Поскольку М > N , множество V можно представить в
N
виде объединения V = I К непересекающихся непустых
/ = 1
подмножеств У(1). Рассмотрим произвольное семейство, состоящее
из г таких разбиений множества V :
(лава 3
и соответствующее семейство биекций
<ра -М ^ { У ^ , . . . ,У ^ } ,
для которых фа (к,) = У^ , г = 1, N .
Рассмотрим также произвольное отображение
ц/ : К х N —> Ы*, где = {1, 2,..., г} , такое, что для любых
к € К, I € N
у/{к,1) = а \к\..а \к\ сс(к)е К г, у = Ц . (1)
Назовем последовательность у/{к,1) распределителем,
отвечающим данным значениям к е ЛГ, / е N .
Теперь мы сможем определить правило зашифрования
произвольного шифра замены. Пусть
х е Х , х = хг . лс/5 х е [/,1 = 1,1; к е К
и у/(к,1) = а \к)...а \к). Тогда Я* О ) = у , где у = у х...у, ,
у ] е<ра(к)(х]) , ; = 1,1. (2)
В качестве у / можно выбрать любой элемент множества
(р (*)(дг ) . Всякий раз при шифровании этот выбор можно
а1
производить случайно, например, с помощью некоторого
рандомизатора типа игровой рулетки. Подчеркнем, что такая
многозначность при зашифровании не препятствует расшифрованию,
так как У^° Г\УУ} = 0 при / Ф у .
88
Классификация шифров
§ 3.2. Классификация шифров замены
Если ключ зашифрования совпадает с ключом расшифрования:
к3 = к р , то (как уже указывалось в гл. 2) такие шифры
называют симметричными, если же к3 Ф кр — асимметричными.
В
связи с указанным различием в использовании ключей
сделаем еще один шаг в классификации (см. рис. 9).
Рис. 9
Отметим также, что в приведенном определении правило
зашифрования Ек (х) является, вообще говоря, многозначной
функцией. Выбор ее значений представляет собой некоторую
проблему, которая делает многозначные функции Ек(х) не
слишком удобными для использования. Избавиться от этой
проблемы позволяет использование однозначных функций,
что приводит к естественному разделению всех шифров замены
на однозначные и многозначные замены (называемых также
в литературе омофонами) (см. рис. 10).
Для однозначных шифров замены справедливо свойство:
I лава 3
для многозначных шифров замены:
З а ,/:|К в(,)|> 1 .
Рис. 10
Исторически известный шифр — пропорциональной замены
представляет собой пример шифра многозначной замены,
шифр гаммирования — пример шифра однозначной замены.
Далее мы будем заниматься в основном изучением однозначных
замен, получивших наибольшее практическое применение.
Итак, далее М = N и фа {иг)=: Уа^ \ I = 1 ,М .
Заметим, что правило зашифрования Ек естественно
“рассматривается как” отображение, Ек : II* -> У * .
В силу инъективности (по к ) отображения Ек и того, что
м = и . введенные в общем случае отображения (ра являются
биекциями (ра :11 <-> V , определенными равенствами
90
Классификация шифров
-> I = 19М9а = \ , г . Число таких биекций не превосходит
N1
Для шифра однозначной замены определение правила
зашифрования можно уточнить: в формуле (2) включение
следует заменить равенством
У^=<Ра^^Лx^), 7 = 1,/. (2’)
Введем еще ряд определений.
Если для некоторого числа д е N выполняются включения
V, € В д, I — 1,Л^, то соответствующий шифр замены будем
называть шифром равнозначной замены. В противном
случае — шифром разнозначной замены (см. рис. 11).
Рис. 11
В подавляющем большинстве случаев используются
шифры замены, для которых V е А р , для некоторого р е N .
При р ~ 1 говорят о поточных шифрах замены, при р > 1 —
о блочных шифрах замены (см. рис. \2).
91
/ лава 3
Рис. 12
Относительно деления шифров на поточные и блочные
подробнее см. в гл. 8.
Следующее определение. В случае г = 1 шифр замены
называют одноалфавитным шифром замены или шифром
простой замены. В противном случае — многоалфавитным
шифром замены (см. рис. 13).
Рис. 13
Ограничиваясь наиболее важными классами шифров замены
и исторически известными классами шифров перестановки,
сведем результаты классификации в схему, изображенную
на рис. 14.
92
Классификация шифров
Шифры Шифры Композиционные
замены перестановки шифры
Многозначные Однозначные Маршрутные
замены замены перестановки
Симметричные
шифры
Асимметричные
шифры
Столбцовые
(строчные)
перестановки
Решетки,
лабиринты
Поточные Блочные
шифры шифры
Одноалфавитные М ногоалфавитные -► Шифры
шифры шифры гаммирования
Рис. 14
Прокомментируем приведенную схему. Подчеркнем, что
стрелки, выходящие из любого прямоугольника схемы, ука-
93
I лава 3
зывают лишь на наиболее значимые частные подклассы шифров.
Пунктирные стрелки, ведущие из подклассов шифров
перестановки, означают, что эти шифры можно рассматривать
и как блочные шифры замены в соответствии с тем, что открытый
текст делится при шифровании на блоки фиксированной
длины, в каждом из которых производится некоторая
перестановка букв. Одноалфавитные и многоалфавитные
шифры могут быть как поточными, так и блочными. В то же
время шифры гаммирования, образующие подкласс многоалфавитных
шифров, относятся к поточным, а не к блочным
шифрам. Кроме того, они являются симметричными, а не
асимметричными шифрами.
Далее мы рассмотрим свойства большинства из указанных
на схеме классов шифров.
Контрольные вопросы
1. С какими примерами шифров замены и перестановки Вы
познакомились в историческом обзоре?
2. Существуют ли шифры, не являющиеся ни шифрами замены,
ни шифрами перестановки?
3. Приведите пример шифра многозначной замены.
4. Может ли блочный шифр быть шифром разнозначной замены?
5. Может ли шифр простой замены быть равнозначным ,
разнозначным, блочным шифром?
6. В каком случае шифр гаммирования является одноалфавитным
шифром?
7. Каково максимальное число простых замен, из которых
может состоять многоалфавитный шифр?
8. Можно ли рассматривать множество возможных открытых
и шифрованных текстов как множество шифровели-
чин и шифрообозначений шифра замены?
94
Глава 4
Шифры перестановки
В историческом обзоре упоминались некоторые типы
шифров перестановки. Среди них — шифр Сцитала, атбаги,
поворотная решетка Кардано. В самом общем виде шифр
перестановки определен в гл. 3. Ключом шифра является перестановка
номеров букв открытого текста. Зависимость ключа
от длины текста создает значительные неудобства в использовании
шифра. В силу этого был предложен ряд частных
шифров перестановок, которые можно применять для зашифрования
текстов любой длины.
§ 4.1. Маршрутные перестановки
Широкое применение получили так называемые маршрутные
перестановки, основанные на некоторой геомегри-
ческой фигуре. Отрезок открытого текста записывается в такую
фигуру по некоторой траектории. Шифрованным текстом
является последовательность, полученная при выписывании
текста по другой траектории. Например, можно записывать
сообщение в прямоугольную таблицу, выбрав такой маршрут:
будем двигаться по горизонтали, начиная с левого верхнего
угла, поочередно слева направо и справа налево. Списывать
же сообщение будем по другому маршруту: по вертикалям,
начиная с верхнего правого угла и двигаясь поочередно сверху
вниз и снизу вверх.
Пример (маршрутной перестановки)
Зашифруем указанным выше способом фразу пример
маршрутной перестановки, используя прямоугольную таблицу
размером 4x 7 :
95
/ лава 4
п р и м е Р м
н т У р ш Р а
О й п е Р е с
и к в о н а т
Зашифрованная фраза выглядит следующим образом:
мастаеррешрноермвпуиртикионп
Обращение описанных шагов при расшифровании не
представляет труда.
Широкое распространение получила разновидность маршрутной
перестановки, называемая вертикальной перестановкой.
В этой системе также используется прямоугольная
таблица, в которую сообщение записывается обычным образом
(по строкам слева направо). Выписывается же сообщение
по вертикалям (сверху вниз), при этом столбцы выбираются в
порядке, определяемом числовым ключом.
Пример {вертикальной перестановки)
Зашифруем фразу вот пример шифра вертикальной перестановки,
используя прямоугольник размером 6 х 7 и числовой
ключ (5,1,4,7,2,6,3).
5 1 4 7 2 6 3
в О т п р и м
е р ш и ф Р а
в е Р т и к а
л ь н О й п е
Р е с т а н о
в к и
96
Шифры перестановки
Отметим, что нецелесообразно заполнять последнюю
строку прямоугольника “нерабочими” буквами, так как это
дало бы противнику, получившему в свое распоряжение данную
криптограмму, сведения о длине числового ключа. В самом
деле, в этом случае длину ключа следовало бы искать
среди делителей длины сообщения.
Теперь, выписывая буквы по столбцам в порядке, указанном
числовым ключом, получим такую криптограмму:
ореъекрфийамааеотшрнсивевлрвиркпнпитот
При расшифровании, в первую очередь, надо определить
число длинных столбцов, то есть число букв в последней
строке прямоугольника. Для этого нужно разделить число
букв в сообщении на длину числового ключа. Ясно, что остаток
от деления и будет искомым числом. Когда это число определено,
буквы криптограммы можно водворить на их собственные
места, и сообщение будет прочитано естественным
образом.
В нашем примере 38 = 7-5 + 3, поэтому в заполненной
таблице имеется 3 длинных и 4 коротких столбца. Согласно
числовому ключу, начальные буквы криптограммы берутся из
второго (по счету слева) столбца, он — длинный (так как первые
три столбца — длинные), поэтому первые шесть букв образуют
второй столбец. Следующие пять букв образуют пятый
столбец (он — короткий). И так далее.
Более сложные маршрутные перестановки могут использовать
другие геометрические фигуры и более “хитрые” маршруты,
как, например, при обходе шахматной доски “ходом
коня”, пути в некотором лабиринте и т.п. Возможные варианты
зависят от фантазии составителя системы и, конечно, естественного
требования простоты ее использования.
97
( лава 4
§ 4.2. Элементы криптоанализа шифров
перестановки
Укажем сначала основные идеи, используемые при вскрытии
вертикальных перестановок.
Заметим прежде всего, что буквы каждого столбца заполненного
прямоугольника выписываются в криптограмму подряд,
то есть криптограмма разбивается на отрезки, являющиеся
столбцами таблицы. Поэтому при дешифровании следует попытаться
соединить две группы последовательных букв криптограммы
так, чтобы они образовывали хорошие (“читаемые”) с
точки зрения обычного текста комбинации. Для этого естественно
использовать наиболее частые биграммы открытого текста,
которые можно составить из букв рассматриваемого шифрованного
текста. Если для первой пробы выбрано, скажем, сочетание
СТ (самая частая биграмма русского языка), то мы можем
по очереди приписывать к каждой букве С криптограммы
каждую букву Т из нее. При этом несколько букв, стоящих до и
после данной буквы С, и несколько букв, стоящих до и после
данной буквы Т, соединяются в пары, то есть получаются два
столбца букв, записанные рядом:
I П
Конечно, мы не знаем длины столбцов, но некоторые ограничения
на них можно получить, используя положение конкретных
букв. Так, столбцы должны иметь одинаковые длины или
первый столбец может быть длиннее второго на одну букву, и
тогда эта буква — последняя буква сообщения:
98
Шифры перестановки
С т
А Б
М <- последняя буква сообщения
Если приписываемые друг к другу буквы разделены, скажем,
только двумя буквами, то, как легко видеть, мы можем составить
в соседних столбцах не более трех пар, и длина каждого
столбца не превышает четырех. Кроме того, ограничением может
послужить появление запретной биграммы (например,
гласная — мягкий знак):
А Ь запретная биграмма
Для выбранного сочетания СТ получается по одной паре
столбцов для каждого конкретного выбора букв С и Т из криптограммы,
и из них целесообразно отобрать ту пару, которая
содержит наиболее частые биграммы.
Заметим, что при автоматизации этого процесса можно
приписать каждой биграмме вес, равный частоте ее появления в
открытом тексте. Тогда целесообразно отобрать ту пару столбцов,
которая имеет наибольший вес. Кстати, появление одной
биграммы с низкой частотой может указать на то, что длину
столбца надо ограничить.
Выбрав пару столбцов, мы аналогичным образом можем
подобрать к ним третий (справа или слева) и т. д. Описанная
процедура значительно упрощается при использовании вероятных
слов, то есть слов, которые могут встретиться в тексте с
большой вероятностью.
Рассмотрим также метод, применимый к любым шифрам
перестановки. Допустим, что к двум или более сообщениям (или
99
Г лава 4
отрезкам сообщений) одинаковой длины применяется один и тот
же шифр перестановки. Тогда очевидно, что буквы, которые находились
на одинаковых местах в открытых текстах, окажутся
на одинаковых местах и в шифрованных текстах.
Выпишем зашифрованные сообщения одно под другим так,
что первые буквы всех сообщений оказываются в первом столбце,
вторые — во втором и т. д. Если предположить, что две конкретные
буквы в одном из сообщений идут одна за другой в открытом
тексте, то буквы, стоящие на тех же местах в каждом из
остальных сообщений, соединяются подобным же образом. Значит,
они могут служить проверкой правильности первого предположения,
подобно тому как комбинации, которые дают два
столбца в системе вертикальной перестановки, позволяют проверить,
являются ли соседними две конкретные буквы из этих
столбцов. К каждому из указанных двухбуквенных сочетаний
можно добавить третью букву для образования триграммы и т.
д. Если располагать не менее чем четырьмя сообщениями одинаковой
длины, то можно с уверенностью гарантировать их
вскрытие подобным образом.
Контрольные вопросы
1. Приведите пример шифра перестановки, который может
рассматриваться и как блочный шифр замены.
2. Как определить по криптограмме, полученной с помощью
шифра вертикальной перестановки, число коротких столбцов
заполненного открытым текстом основного прямоугольника?
3. Какие свойства открытого текста используются при вскрытии
шифра вертикальной перестановки?
4. Сколько ключей имеет шифр поворотной решетки (см. главу
1). На основе прямоугольника размером т х п?
5. Каким образом можно использовать вероятные слова для
вскрытия ряда криптограмм, полученных на одном ключе
шифра перестановки?
100
Глава 5
Шифры замены
Мы будем рассматривать лишь однозначные замены (см.
главу 3), для которых правило зашифрования является обычной
однозначной функцией. Одноалфавитные однозначные
замены обычно называют шифрами простой замены.
§ 5.1. Поточные шифры простой замены
Наибольшее распространение получили поточные шифры
простой замены, множества шифрвеличин и шифробозначе-
ний которых совпадают с алфавитом открытого текста^. Как
указывалось в главе 2, ключом такого шифра является подстановка
к на множестве А , верхняя строка которой представляет
собой естественную последовательность букв алфавита,
а нижняя — систематически перемешанную или случайную
последовательность букв из А (см. Приложение 1).
Помимо явного задания (в виде двустрочной записи)
ключ может быть задан некоторой формулой, как, например,
для определяемого ниже шифра Цезаря (который иногда называют
также сдвиговым шифром) и аффинного шифра. При
использовании этих шифров буквы алфавита А удобно отождествлять
с их порядковыми номерами, так что, например,
для латинского алфавита
а = О, Ь = 1,..., 2 = 25 .
Шифр Цезаря
I
Х = У = 1]2'26,К = г 26. Для х = (х1,..,х1), у = (у1,...,у1),
/ = 1
к е К полагаем
У = Ек(х) = (х1 +к,...,х,'+к),
101
Гпава 5
* = Пк 0 0 = (Уг + (26 - к),..., у, + (26 - к ) ) ,
где + и • — операции кольца вычетов 2 26.
Аффинный шифр
Х = У = 1)2'26, К = г ;бх 2 26. Для к = ( а ,Р ) е К , а * О,
/=1
Х = (Х1 У = (У\,...,У,), полагаем
у = Ек(х) = ( а х 1 +Р, . . . ,а-Х/+Р) ,
х = Ок (у) = ((у , + ( 2 6 - 0 ) ) (у, + (2 6 - Р)) • а ' 1),
где + и • — операции кольца 2 , а (X х — элемент из мультипликативной
группы 2 \ь , обратный к а .
Пример
Зашифруем слово СКУРТОСЖАРНУ с помощью аффинного
шифра, полагая к = (3,5). Данный ключ индуцирует
следующую подстановку на 2 :
О 1 2 3 4 5 6 7 8 9 10 11 12
5 8 11 14 17 20 23 0 3 6 9 12 15
13 14 15 16 17 18 19 20 21 22 23 24 25
18 21 24 1 4 7 10 13 16 19 22 25 2
Если декодировать числа в буквы, то получим следующее
соответствие для букв:
102
Шифры замены
А В С Э Е Р О Н I .1 К Ь М
Р I Е О К С Х А О С . 1 М Р
к о р д я 8 Т 1 1 У \ У Х У 2 :
8 У У В Е Н К К д Т \ У 2 С
Слову СКУРТООКАРНУ соответствует числовая последовательность
х = (2,17,24,15,19,14,9,17,0,15,7,24) . Зашифровать
открытый текст мы можем двумя способами. Во-
первых, можно воспользоваться полученной подстановкой,
заменяя каждую букву слова (найденную в верхней строке) ее
образом в нижней строке: ЬЕ2УКУХЕРУА2. Во-вторых,
можно вычислить значение функции зашифрования Ек (х ) ,
исходя из ее определения:
у = Ек (х) = (3-2 + 5, 3-17 + 5, 3-24 + 5, 3-15 + 5,
3-19 + 5, 3-14 + 5, 3-9 + 5, 3-17 + 5,
3-0 + 5, 3-15 + 5, 3-7 + 5,3 -24+ 5) =
= (11, 4,25,24,10,21,23,4,5,24,0, 25).
В буквенном эквиваленте у совпадает с полученным ранее
шифрованным текстом.
Для расшифрования у следует вычислить 3-1 в группе
2 ;б. Очевидно, что 3-1 = 9. Теперь расшифруем у в соответствии
с определением правила расшифрования:
х = Ик (у ) = ((11 + 21)- 9,(4 + 21) • 9,(25 + 21) • 9,(24 + 21) • 9,
(10 + 21)- 9,(21 + 21)- 9,(23 + 21)- 9,(4 + 21)- 9,(5 + 21) • 9,
(24 + 21)- 9,(0 + 21)- 9,(25 + 21) • 9) =
= (2,17,24,15,19,14,6,17,0,15,7,24).
103
I лава 5
Здесь мы воспользовались определением операций сложения
и умножения в кольце 2 26, заменяя результат обычных
целочисленных вычислений остатком от деления на 26.
В связи с рассмотрением аффинного шифра полезно напомнить
один хорошо известный алгебраический результат.
Теорема. Отображение / : Ъп —» Ъп, определяемое для
фиксированных а,Ъ е Ъп формулой
/ (а ) = а а + Ь(то<1п ) ,
является биективным тогда и только тогда, когда
(а,п) = 1.
До сих пор мы предполагали, что шифробозначениями
являются отдельные знаки алфавита. Однако это вовсе не
обязательное условие. Как отмечалось в гл. 3, имеются шифры
равнозначной замены и шифры разнозначной замены. В
первом случае все шифробозначения имеют одинаковые
значности, например один, два и т. д. Во втором — разные
значности, например, некоторые шифробозначения могут
быть отдельными знаками, другие — состоять из пары или
большего числа знаков. По соображениям экономии и скорости
шифрования значность шифробозначений не должна быть
большой. В большинстве известных примеров разнозначных
шифров значность шифробозначений не превосходит двух.
Приведем один из таких примеров [Вес97].
Пример (шифра простой неравнозначной замены)
Рассматривается прямоугольник размером 4x7, в который
записан систематически перемешанный английский алфавит
(расширенный символами и знаком раздела “/”),
построенный на основе ключевого слова ПЧСГГАТШ:
104
Шифры замены
1 N С Т А V 8
0 1 86 3 5 94 6
В В Е Р С Н 5
80 83 2 89 91 95 98
К Ь М О Р <5 К
81 84 87 4 92 96 7
V X У Ъ /
82 85 88 90 93 97 99
Нумерация букв алфавита произведена по столбцам
(сверху вниз), при этом восемь самых частых букв
(А,Е,1,Ы,0,К,8,Т) занумерованы числами от 0 до 7, а остальные
— двузначными числами от 80 до 99. Такую таблицу
легко запомнить. Работать же удобнее с эквивалентной таблицей:
0 1 2 3 4 5 6 7 8 9
I N Е Т О А 8 Я - -
В К V в ь V/ С м X Р
У О Р ъ V Н 0 ] /
При зашифровании открытый текст записывается со знаком
пробела между словами. Точка, встретившаяся в тексте,
считается отдельным словом. После этого производится замена
шифрвеличин на шифробозначения согласно таблице,
при этом цифровые данные не изменяются.
§ 5.2. Криптоанализ поточного шифра
простой замены
Рассмотрим сначала простейший случай — однобуквенной
замены.
105
Г лава 5
Любой метод вскрытия шифра простой однобуквенной
замены основан на том обстоятельстве, что с точностью до
переобозначений частотные характеристики т -грамм шифртекста
и открытого текста одинаковы. При этом существенно
используются априорные частотные характеристики предполагаемого
открытого текста, получаемые с учетом “характера
переписки”. Как отмечено в Приложении 1, такие характеристики
являются более “рельефными” для литературных текстов
и менее “рельефными” для формализованных электронных
текстов. Чем менее рельефно распределение знаков текста,
тем сложнее задача вскрытия шифра простой замены.
Для открытых текстов с “почти равномерным” распределением
знаков эта задача становится практически не решаемой.
Это следует учитывать и не питать иллюзий о простоте
вскрытия простой замены, о которой часто упоминается в
популярных книгах по защите информации. Методы “рандомизации”
или “сжатия” открытых текстов, например, с использованием
компьютерных архиваторов значительно усложняют
задачу вскрытия шифра простой замены.
Как будет ясно из дальнейшего (гл. 7), рельефность диаграммы
текста тесно связана с такой его важной теоретикоинформационной
характеристикой, как избыточность. Далее
мы будем решать задачу вскрытия простой замены лишь при
условии, что предполагаемые открытые тексты — это литературные
тексты с “приличной” избыточностью. Кроме того,
мы будем считать, что при дешифровании мы располагаем
достаточно большим числом знаков шифртекста, чтобы опираться
не на “фокусы”, использованные, например, в известных
произведениях Э. А. По и А. Конан Дойля, а в большей
степени на “статистику”.
Алгоритм вскрытия простой замены по тексту криптограммы
достаточно сложно формализовать. При любой попытке
формализации теряется какой-нибудь важный нюанс.
Поэтому мы укажем лишь основные идеи, лежащие в основе
106
Шифры замены
такого алгоритма. Обычно выделяют следующие этапы алгоритма:
Алгоритм 1
1. Подсчет частот встречаемости шифробозначений, а также
некоторых их сочетаний, например биграмм и триграмм
подряд идущих знаков.
2. Выявление шифробозначений, заменяющих гласные и
согласные буквы.
3. Выдвижение гипотез о значениях шифробозначений и их
проверка. Восстановление истинного значения шифробозначений.
Сделаем ряд замечаний и уточнений.
Если длина текста достаточно велика, то найденные на
этапе 1 частоты окажутся близкими к табулированным значениям
частот знаков (соответственно — биграмм или триграмм).
Проведенная на этом этапе работа служит основанием
для выдвижения гипотез о значениях шифрвеличин, соответствующих
данным шифробозначениям. При этом учитывается,
что каждая буква имеет группу предпочтительных связей
(см. Приложение 1), которые составляют ее наиболее характерную
особенность. Как правило, такие гипотезы подтверждаются
не полностью. Хорошим критерием при этом является
“читаемость” восстанавливаемого открытого текста. Выделение
шифробозначений, отвечающих гласным и согласным,
основано на характерных свойствах этих букв, указанных
в Приложении 1. Добавим к ним следующие соображения
(относимые к большинству европейских языков). Если
шифробозначение часто встречается, равномерно располагается
по шифртексту, в отдельных местах чередуется через 1, 2
или 3 знака, сочетается со средними и редкими (по частоте)
шифробозначениями, то это дает основания полагать, что
такое шифробозначение скрывает гласную букву. Удвоение
гласных в открытом тексте происходит реже, чем согласных.
Если некоторое шифробозначение признано гласной, то бук107
I лава 5
ва, часто сочетающаяся с ней, скорее всего согласная. В открытом
тексте чрезвычайно редко встречаются три и более
подряд идущие гласные. Четыре и более подряд идущие согласные
также редки. Важно учитывать также процентное соотношение
чисел гласных и согласных в открытом тексте.
При проверке гипотез о значениях шифробозначений полезен
поиск в шифртексте слов с характерной структурой,
которые часто встречаются в открытом тексте. Для русского
языка — это, например, слова сколько, которое, что и т. п.
Для английского языка — слова егегу, (Иа(, 1оок, (Не и т. п.
Такие слова выделяются в шифртексте посредством интервалов
между повторяющимися частыми буквами, характерными
сочетаниями гласных и согласных.
Если с помощью приведенных соображений произведено
несколько идентификаций шифробозначений, то дальнейшая
работа по вскрытию текста криптограммы не представляет
особого труда.
Пример вскрытия шифра простой однобуквенной замены
приведен в Приложении 2.
Задача дешифрования еще более упрощается, если известно,
что использовался сдвиговый или аффинный шифр.
Так, для аффинного шифра бывает достаточно идентифицировать
лишь пару шифробозначений с тем, чтобы полностью
восстановить открытый текст (см., например, [Сал96]).
Из наших рассмотрений становится понятным, что наиболее
трудно формализуемым фрагментом алгоритма 1 является
проверка выдвигаемых гипотез о значениях шифробозначений.
Трудность состоит в формулировке критерия, подтверждающего
или отвергающего ту или иную гипотезу. В
статье [Так95], посвященной этому вопросу, был предложен
четко сформулированный критерий, основанный на “близости”
матрицы биграмм Д(/) = (А (*))лх/| (где п — число букв
алфавита) данного текста г эталонной матрице биграмм
108
Шифры замены
В = (Ъу )пхп открытого текста. Приведем эту идею и основанный
на ней эвристический алгоритм дешифрования.
Мерой близости служит следующая “целевая функция”
/(О ? связывающая матрицы Д(/) и В:
Будем исходить из того естественного предположения,
что если у — данная криптограмма и ^ — правило расшифрования
на ключе к данного шифра простой замены, то для
истинного ключа ки значение
должно быть минимальным.
Идея основного шага алгоритма состоит в том, чтобы исходя
из некоторого первичного “приближения” к для ключа
ки, основанного, например, на диаграмме частот букв, немного
его изменять неким “разумным” способом, уменьшая
значение целевой функции / ( / ) .
Приведем теперь формальное описание алгоритма
Алгоритм 2
1. Построить начальный вариант ключа к на основе сравнения
частот знаков криптограммы и открытого текста.
2. Положить у = / ( Ок( у )).
3. Положить к' = к .
4. Поменять местами в нижней строке подстановки А:1 некоторую
пару букв, скажем а и .
5. Положить у’= / ( О к,(у)).
6. Если у’< V, то положить к = к \ у’= V и перейти к 4.
(1)
[1ак95].
109
/ лава 5
7. Перейти к шагу 3.
Алгоритм заканчивается, когда условие V'<V не выполняется
в течение некоторого числа итераций, например 100.
Переход на шаге 4 от к к к ' , связанный с транспозицией
пары символов, имеет под собой следующее основание. На
шаге 5 вычисляется величина
у '= / ( 0 4.(у )) = 2 А уЮ ь 'О ')) ■-Ъц\ =
и
и
где Д'О) — матрица, полученная из матрицы Д(7) путем
перестановки в ней столбцов с номерами а и Д , а также
строк с теми же номерами.
В силу отмеченного свойства на шаге 5 алгоритма не
нужно проводить трудоемкую операцию вычисления матрицы
биграмм А (Лк, (у)) непосредственно по “расшифрованному”
тексту Лк, ( у ) . Достаточно вычислить лишь матрицу
А(Лк(у) ) , а на следующих шагах алгоритма производить в
ней одноименные перестановки строк и столбцов.
Выбор транспозиции (« ,/? ) на шаге 4 можно производить,
например, следующим естественным образом. Пусть
5 = (5х, 52,...,5„) — вектор, образованный буквами криптограммы,
упорядоченными по убыванию частот. Тогда последовательность
транспозиций можно выбрать такой:
110
Шифры замены
($1, 52 ), (*^2 9 )»•••» (^л-2 »^л-1 ХО^яЧ ’ )’
С5 ! ? 5 3 X 0*2 ? 5 4 Х---9 ( $ п- 2 9 $п X
О и О '
В |7ак95] показано, что алгоритм 2 является достаточно
эффективным.
Отметим некоторые особенности вскрытия равнозначных
и разнозначных шифров простой замены.
Если шифр простой замены не является однобуквенным,
то при вскрытии криптограммы необходимо попытаться восстановить
множество шифрвеличин. Если эта задача решена,
то дальнейшая работа ничем не отличается от той, которую
мы проделали для шифра однобуквенной простой замены.
Заметим, что в литературных открытых текстах часто
встречаются повторения фрагментов, состоящих из трех и
большего числа букв. При применении к тексту шифра простой
замены соответствующие повторения остаются и в шифрованном
тексте. Если в криптограмме встретилось несколько
повторений, то их успешно можно использовать для определения
значности шифробозначений.
Очевидно, что для равнозначного шифра простой замены
длины повторений и расстояния между ними должны быть
кратны значности шифра. Находя наибольший общий делитель
этих чисел, мы с большой вероятностью получаем искомую
значность. Некоторые сомнения в правильности определения
значности помогает устранить подсчет общего числа
шифробозначений. Если это число близко к ожидаемому числу
шифробозначений (скажем, к числу букв алфавита), и диаграмма
их повторяемости близка к табличной, то, скорее всего,
значность определена верно.
Для разнозначного шифра дело обстоит несколько сложнее.
В этом случае числа, равные длинам повторений и расстояниям
между ними, скорее всего, взаимно просты в сово111
/ лава Ь
купности. Однако и для таких шифров задача определения
множества шифробозначений не безнадежна. В этом помогает
естественное ограничение, которым обычно пользуются при
составлении таблицы шифробозначений. Оно связано с требованием
однозначности расшифрования и заключается в
том, чтобы ни одно из шифробозначений не являлось началом
никакого другого шифробозначения (в теории кодирования в
подобной ситуации говорят о префиксном коде). Если значность
шифробозначений колеблется в незначительных пределах,
то перебор сравнительно небольшого числа вариантов
приводит (с учетом ограничения) к правильному определению
большинства шифробозначений. Некоторые затруднения
могут возникать лишь при определении значности шифробозначений,
редко встречающихся в тексте. Как правило, эти
проблемы решаются вместе с попытками прочтения тех участков
криптограммы, для которых восстановленная значность
шифробозначений не вызывает сомнений.
Увеличение значности шифробозначений делает шифр
неэкономным, поэтому получили распространение шифры,
использующие одно- и двузначные шифробозначения, подобные
рассмотренному выше в примере цифровому шифру.
Понятно, что для таких шифров наибольшую повторяемость в
шифртексте имеют цифры, с которых начинаются двузначные
шифробозначения. Выдвигая гипотезы о таких цифрах и отмечая
в шифртексте соответствующие двузначные шифробозначения,
можно восстановить и однозначные шифробозначения,
оказавшиеся в шифртексте между некоторыми двузначными
шифробозначениями. Дальнейшая работа по
вскрытию открытого текста для разнозначного шифра ничем
не отличается от уже знакомой нам работы для однобуквенной
простой замены.
112
Шифры замены
§ 5.3. Блочные шифры простой замены
Как мы убедились, задача вскрытия простой однобуквенной
замены является не слишком сложной. Основная слабость
такого шифра состоит в том, что избыточность открытого
текста, полностью проникающая в шифртекст, делает (за счет
малого числа шифрвеличин, которыми являются буквы алфавита)
очень рельефной диаграмму повторяемости знаков
криптограммы. Это побудило в свое время криптографов к
устранению этой слабости за счет увеличения числа шифрвеличин.
Интуитивно понятно, что чем больше разница между
числом шифрвеличин и числом букв алфавита, тем более равномерной
должна стать диаграмма повторяемости знаков
шифртекста. Первым естественным шагом в этом направлении
стало увеличение значности шифрвеличин, то есть использование
блочных шифров простой замены.
Простейший блочный шифр оперирует с биграммными
шифрвеличинами. Одними из первых таких шифров были
биграммные шифры Порта и Плейфера (см. гл. 1). Приведем
описание шифра Плейфера, нашедшего широкое применение
в начале нашего века.
Основой шифра Плейфера является прямоугольная таблица,
в которую записан систематически перемешанный алфавит
(для удобства запоминания). Правило зашифрования
состоит в следующем.
Буквы биграммы (/, у), / Ф у (являющейся шифрвеличи-
ной) находятся в данной таблице. При зашифровании биграмма
(/,у) заменяется биграммой (&,/), где к и / определяются
в соответствии с правилами 1-3.
1. Если / и у не лежат в одной строке или одном столбце,
то их позиции образуют противоположные вершины прямоугольника.
Тогда к и / — другая пара вершин, причем к —
вершина, лежащая в той же строке, что и /.
2. Если / и у лежат в одной строке, то к и / — буквы той
же строки, расположенные непосредственно справа от / и у
113
Iлава Ь
соответственно. При этом если одна из букв — последняя в
строке, то считается, что ее “правым соседом” является первая
буква той же строки.
3. Аналогично, если / и у лежат в одном столбце, то они
заменяются их “соседями снизу”.
Наглядно правило зашифрования можно проиллюстрировать
следующим образом.
В случае 1:
В случае 2:
/ к .• у /
В случае 3:
При зашифровании открытый текст представляется в виде
последовательности биграмм. Если текст имеет нечетную
114
Шифры замены
длину или содержит биграмму, состоящую из одинаковых
букв, то в него добавляются “пустышки” следующим образом.
“Пустышкой” является некоторая редкая для данного
типа текста буква (или знак), которая вставляется между одинаковыми
буквами биграммы или добавляется в текст для
того, чтобы его длина стала четной. Такие изменения открытого
текста, как правило, не мешают при расшифровании.
Проиллюстрируем сказанное следующим примером.
Пример (шифра Плейфера)
Пусть шифр использует прямоугольник размером 5 х 6 , в
который записан систематически перемешанный русский 30-
буквенный алфавит на основе ключевого слова командир:
к О м а н д
и Р б в г е
ж 3 л п с т
У ф X ц ч ш
щ ь ы э ю я
Зашифруем фразу “автором метода является Уитстон”.
В качестве “пустышки” будем использовать редкую букву ф.
Представим фразу в виде последовательности биграмм:
АВ ТО РО МФ МЕ ТО ДА ЯВ ЛЯ ЕТ ТЯ УИ ТС ТО НФ
(Нам пришлось дважды вставить “пустышку”.)
В соответствии со сформулированными правилами получаем
шифртекст:
ВП ЗД ЗР ОХ ДБ ЗД КН ЭЕ ТЫ ТШ ШД ЩЖ ЖТ ЗД 0 4
или без пробелов
впздзрохдбздкнэетытшшдщжжтздоч
115
Iлава 5
Криптоанализ шифра Плейфера опирается на частотный
анализ биграмм, триграмм и четырехграмм шифртекста и
особенности замены шифрвеличин на шифробозначения, связанные
с расположением алфавита в прямоугольнике. При
этом существенную информацию о заменах дает знание того,
что используется систематически перемешанный алфавит.
Замечательный пример вскрытия криптограммы, полученной
применением шифра Плейфера, приведен в [8а196].
Шифрвеличинами для другого широко известного блочного
шифра — шифра Хилла (названного по имени Лестора
Хилла) — являются п -граммы открытого текста (« > 2 ),
представленного некоторым числовым кодом (так что алфавитом
открытого текста служит кольцо вычетов по модулю
мощности алфавита Ът ).
Правило зашифрования представляет собой линейное
преобразование кольца Ът \ если х = (хХ9...,хп) — «-грамма
открытого текста, к = (ку ) — некоторая обратимая матрица
над Ъ (ключ) и У = — «-грамма шифртекста, то
у ^ = Ек (х) = к • . Соответственно х ^ = В к (у) = к~1 • у ^ ,
где к~] — матрица, обратная к матрице для к .
Подчеркнем, что матричные операции здесь производятся
над кольцом Ъ .
Проиллюстрируем введенное определение примером.
Пример (шифра Хилла)
Положим п = 4 и зашифруем фразу:
без труда не вынешь рыбку из пруда
записанную в 30-буквенном русском алфавите. Условимся о
числовом кодировании букв в соответствии с таблицей:
116
Шифры замены
А Б В Г д Е Ж 3 И К Л М Н О П
1 18 11 6 0 15 20 5 21 23 13 4 16 8 25
Р С Т У Ф X ц Ч Ш щ Ь ы Э Ю Я
24 10 19 26 12 2 28 7 17 22 3 29 27 14 9
В качестве ключа выберем матрицу
"1 2 3 4"
1 2 3 5
к = *
1 3 3 5
,1 3 4 5;
являющуюся обратимой над кольцом 2 30. Несложно убедиться
в том, что
г 5 28 1 27^
, _ 0 29 1 О
О 0 29 1
,29 1 0 0 ,
Запишем открытый текст по столбцам матрицы Т :
"18 241616 24 26 24^
15 261515 29 2126
Т =
5 0 11 1718 5 О
, 19 1 29 3 23 25 1 ,
и получим шифртекст в виде столбцов матрицы к • Т :
117
Г лава 5
2 3 4^ /
1 2 3 5
1 3 3 5
,1 3 4 5, ч
18 241616 24 26 24ч
15 261515 29 2126
5 0 11 17 18 5 О
✓ х 19 1 29 3 23 25 1
^19 20 15 19 18 3 20 л
8 21 14 221128 21
2317 29 7 101917
28 17 10 24 28 24 17
Теперь осталось воспользоваться числовым кодом, чтобы
выписать шифртекст в буквенном виде:
токцжишшеюыстщчрбвсцъцтржишш
Замечание. Из соображений удобства в применении получили
широкое распространение шифры, для которых правила
зашифрования и расшифрования идентичны. Такие
шифры называются обратимыми. Шифр Хилла является обратимым
в том и только том случае, когда к~х — к , или иначе:
к2 = Е , где Е — единичная матрица. Матрица, удовлетворяющая
этому свойству, называется инволютивной.
Из курса алгебры известен критерий обратимости квадратной
матрицы над кольцом Ът .
Теорема. Квадратная матрица М над кольцом Ът обратима
тогда и только тогда, когда (|Л/|, т ) = 1, то есть
определитель \М\ взаимно прост с т .
Заметим, что правило зашифрования Ем (с матрицей
М п/п) в шифрсистеме Хилла является обратимым линейным
118
Шифры замены
преобразованием «-мерного модуля 2" . Такая функция является
лишь одним из примеров простого задания обратимого
преобразования 2 ” —» 2" , являющегося, очевидно, биекцией
на 2 ” . Любая же такая биекция потенциально может рассматриваться
как правило зашифрования блочного шифра
простой замены (если п — размер блока), выбираемого некоторым
ключом. Поскольку число обратимых линейных преобразований
модуля 2" составляет (при п>2 ,т>2 ) лишь
незначительную часть общего числа рассматриваемых биекций,
то же самое можно сказать и о доле, которую составляют
(при данном п) шифрсистемы Хилла в множестве возможных
блочных шифров простой замены.
Замечание. Можно проверить, что имеется всего 24 обратимых
преобразования / : 2 2 —» 2 2, причем все они являются
аффинными, то есть для любого х е 2 2 они имеют вид
/ ( х ) = х- А + Ь,
где А — некоторая обратимая 2 x 2 -матрица над 2 2, и
Ье Ъ \.
Естественным обобщением шифра Хилла является аффинный
блочный шифр, правило зашифрования Е ^ (х )
которого определяется формулой (1). При этом А является
обратимой п х п матрицей, а Ь — фиксированным п-
мерным вектором над 2 да.
Как и при рассмотрении предыдущих шифров, приведем
некоторые соображения о криптоанализе аффинного блочного
шифра и, в частности, шифра Хилла.
Увеличение значности шифрвеличин резко усложняет
попытки вскрытия открытого текста по известному тексту
криптограммы. Однако свойство линейности, присущее рас-
119
I лава Ь
сматриваемым шифрам, конечно, является их криптографической
слабостью. Чтобы показать это, рассмотрим следующую
криптоатаку на аффинный шифр.
Предположим, что известны п -1-1 пар блоков открытого
текста и соответствующих им блоков шифртекста:
(х0,у0 (х„,у„ ) , Х „ ^ б 2 ” , полученных на одном ключе
(А,Ь) . Требуется этот ключ найти.
Для решения поставленной задачи положим:
х (,) = х , - х 0, у о) = у , - у 0,г = 1,п.
Тогда 5с(,) и у {,) оказываются связанными линейным соотношением
у (/) = х 0) • А .
Аналогичное соотношение имеет место и для матриц
( у 0 ) )
х = и 7 =
х (и) у(/” V ) ^ )
из которого находим матрицу А в виде произведения
А = Х ~1 У .
Наконец, вектор Ь находится, например, по формуле
Ь = у 0 - х0 • А . Естественно, что такое решение корректно
лишь в том случае, когда матрица X обратима.
Поскольку обращение матрицы и вычисление произведения
матриц являются не слишком трудоемкими операциями,
то таковой же является и поставленная задача.
Более детальное рассмотрение блочных шифров простой
замены будет продолжено в гл. 8.
120
Шифры замены
§ 5.4. Многоалфавитные шифры замены
Напомним, что правило зашифрования многоалфавитного
шифра однозначной замены определяется следующим образом.
Пусть х = (я, — открытый текст, представленный
последовательностью шифрвеличин х ( е11, / = 1,/, и к —
произвольный ключ. Тогда
Ек (х) = (яг. О , я,(х,)) , (2)
где ^ , / = 1,/, — некоторые подстановки на множестве всех
шифрвеличин, однозначно определяемые данным ключом.
При этом здесь и далее мы ограничимся рассмотрением случая,
когда множества шифрвеличин и шифробозначений совпадают
друг с другом (II = V ).
Заметим, что в рассматриваемых условиях любой многоалфавитный
шифр представляет собой совокупность шифров
простой замены, каждая из которых используется для зашифрования
очередной шифрвеличины в соответствии с вспомогательной
последовательностью у/(к, /) (распределителем),
определяемой выбранными ключом и открытым текстом по
формуле (1), приведенной в гл. 3. Принципиально один многоалфавитный
шифр отличается от другого лишь способом
образования распределителя.
На практике используются в основном поточные многоалфавитные
шифры, среди которых выделяются два больших
подкласса — шифры, реализуемые дисковыми шифраторами,
и шифры гаммирования. В литературе можно найти упоминание
и о других примерах поточных многоалфавитных замен
(см., например, [Са178]). В подобных шифрсистемах в (2)
потенциально могут использоваться все возможные подстановки
п данного алфавита. Они строятся с помощью произ121
I лава Ь
ведений определенного вида из небольшого числа исходных
подстановок.
В следующем подпункте мы остановимся на дисковых
шифрах, а шифрам гаммирования, в силу их большой значимости,
отведем отдельную главу.
§ 5.5. Дисковые многоалфавитные
шифры замены
Общая характеристика и принцип действия дискового
шифратора были даны в гл. 1. Здесь мы рассмотрим правило
зашифрования и некоторые свойства такого шифра.
Прежде всего следует выписать преобразование символов
алфавита (в качестве которого, как и ранее, будем рассматривать
множество Ъп = {0,1, . . . , я - 1}), осуществляемое движущимся
диском. Для этого рассмотрим два соседних угловых
положения диска при его повороте (по часовой стрелке).
Пусть в исходном положении диск реализует подстановку
Для того чтобы выписать подстановку, реализуемую диском
после поворота на угол 2я / 9 взглянем на соответствующие
рисунки (см. рис. 15, 16).
Так как диск сдвигается как твердое тело, символ открытого
текста, поступающий на него с входной розетки, проходит
затем по имеющимся в диске соединениям, превращаясь
в символ шифртекста.Разница между двумя рассматриваемыми
положениями диска, как видно из рисунков, состоит
лишь в том, что после поворота символы с входной розетки
поступают на входные контакты диска, номера которых
уменьшаются на единицу (по модулю п ). Мы можем перенумеровать
входные символы, уменьшив каждый на единицу.
122
Шифры замены
Тогда входные контакты диска будут совпадать с входными
символами, которые, пройдя по своим траекториям через
диск, попадут на контакты выходной розетки. Чтобы вернуться
к исходной нумерации символов, следует их увеличить на
единицу.
Вх. розетка Диск Вых. розетка
Рис . 15. Начальное расположение диска
Вх. розетка Диск Вых. розетка
Ри с . 16. Положение диска после поворота
Если ввести в рассмотрение подстановку
' 0 1... л - 2 л - 1 4
, 1 2... л - 1 О
Т =
то из сказанного выше следует, что после поворота диск реализует
подстановку, представимую в виде произведения подстановок:
123
/ лава 5
( * х т = ) Г/ - пС л/ —, ,1 1 = Г * )
+1, +1,
Теперь очевидно, что при повороте диска на угол
2тп , т = \-,-п----\-, диск будет реализовать подстановку
п
гр—7П ^ грШ
Рассмотрим теперь дисковый шифратор, состоящий из нескольких
насаженных на общую ось дисков, так что символы с
входной розетки, попадая на блок дисков, последовательно проходят
перепайки каждого из дисков, попадая на контакты выходной
розетки. Обычно при работе такого шифратора диски при шифровании
очередного знака открытого текста сдвигаются (по определенному
правилу) на некоторые угловые положения (кратные
2 л / ) . Схема движения дисков является ключевым элементом
шифратора. Получим правило зашифрования текущего знака открытого
текста такого шифратора.
Пусть в начальных угловых положениях рассматриваемые
диски реализуют подстановки Х 1Э...,Х^ из симметрической
группы 8 п (они также являются ключевыми элементами) и в данный
такт шифрования данные диски находятся в соответствующих
угловых положениях у ^ , у^ е 0, п - 1. Это означает,
что /-й диск реализует подстановку Т~Гг • X; • Т Гг. Тогда
очередная буква открытого текста X будет зашифрована в букву
У ~ Ек (* ), где
у = Т~г' -X, -Т п ~Г2 • Х 2 •ТГг~Уъ Х]ч Т г»(х).
Формально определить правило зашифрования любого открытого
текста для дискового шифратора чрезвычайно сложно (в
связи с обилием различных ключевых элементов). Для поточных
124
Шифры замены
шифров, как правило, бывает достаточно знания правила зашифрования
буквы текста.
Число простых замен, из которых “состоит” многоалфавитный
шифр, реализуемый дисковым шифратором, может быть
чрезвычайно большим. Чем больше это число, тем сложнее криптоанализ
такого шифра. В связи с этим параметры дисковых схем
(число дисков, реализуемые ими подстановки, схемы движения
дисков и т. д.) должны быть тщательно продуманы.
Схемы токопрохождения электрических импульсов в дисковом
шифраторе могут усложняться за счет введения “отражающего
экрана”, вместо выходной розетки. В результате этого импульс
тока вторично проходит через блок дисков, только в противоположную
сторону. Такая “обратимая” схема токопрохождения была
использована в знаменитой “Энигме”.
Криптоанализ дисковых шифраторов является весьма сложной
задачей, выходящей за рамки данной книги.
Контрольные вопросы
1. Какие шифры называются шифрами простой замены?
2. Что является ключом шифра простой замены? Каково максимально
возможное число ключей шифра простой замены?
3. Что более целесообразно для надежной защиты информации:
архивация открытого текста с последующим шифрованием
или шифрование открытого текста с последующей архивацией?
4. Имеет ли шифр Плейфера эквивалентные ключи, то есть такие
ключи, на которых любые открытые тексты шифруются одинаково?
Сколько различных неэквивалентных ключей имеет
шифр Плейфера?
5. Предположим, что матричный шифр Хилла используется для
зашифрования открытого текста, представленного в виде двоичной
последовательности. Сколько ключей имеет такой
шифр?
125
Глава 6
Шифры гаммирования
Напомним, что в основе рассматриваемых систем шифрования
лежит метод “наложения” ключевой последовательности
— гаммы — на открытый текст. “Наложение” заключается
в позначном (побуквенном) сложении или вычитании по
тому или иному модулю. Хотя мы уже отмечали выше, что
данные шифрсистемы относятся к многоалфавитным системам
замены, шифры гаммирования имеют целый ряд особенностей
и заслуживают отдельного рассмотрения. В силу простоты
своей технической реализации и высоких криптографических
качеств эти шифры получили широкое
распространение.
Исторически первый шифр гаммирования совпадал, по
сути, с шифром Виженера, однако без использования самой
таблицы Виженера. Заметим, что таблица Виженера представляет
собой квадрат, каждая строка и каждый столбец которого
— некоторая перестановка знаков данного алфавита.
Произвольная такая таблица называется латинским квадратом.
Идя по пути обобщения, введем понятие шифра табличного
гаммирования.
§ 6.1. Табличное гаммирование
Шифр табличного гаммирования в алфавите
А = определяется произвольным латинским квадратом
I на А и способом получения последовательности букв
из А, называемой гаммой шифра (см. рис. 17). Буква а, открытого
текста под действием знака гаммы а] переходит в
букву ак шифрованного текста, содержащуюся ву'-й строке и
126
Шифры гаммирования
I-м столбце квадрата Ь (подразумевается, что строки и
столбцы в Ь занумерованы в соответствии с порядком следования
букв в алфавите А).
Т0—> а{
г1
а, ак
Рис. 17
С алгебраической точки зрения буква ак есть результат
применения к буквам а{ и а] квазигрупповой операции *,
табличным заданием которой является латинский квадрат Ь :
ак =а 1*а] .
В случае шифра Виженера квазигруппа (Л,*) является
группой ( 2 Л,+) . При этом уравнение шифрования имеет вид
ь, = ( а ,+ г 1)то й п , ( 1 )
а {//} представляет собой периодическую последователь-
ность, образованную повторением некоторого ключевого
слова.
Наряду со сложением используется и вычитание знаков
гаммы. Соответствующие уравнения шифрования принимают
вид
Ь,=(а,-г,)тоАп (2)
ИЛИ
ь, =(у, -а , )то й п . (3)
127
/ лава 6
Шифры гаммирования с уравнениями шифрования (1) —
(3) обычно называют шифрами модульного гаммирования.
Если в качестве квазигрупповой операции * на множестве
5-мерных двоичных векторов используется операция покоординатного
сложения по модулю 2:
Ъ, =а, ®у,, (4)
то получаем шифр Бернама.
Шифры гаммирования, определяемые уравнениями (3) и
(4), замечательны тем, что при их применении для зашифрования
и расшифрования требуется лишь один узел. В самом
деле, знаки открытого текста находятся из тех же уравнений
при взаимной замене а1 на Ь( . Такие шифры обычно называют
обратимыми (см. замечание после примера шифра Хилла).
Сделаем следующее замечание. Как шифр замены, произвольный
шифр гаммирования имеет следующую интерпретацию.
С /-й строкой латинского квадрата Ь ( у = 1, п ) можно
связать подстановку (“сдвиг” на а ^ ):
а* *а У а~>2 *а ,.,.,.ма л *а у
из симметрической группы $!(А) . Пусть
К{А) = {%] ^ = \,п}.
Тогда в каждом такте шифрования знак открытого текста
заменяется по одной из подстановок из К(А). Распределителем
такого «-алфавитного шифра замены является сама гамма
шифра.
128
Шифры гаммирования
Иногда Я(А) — это группа или смежный класс по некоторой
подгруппе из 8(А) . В таких случаях мы будем называть
шифр табличного гаммирования групповым. Произвольный
шифр табличного гаммирования не слишком удобен для
практической реализации. Наиболее удобны именно групповые
шифры, к которым относятся шифры модульного гаммирования.
§ 6.2. О возможности восстановления
вероятностей знаков гаммы
Криптоанализ произвольного шифра табличного гаммирования
во многом схож с криптоанализом шифра модульного
гаммирования. Рассмотрим основные идеи анализа на примере
шифра с уравнением ( 1 ).
Занумеруем буквы алфавита А числами от 0 до п -1 и
воспользуемся формальными моделями рассматриваемых
последовательностей (см. гл. 2). Пусть и 81 — вероятности
появления знака / в открытом тексте, гамме и в шифрованном
тексте соответственно. Тогда задание вероятностных
распределений на знаках открытого текста и гаммы (которые
естественно считать независимыми) индуцирует распределение
вероятностей знаков шифртекста по формуле:
в которой разность } — г берется по модулю п. (Достаточно
заметить, что Ъ = у <=> а = у - г, у — / , и воспользоваться
формулой полной вероятности.) Легко проверить, что
п- 1
(5)
п- 1
129
Гпава 6
Из формулы (5) следует, что если г{ =\ /п при всех
/ = 0, п - 1, то и = 1/и при всех у = 0, и - 1 . Это означает,
что при зашифровании открытого текста равновероятной
гаммой получается шифртекст, вероятностные свойства которого
не отличаются от самой равновероятной гаммы. Это
обстоятельство не оставляет шансов криптоаналитику использовать
диаграмму повторяемости букв открытого текста,
поскольку при наложении гаммы эта информация как бы стирается.
Поэтому на практике стремятся к тому, чтобы по своим
вероятностным свойствам гамма была близка к случайной
равновероятной последовательности.
Возникает естественный вопрос о том, можно ли при использовании
неравновероятной гаммы восстановить ее вероятностные
характеристики непосредственно по шифртексту и
можно ли эту информацию использовать при криптоанализе
шифра гаммирования.
Попытаемся сначала оценить вероятности гг непосредственно
по шифртексту. При этом мы должны располагать достаточно
точными приближениями распределений
р = (р 0,...,р„_1) , ? = V I )
(получаемыми с помощью подсчета частот встречаемости
знаков).
Рассмотрим соотношение (5) как систему линейных
уравнений относительно неизвестных гг9 г — 0, и - 1 . Нетрудно
заметить, что матрица рассматриваемой системы имеет вид
130
Шифры гаммирования
г Р о Рп-1 ••• Р\ Л
Р = Р\ Ро - Рг
р п-\ р п. 2 - Р о
Такая матрица называется циркулянтом [Кос87]. В ней
каждая строка получается циклическим сдвигом предыдущей
строки. Известно [Кос87], что определитель |Р| циркулянта
равен произведению
где {е0,...,еп_1}— множество всех корней степени п из 1 (в
поле комплексных чисел), причем
и-1
В том случае, когда Р | Ф 0 , вектор г однозначно определяется
из соотношения
Г 1 = р - ‘ . Л (6)
Приведем (без доказательства) формулу для Р 1
/ х0 X, ... х и_, ^
Р~1 = х п - \ х 0 - х п - 2 (7)
Х[ х 2 - *0 )
131
/ лава 6
где
Условие \Р Ф О можно проверить непосредственно по
данному распределению вероятностей букв открытого текста.
V; — число вхождений символа / в шифрованный текст:
§ 6.3. Восстановление текстов,
зашифрованных неравновероятной
гаммой
Пример (использования шифра модульного гаммирования)
Рассмотрим следующую постановку задачи. Пусть при
использовании шифра модульного гаммирования в результате,
например, некоторой неисправности гаммообразующего
Пользуясь (6) и (7), можно вычислить приближение г ^
для г 1 , подставляя вместо 5 I в (6) вектор у I = -1 ... , где
откуда
132
Шифры гаммирования
устройства, т.е. устройства, вырабатывающего гамму, в ней
встречаются не все знаки. Предположим, далее, что гамма
состоит лишь из знаков у]9...9ут , т <п , которые встречаются
с вероятностями г 9...9гг соответственно. Будем также
предполагать, что исходный открытый текст является обычным
литературным текстом. В этих условиях требуется дешифровать
полученную криптограмму.
Заметим, что к подобной постановке задачи можно было
прийти иначе. Выделив несколько знаков гаммы, имеющих
достаточную суммарную вероятность, например 0,8, предположим,
что лишь они использовались при шифровании. Это
предположение может привести к потере истинного варианта
при построении некоторого метода вскрытия. Вероятность
потери можно оценить при этом стандартными методами
статистики.
При решении поставленной задачи примем во внимание,
что в /-м такте шифрованию подлежала одна из следующих
букв открытого текста:
',0) =* , -Г\’~ Л т) =з,-Гт> (8)
где — буква шифртекста.
Поэтому знаки открытого текста следует искать в колонках
таблицы, изображенной на рис. 18:
Р и с .18
133
/ лава 6
Отбирая по одному знаку из каждой колонки так, чтобы
получился “читаемый” текст, мы получим возможность восстановить
открытый текст.
Описанный метод относится к классу так называемых
методов бесключевого чтения (когда открытый текст восстанавливается
без предварительного определения ключа) и называется
методом чтения в колонках.
Метод чтения в колонках можно усовершенствовать за
счет упорядочения букв в колонках. В самом деле, в каждом
такте возможные знаки открытого текста
имеют априорные вероятности р (1),...,р (т), которые считаются
известными. В нашем случае имеется также дополнительная
информация, а именно, известно, что произошло событие
“ ^ =5 ”. При этом
Теперь можно упорядочить вероятности (8) знаков открытого
текста в каждой колонке таблицы в соответствии с
убыванием вычисленных апостериорных вероятностей. Поступив
таким образом, мы поместим наиболее вероятные знаки
открытого текста в начало таблицы, чем облегчим чтение в
колонках.
р{а, = я/1, = {(к)} = гп , к = 1 , т .
Отсюда по формуле Байеса получаем
------------ , К = 1,01. (9)
134
Шифры гаммирования
С ростом т чтение в колонках становится затруднительным,
а при т — п и при условии, что при шифровании использовалась
случайная равновероятная гамма, каждая колонка
содержит все знаки алфавита, ни одному из которых
нельзя отдать предпочтения. Поэтому в последовательности
колонок можно прочитать любой текст, то есть нет возможности
получить информацию об истинном сообщении.
Пример (использования неисправности в реализации
шифра Бернама)
Рассмотрим шифр гаммирования, определяемый уравнением
(4), называемый шифром Вернама. Узел реализации
такого шифра можно представить схемой, изображенной на
рис. 19. На этой схеме кружочками обозначены узлы сложения
по модулю 2 битов открытого текста с соответствующими
битами гаммы. Знаки открытого текста и знаки гаммы
представляются при этом 5-мерными двоичными векторами.
Рис. 19
В случае обрыва одного из “проводков”, идущих от источника
гаммы, последовательность знаков гаммы будет со-
135
I лава 6
держать лишь половину возможных своих значений. Соответствующая
координата в любом 5-мерном векторе гаммы будет
равна нулю. В случае обрыва двух или большего числа
“проводков” векторы гаммы будут содержать два или большее
число нулевых координат. Число возможных знаков гаммы
будет сокращаться вдвое при каждом обрыве. Таким образом,
подобная неисправность схемы приводит к постановке
задачи, указанной в предыдущем пункте. В рассматриваемом
случае подобную неисправность можно обнаружить по шифртексту.
Покажем, как это сделать при условии, что “исправная”
гамма является случайной и равновероятной. Будем при этом
рассматривать позначные модели открытого текста, гаммы и
шифртекста, то есть считать, что они являются реализациями
случайных независимых испытаний полиномиальных схем с
соответствующими распределениями вероятностей р (А ),
г ( А), 8 (А) на знаках открытого текста, гаммы и шифртекста.
Естественно также условиться, что распределения
р(А) и г(А) являются независимыми. При этом распределение
?( А) определяется формулой
*(у)= ^ р М - г(г ) , ( 10)
(х,г)
у=х@/
где х — знак открытого текста, у — знак гаммы, у — знак
шифртекста.
Итак, в нашем случае алфавитом открытого текста, шифрованного
текста и гаммы является множество
А = {{ах, а 2,а ъ,а ^ ,а ь) : а, е 2 2,/ = 1,5},
образующее абелеву группу относительно операции ® покоординатного
сложения векторов по модулю 2. При обрыве,
136
Шифры гаммирования
например, первого соединения (на рис. 19 обрыв указан символом
“ / “) возможные знаки гаммы образуют подмножество
В = {ф,р 2, р ъ, р л, р 5): е 2 2,у = 2,5},
являющееся подгруппой группы (А,Ф) . Точно так же и при
любых других обрывах множество знаков гаммы образует
подгруппу В группы (Д ® ) .
Теорема. При использовании равновероятной гаммы
векторы, принадлежащие одному смежному классу группы А
по подгруппе В, встречаются в шифртексте с равными вероятностями.
Доказательство. Разложим группу А = {ах,...,ап} в левые
смежные классы по подгруппе В = {Ъх 9...Ьт }:
Л = Д и ( я 2 е Я ) и . . . и ( * г Ф Д ), ( 1 1 )
где §; е А, 1 = 2,1, — представители соответствующих
смежных классов, и рассмотрим один из смежных классов
Н = {к\,...,кт} в этом разложении. Пусть для удобства
Н = §Ф В . Ясно, что числа (,т,п связаны равенством
п = 1*т.
Выберем нумерацию элементов множеств В и Н в соответствии
с равенством
_ Нк = ё® Ъ к (12
при к = \ ,т .
Так как В само является группой, при любых г ,к е \ ,т
найдется такое / е 1, т , для которого выполняется равенство
13'
(лава 6
ъ, =ьк ® V (13)
Заметим, попутно, что в группах А и В каждый элемент является
обратным для самого себя.
Легко видеть, что если в (13) индекс / пробегает все значения
от 1 до т , то (при фиксированном к) и индекс ] пробегает
то же множество значений.
Вычислим вероятность $(кк ) появления знака кк смежного
класса Н в шифртексте. В связи с условием равновероятности
знаков гаммы, а также в соответствии с ( 10) - (13)
имеем:
При этом мы воспользовались тем очевидным свойством, что
в случае обрыва знаки гаммы по-прежнему будут иметь одинаковые
вероятности.
Отсюда следует, что вероятность з(кк ) не зависит от к и
совпадает с ^(к}) для любого / = \9тп , что и требуется.
Теорема доказана.
Доказанная теорема позволяет определить по шифртексту
характер произошедшей неисправности. Для этого с использованием
частотных свойств используемого кода (например,
МТК-2 или др.), аналогичных частотам букв в открытом тек138
Шифры гаммирования
сте, можно подсчитать значения вероятностей знаков смежных
классов § {® В, г = 1,/, из разложения ( 1 1 ) по формуле
где а е ® В . Этот подсчет может быть проведен для любых
комбинаций обрывов. Теперь остается определить частоты
символов шифртекста и сравнить их с рассчитанными заранее
эталонными диаграммами. Сравнение выявит характер
неисправности, и задача восстановления открытого текста
будет сведена к чтению в колонках.
Заметим, что вместо 5-мерных можно было рассматривать
и л-мерные векторы, п > 5. Предложенный метод работает
и в этом, более общем случае.
§ 6.4. Повторное использование гаммы
Как и раньше, мы предполагаем, что алфавит А открытых
текстов, гаммы и шифртекстов представляет собой множество
чисел Ъп = {0,1,..., п — 1} .
Пусть в распоряжении криптоаналитика оказались две
криптограммы, полученные наложением одной и той же гаммы
на два разных открытых текста:
Рассмотрим возможности криптоаналитика по восстановлению
исходных открытых текстов.
М8.ФВ)
8 { = Г| + Г(тоАп ),
^2 = + Г(тойп) ,
где
/ лава 6
Прежде всего можно найти позначную разность
5 = 5| - 8 2 = Тх - Т 2 (гпосЗгс).
Пусть 5 = 2,... • Тогда поставленная задача сводится
к попытке подобрать пару открытых текстов, разность которых
совпадает с известной последовательностью 5 . Будем
в связи с этим говорить о разложении 8 на два составляющих
открытых текста. В случае когда данные тексты являются
нормативными текстами, например, на русском, английском
или другом языке, для решения последней задачи используется
ряд подходов. Интуитивно понятно, что при достаточной
длине текстов маловероятна возможность множественного
представления данной последовательности $ в виде
разности Тх—Т2. Как правило, такое разложение бывает
единственным. Здесь имеет место приблизительно такая же
ситуация, как и при рассмотрении вопроса о расстоянии
единственности (см. гл. 7).
Один из таких подходов (хорошо известных из истории
криптографии) связан с использованием некоторого запаса
слов или словоформ, часто встречающихся в открытых текстах.
Это могут быть, например, стандарты переписки, частые
А:-граммы и т. п.
Предположим сначала, что одно из вероятных слов встретилось
в начале первого сообщения:
В таком случае можно вычислить начало второго сообщения:
вероятное слово
140
Шифры гаммирования
Если / > 4, легко определить, является ли начало Т2 “читаемым”
или нет. В первом случае нужно попытаться продлить
начало Т2 по смыслу. Во втором случае нужно сдвинуть
начало вероятного слова в Тг и проделать то же самое.
Если удалось развить Т2 до т знаков (т> /):
II н **
Г2 = / у 2 !т ■■■, то можно вычислить и соответствующие
т - 1 знаки
Т\ =1\-*1 *1+1 +$1+1-*т +*т’
и попытаться, в свою очередь, развить по смыслу Г,.
Продолжая этот процесс далее, мы частично или полностью
восстановим оба текста или убедимся в том, что опробуемого
вероятного слова данные тексты не содержат. В последнем
случае следует попытаться ту же процедуру проделать
для следующего вероятного слова.
Может оказаться так, что при опробовании некоторого
слова удается восстановить лишь часть каждого из текстов, а
дальнейшее развитие их по смыслу бесперспективно. В таком
случае следует продолжить работу с другим вероятным словом.
Конечно, данный метод далеко не всегда приводит к успеху.
Но нельзя пренебрегать шансом, который он дает.
Пример
Возьмем два текста на английском языке, содержащих
наиболее часто встречающуюся триграмму ТНЕ:
Т\ = ТНЕ АРРЬЕ, Т2 = ТЕЬЬ ТНЕМ,
и зашифруем их одной и той же гаммой Г = ОЫЕТ\\ЮТНКЕ.
При этом будем пользоваться числовыми значениями букв
согласно следующей таблице:
141
Г лава 6
00 01 02 03 04 05 06 07 08 09 10 11 12
А В С О Е Р С Н I К Ь М
13 14 15 16 17 18 19 20 21 22 23 24 25
N О Р 0 Я 8 Т V V XV X У Ъ
В результате зашифрования получаем:
тх 19 07 04 00 15 15 И 04
т2 19 04 11 11 19 07 04 12
Г 14 13 04 19 22 14 19 07
07 20 08 19 11 03 04 11
07 17 15 04 15 21 23 19
5 00 03 19 15 22 08 07 18
Предположим теперь, что триграмма ТНЕ находится в
начале Тх, тогда можно вычислить начало Т2 :
Тх= 7т2 + 5' = Т Н Е А
19 07 04 00
Т2=Тх- 8 = Т Е Ь ь
19 04 11 11
Дальнейшие попытки продолжить по смыслу Тх или Т2
к успеху не приводят. Поэтому предположим, что Т2 также
содержит ТНЕ. С учетом полученного результата, мы получаем
два варианта расположения триграммы ТНЕ в тексте Т2 .
В первом из них триграмма ТНЕ расположена, начиная с пятой
позиции, во втором — начиная с шестой позиции.
142
Шифры гаммирования
Рассмотрим первый вариант:
Т2 19 04 11 И 19 07 04
Т Е Ь ь Т Н Е
Т2 19 07 04 00 15 15 11
Т Н Е А Р Р Ь
Теперь ясно, что Т2 = ТНЕ АРРЬЕ, откуда получаем Т\ =
ТЕЬЬ ТНЕМ.
Идея другого способа разложения разности открытых
текстов состоит в упорядочении возможных вариантов пар
букв (/,,*,) по убыванию апостериорных вероятностей
р{1г = V, = у - и / з г - и ) , и , у е А , / = 1,2,... ,
построении для каждого / упорядоченных колонок, состоящих
из таких пар, и попытке чтения (аналогичной изложенной
выше) в колонках сразу двух открытых текстов. При этом
(как и ранее) используются позначные модели рассматриваемых
последовательностей и аналог формулы (9).
§ 6.5. Криптоанализ шифра Виженера
Рассмотрим шифр модульного гаммирования с уравнением
(1), для которого гамма является периодической последовательностью
знаков алфавита. Как указывалось в историческом
экскурсе, такая гамма обычно получалась периодическим
повторением некоторого ключевого слова. Например,
ключевое слово КЕУ дает гамму КЕУКЕУКЕУ... . Рассмотрим
задачу вскрытия такого шифра по тексту одной криптограммы
достаточной длины.
Пусть /и — длина ключевого слова. Обычно криптоанализ
шифра Виженера проводится в два этапа. На первом этапе
143
I лава 6
определяется число //, на втором этапе — само ключевое
слово.
Для определения числа /и применяется так называемый
тест Казискщ названный в честь Ф. Казиски, применившего
его в 1863 г. Тест основан на простом наблюдении того, что
два одинаковых отрезка открытого текста, отстоящих друг от
друга на расстоянии, кратном / / , будут одинаково зашифрованы.
В силу этого в шифртексте ищутся повторения длины,
не меньшей трех, и расстояния между ними. Обратим внимание
на то, что случайно такие одинаковые отрезки могут появиться
в тексте с достаточно малой вероятностью.
Пусть с1Х9с129... — найденные расстояния между повторениями
и (1 — наибольший общий делитель этих чисел. Тогда
// должно делить й . Чем больше повторений имеет текст,
тем более вероятно, что // совпадает с с1. Для уточнения
значения /и можно использовать так называемый индекс совпадения,
введенный в практику У. Фридманом в 1920 г.
Для строки х = (х]9...9хт) длины /я, составленной из
букв алфавита А, индексом совпадения в х , обозначаемым
/ с(х ), будем (следуя [81195]) называть вероятность того, что
две случайно выбранные буквы из х совпадают.
Пусть А = {а, Будем отождествлять буквы алфавита
с числами, так что ах = 0,..., ап_{ =п — 2,а п =п — 1 .
Теорема Индекс совпадения в х вычисляется по формуле
Ц / , ( / , “ О
/ с ( х ) = " 0 - - , (14)
тут - 1)
где / 1 — число вхождений буквы а1 вх, / е .
144
Шифры гаммирования
Доказательство. Будем вычислять / с(х) как отношение
числа благоприятных исходов к общему числу исходов.
Благоприятным является исход, при котором на выбранных
двух позициях в х расположены одинаковые буквы. Общее
число исходов равно, очевидно, . Число благоприятных
исходов есть
т - 1
Е с л - (15)
/=0
В самом деле, переупорядочим буквы в х таким образом,
чтобы сначала шли / а букв а}, затем— / а букв а2 и т.д.:
а}9...9ах ...а п9...9ап . (16)
^ а{ • / ап
Теперь заметим, что при случайном выборе мест (/ и у) в
строке х благоприятными являются следующие исходы:
[0 ... / ... У - т — 1
1 - ау.. ах ..
| ° . .. г у ...,т - 1
1 -■ а2 а2 ...
Го.. . 1 . •У - . т - 1
1 ... а п. ап ...
В случае ( а}) мы можем выбрать пару букв ах из набор*
(16) С г способами, в случае ( а2) пару букв а2 из (16) —
/ о ,
2
С г способами и т. д. Таким образом, общее число благо
/«2
А лава 6
приятных исходов выражается величиной (15), а индекс совпадения
в х — формулой
и, следовательно, формулой (14).
Пусть х — строка осмысленного текста (например, английского).
Допустим, как и ранее, что буквы в х появляются
на любом месте текста с соответствующими вероятностями
/?0, н е з а в и с и м о друг от друга, где р 1 — вероятность
появления буквы / в осмысленном тексте, г^.Ъп. В такой
модели открытого текста вероятность того, что две случайно
выбранные буквы из х совпадают с / € Ъп, равна р] , следовательно,
Взяв за основу значения вероятностей р }, приведенные в
Приложении 1 для открытых текстов на английском языке,
получаем приближение ^25 р 12 « 0 ,0 6 6 . Тем самым для анг-
*=о
лийских текстов х можно пользоваться следующим приближением
для индекса совпадения:
Аналогичные приближения можно получить и для других
языков. Так, для русского языка на основании данных из
Приложения 1 получаем приближение:
т-1
л-1
(17)
1с( х ) * 0,066.
146
Шифры гаммирования
1с(х)*> 0,053.
Приведем значения индексов совпадения для ряда европейских
языков, заимствованные из [РН85]:
Т аб л и ц а 6. Индексы совпадения европейских языков
Язык Русский Англ. Франц. Нем. Итал. Испан.
1с(х) * 0,0529 0,0662 0,0778 0,0762 0,0738 0,0775
Рассуждения, использованные при выводе формулы (17),
остаются, очевидно, справедливыми и в случае, когда х —
результат зашифрования некоторого открытого текста простой
заменой. В этом случае вероятности р г переставляются
Предположим, что х — реализация независимых испытаний
случайной величины, имеющей равномерное распределение
на Ъп . Тогда индекс совпадения вычисляется по формуле
Вернемся к вопросу об определении числа /л .
Пусть у = У\У2—Ут —данный шифртекст. Выпишем его
с периодом / л :
п~ 1
местами, но сумма У /?,2 остается неизменной.
1 = 0
Й 1 1 1
У/
Ун I
У2ц 1
У2
УН'2
У2(1 2
Ун
У2н
Узн
147
/ лава 6
и обозначим столбцы получившейся таблицы через У^,...,У^ .
Если /л — это истинная длина ключевого слова, то каждый
столбец У^9г е 1,//, представляет собой участок открытого
текста, зашифрованный простой заменой, определяемой подстановкой
ГО 1 2 ... п - 8 ... п }
^ я + 1 8 + 2 ... О ... 8 - \ ) (18)
для некоторого 8 е 0 , п - 1 (числа берутся по модулю п).
В силу сказанного выше (для английского языка)
1С (У^ ) « 0,066 при любом /. С другой стороны, если /л отлично
от длины ключевого слова, то столбцы У^ будут более
“случайными”, поскольку они являются результатом зашифрования
фрагментов открытого текста некоторым многоалфавитным
шифром. Тогда 1С(У^) будет ближе (для английского
языка) к числу ^ ж 0,038 .
26
Заметная разница значений 1с(х) для осмысленных открытых
текстов и случайных последовательностей букв (для
английского языка — 0,066 и 0,038, для русского языка —
0,053 и 0,030) позволяет в большинстве случаев установить
точное значение / л .
Предположим, что на первом этапе мы нашли длину
ключевого слова /и . Рассмотрим теперь вопрос о нахождении
самого ключевого слова. Для его нахождения можно использовать
так называемый взаимный индекс совпадения.
148
Шифры гаммирования
Пусть х = (х1,...,хт), у = ( у },...,ут./ — две строки
букв алфавита А . Взаимным индексом совпадения в х и у ,
обозначаемым М1с( х , у ) , называется вероятность того, что
случайно выбранная буква из х совпадает со случайно выбранной
буквой из у .
Пусть И / о ' , — числа вхождений
букв алфавита в х и у соответственно.
Следующее утверждение доказывается точно так же, как
и предыдущая теорема.
Теорема. Взаимный индекс совпадения в х и у вычисляется
по формуле
п-1
Е / , V ,
Шс<х,у) = '-° . (19)
т • т
Пусть к = ( к 19...,к ) — истинное ключевое слово.
Попытаемся оценить индексы М1С (У /, ).
Для этого напомним, что Г / является результатом зашифрования
фрагмента открытого текста простой заменой,
определяемой подстановкой (18) при некотором я . Вероятность
того, что в и произвольная пара букв равна О,
имеет, очевидно, вид р п_^ - р п_8 (где р а — вероятность появления
буквы а в открытом тексте); вероятность того, что
обе буквы есть 1, равна р п_% +1 • р п_% +1, и так далее. На основании
этого получаем:
А=0 А=0
149
I лава ь
Заметим, что сумма в правой части последнего равенства
зависит только от разности - 5 у)шо<\п , которую назовем
относительным сдвигом У/ и У^ . Заметим также, что
п- 1 п- 1
^ /* У ’ /*(у+.у)тос1« ~ * /*(У~.у)то<1и 9 (20)
у=0 у=0
поэтому У/ и У^ с относительными сдвигами д1 и п — з
имеют одинаковые взаимные индексы совпадения. Приведем
таблицу значений сумм (20) для английского языка (см.
[8695]):
Т а б л и ц а 7. Взаимный индекс совпадения при сдвиге з
Сдвиг 5 0 1 2 3 4 5 6
М1с(х, у) » 0,066 0,039 0,032 0,034 0,044 0,033 0,036
7 8 9 10 11 12 13
0,039 0,034 0,034 0,038 0,045 0,039 0,043
Аналогичные таблицы можно получить и для других
языков.
Обратим внимание на то, что ненулевые “сдвиги” дают
взаимные индексы совпадения, изменяющиеся в пределах от
0,032 до 0,045, в то время как при нулевом сдвиге индекс
М1с(х,у) близок к 0,066. Это наблюдение позволяет определить
величины относительных сдвигов — з^; столбцов У/ и
У ^ . Для этого заметим, что при некотором значении
»у(/,у) е 0, и - 1 столбец У ^ 1^ , полученный из У^ прибав150
Шифры гаммирования
лением к каждому его элементу числа ^(/,7*) (по модулю п ),
то взаимный индекс совпадения должен быть (для английско-
У* равен нулю. Если же я Ф ^ , то взаимный индекс
совпадения должен колебаться в пределах 0,032 4- 0,045.
Используя изложенный метод, мы сможем связать системой
уравнений относительные сдвиги различных пар столб-
чевого слова, из которых можно выбрать наиболее предпочтительный
вариант (если ключевое слово является осмысленным).
Следует отметить, что предложенный метод будет эффективным
для не слишком больших значений / / . Это объ-
имеет нулевой относительный сдвиг с У/ .
Пусть У® 9У* 1 — результаты зашифрования
У^ каждой из простых замен (18). Несложно вычислить взаимные
индексы
м ц г ^ г ; 1), 0 < 5 < п - 1 , ! < / < / < / /
(всего, таким образом, имеется С'2 • п значений). Для этого
воспользуемся формулой, полученной из (19):
п- 1
Если я равно ^ (относительному сдвигу У^ и У ^ \
го языка) близок к 0,066, так как относительный сдвиг У/ и
„Л
цов У^ и У^ . В результате останется 26 вариантов для клю-
151
/ лава 6
ясняется тем, что для хороших приближений индексов совпадения
требуются тексты достаточно большой длины.
§ 6.6. Ошибки шифровальщика
Предположим, что при шифровании текста Т = /^2.../,
модульной гаммой Г — у ху 2 —/1 произошел сбой и был пропущен
(или повторен) некоторый т-значный отрезок гаммы
(или открытого текста) УкУк+\—Ук+т-\ (соответственно
1к*к+\—*к+т-\)- Э™ могло произойти, например, в случае, когда
шифровальщика, производящего работу вручную, вдруг
что-то отвлекло, и он допустил ошибку. При расшифровании
получатель не сможет полностью восстановить открытый
текст. Предположим, что он запросил отправителя повторно
передать сообщение, и тот вновь зашифровал тот же текст
той же гаммой, но уже без ошибок. Проанализируем последствия
таких действий с позиций противника, ведущего перехват.
Рассмотрим случай, когда в результате сбоя оказывается
пропущенным отрезок открытого текста. Тогда криптоаналитик
противника будет иметь два шифрованных текста:
^1 = ( 1 + У\’—>*к-\ + Ук-1 ’ *к+т + У к ’- ’ (1 + У1-т>
8 2 =(\ + У1 + У к - ] ’ *к + У к ’—>*1 +У1-
Теперь можно выделить следующие два фрагмента в 51,
и 82:
= *к+т + У к ’ " - ’ *1-т + У 1-2т’
^ 2 ^к+т Ук+т У 1-т'
(22)
152
Шифры гаммирования
Распишем отрезки открытых текстов в виде последовательности
т-г рамм:
Т ~ 0 к ’ " "> ^к+т -\ )’ к+т к+2т -\ )’**• ? V------------------у-------------------- ' -4------------------------у ---------------------/
Т ~~ ^ -V-к---+---т---- -->--'-”--^^-к---+----2--т-------\-- -)/>••• •
Так же распишем отрезок гаммы:
^ ~ (У к 9***9 У к+т-1 (У к+т ’•**> Ук+2т-\ *
4----------------у----------------- ' 4------------------- у ------------------- '
Го У\
Тогда соответствующие отрезки 5, и 82 можно представить
в виде суммы т-грамм:
*^1 ~*\ +У09*2 +У\’-"> ^23^
$2 +У\>*2 У 2 ’**•’
где векторы складываются покоординатно по модулю п.
Теперь можно выразить разность 82 — 8Х:
& = $2 “ ^1 = У 1 Уо> У 2 ~ У \ > — • (2 4 )
Пусть 5 = ^ ,$ 2,.... Тогда с помощью (24) образуем последовательность
<5* — •1")5,29»У| “Ь‘5'2 ,
I
которая, в силу очевидного равенства ^ Ии = / , —у0, имеет
и=1
ВИД
8 = Г о ~ Г о>Г1 ~ Г 0 ’Г 2 - Г о— • (2 5 >
153
I лава Ь
Наконец, находим разность 8 Х = 5) - 5 , которая, с учетом
(25), имеет вид
5 , = 7\ + У о,12 + Уо><з + Уо> - • (26 )
Последовательность (26) представляет собой результат
зашифрования отрезка открытого текста Тх =^+т^А:+т+1 >•••
периодической гаммой
^1 ~~ У к ->Ук+\ >-">Ук+т-\>Ук > У к+ \’‘” > У к+т -\>—
Тем самым мы свели задачу к вскрытию шифра Виженера,
решение которой нам уже известно. Поэтому подобная
ошибка шифровальщика является недопустимой. Заметим,
что при этом число пропущенных знаков т скорее всего не
может быть слишком большим.
Нетрудно убедиться в том, что и три другие ошибки (в
комбинации: пропуск/повтор отрезка гаммы/открытого текста)
также приводят к задаче вскрытия шифра Виженера.
Кроме того, легко установить характер такой ошибки непосредственно
по текстам двух имеющихся в распоряжении
криптоаналитика шифртекстов.
Контрольные вопросы
1. В чем слабость шифра гаммирования с неравновероятной
гаммой?
2. Является ли надежным шифрование литературного текста
с помощью модульного гаммирования, использующего
гамму, два знака которой имеют суммарную вероятность,
совпадающую с суммарной вероятностью остальных знаков?
Почему?
3. Почему наложение на открытый текст гаммы, представляющей
собой периодическую последовательность небольшого
периода, не дает надежной защиты?
154
Шифры гаммирования
4. Почему недопустимо использовать дважды одну и ту же
гамму (даже случайную и равновероятную!) для зашифрования
разных открытых текстов?
5. Почему в качестве гаммы нецелесообразно использовать
текст художественного произведения? Можете ли Вы
предложить метод вскрытия такого шифра?
6. Можно ли по шифртексту получить приближения для
вероятностей знаков гаммы?
7. В чем состоит тест Казисии?
8. Назовите основные этапы работы по вскрытию шифра
Виженера.
9. Каким образом рассчитывается индекс совпадения для
реального языка?
10. Из каких простых замен «состоит» шифр гаммирования
(как многоалфавитный шифр)?
155
Глава 7
Надежность шифров
§ 7.1. Энтропия и избыточность языка
Рассмотренные нами модели отражают лишь поверхностные
свойства открытых текстов. Более глубокие свойства текстов
изучаются методами теории информации, разработанной
К. Шенноном. Речь идет о “количестве информации”, содержащейся
в сообщении. Для выяснения этого необходимо ввести
разумную меру количества информации.
Проследим за рассуждениями К. Шеннона по этому поводу.
Они связаны с понятием энтропии, определяемой функцией
от вероятностного распределения и характеризующей количество
неопределенности или информации в случайном
эксперименте. К. Шеннон предложил признать формулу
прирост информации = устраненной неопределенности,
на основании которой неопределенность и информация должны
измеряться одной и той же мерой.
К такому выводу можно прийти на примере эксперимента
со случайным бросанием монеты. Какова неопределенность
того, что в результате очередного бросания монеты выпадет
“орел”? Если монета дефектна и при бросании всегда выпадает
орлом, никакой неопределенности нет — наоборот, есть
полная определенность: обязательно выпадет орел. Максимальной
же неопределенность будет, очевидно, в случае, когда
монета не имеет дефектов, т. е. с равными вероятностями
выпадают обе ее стороны.
Результат бросания монеты можно трактовать иначе. Если
монета всегда выпадает орлом, то при проведении очередного
эксперимента мы не получим никакой информации: мы
156
Надежность шифров
заранее знали об исходе эксперимента. Другими словами, количество
информации, извлекаемой из эксперимента, равно
нулю. Максимальным количество получаемой информации
будет, очевидно, в случае когда «орел» и «решка» равновероятны.
П
ример количественной меры неопределенности случайного
эксперимента дает теоретическая физика — такой мерой
служит энтропия. Применительно к независимым испытаниям
случайной величины % с распределением вероятностей
Единицу измерения энтропии вероятностной схемы предлагает
так называемая теорема кодирования [Ягл73], утверждающая,
что любой исход можно закодировать символами
О и 1 так, что полученная длина кодового слова будет сколь
угодно близка сверху к Н{%) . На основании этого единицей
количества информации естественно считать 1 бит. Например,
количество информации, получаемое при бросании монеты,
равно 1 бит, так как орел можно закодировать единицей,
а решку — нулем.
Легко видеть, что если р ^ Х / п при всех / = 1,л, то
Н 0 = = 1о§2 п . Кроме того, в общем случае имеет место
неравенство Н ( > О, причем Н ( = 0 в том и только в
том случае, когда р ( = 1 для некоторого / и р ] = 0 для всех
4 = (1)
энтропия Н( ^ ) определяется формулой
п
(2)
У* * -
157
[ лава 7
Мерой среднего количества информации, приходящейся
на одну букву открытого текста языка Л (рассматриваемого
как источник случайных текстов), служит величина Н А, называемая
энтропией языка Л . Естественно вычислять ее последовательными
приближениями: Н 0, Н х, где Н х — энтропия
позначной модели открытого текста, то есть величина
(2), в которой р 1 совпадает с вероятностью появления буквы
а1 в открытом тексте. Для английского языка, Н 0 » 4,70,
Н х = Н ( ^ ) «4,14. В качестве следующего, более точного
приближения, энтропия вероятностного распределения биграмм,
деленная на 2 (нас интересует энтропия на знак). В
общем случае следует взять энтропию вероятностной схемы
на г-граммах, деленную на г. Соответствующие вычисления
для английского языка дают отношения -Н---2- «3,5 6 ,
2
ц
® 3,30, и так далее. Исследования показывают, что с рос-
Нг
том г отношение —- стремится к некоторому пределу. Этот
г
предел и принимается за определение энтропии Н А языка
Л 5:
Я Л = Н ш ^ . (3)
Г—>00 у»
При этом формула
5 Существование предела (3) строго доказывается для стационарных эр-
годических источников сообщений.
158
надежность шифров
1о§2 п
(4)
определяет избыточность языка КА .
Термин “избыточность языка” возник в связи с тем, что
максимальная информация, которую в принципе могла бы
нести каждая буква сообщения, равна Н 0 = 1о§0 п (где п —
число букв в алфавите). Как было отмечено выше, так было
бы в случае, если буквы сообщения появлялись случайно и
равновероятно. В то же время средняя энтропия буквы в открытом
тексте значительно меньше и, следовательно, буква
несет меньше информации, чем 1о§^ п . Величина
1о§а п - Н х характеризует, таким образом, неиспользованные
возможности в передаче информации с помощью текста, а
отношение
в некотором смысле показывает, какую часть букв открытого
текста можно опустить без потери содержания. Имеется в виду,
что потерянная информация будет восстановлена другими
буквами сообщения вследствие закономерностей языка.
К. Шеннон предложил оригинальный метод оценивания
отношения Н г/ г для осмысленных текстов с позиции меры
неопределенности опыта, состоящего в угадывании г-й буквы
текста, при условии, что предшествующие его буквы известны
[Ягл73]. Эксперимент по угадыванию г-й буквы текста
легко может быть поставлен. Для этого достаточно выбрать
осмысленный отрезок открытого текста длины г — 1 и предложить
кому-либо угадать следующую букву. Подобный опыт
может быть повторен многократно, при этом сложность угадывания
г -й буквы может быть оценена с помощью среднего
\оёап - Н к ^
1о§2 п 1о§2 п
159
/ лава /
значения числа попыток Рг9 требующихся для нахождения
правильного ответа. Ясно, что величины Рг для разных значений
г являются определенными характеристиками статистической
структуры языка. Очевидно, что среднее число попыток
Рг с ростом г может лишь уменьшаться. Прекращение
этого уменьшения будет свидетельствовать о том, что соответствующие
опыты имеют одинаковую неопределенность, то
есть что отвечающая им величина Н г/ г практически уже
достигла своего предельного значения Н А .
Исходя из этих рассуждений, К. Шеннон произвел ряд
подобных экспериментов, в которых г принимало значения
1,15 и 100. При этом он обнаружил, что отгадывание сотой
буквы по 99 предшествующим заметно более просто, чем угадывание
15-й буквы по 14 предыдущим. Опыты показали, что
с ростом г величина Н г/ г убывает вплоть до г « 3 0 , а при
дальнейшем росте г она уже практически не меняется.
Согласно исследованиям Б. Б. Пиотровского [Ягл73],
имеют место следующие приближения величины Н л :
Т аб л и ц а 8
Яд
(бит/букву) (в процентах)
Русский
язык
Франц.
язык
Русский
язык
Франц.
язык
Язык в целом 1,37 1,40 72,6 70,6
Разговорная
речь
1,40 1,50 72,0 68,4
Литературный
текст
1,19 1,38 76,2 71,0
Деловой текст 0,83 1,22 83,4 74,4
160
Надежность шифров
Из приведенной таблицы видно, что языки имеют весьма
большую избыточность. Что означает, например, избыточность,
составляющая 75%? Это не означает буквально то, что
любые 3 из 4 букв текста можно вычеркнуть без потери информации.
Более точно это означает, что при оптимальном
кодировании текста (при использовании, например, кода
Хаффмена, кода Фано или другого оптимального кода
[ШенбЗ]) его можно сжать до четверти длины без потери информации.
Сделаем замечание о другом возможном подходе к определению
величины Я Л для литературных текстов.
А. Н. Колмогоров, не согласившись с тем, что теоретикоинформационные
рассмотрения игнорируют вопрос о смысловом
содержании литературных текстов, предложил так
называемый комбинаторный подход [Ягл73]. Суть такого
подхода к определению энтропии текста состоит в следующем.
Шенноновскую энтропию Я л , приходящуюся на букву
текста, можно определить тем условием, что для п -
буквенного алфавита число текстов длины Ь , удовлетворяющих
заданным статистическим ограничениям, равно (при достаточно
больших Ь ) не п 1 = 2 71оё2" = 2 7' я° , как это было бы,
если мы имели бы право брать любые наборы из Ь букв, а
всего лишь
М(Ь) = 2 а'" а . (5)
По сути, это и есть асимптотика числа осмысленных открытых
текстов длины Ь для данного языка Л . Исходя из
этого, можно определить энтропию Я Л языка формулой
Я д =1!т(-!-1о8 гМ(А)
'— и )
161
Iлава 7
не зависящей ни от каких теоретико-вероятностных представлений.
Величину М(Ь) можно оценивать с помощью подсчета
числа возможных продолжений литературного текста.
§ 7.2. Расстояние единственности
Попытки определения истинного ключа шифра по данной
криптограмме путем ее расшифрования на всех возможных
ключах могут привести к тому, что критерий на открытый
текст примет несколько претендентов за открытый текст. Это
объясняется не только недостатками критерия. При небольших
длинах криптограмм результат ее расшифрования может
дать несколько осмысленных текстов. Например, криптограмму
М^А.1\У, полученную при использовании сдвигового
шифра (см. гл. 5) для английского языка, порождают два открытых
текста МУЕК и АКЕКА, отвечающих ключам Р (=5)
и ^ (=22). При этом один из ключей является истинным, а
другой — ложным. Аналогичная ситуация может иметь место
для любого другого шифра.
Найдем оценку для числа ложных ключей. Для этого рассмотрим
связь между энтропиями вероятностных распределений
Р(Х) , Р(К), Р(У) , заданных на компонентах Х ,К ,У
произвольного шифра Хв (см. гл. 2). Нам понадобятся некоторые
дополнительные сведения об условной энтропии двух
вероятностных распределений.
Пусть имеются дискретные случайные величины % и /7,
заданные вероятностными распределениями Р(^ )9 Р(?]) . Для
них можно вычислить совместное распределение Р(<!;,Г)) и
условные распределения Р(%/у), Р(г//х) для любых фиксированных
значений х е у е /7.
Определим условную энтропию Н{%/у) формулой
162
Надежность шифров
НЦ; / у) = р(х/У) • 1о§2 р (х/ у ) .
Усредненная (по всем у ^Т ] ) величина Н{<^/у) называется
условной энтропией двух вероятностных распределений:
1р) = -'5УЦр(У)-р(х/у) • 1о82 р(х/у) • (6)
У*п
(При этом в (6) по определению полагаем \о%2Р{х/у) = 0, если
Р(х /у ) = 0.)
Величина (6) измеряет среднее количество информации о
обнаруживаемое с помощью г/. Известно (см. [ШенбЗ]),
что имеет место неравенство < Н (<%) , причем равенство
= Н( ^ ) выполняется тогда и только тогда, когда
<^,77 — независимые случайные величины.
Назовем условную энтропию Н(К/У) неопределенностью
шифра Xв по ключу. Она измеряет среднее количество
информации о ключе, которую дает шифртекст. Аналогично
вводится неопеределенностъ шифра по открытому тексту
Н (Х /У ) . Эти величины являются мерой теоретической
стойкости шифра. В этом можно убедиться на основании следующих
рассуждений.
Минимально возможным значением неопределенности
шифра по открытому тексту Н(Х/У) является 0. Что можно
сказать о шифре в этом случае? Ясно, что равенство
Н(Х/У) = 0 выполняется лишь тогда, когда каждое слагаемое
в выражении для Н(Х/У) равно нулю:
Р(У) ■ Р(х/у) • 1о§2 р ( х /у ) = 0
для всех х , у . Согласно принятой договоренности это возможно
лишь в случаях, когда (1о§2р(х/у) = 0 или когда
163
( лава 7
1°§ 2 Р(х/ у ) = 0 5 то есть если р ( х / у ) = 1 при некоторых
х, >>. Это означает, что по данному у можно получить существенную
информацию о х , что свидетельствует о слабости
шифра. Чем больше Н (Х /У ) , тем меньше информации получает
противник об открытом тексте по криптограмме. Идеальной
является ситуация, когда Н(Х/У) = Н ( Х ) . Именно в
этом случае шифр можно было бы назвать идеальным или совершенным.
Заметим, что (в силу сделанного выше замечания)
такое представление полностью соответствует определению
совершенного по К. Шеннону шифра (см. § 7.3).
Связь между энтропиями компонент шифра дает известная
[ШенбЗ] формула для неопределенности шифра по ключу:
ЩК/У) = Щ Х ) + ЩК ) - Н(Г ) , (7)
полученная К. Шенноном. Эта формула позволит нам получить
оценку среднего числа ложных ключей.
Рассмотрим произвольный поточный шифр замены,
для которого множество X открытых текстов представляет
собой множество возможных осмысленных текстов в данном
алфавите А (например, русском, английском или некотором
другом), состоящим из п букв. Зафиксируем некоторое число
Ь е N и будем интересоваться числом ложных ключей, отвечающих
данной криптограмме у е А1 . Предполагается, что
А служит также алфавитом шифрованного текста. Введем
обозначение
К(у ) = { к е К : З х е Х , Ек (х) = у}.
Х ( у ) есть множество ключей, для каждого из которых у
является результатом зашифрования некоторого осмысленного
открытого текста длины Ь .
Если мы располагаем криптограммой у , то число ложных
ключей равно |А’(<у)| — 1 , так как лишь один из допусти-
164
Надежность шифров
мых ключей является истинным. Определим среднее число
ложных ключей к / (относительно всех возможных шифртек-
стов длины Ь ) формулой,
|-о.
которая легко приводится к виду
К1 = У р (у)-\К (У)\~1- (*)
уеУ
Теорема .Для любого рассматриваемого шифра с равновероятными
ключами при достаточно больших значениях
Ь имеет место неравенство
\к \ <9»
где КА — избыточность данного языка.
Доказательство. Согласно формулам (3) и (4), а также условию
X при достаточно большом Ь получаем:
Н{Х) = Н 1 * 1 - Я Л = 1 -(1 -Д л )-к> Е 2и. (10)
Так как У с; А1', то
Н (У ) < 1о§ 2\у \ < 1о§ 2\а 1 | = 1о%2 п 1 = I • 1о§2 п .
Отсюда, а также из формулы (7) для неопределенности
шифра по ключу и формулы ( 10), получаем:
Н(К/У) = Н ( Х ) + Н(К) - Н(У) *
* Н(К) + Ь • (1 - КА) • 1оё2 п - Н(У) >
> Н(К) + 1 • (1 - 7?Л)• 1о§2 п - Ь - 1о§2 п =
= Н(К) - 7,• 7?Л • 1о§2 п ■ (П)
165
[ лава 7
Найдем соотношение между неопределенностью шифра
по ключу и числом ложных ключей. Из определения условной
энтропии и равенства (8) получаем:
Н (К /У ) = ^ р ( у ) ■ Щ К / у ) < ^ р ( у ) ■ 1оё21*(>0| <
уеУ уеУ
Г \
- 1°ё: Х р СуН ^ О ) ! = 1о§2 (лг^ + 1).
Мы воспользовались известным неравенством Иенсена
[Бил69] применительно к функции действительного переменного
/ ( х ) = 1о§2 х .
Так называют следующее утверждение. Если ^(1) — заданная
на отрезке (а,в) вогнутая (то есть выпуклая вверх)
функция действительного переменного, то при любых значе-
ш
I,, (т е (а,в) и любыхр,, . . . ,рт > 0, ] Г /?7 = 1 ,
;=1
т / т
полняется неравенство
ниях (I, 1т 6 любых Ри Рт ^ О/ ^ Р ' ~ *' ВЬ|‘
;=1
Г \
■ Для
;=1 ^ '=1 У
выпуклых (вниз) функций знак неравенства — противоположный.
Таким образом, получаем неравенство
ЩК /У )< \о ё 2 ( к ,+ 1 ) , ( 12)
которое имеет место при достаточно большом Ь . Из (И) и
( 12) следует, что
1о§ 2(к ь + 1) ^ н (к ) ~ 1 К \ - 1оВ2 п ■
Условие равновероятности ключей шифра максимизирует
энтропию Н(К) . Это дает нам неравенство
166
НаОежность шифров
1о82 +1)>1о§2| ^ |-1-/гл -1оЕ2 п,
потенцируя которое получаем искомое неравенство (9).
Назовем расстоянием единственности для шифра натуральное
число (обозначим его Ь0 ), для которого ожидаемое
число ложных ключей к*Л равно нулю. По сути, расстояние
единственности есть средняя длина шифртекста, необходимая
для однозначного восстановления истинного ключа (без каких-
либо ограничений на время его нахождения).
Для получения оценки расстояния единственности для
поточного шифра с равновероятными ключами воспользуемся
неравенством (9). Непосредственно из этого неравенства следует,
что
Минимально возможное значение Ь в этом неравенстве и
принимается за Ь0. Таким образом
Несмотря на некоторую некорректность вывода формулы
(13), эта формула тем не менее хорошо согласуется с практикой,
и поэтому ею пользуются. Например, для шифра простой
замены с параметрами п - 26, |А| = 26!, Яа = 0,5 формула
(13) дает оценку
К1 + 1
откуда при к 1 = 0 получаем | АГ| < п 1 Пк и, следовательно,
КА -1о§2 л
167
I лава 7
88,4
0,5-4,7
= 38.
Это значит, что для английского языка в среднем по
криптограмме длиной около 40 можно однозначно определить
открытый текст, что приблизительно соответствует практическому
опыту.
Замечания
1. Следует иметь в виду, что при попытке вскрыть, например,
шифр простой замены с использованием только частот
букв целесообразно оценивать расстояние единственности с
учетом оценки энтропии Н А величиной Н х, вычисленной
для позначной модели открытого текста. При этом оценка
для расстояния единственности может существенно вырасти.
При использовании частот биграмм целесообразно Н А
приблизить величиной Н 2 и так далее.
2. В наших выводах о числе ложных ключей и расстоянии
единственности для поточного шифра предполагалось,
что число ключей \к\ рассматриваемого шифра является
постоянным. Тем самым из рассмотрения выпадают, например,
шифры гаммирования со случайной гаммой. Для
них число ключей растет вместе с ростом длины открытого
текста и тем самым может потенциально вырасти до
бесконечности. Подобные шифры обычно называют случайными
в отличие от программных шифров, для которых
число ключей фиксировано и не зависит от длины открытого
текста. Таким образом, наши выводы справедливы
лишь для программных шифров. Для случайных шифров
расстояние единственности потенциально может быть
равно + оо . Такие шифры имеют название идеальных.
3. Формулу расстояния единственности можно применять и
для блочных шифров. В этом случае шифр можно рас168
Надежность шифров
сматривать как поточный, но в большом алфавите. Естественно,
что при этом следует использовать избыточность
языка, подсчитанную для «-грамм, где п — длина блока
К а
(грубым приближением для нее служит отношение ).
П
§ 7.3. Стойкость шифров
Надежность или стойкость шифров определяется объемом
работы криптоаналитика, необходимой для их вскрытия.
Шифрсистема может служить объектом нападения противника,
располагающего разного уровня интеллектуальным и вычислительным
потенциалом. Нападающий может быть оди-
ночкой-хакером, имеющим персональный компьютер. Задача
криптоанализа может интересовать некую фирму, обладающую
солидным персоналом и оборудованием. Наконец, речь
может идти о работе по добыванию информации мощной государственной
организацией типа АНБ США. Возможности
потенциального противника определяют требования, предъявляемые
к надежности шифрования.
Исходная информация и цели криптоаналитика могут
быть разными. Несомненно, основная цель состоит в получении
конфиденциальной информации. Целью нападения может
служить также примененный секретный ключ, с помощью
которого криптоаналитик может вскрывать другие криптограммы.
Шифрсистема может быть надежно защищенной от
одних угроз и быть уязвимой по отношению к другим. Попытки
противника по добыванию зашифрованной информации
называют криптоатаками.
В криптографии с секретным ключом обычно рассматривают
следующие криптоатаки.
Атака на основе шифртекста: криптоаналитик располагает
шифртекстами у х = Ек{ ( х , у т = Ект (хт ) , отвечаю-
169
\лава 1
щими неизвестным открытым текстам различных сообщений.
Требуется определить хотя бы одно из сообщений
х19г = 19т9 (или соответствующий ключ исходя из
необходимого числа т криптограмм, или убедиться в
своей неспособности сделать это. В качестве частных случаев
возможно совпадение ключей: кх =... = кт или совпадение
открытых текстов: х х = ... = хт .
Атака на основе известного открытого текста: криптоаналитик
располагает парами (хХ9у х)9...9(хт9у ) открытых и
отвечающих им шифрованных текстов. Требуется определить
ключ кг для хотя бы одной из пар. В частном случае,
когда кх - ... = кт , требуется определить ключ к или,
убедившись в своей неспособности сделать это, определить
открытый текст хт+х еще одной криптограммы
у т+х = Ек (хт+1) , зашифрованный на том же ключе.
Атака на основе выбранного открытого текста: эта атака
отличается от предыдущей лишь тем, что криптоаналитик
имеет возможность выбора открытых текстов хХ9...9хт.
Цель атаки та же, что и предыдущей. Подобная атака
возможна, например, в случае, когда криптоаналитик имеет
доступ к шифратору передающей стороны, или в системах
опознавания “свой-чужой”.
Атака на основе выбранного шифртекста: эта атака отличается
от второй атаки лишь тем, что криптоаналитик имеет
возможность выбора шифртекстов у Х9...9у т . Цель атаки
та же, что и во втором случае. Подобная атака возможна,
например, в случае, когда криптоаналитик имеет доступ к
шифратору принимающей стороны.
Атаки на основе выбранных текстов считаются наиболее
опасными. Иногда к указанным атакам добавляют и другие.
170
Надежность шифров
Шифр, выдерживающий все возможные атаки, можно признать
хорошим или надежным.
Различие в действенности различных криптоатак можно
прокомментировать на примере шифра простой замены. Хотя
этот шифр легко вскрываем даже при использовании атаки на
основе шифртекста, это все-таки требует некоторых усилий.
При проведении атаки на основе известного открытого текста
задача становится вовсе тривиальной, как только в доступных
открытых текстах встретятся все буквы алфавита. Наконец,
при атаке на основе выбранного открытого текста ничего не
нужно ждать, так как ключ автоматически получается при зашифровании
всех букв алфавита.
При проведении любой криптоатаки обычно пользуются
общепринятым в криптографии правилом Керкгоффса. В книге
“Военная криптография”, изданной в 1883 г., он сформулировал
шесть следующих требований к системам шифрования:
1 ) система должна быть нераскрываемой, если не теоретически,
то практически;
2) компрометация системы не должна причинять неудобств
ее пользователям;
3) секретный ключ должен быть легко запоминаемым
без каких-либо записей;
4) криптограмма должна быть представлена в такой
форме, чтобы ее можно было передать по телеграфу;
5) аппаратура шифрования должна быть портативной и
такой, чтобы ее мог обслуживать один человек;
6) система должна быть простой. Она не должна требовать
ни запоминания длинного перечня правил, ни большого
умственного напряжения.
Второе из этих правил и стало называться правилом
Керкгоффса. Суть его состоит в том, что при проведении
криптоанализа можно считать известной систему шифрования.
Стойкость (или надежность) шифрования должна определяться
лишь секретностью ключа шифрования.
171
Глава 7
Признание всеми этого принципа в криптографии связано
с тем, что “шила в мешке не утаишь”. Рано или поздно те или
иные сведения об используемой шифрсистеме становятся известными.
В военных условиях могут быть захвачены узлы
связи с шифртехникой. Могут потерпеть аварию и попасть в
руки противника самолет или судно, оборудованные шифр-
средствами. Нельзя исключать предательства шифровальщика
и т. п.
Тем не менее шифры, используемые специальными службами,
всемерно охраняются, Это обусловлено необходимостью
дополнительного запаса прочности, поскольку до сих
пор создание шифров с доказуемой стойкостью является
очень сложной проблемой.
Обоснование надежности шифрсистем осуществляется,
как правило, экспериментально при моделировании криптоатак
с привлечением группы высококвалифицированных специалистов,
которым предоставляются благоприятные условия
для работы и необходимая техника. На государственном
уровне гарантию надежности криптографической защиты дают
уполномоченные для этой цели организации. В России такой
организацией является ФАПСИ. Любые средства шифрования,
используемые государственными организациями,
должны иметь сертификат ФАПСИ.
Рассмотрение вопросов надежности шифрования невозможно
без введения качественной и количественной мер. В
криптографии рассматривают два подхода к стойкости —
теоретическую стойкость и практическую (или вычислительную)
стойкость.
Теоретическая стойкость шифров
При рассмотрении вопроса о теоретической стойкости
шифров отвлекаются от реальных временных и сложностных
затрат по вскрытию шифра (что определяет подход к практической
стойкости). Во главу угла ставится принципиальная
172
Надежность шифров
возможность получения некоторой информации об открытом
тексте или использованном ключе. Впервые такой подход исследовал
К. Шеннон [ШенбЗ]. Он рассматривал уже знакомую
нам модель шифра и единственную криптоатаку на основе
шифртекста. Проследим за его рассуждениями.
Как мы указывали, конечной целью работы криптоаналитика
является текст сообщения или ключ шифрования. Однако
весьма полезной может быть даже некоторая вероятностная
информация об открытом тексте. Например, уже предположение
о том, что открытый текст написан по-английски,
предоставляет криптоаналитику определенную априорную
информацию об этом сообщении даже до того, как он увидит
шифртекст. Так, например, он заранее знает, что слово “Ье11о”
является более вероятным началом сообщения, чем, скажем,
набор букв “аЬсс!е”. Поэтому первая цель криптоанализа состоит
в том, чтобы увеличить количество этой априорной информации,
относящейся к каждому возможному открытому
тексту таким образом, чтобы истинный открытый текст сделать
более вероятным после получения шифртекста, хотя, конечно,
и не обязательно точным.
Пусть, например, криптоаналитик перехватил текст
“аЪсссГ и знает (или предполагает), что он был зашифрован
при помощи шифра простой замены. Этот шифртекст говорит
ему о том, что открытый текст состоит из пяти букв, третья и
четвертая из которых являются одинаковыми, а остальные
отличными от этой буквы и разными. Хотя он не может быть
уверенным, что этим словом является и‘Ье11о” (это может быть
еще “1е8зу” или что-то подобное), тем не менее апостериорные
вероятности таких открытых текстов возрастают относительно
их априорных вероятностей. Криптоаналитик, кроме
того, полностью уверен (в предположении, что использовалась
именно простая замена) в том, что этот открытый текст
не может быть ни словом “айег”, ни словом “са!сЬ”, и, таким
образом, апостериорная вероятность обоих этих открытых
173
( лава 7
текстов сокращается до нуля, даже вне зависимости от их априорных
вероятностей.
Шеннон назвал шифр совершенным, если для любого открытого
текста знания, которые могут быть получены из соответствующего
ему шифртекста, не раскрывают никакой информации
об открытом тексте, за исключением, возможно,
его длины. Другими словами, для совершенных шифров апостериорные
вероятности открытых текстов (вычисленные после
получения криптограммы) совпадают с их априорными
вероятностями.
Вспомним о введенной нами модели шифра Xв , в которой
фигурировали распределения вероятностей Р{Х), Р(К) .
Они как раз и являются наборами априорных вероятностей
Р х (*),х е X и р к (к), к е К. Будем предполагать, что
Рх (* )> Рк (к) > 0 для любых х е X, к е К .
Далее мы будем рассматривать лишь такие шифры, для
которых выбор ключа и выбор открытого текста являются
независимыми событиями. Это равносильно тому, что распределения
Р ( Х \ Р(К) являются независимыми. Эти распределения
естественным образом индуцируют распределение
вероятностей Р(У) = {ру(у),У е У} на множестве возможных
шифртекстов по формуле
Рг(У)= X Рх ( х ) 'Р к (к )• О4)
(*,*)
Ьк(х)=У
Поясним корректность такого определения. Нужно проверить,
что
5 ] р у (у) = 1•
уеУ
174
Наоежность шифров
Рассмотрим отображение / : X х К -» У , определенное
условием / | = Ек для любого к е К . Тогда, поскольку
/ - \ У ) = Х х К ,
получаем:
У,Ру(у) = Т, Е РХ(Х) 'Рк(к) =
уеУ уеУ (х,к)
Ек(х)=у
=Е Е Рх(х) - р А к)= Е Рх(х) 'РЛк)=
уеУ (х,к)е/(~\ (х,к)еХхК
=Е Е (*) • ^ (*)=Е **(*)• Е Рк ( * )= 1 •
Естественным образом вводятся и условные вероятности
Ру/х ( у / х )> Ру/к (У/к) 9 определяемые формулами:
Р у/х (у/ х )= Е р И * ) , (15)
кеК:
Ек (х)=у
Р у / к ( у / к ) = Е / * ( * )• ( 16>
д:еХ:
Ек(х)=у
Несложно проверить, что формулы (15) и (16) задают вероятностные
распределения, то есть что при любом х е Х
^ Р у/х (у / х ) = 1>
уеУ
и при любом к е К
.Т кР у / к ( у / к ) = У
кеУ
175
I лава 7
С целью упрощения записи нижние индексы в обозначениях
р }/х ( у / х), Ру/к(у/к) будем опускать и записывать
их в виде р ( у /х ) , р ( у /к ) соответственно.
Отметим, что с помощью формулы для условной вероятности
П Ф ) - ^ (17)
Р(Ь)
мы можем вычислить и условные вероятности
Р(х/У% Р(к/У) ■
Р ,М
р ( к / у )= р А к ) р ( у / к ) .
Ру(у)
(18)
Следующее определение лишь формализует предложенный
выше подход к теоретической стойкости шифра (только
по отношению к атаке на основе единственного шифртекста).
Определение. Назовем шифр Ев совершенным, если для
любых х е X , у е У выполняется равенство
р(х/у) = Рх (х ) . (19)
Отметим одно очевидное свойство совершенного шифра.
Утверждение 1. Если шифр Ев — совершенный, то
\Х\<\У\<\К\. (20)
Доказательство. Первое неравенство, очевидно, имеет
место для любого шифра. Если шифр — совершенный, то для
любых х е X, у е У найдется ключ к & К , такой, что
Ек(х) = у . В самом деле, в противном случае, согласно (15),
176
Надежность шифров
мы бы имели р ( у / х ) = 0 , а тогда и, согласно (18),
р ( х / у ) - 0 . Согласно (19), вероятность р х (х) также оказывается
равной нулю, вопреки нашей договоренности о том,
что р х (х) > 0 для любого х е Х .
Отсюда следует также, что для любого х е X выполняется
равенство {Ек (х), к е К} = У и, следовательно,
|у| < |К\ . Утверждение доказано.
В большинстве случаев применяемые на практике шифры
обладают свойством X = У . Следуя К. Шеннону, назовем
такие шифры эндоморфными. К. Шеннону удалось полностью
описать эндоморфные совершенные шифры с минимально
возможным числом ключей. Согласно (20), это минимально
возможное число ключей |А^| равно |к |. В несколько более
общей форме теорема формулируется следующим образом.
Теорема (К. Шеннон). Пусть — шифр, для которого
\Х\ = |Г| = |^Г|. Тогда шифр ^ — совершенный тогда и только
тогда, когда выполняются два условия:
1) для любых х е X , у еУ существует единственный
ключ к е К , для которого Ек (х) = у ;
2) распределение вероятностей Р (К ) — равномерное,
то есть для любого ключа р к (к ) = —
Доказательство. Пусть шифр Ъв — совершенный. Согласно
доказательству утверждения 1 ,
177
/ лава 7
Поэтому из неравенства к , Ф к2 следует неравенство
Ек[ (х) * Ек2 (х) для любого х е X . Это доказывает необходимость
условия 1).
Пусть X = . Зафиксируем произвольный элемент
у е У и занумеруем ключи так, чтобы Е^. (х1) = у,
г - \ }М . Тогда
( х / А = Р(у / х , ) ' Р х (х .) = Р к (К ) 'Р х ( х , ) (2П
Ру(у) рЛу )
Так как — совершенный шифр, то р (х ,/у) = р х (*/).
Отсюда и из (21) получаем равенство р к (к,) = р у(у) для
любого г = 1,Л^, которое доказывает необходимость условия
2).
Пусть условия 1) и 2) выполнены. Тогда, пользуясь для
фиксированного элемента у е У введенной выше нумерацией
ключей, имеем цепочку равенств:
А - 0 0 = ' Т и Р х ( х , ) р К( к , ) = (уол1))ЛГ ^ N
Як,(х,)=У
из которой
( / ) = Р А ^ У М = А У
Р у(у ) (у“ 2»
Достаточность условий теоремы также доказана.
Обратим внимание на то, что таблица зашифрования
шифра, удовлетворяющего условиям теоремы Шеннона, согласно
условию 1 ) этой теоремы, является латинским квадратом.
Поэтому в случае, когда X = У = К = , по сути дела,
шифры табличного гаммирования со случайными равно-
178
Надежность шифров
вероятными ключами, и только они являются единственными
совершенными шифрами.
V/к X, х ы
К Е кх(х 1> Е кх (*ы)
кы Е кы (*1> ... Е км ( * * )
Подчеркнем также, что не только указанные шифры являются
совершенными. В качестве примера можно указать
следующий не эндоморфный совершенный шифр.
Пример
X = {*(),*,}, У = {Уо,У\,Уг), К = {к0,кь к2},
Ек, (х] ) = Ут> т = (* + У)тос13, р К(к, ) = 1/3, / = 0,2.
Теорема Шеннона может быть обобщена и для некоторых
других криптоатак. Например, в статье [Со<190] такое обобщение
проводится для криптоатак на основе нескольких
шифртекстов, полученных на одном ключе, а также для криптоатак
на основе ряда открытых и соответствующих им шифрованных
текстов, образованных с помощью одного ключа.
Практическая стойкость шифров
В своей работе [ШенбЗ] К. Шеннон, помимо исследований
по теоретической стойкости, рассматривал также вопрос
о практической стойкости шифров. Он рассуждал следующим
образом (рассматривая, как и ранее, криптоатаку на основе
одного шифртекста на шифр, не являющийся совершенным).
179
I лава 7
После того как объем перехвата ( у ) превзойдет расстояние
единственности (естественно, предполагается, что для рассматриваемого
шифра оно существует!), обычно будет сущесгвовать
единственное решение (х или к ) криптограммы. Задача дешифрования
и состоит в нахождении этого единственного решения,
имеющего высокую вероятность ( р ( х / у ) или р(к/у) ) . До того
как объем перехвата достигнет расстояния единственности, задача
состоит в нахождении всех решений, имеющих большую вероятность
(по сравнению с остальными решениями), и, конечно, в определении
вероятностей этих решений.
Несмотря на то, что эти решения можно в принципе найти,
поочередно перебирая, например, все ключи при расшифровании,
для различных шифров нужно будет затратить для этого весьма
различающиеся объемы работы. Средний объем работы IV(И) ,
необходимый для определения ключа по криптограмме, состоящей
из N букв, измеренный в удобных элементарных операциях,
К. Шеннон предложил назвать рабочей характеристикой шифра.
Это среднее значение берется по всем сообщениям и всем ключам
с соответствующими им вероятностями. Функция IV(М) характеризует
средние затраты (временные и материальные), необходимые
для практического дешифрования криптограммы. Подобную
характеристику можно рассматривать не только для одной
конкретной криптоатаки, но и для других постановок задач криптоанализа.
Рис. 20
180
Надежность шифров
К. Шеннон привел рабочую характеристику шифра простой
замены, сопоставив ее с неопределенностью шифра по
открытому тексту (как функцией длины сообщения). Пунктирная
линия кривой на рис. 20 относится к области, где имеется
несколько возможных решений. По мере увеличения
объема перехвата количество необходимой работы быстро
уменьшается, стремясь к некоторому асимптотическому значению,
которое достигается, когда дополнительные данные
уже не уменьшают работы.
Наибольший интерес представляет предельное значение
IV(Щ при N -> со (то есть IV(со) ), которое можно рассматривать
как среднюю работу по дешифрованию при неограниченном
объеме шифртекста. Практическое вычисление IV(со)
представляет собой весьма сложную задачу. В связи с этим
практическую стойкость шифра обычно оценивают с помощью
величины И^(оо), которую можно назвать достигнутой
оценкой рабочей характеристики. Она определяется средней
трудоемкостью наилучшего из известных методов вскрытия
данного шифра. Если значение IV (оо) вычисляет криптоаналитик,
которому известны все имеющиеся в настоящее время
методы анализа шифров, то полученная оценка практической
стойкости шифра заслуживает доверия, особенно если вычисления
сделаны с достаточным “запасом”. Имеется в виду правильный
выбор нижнего порога сложности А, выделяющий
практически стойкие шифры неравенством РУД(оо) > Л .
Большое значение имеет математическая модель вычислений,
используемая при оценке практической стойкости
шифра. По сути, речь идет о модели гипотетической ЭВМ,
которой располагает потенциальный противник и которая
способна реализовать крупный фрагмент алгоритма вскрытия
как одну элементарную операцию. Например, опробование
одного ключа к е К и проверку результата расшифрования
по критерию открытого текста (выполняется ли включение
181
/ лава 7
Ок(у ) б ! ? ) , в принципе, можно принять за одну элементарную
операцию.
Более детальное исследование вопросов практической
стойкости (выходящее за рамки данной книги) выводит на
серьезные проблемы теории сложности алгоритмов и разработки
методов криптоанализа.
§ 7.4. Вопросы имитостойкости шифров
Как мы уже отмечали в гл. 2, помимо пассивных действий
со стороны потенциального противника, состоящих в подслушивании
или перехвате передаваемой по каналу связи
шифрованной информации, возможны также его активные
действия, состоящие в попытках подмены или имитации сообщения.
Если передается шифрованное сообщение у е У (полученное
из открытого текста х € X на ключе к е К ), то противник
может его заменить на у ', отличный от у . При этом
он будет рассчитывать на то, что на действующем ключе к
новая криптограмма при расшифровании будет воспринята
как некий осмысленный открытый текст х ' , отличный от х .
Конечно, это событие может произойти с некоторой вероятностью,
и чем больше эта вероятность, тем успешнее будет
попытка подмены.
Попытка имитации может быть предпринята противником
в том случае, когда линия связи готова к работе (на приеме
и передаче установлены действующие ключи), но в рассматриваемый
момент никакого сообщения не передается. В
таком случае противник может выбрать некий у е У и послать
его от имени законного отправителя. При этом он будет
рассчитывать на то, что на действующем ключе его криптограмма
при расшифровании будет воспринята как некий осмысленный
открытый текст. Чем больше вероятность этого
события, тем успешнее будет попытка имитации.
182
При теоретическом исследовании активных действий
противника обычно ставят его в наиболее благоприятные условия,
помещая между отправителем и получателем, как это
указано на схеме (см. рис. 2 1 ).
Надежность шифров____________________________________________
Рис. 21
Имитостойкость шифра определим как его способность
противостоять попыткам противника по имитации или подмене.
Естественной мерой имитостойкости шифра служит вероятность
соответствующего события:
(у ) е X — для попытки имитации сообщения;
(В к (У ) е Л (У * У) — Для попытки подмены сообщения.
В соответствии с этим введем следующие обозначения:
Р им *“ шах р (В к (у ) е X ) , (22)
уеУ
Р п от = т а х Р Ф к (У ' ) е Х ) . (23) у,у'еУ
У'*У
183
I лава /
которые назовем соответственно вероятностью имитации и
ту попытку, которая с большей вероятностью приводит к успеху,
вводят также вероятность навязывания формулой
Рн ~~ т ах(Рим, р подм } .
Для шифров с равновероятными ключами (в рамках введенной
в гл. 2 модели) можно получить общие оценки введенных
вероятностей.
Утверждение 1 .Для шифра с равновероятными клю-
Доказательство. Пусть К( у ) = { к ^ К \ Ок(у) е X } .
Тогда в силу условия равновероятности ключей
вероятностью подмены6. Полагая, что противник выбирает
нами имеет место достижимая оценка р им >
Согласно (22),
(24)
Заметим, что имеет место соотношение
(25)
у<=У
6 В [Сим88] р подм определяется несколько иначе, однако утверждение 2
для него остается справедливым.
184
Надежность шифров
В самом деле, рассмотрим таблицу зашифрования, строки
которой занумерованы ключами, столбцы — открытыми
текстами, а на пересечении строки с номером к е К и столбца
с номером х е X расположен шифрованный текст
из которого, с учетом (24), получаем требуемое неравенство.
Остается доказать его достижимость. Приведем пример шиф-
Рассмотрим шифр ]Г#, определенный условием
^к\ (х\ )~ ^к2 ^х2 ) тогда и только тогда, когда кх—к2 и
х\ = *2 • Ясно, что для такого шифра выполняются равенства
Обратим внимание на то, что для эндоморфного шифра с
равновероятными ключами (например, для шифра гаммирования
с равновероятной гаммой) р ИМ = 1. Это означает, что
такой шифр максимально уязвим к угрозе имитации сообщения.
Поэтому, несмотря на их многие положительные качества,
эндоморфные шифры нуждаются в имитозащите. Утверждение
2 показывает, что имитостойкость шифра растет пропорционально
отношению Это объясняет широко ису
— Ек (х) . Легко видеть, что сумма
уеУ
совпадает с
числом клеток этой таблицы, откуда следует (25).
Из (25) следует очевидное неравенство
ра, для которого р ИМ =
= -т-у, что и требуется.
и
185
Iлава /
пользуемый для имитозащиты способ введения избыточности
в передаваемое сообщение, например, дополнительных “добавок”
к передаваемому сообщению типа аутентификаторов
или имитовставок.
Утверэвдение 2. Для шифра в с равновероятными ключами
имеет место достижимая оценка
\Х\ -1
Рпот ~ |}^|_| ‘
Доказательство. Пусть К( у ,у ' ) = К( у ) г>К( у ' ) . Тогда,
в силу условия равновероятности ключей, из (24) получаем:
а д '
Несложно заметить, что выполняется соотношение
2 |К 0 ' , / ) | = ( И - ] ) ' |В Д | , (28)
у\(у'*у)
из которого (поскольку сумма в левой части равенства содержит
|У| - 1 слагаемых), следует неравенство
шах ^ ^ —г— . (29)
\К(у] |У|-1
В силу (27)
\К(У)\ •
186
Надежность шифров
Отсюда и из (29) получаем требуемое неравенство. Остается
доказать его достижимость. Для этого построим соответствующий
пример.
Попытаемся построить шифр удовлетворяющий условиям
|ВДН*</)|. УУ./еГ,
\К(У\,Уг\= К(у \ ,у 2), Ч у \ ,у \ е Г . <30)
Согласно (25) и (28) для такого шифра выполняются соотношения
( |г|-|*Су)|=|*Н4 Уу61'.
[1*001 • (|*| -1)=1*0,У)| • (|г| -1), Чу,/6 У,
из которых сразу получаем искомое равенство
| * 0 ' . / ) | 1 4 - *
р “ т |* о о | И - г
Таблицу зашифрования шифра, удовлетворяющего условиям
(30), можно построить с помощью так называемых ортогональных
латинских квадратов.
Два латинских квадрата размером п х п, составленные из
элементов множества 1, 2,..., п . называются ортогональными,
если при их совмещении друг с другом получается таблица,
содержащая (в своих клетках) все п возможных (упорядоченных)
пар чисел (г,/), /,У е 1 ,п .
Известно [Хол70], что перестановкой строк и столбцов
любой латинский квадрат можно привести к виду, в котором в
первом столбце числа 1, 2 идут в возрастающем порядке.
187
I лава 7
Такой латинский квадрат называется полуиормсшизованным.
Известно также [Хол70], что любую пару ортогональных латинских
квадратов можно привести перестановкой строк и
столбцов к паре полунормализованных латинских квадратов.
Рассмотрим теперь таблицу чисел размером 2п х (п - 1),
полученную из пары полунормализованных латинских квадратов
размером п х п наложением друг на друга и вычеркиванием
получившегося первого столбца. При этом 2п строк
образуются графически из полученного прямоугольника, если
ГО каждую составляющую его пару (/, /) записать в виде
У )
Можно заметить, что ее можно использовать в качестве таблицы
зашифрования искомого шифра. Гак, для п = 3 соответствующий
пример изображен на рис. 22-24.
1 2 3
2 3 1
3 1 2
1 3 2
2 1 3
3 2 1
Рис. 22. Полунормализованные ортогональные
латинские квадраты
0 , 1) (2,3) (3,2)
(2,2) (3,1) (1,3)
(3,3) ( 1 ,2) (2, 1)
Рис. 23. Наложение латинских квадратов
В данном примере |АХ.У)| = 4, \К (у,у' )| = 2.
Построенный таким образом шифр X# имеет следующие
параметры: |х | = п - 1, |г | = п, (А-] = 2п . Поэтому для него
188
Надежность шифров
П - 2
РПОДМ 1 п - 1
Х\ Х2
2 3
к2 3 2
к, 3 1
К 1 3
К
1 2
К
2 1
Рис. 24. Таблица зашифрования
Для доказательства утверждения 2 остается добавить, что
имеет место следующее утверждение [Хол70]: для всякого
п > 6 существует пара ортогональных латинских квадратов
порядка п .
Утверждение доказано.
Итак, вероятность навязывания р н для шифра с равновероятными
ключами удовлетворяет неравенству
Поэтому для надежной защиты от подмены или навязывания
необходимо, чтобы число |Г| значительно превосходило чис-
ло \х\.
Возникает естественный вопрос, как определить совершенную
шттостойкостъ (то есть теоретически наилучшую
189
/ лава /
защиту от имитации или подмены), достижимую при данной
величине |Т| множества допустимых криптограмм и при произвольном
распределении Р(К) на множестве ключей. Чтобы
ответить на этот вопрос, приведем более тонкую оценку
для вероятности р им , известную как граница Симмонса.
Обозначим через 1(У,К) взаимную информацию между
У и К [Сим88], то есть величину, определяемую формулой
тогда справедливо следующее.
Утверждение 3. Имеет место достижимая оценка
Доказательство. Обозначим через 8 ( у , к ) индикатор
события с1к (у ) е X :
Тогда для данного ключа к € К криптограмма у будет принята
как допустимая лишь в том случае, когда 8 (у, к) = 1.
Согласно формуле полной вероятности вероятность
р { у — доп) того, что у окажется допустимой криптограммой,
равна
1(У,К) = Щ У ) -Н (У /К ) , (31)
1о ёР и и> - 1 (У ,К ) . (32)
<*к(>>)*х.
р ( у - доп) = 5 ] р(к) • р(у - доп/ к ) ,
а поскольку
190
НаОежность шифров
то
р ( у - д о п / к ) = { 1, ^ Д ) = 1’
[О, 8 (у,к) = О,
Р(У ~ доп) = ^ 8 (у,к) ■ р(к ) . (33)
кеК
Представим вероятность р { у ) в виде
Р(У) = X Р(к) • р ( у ! к) р(к) • к ) - 8 ( у ,к ) . (34)
йеЯ' кеК
Второе равенство в (34) следует из того, что если
Р(к) ■ р(у / к) ф 0 , то 5(у,к) = 1.
Теперь мы можем получить границу Симмонса для вероятности
р ИК . Для этого введем функцию
Р(к ) -8 (у, к)
р ( у - доп)
Легко видеть, что ()у (к) — неотрицательная функция от
к , которая при суммировании по к (с учетом (33)) дает 1.
Выражая р(к)- §{у,к) из (35) и подставляя его в (34),
получаем:
Р(У) = Р(У ~ Доп) • 5 ] ^ у (к) ■ р ( у / к ) . (36)
кеК
Прологарифмировав (36) и умножив получившееся равенство
на р ( у ), получим выражение
191
/ лава 7
Р(У) 1°Е Р(У) = р(у ) 1°ё Р(У - Доп) +
+ р ( у ) 1о ^ Я у (к)р(у/к) . (37)
кеК
Второе слагаемое в правой части (37), с учетом (36), можно
представить в виде
кеК кеК
Воспользуемся неравенством Иенсена [Бил69], взяв за основу
функцию / ( 1) = {1о :
2 в у ( к ) р ( у 1 к) 1о§ р{у / к) >
кеК
^ 1^Яу(к)р{у1к)\\щ[^ду(к)р{у1кУ\%
кеК кеК
откуда
Р(У) 1о§ X (к )р{у / к ) *
кеК
< р ( у - Доп)]Г ^ (к)р(у / к) 1од р ( у / к) =
кеК
= X Р(к)р(у / к)д(у, к) 1од р ( у / к) =
кеК
= X Р(к)р(у / к) 1о§ р ( у / к). (3 8)
кеК
Здесь мы воспользовались определением (35), а также тем,
что из неравенства р ( у / к)р(к) Ф 0 следует равенство
8 ( у , к ) = 1 .
Теперь, суммируя (37) по у и пользуясь оценкой (38) для
второго слагаемого, получаем неравенство
192
Надежность шифров
- Н(У) < ^ [р ( у ) 1о§ р( у - доп)] -Н( Г/ К) ,
уеУ
из которого, согласно (31), следует, что
^ р ( у ) \ о% р ( у -щ т )> - 1 { У ,К ) . (39)
Отсюда, наконец, получаем искомое неравенство:
р ИЫ = 1о§[тах р ( у - доп)] = Д'еУ
= Е Р(У)] ■ 1о§[тах р ( у - доп)] >
уеУ У
^ ^ Р(У) • 1°§ Р(У - Доп) > -1(У, К).
уеУ
Утверждение 3 доказано.
Из приведенных рассуждений следует, что равенство в
(32) достигается в том и только в том случае, когда одновременно
выполняются следующие два условия:
1. Вероятность р ( у — доп) не зависит от у (поэтому
левые части в (32) и (39) равны);
2. Для каждой криптограммы у е У вероятность р(у/к)
одинакова при всех к , для которых 8(у,к) = 1 .
Из утверждения 3 следует оценка для логарифма вероятности
навязывания р н :
1оЕ/?н >~1(У,К) , (40)
причем необходимыми (но уже не достаточными) условиями
достижения равенства в (40) являются условия 1 и 2.
Согласно [Сим88], совершенная имитостожость определяется
как равенство в (40). Следует, однако, отметить, что
даже при достижении совершенной имитостойкости вероятность
навязывания мала лишь при большой величине
193
/лава 7
1(У,К), то есть в том случае, когда криптограмма дает значительную
информацию о ключе. Информация, которую дает
У относительно К , есть мера того, в какой степени ключ
используется для обеспечения имитостойкости.
В общем случае не известно, при каких условиях существуют
шифры, обеспечивающие совершенную имитостой-
кость, хотя и имеются соответствующие примеры [Сим88].
Любопытно отметить, что эти примеры свидетельствуют о
том, что криптостойкость и имитостойкость шифра являются
независимыми свойствами шифра.
§ 7.5. Шифры, не распространяющие
искажений
Помимо целенаправленных искажений передаваемой
шифрованной информации возможны также искажения, происходящие
за счет наличия помех в канале связи. Такие помехи
могут привести к искажениям или даже потере отдельных
знаков используемого алфавита. Если искаженный знак не
является знаком того же алфавита, то на приеме факт искажения
легко установить. В противном случае факт искажения
может быть установлен лишь при расшифровании, когда искажение
в шифртексте приводит к потере части или даже всего
открытого текста. Так же проявляется и потеря знаков
шифртекста. Последствия искажений шифртекста при передаче
могут быть различными для разных типов шифров. Нас
будет интересовать вопрос о свойствах самого шифра, позволяющих
не распространять искажений при расшифровании.
При этом мы ограничимся рассмотрением лишь эндоморфных
шифров и искажений, которые либо заменяют знаки алфавита
знаками того же алфавита (искажения типа “замена знаков”),
либо приводят к потере знаков или появлению дополнительных
знаков алфавита (искажения типа “пропуск-вставка знаков”).
194
Надежность шифров
Шифры, не распространяющие искажений типа
“ замена знаков”
Будем рассматривать шифры, для которых открытые и
шифрованные тексты являются словами в некотором алфавите
А и которые не изменяют длины сообщений при шифровании.
В терминологии, введенной в гл. 2, речь пойдет о
шифрах, описываемых моделью = (Х ,К ,У ,Е ,В ) , в кото-
I.
рой X = У = 1 М ' , причем для любых х € X и к е К длина
/=1
у = Ек (х) совпадает с длиной х .
Естественной мерой значительности последствий искажений
типа “замена знаков” является метрика на множестве
сообщений X = У . По-видимому, простейшей является метрика
Хэмминга /л , определяемая формулой
Л
М( х , у ) = ^ 8 ( х 1, у 1 ) , (41)
/ = 1
где л; = (*!,...,хл ) ,у = 0 ^,...,у л ) е Х ,
ж ' ч I 1’
[О, Х{ = у { .
Как мы знаем, для эндоморфного шифра каждое правило
зашифрования Ек представляет собой биекцию Ек : X —> X .
В силу этого часто бывает удобно пользоваться подстановочной
моделью шифра — Еп = ( Х , Е ) , в которой множество
Е = {ек :к е К} рассматривается как множество подстановок
е :X - > X , е е Е . При этом индекс к можно опустить, имея
в виду наличие взаимно однозначного соответствия между
правилами Ек и подстановками е .
195
(лава 7
Далее в этом параграфе мы будем рассматривать именно
подстановочную модель шифра.
Определение 1 . Будем говорить, что шифр Еп = ( Х 9Е)
не распространяет искажений типа замены знаков, если для
любых х 9у е Л л, 1 < Я < Ь9 и любого е е Е выполняется неравенство
/и(е~хх,е~ху )< ц { х , у ) . (42)
Данное определение естественным образом формализует
понятие “не распространения искажений”. Неравенство
(42) означает, что число искажений в расшифрованном тексте
не превышает числа искажений в передаваемом шифрованном
тексте. Иногда говорят также, что шифр, удовлетворяющий
условию (42), является помехоустойчивым (или помехостойким)
к искажениям рассматриваемого типа.
Утверждение 1 . Шифр не распространяет искажений
типа замены знаков тогда и только тогда, когда для любого
Л е 1 9Ь, любых х 9у е Л л и любого е е Е выполняется
равенство
/и(е~'х,е~1у ) = м ( х , у ) . (43)
Доказательство. Действие преобразования е на
множестве Дя = А л х А л , заданное формулой е(х, у ) =
= ( е~1х,е~1у ) , определяет биекцию Ал -» Ал . Поэтому если
( х 9у ) пробегает Ал 9 то и (е~хх,е~1у) также пробегает Дя .
Отсюда следует, что
^ ^ ( е - ' х , е ~ 1у )= ^ ц ( х , у )
ИЛИ
196
Набежностьшифров
^ [ /и ( х , у ) - /и ( е ~ 1х,е~[у)\ = 0. (44)
(Х,у)
Если шифр не распространяет искажений, то, в силу (42),
каждое слагаемое в (44) неотрицательно. Поэтому равенство
(44) может выполняться лишь в случае, когда имеет место условие
(43), что и требуется.
Определение 2. Подстановки е € Е , удовлетворяющие
условию (43), называются изометриями на X .
Утверждение 1 показывает, что для шифров, не распространяющих
искажений типа замены знаков, множество Е
состоит из изометрий. Критерий того, что подстановка е е Е
является изометрией на X , получен А. А. Марковым (см.
[Баб97]). Для его формулировки введем следующие два преобразования
множества X :
= (аЛ9—9а]л)> (45)
К(ах,..., ал ) = (а{),..., Кл (ал )), (46)
где 0 ‘1,.-5Уд) — перестановка чисел 1,2,..., Я; 7?/ е 8 (А) —
некоторые фиксированные подстановки множества А ,
а, е А, Л е 1,Ь, г е 1,А .
Теорема (А. А. Маркова). Биекция е е Е является изометрией
на X тогда и только тогда, когда е = К • П ^ ^
для подходящих преобразований, определенных формулами
(45), (46).
Доказательство. Достаточность условия теоремы очевидна,
поскольку преобразования К и П ^ являются
изометриями и произведение изометрий также является изометрией.
Обратимся поэтому к доказательству необходимости
условия теоремы.
197
I лава 7
Для фиксированного элемента (а],...,ад) е А X введем
обозначение
АЛ = { ( « ! , . ад), а е А}
и покажем, что если е(а|,...,ад) = (с|,...,сд), то для любого
/ е 1,Я найдется у е 1, Л такое, что
(47)
Д
Любые элементы множества Аг отличаются лишь в одной
позиции. Если бы равенство (47) не выполнялось, то на-
шлись бы х ,у е е(А;) такие, что //(*,у) > 2. Это противоречит
условию о том, что е — изометрия на X . Итак, (47) имеет
место.
В (47) е осуществляет биекцию по соответствующим координатам:
в(а] а? 1 , а, а,+1 а^) —
(48)
где К' — некоторая биекция множества А . Меняя значение 1
от 1 до Я, получим перестановку ( д ,...,/д) множества 1 ,Л,
такую, что
е{ах,...,ал ) = (Кк{ (акх),...,Ккя (акя )), (49)
где
198
Надежность шифров
г 1 2 ...Л л 1
ЧУ1 ]2 ••• ]Х
Покажем, что
/ 1 2 ... Л ^
к\ к2 - кл ,
71-Л ’ (50)
где Я = — преобразование, полученное в (49).
Для этого введем в рассмотрение “окрестность радиуса Г
точки (а|,...,ад):
О, (в!,..., ад) = 0 4 *
/=1
Эта окрестность представляет собой множество точек из
отстоящих (по метрике Хэмминга) от данной точки не
более чем на единицу. Аналогично можно ввести и окрестности
От («1 ,..., а^) большего радиуса.
Заметим вначале, что (50) выполняется на Ох(ах,...,ах) .
Это следует из (47) и (48). То же самое можно выразить в другой
форме:
<Р = е - П к] кх •К "* =Ш Ах, (51)
где Ш х — тождественное преобразование множества А л .
Докажем, что равенство (51) выполняется на всем А Л .
Для этого рассмотрим произвольную точку (6],...,6д ) е А А и
систему окрестностей В1, / = 0,Л :
199
[ лава 7
В0 = 0 \(а \9...9а^)9 В\ = 0\(Ъ\9а2 ад
В л = ° \
и индукцией по г покажем, что <р = Ш % на каждом из них.
При / = 0 справедливость (51) уже проверена. Допустим,
что утверждение верно для г = к и рассмотрим
I — к + 1 .
Пусть х е В ]+х=Ох(Ъъ ...,Ъ]+ьа]+2 ,...,ах ) и пусть </ =
- (Ь^9...9Ь^9а^+^9...9а^) — “центр” окрестности В] . Ясно,
что //(х ,б /)< 2 . Если при этом /и(х9с1) = 1, то и
ф(х) = х по предположению индукции. Пусть тогда
/л(х,<]) = 2 . Покажем, что для любого у е 0 2(с1) имеет
место равенство <р(у) = у .
Без ограничения общности можно считать, что
У ~ (съ с2'>Ъъ9...9Ъ]9а^ \ 9„.9ах ) 9
где с, фЪХ9с2 фЬ2. Рассмотрим т о ч к и
и — (с |,Ъ2 V»Ъ^ ,ауЧ1,...,йд ), V — (^1 ,^2563,...,Ъ] , ) • • • ) ) •
Поскольку и, V е 2?у, то по предположению индукции
<р(и) = и9 ^>(у) = V. В силу того что (р, очевидно, изометрия,
получаем цепочку равенств
Кф(у\у) = К<Р(У\Ф)) = = 1 .
Аналогично получаем равенство /и(<р(у)9и) = 1. Следовательно,
е О, (и) п О, (у ) .
200
Надежность шифров
Легко заметить, что пересечение 0\ (и) слОу{у) состоит
лишь из двух точек — й и у . Поэтому (р{у) е {с1,у} . По
предположению индукции <р(с1) = я?, а так как (р — биекция,
то <р(у) = у , что и требуется.
Мы доказали равенство (50). Тем самым теорема доказана.
С
огласно теореме А.А.Маркова, в классе эндоморфных
шифров, не изменяющих длины сообщений, не распространяют
искажений типа замены знаков, например, шифры перестановки,
поточные шифры однозначной замены, а также
их композиции типа шифр замены — шифр перестановки.
Шифры, не распространяющие искажений типа
“ пропуск-вставка знаков”
При исследовании свойств шифров, не распространяющих
искажений типа “пропуск знаков”, так же, как и в
предыдущем случае, ограничимся рассмотрением лишь эндоморфных
шифров. Отметим также, что исследование вопроса
об искажениях типа “вставка знаков” производится
совершенно аналогично, поэтому далее пойдет речь лишь
об искажениях типа “пропуск знаков”.
Приведем результат характеризации множества Е подстановок
на множестве X = У , отвечающего подстановочной
модели эндоморфного шифра не распространяющего
искажений типа “пропуск знаков”.
I
В данном случае X = У = \ ^ А Л , где А — алфавит со-
/1=1
общений. Пусть 8 — бинарное отношение на множестве
X , определенное следующим образом. Пусть а , а !€ Х ,
тогда
201
I лава 7
а е а ' о 3 /€ 1,Л :а = (ах,...,ах ),а'= (ах,...,а]_1 ,а]+1,...,аА).
Через 8 к обозначим “степень” отношения 8 :
а8ка'<?> З а 1 ,...,#*-1 е X , абга1,...,#*-1^ # 1.
Определение 3. Будем говорить, что шифр '^п=(Х,Е)
не распространяет искажений типа “пропуск знаков ”, если
для любых х, у е X , любого к , меньшего длины слова х ,
а также любого е е Е из условия Х8ку следует, что
(е~] х ) е к (е -1 у ) .
Обозначим через 7ГЬ отображение множества X в себя,
определенное для любого а = (а 19...,ад ) е X формулой
тгь (а\,...,ал ) = (к(ах\...,тг(ах ) ) ,
где п — некоторая подстановка множества А , а через
/ — отображение X в себя, меняющее порядок следования
букв любого слова на противоположный: /(а ],...,а д ) =
= (ад,...,а]).
Приведем без доказательства следующий результат
[Глу98,99].
Теорема. Если Т,п - ( Х, Е) — шифр, не распространяющий
искажений типа “пропуск знаков ”, то для любого
е е Е либо е = 7ГЬ, либо е = • / (при подходящем
тте8 (А)).
Таким образом, класс шифров, не распространяющих
искажений типа “пропуск-вставка знаков”, более беден,
202
Надежность шифров
нежели класс шифров, не распространяющих искажений
типа замены знаков. Таковыми являются, например, шифры
простой замены (или одноалфавитные шифры замены) или
шифры простой замены, усложненные перестановкой, осуществляющей
изменение порядка следования знаков любого
слова на противоположный.
Контрольные вопросы
1. Как определяются энтропия и избыточность языка?
2. Как можно качественно охарактеризовать избыточность
языка?
3. Какие тексты на русском языке имеют большую избыточность:
литературные или технические?
4. Почему неопределенность шифра по открытому тексту
(или по ключу) можно рассматривать как меру теоретической
стойкости шифра?
5. Как зависит расстояние единственности для шифра от
энтропии языка?
6. Найдите расстояние единственности для шифра Виженера,
который используется для шифрования русских
технических текстов с избыточностью 0,5.
7. Какие атаки используются в криптоанализе?
8. Каким образом априорные вероятностные распределения
на множествах открытых текстов и ключей индуцируют
вероятностное распределение на множестве шифрованных
текстов?
9. Какой шифр называется совершенным (для атаки на основе
шифртекста)?
10. В каком случае шифр модульного гаммирования является
совершенным (для атаки на основе шифртекста)?
11. Верно ли, что лишь шифры табличного гаммирования
являются совершенными?
12. Чем отличаются понятия теоретической и практической
стойкости шифра?
203
I лава 7
13. Что такое имитостойкость шифра? Что может служить
мерой имитостойкости шифра? Является ли шифр гаммирования
имитостойким?
14. Что такое совершенная имитостойкость шифра?
15. Является ли шифр гаммирования шифром, не размножающим
искажений типа “замена знаков”, “пропуск
знаков”?
Глава 8
Блочные системы шифрования
Используемые в настоящее время системы шифрования
делятся на два класса: блочные и поточные системы. Как
отмечалось в § 3.2, основной критерий такого разделения —
мощность алфавита, над знаками которого производится операция
шифрования. Если открытый текст перед шифрованием
разбивается на блоки, состоящие из нескольких знаков, то
есть исходное сообщение обрабатывается блоками, то мы
имеем дело с блочным шифром. Если каждый знак сообщения
шифруется отдельно, то такой шифр — поточный.
Разделение шифров на поточные и блочные связано с алгоритмическими
и техническими особенностями реализации
шифрующих преобразований, использующими возможности
существующей элементной базы (разрядность процессоров,
быстродействие микросхем, объем памяти компьютера). При
увеличении мощности алфавита необходимо исследовать,
прежде всего, вопросы о выборе преобразований, реализуемых
криптосхемой, и способе их практической реализации,
влияющем на эффективность функционирования криптосхемы
с точки зрения эксплуатационных характеристик.
Естественно, что точное значение мощности алфавита,
начиная с которого шифр следует считать уже не поточным, а
блочным, назвать нельзя. Более того, с развитием техники эта
характеристика меняется в сторону увеличения. Например, в
настоящее время используются 16- и 32-разрядные процессоры,
а перспективная шифровальная техника проектируется
уже на 64-разрядных процессорах. Поэтому при построении
поточных шифров могут быть использованы алфавиты мощ-
ностью 20 32 и о26 4 .
Следует отметить, что переход от поточного к блочному
шифрованию открывает дополнительные возможности для
205
Глава 8
повышения стойкости криптографических алгоритмов. Как
отмечалось в гл. 7, все естественные языки обладают большой
информационной избыточностью. Интегральной характеристикой
избыточности служит энтропия текста. При шифровании
текстов с малой энтропией имеется возможность применения
методов, аналогичных методам вскрытия шифра простой
замены. С увеличением мощности алфавита энтропия на
один знак в “новом алфавите” также увеличивается. Таким
образом, использование статистических закономерностей
открытых сообщений при проведении криптографического
анализа блочных шифров существенно затрудняется. Кроме
того, анализ блочных шифров неразрывно связан с исследованием
преобразований алфавитов большой мощности, а как
правило, увеличение размеров задачи приводит к нелинейному
росту трудоемкости ее решения, что также приводит к
снижению эффективности известных методов криптографического
анализа.
Оборотной стороной сложности анализа блочных криптосхем
является трудность обоснования их криптографических
качеств и получения доказуемых оценок стойкости.
Приходится разрабатывать методы анализа, учитывающие
специфику схем блочного шифрования. К недостаткам блочных
шифров следует отнести также сложность реализации
преобразований алфавитов большой мощности. Однако этот
недостаток удается преодолеть путем использования преобразований
специального вида.
§ 8.1. Принципы построения блочных
шифров
Как правило, алфавитом, на котором действует блочный
шифр, является множество двоичных векторов-блоков открытого
текста одинаковой длины (64, 128 и т. д.). Сама реализация
преобразований столь больших алфавитов является слож206
Ьлочные системы шифрования
ной задачей, а использование преобразований с целью шифрования
требует от них еще ряда специальных качеств.
В [ШенбЗ] К. Шеннон сформулировал общий принцип
построения шифрующих преобразований — принцип “перемешивания”.
Суть его состоит в требовании, чтобы применение
шифрующего преобразования к наборам аргументов, отличающихся
в незначительном числе позиций, приводило к
существенному изменению результата. Обеспечить выполнение
этого требования в сочетании с простотой реализации
конкретного отображения в общем случае представляется
затруднительным. Поэтому К. Шеннон предложил реализовывать
сложные преобразования в виде суперпозиции нескольких
простых некоммутирующих отображений. Подход
К. Шеннона, использующий итеративное построение преобразований,
в настоящее время является магистральным путем
синтеза блочных шифров.
Блочные шифры реализуются путем многократного применения
к блокам открытого текста некоторых базовых преобразований.
Базовые преобразования должны удовлетворять
ряду требований, обусловленных тем, что они, во-первых,
должны быть просто реализуемым, в том числе программным
способом на ЭВМ, и, во-вторых, при небольшом числе итераций
давать аналитически сложные преобразования.
Обычно используются базовые преобразования двух типов
— сложные в криптографическом отношении локальные
преобразования над отдельными частями шифруемых блоков
и простые преобразования, переставляющие между собой
части шифруемых блоков. В криптографической литературе
первые преобразования получили название “перемешивающих”,
а вторые — “рассеивающих”. Качественно можно сказать,
что перемешивание усложняет восстановление взаимосвязи
статистических и аналитических свойств открытого и
шифрованного текстов, а рассеивание распространяет влияние
одного знака открытого текста на большое число знаков
шифртекста, что позволяет сгладить влияние статистических
207
I лава 8
свойств открытого текста на свойства шифртекста. Следует
отметить, что в данном случае перемешивание понимается в
обычном смысле, а не как качественное свойство шифра, введенное
К. Шенноном.
Алгоритм шифрования выполняет некоторое число циклов
(итераций). Каждый цикл состоит в применении преобразований
первого и второго типов. Такой принцип построения
дает возможность реализовать каждый цикл шифрования с
использованием однотипных узлов, а также выполнять расшифрование
путем обработки данных в обратном направлении.
Удобной моделью для реализации базовых преобразований
служат регистры сдвига. При этом рассеивающие преобразования
определяются функциями обратной связи, а перемешивающие
— сдвигами информации в регистре.
Получили распространение алгоритмы, в которых осуществляются
преобразования над векторами, представляющими
собой левую и правую половины содержимого регистра сдвига.
Для построения таких алгоритмов часто используется конструкция,
называемая сетью Фейстеля (Ре1з1е1 Ые1\уогк) (см.
рис. 25).
Рис. 25
Преобразование, реализуемое сетью Фейстеля в / -м цикле
шифрования, имеет вид
208
Ьлочные системы шифрования
г , = х 2,
У2 = Х ,Ф / , ( Х 2,к,),
(1)
где X — входной блок, разделенный на две половины Х 1 и
Х 2, а (У{, У2) — результат зашифрования блока X на ключе
к, с помощью функции / 1.
Алгоритм шифрования реализуется несколькими итерациями
преобразования сети Фейстеля с использованием ключа
к . При этом очередная (/ -я) итерация использует в качестве
входного блока X результат предыдущей итерации и
ключ к{, вычисляемый определенным образом по ключу к .
Функция / г может зависеть или не зависеть от номера итерации.
Ценность преобразований подобного вида заключается в
том, что даже если / 1 не является обратимой функцией, преобразование
сети Фейстеля обратимо. В самом деле, из (1)
сразу следует, что
§ 8.2. Примеры блочных шифров
Американский стандарт шифрования данных ОЕ8
Стандарт шифрования данных БЕ8 (Ваш ЕпсгурИоп
81ап<$аг($) опубликован Национальным бюро стандартов
США в 1977 г. В 1980 г. этот алгоритм был принят Национальным
институтом стандартов и технологий США (НИСТ)
в качестве стандарта шифрования данных для защиты от
несанкционированного доступа к важной, но несекретной
209
I лава 8
информации в государственных и коммерческих организациях
США.
К достоинствам ОЕ8 можно отнести простоту ключевой
системы, высокую скорость аппаратной и программной реализации,
достаточно высокую криптографическую стойкость
алгоритма шифрования при заданной длине ключа.
Алгоритм ОЕ8, используя комбинацию ряда подстановок
и перестановок, осуществляет шифрование 64-битовых блоков
данных с помощью 56-битового ключа к . Схема алгоритма
ЭЕ8 изображена на рис. 26, 27.
Рис. 26
Процесс шифрования состоит в начальной перестановке
битов входного блока, шестнадцати циклах шифрования и,
наконец, конечной перестановке битов.
Отметим, что все приводимые ниже таблицы являются
стандартными и должны использоваться при реализации алгоритма
БЕ8 в неизменном виде. Все перестановки и коды в
аблицах подобраны разработчиками таким образом, чтобы
максимально затруднить процесс вскрытия шифра путем
подбора ключа.
210
Ьпочные системы шифрования
Рис. 27
211
/ лава 8
В приводимом ниже описании алгоритма ОЕ8
использованы следующие обозначения:
Ц и К( — левая и правая половины 64-битного блока
А А;® — операция побитового сложения векторов-блоков по
модулю 2;
к{ — 48-битовые ключи;
/ — функция шифрования;
1Р — начальная перестановка степени 64.
При зашифровании очередного блока Т (см. рис. 27) его
биты подвергаются начальной перестановке 1Р согласно
табл. 9.
Т аб л и ц а 9. Начальная перестановка 1Р
58 50 42 34 26 18 10 2
60 52 44 36 28 20 12 4
62 54 46 38 30 22 14 6
64 56 48 40 32 24 16 8
57 49 41 33 25 17 9 1
59 51 43 35 27 19 11 3
61 53 45 37 29 21 13 5
63 55 47 39 31 23 15 7
При этом бит 58 блока Т становится битом 1 , бит 50 —
битом 2 и т. д. Полученный после перестановки блок 1Р(Т)
разделяется на две половины: Ь0, состоящую из 32 старших
бит, и К0, состоящую из 32 младших бит.
Затем выполняется итеративный процесс шифрования,
состоящий из 16 циклов преобразования Фейстеля. Пусть
Тг_х =Д _ 1Т?/_1 — результат (;-1 )-й итерации.
Тогда результат /-й итерации 7 ] = ! ^ определяется
формулами
212
ьлочные системы шифрования
\Ь -
1 (2)
|Д = 1 М © / ( Д ^ Д Д 1=1,16.
Функция / называется функцией шифрования. Ее аргументами
являются 32-битовый вектор К1_] и 48-битовый ключ
к1, который является результатом преобразования 56-
битового ключа шифра к . Результатом последней итерации
является блок Т[6 = Д 6 Д 6. По окончании шифрования осуществляется
восстановление п о з и ц и й битов применением к
г ,6 обратной перестановки 1Р 1.
При расшифровании данных все действия выполняются
в обратном порядке, при этом вместо соотношений (2) следует
использовать соотношения
|^|-1 = А»
{ /_ , =Д , 0 / ( 1 ,Д ,) , / = 16Л,
пользуясь которыми можно “спуститься” от Ьхь И У?16 К 1 0 И Л о .
Схема вычисления значения функции шифрования
/ ( Д ч , кг) изображенана рис 28.
Для вычисления значения функции / используются:
функция расширения Е ; преобразование 5 , составленное из
восьми преобразований 8 -блоков 8 ], 8 2 *—> перестановка
Р . Аргументами функции / являются вектор Д_, (32
бита) и вектор к1 (48 бит). Функция Е “расширяет” 32-
битовый вектор Д ч до 48-битового вектора Е(К{_Х) путем
дублирования некоторых битов вектора Км , при этом
порядок следования битов в ^(Д_! ) указан в табл. 10.
213
( лава Ь
у
е
&
А; (4 8 бит)
N(
Перестановка битов Р
\ /
ЛЪ-1*д
(32 бита)
Рис. 28
Таблица 10
32 1 2 3 4 5
4 5 6 7 8 9
8 9 10 11 12 13
12 13 14 15 16 17
16 17 18 19 20 21
20 21 22 23 24 25
24 25 26 27 28 29
28 29 30 31 32 1
214
Ьлочные системы шифрования
Первые три бита в Е — это соответственно биты 32, 1
и 2 вектора , а последние три бита — это соответственно
биты 31, 32, 1 вектора К{_}.
Полученный результат складывается побитно по модулю
2 с текущим значением ключа кг и затем представляется
в виде восьми последовательных 6-битовых блоков :
Е ( = В 1...В$.
Далее каждый из блоков трансформируется в 4-бито-
*
вый блок В^ с помощью подходящей таблицы ^5^блока В},
список которых приведен в табл. 1 1 . "——
Преобразование блока В в В} осуществляется следующим
образом. Пусть, например, В2 равен 111010. Первый
и последний разряды В2 являются двоичной записью
числа а, 0 < а < 3 . Аналогично средние 4 разряда представляют
число Ъ9 0 < 6 < 15 . В нашем примере а = 2, Ь = 13.
Строки и столбцы таблицы В2 пронумерованы числами
а и Ь . Таким образом, пара (а, Ь) однозначно определяет
число, находящееся на пересечении строки с номером а и
столбца с номером Ъ . В данном случае это число равно 3.
Записывая его в двоичной форме, получаем В2, равный 0011 .
Значение теперь получается применением
перестановки битов Р 9 заданной таблицей к результирую-
> > >
щему 32-битовому блоку В\ В2 ... В^.
215
I лава 8
Таблица 11
Н О М Е Р С Т О Л Б П А
0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15
н 0 14 4 13 1 2 15 И 8 3 10 6 12 5 9 0 7
1 0 15 7 4 14 2 13 1 10 6 12 11 9 5 3 8
о 2 4 1 4 8 13 6 2 11 15 12 9 7 3 10 5 0
3 15 12 8 2 4 9 1 7 5 И 3 14 10 0 6 13
м 0 15 1 8 14 6 И 3 4 9 7 2 13 12 0 5 10
1 3 13 4 7 15 2 8 14 12 0 1 10 6 9 11 5 3?
Е 2 0 14 7 И 10 4 13 1 5 8 12 6 9 3 2 15
3 13 8 10 1 3 15 4 2 И 6 7 12 0 5 14 9
Р 0 10 0 9 14 6 3 15 5 1 13 12 7 11 4 2 8
1 13 7 0 9 3 4 6 10 2 8 5 14 12 11 15 1 8.
2 13 6 4 9 8 15 3 0 11 1 2 12 5 10 14 7
3 1 10 13 0 6 9 8 7 4 15 14 3 11 5 2 12
0 7 13 14 3 0 6 9 10 1 2 8 5 11 12 4 15
С 1 13 8 И 5 6 15 .0 3 4 7 2 12 1 10 14 9 84
2 10 6 9 0 12 11 7 13 15 1 3 14 5 2 8 4
Т 3 3 15 0 6 10 1 13 8 9 4 5 11 12 7 2 14
0 2 12 4 1 7 10 11 6 8 5 3 15 13 0 14 9
Р 1 14 И 2 12 4 7 13 1 5 0 15 10 3 9 8 6 8,
2 4 2 1 11 10 13 7 8 15 9 12 5 6 3 0 14
О 3 И 8 12 7 1 14 2 13 6 15 0 9 10 4 5 3
0 12 1 10 15 9 2 6 8 0 13 3 4 14 7 5 11
К 1 10 15 4 2 7 12 9 5 6 1 13 14 0 11 3 8 Зб
2 9 14 15 5 2 8 12 3 7 0 4 10 1 13 1 6
И 3 4 3 2 12 9 5 15 10 11 14 1 7 6 0 8 13
0 4 11 2 14 15 0 8 13 3 12 9 7 5 10 6 1
1 13 0 11 7 4 9 1 10 14 3 5 12 2 15 8 6 87
2 1 4 11 13 12 3 7 14 10 15 6 8 0 5 9 2
3 6 11 13 8 1 4 10 7 9 5 0 15 14 2 3 12
0 13 2 8 4 6 15 11 1 10 9 3 14 5 0 12 7
1 1 15 13 8 10 3 7 4 12 5 6 11 0 14 9 2 8«
2 7 И 4 1 9 12 14 2 0 6 10 13 15 3 5 8
3 2 1 14 7 4 10 8 13 15 12 9 0 3 5 6 11
216
Ьлочные системы шифрования
Таблица 12
16 7 20 21
29 12 28 17
1 15 23 26
5 18 31 10
2 8 24 14
32 27 3 9
19 13 30 6
22 11 4 25
На каждой итерации используется текущее значение
ключа к1 (48 бит), получаемое из исходного ключа к следующим
образом.
Сначала пользователи выбирают сам ключ к , содержащий
56 случайных значащих битов. Восемь битов, находящихся
в позициях 8,16,...,64, добавляются в ключ таким образом,
чтобы каждый байт содержал нечетное число единиц.
Это используется для обнаружения ошибок при обмене и
хранении ключей. Значащие 56 бит ключа подвергаются перестановке,
приведенной в табл. 13.
Таблица 13
57 49 41 33 25 17 9
1 58 50 42 34 26 18
10 2 59 51 43 35 27
19 11 3 60 52 44 36
63 55 47 39 31 23 15
7 62 54 46 38 30 22
14 6 61 53 45 37 29
21 13 5 28 20 12 4
217
I лава 8
Эта перестановка определяется двумя блоками С0 и О0
по 28 бит в каждом (они занимают соответственно верхнюю и
нижнюю половины таблицы). Так, первые три бита в С0 есть
соответственно 57, 49, 41 биты ключа. Затем индуктивно
определяются блоки С, и Д , / = 1,16.
Если уже определены С;_, и Д _ 1, то С, и Ц получаются
из них одним или двумя левыми циклическими сдвигами
согласно табл. 14.
Таблица 14
г 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16
Число сдвигов 1 1 2 2 2 2 2 2 1 2 2 2 2 2 2 1
Теперь определим ключи к19 1 < / < 16. Ключ к{ состоит
из 48 битов, выбираемых из битов блока С Д согласно таблице
15. Первыми тремя битами в к{ являются биты 14, 17, 11
из блока С Д . Отметим, что 8 из 56 бит (с номерами 9, 18,
22, 25, 35, 38, 43, 54) из С Д отсутствуют в к, .
Таблица 15
14 17 И 24 1 5
3 28 15 6 21 10
23 19 12 4 26 8
16 7 27 20 13 2
41 52 31 37 47 55
30 40 51 45 33 48
44 49 39 56 34 53
46 42 50 36 29 32
218
Ьлочные системы шифрования
Сделаем несколько замечаний.
Нелинейность преобразований, осуществляемых ОЕ8,
определяется только 5-блоками. Их выбор не имеет достаточно
обстоятельного обоснования. Высказывались мнения о
том, что 5-блоки имеют некоторую “лазейку”, позволяющую
осуществлять контроль за шифрованной перепиской. Официальная
же версия такова. В 1976 г. АНБ заявило, что выбор
5-блоков определен следующими требованиями:
— каждая строка табличного задания каждого 5-блока
должна являться перестановкой множества (0, 1,..., 15};
—5-блоки не должны являться линейными или аффинными
функциями своих входов;
— изменение одного бита входа 5-блока должно приводить
к изменению по крайней мере двух битов выхода;
— для каждого 5-блока и любого входа х значение 5(х)
и 5(х ® (О,ОД,1,0,0)) должны различаться по крайней мере
двумя битами.
Криптоанализ БЕ8 приводит ко многим нелинейным системам
уравнений. Дело в том, что каждый бит блока шифртекста
является функцией от всех битов блока открытого текста
и ключа. Известные аналитические методы вскрытия ОЕ8
не дают существенного выигрыша по сравнению с полным
перебором всего множества из 2 56 ключей. К недостаткам
алгоритма ЭЕ8 относится небольшое (по современным меркам)
число ключей, что дает возможность их полного перебора
на быстродействующей вычислительной технике за реальное
время.
Официально ЭЕ8 являлся стандартом шифрования данных
до 31 декабря 1998 г. В 1997 г. был объявлен конкурс на
новый стандарт, который был назван АЕ8 (Айуапсес! Епсгур-
1юп 81апс1агс1). 2 октября 2000 г. Национальный институт
стандартов и технологий (НИСТ) США объявил победителя
“конкурса АЕ8”. Однако для того, чтобы этот алгоритм завоевал
мировое признание, необходимы серьезные исследования
его свойств специалистами различных стран.
219
I лава 8
Стандарт шифрования данных ГОСТ 28147-89
В России установлен единый алгоритм криптографического
преобразования данных для систем обработки информации
в сетях ЭВМ, отдельных вычислительных комплексах
и ЭВМ. Он определяется ГОСТом 28147-89. Этот алгоритм
предназначен для аппаратной и программной реализации,
удовлетворяет необходимым криптографическим требованиям
и не накладывает ограничений на степень секретности
защищаемой информации. Алгоритм реализует шифрование
64-битовых блоков данных с помощью 256-битового ключа.
Схема алгоритма шифрования представлена на рис. 29.
N.
КЗУ
Х0(К 0)
Х ,(К ,)
Х2(К 2)
Х3(К 3)
Х4(К 4)
Х5(К ,)
Хб(К б)
Х7(К 7)
г
ш
3. з7 з5
см.
3.
Г4
..... 1г
32 1
У
см.
Рис. 29
На приведенной схеме:
Лг,, N 2 — 32-разрядные накопители;
220
Ьлочные системы шифрования
СМХ — сумматор по модулю 232 (операция +);
СМ2 — сумматор по модулю 2 (операция ®);
К — 32-разрядный регистр циклического сдвига;
КЗУ — ключевое запоминающее устройство объемом
256 бит, состоящее из восьми 32-разрядных накопителей;
5 — блок подстановки, состоящий из восьми узлов замены
(^-блоков замены) ,82 $8.
Открытые данные, подлежащие зашифрованию, разбивают
на 64-разрядные блоки. Процедура зашифрования
64-разрядного блока Т0 включает 32 цикла (У = 1,32). В
ключевое запоминающее устройство вводится 256 бит ключа
к , записанного в виде восьми 32-разрядных подключей кх:
к - кчк^кък^кък2кх.
Последовательность битов блока
Г0 = ( а 1 (0),...,а32(0) Л ( 0),...,*32(0))
разбивается на две половины по 32 бита (взятые в обратном
порядке):
« (0) = (а32(0) ,а 31(0),...,а 1(0) ) ,
В Д = (632(0) ,М 0) ,...Л (0)).
Эти векторы вводятся в накопители и Ы2 перед началом
первого цикла зашифрования. В результате начальным
заполнением накопителя является вектор а (0) , а начальным
заполнением накопителя Л^2 — вектор Ъ{0) .
Пусть
«(У) = («з2(УХ-,«10')), Ь(Л = (Ь320'),..АО'))
221
\лава 8
— заполнения накопителей и Ы2 после у-го цикла зашифрования
и / — обозначение функции шифрования. Тогда
уравнения шифрования представляются в виде:
\ аЦ ) = / ( « 0 - 1 ) + *,-1(т(х18)) ® Ь( ] ~ !)•
\ ь и ) = а и - 1 ) ,
при у = 1, 24,
| аЦ) = / 0 ( у - 1 ) + ^32-Лтоё8)) ® Ю - 1).
Ь(У) = в(7-1)»
при у = 25,31,
Га(32) = в(31),
> (3 2 ) = /(а (3 1 ) + * 0)Ф6(31).
Вычисление значения функции / производится в два
этапа. На первом этапе ее 32-битовый аргумент х , поступающий
на блок подстановки 5 , разбивается на восемь последовательных
4-битовых вектора, каждый из которых преобразуется
в некоторый 4-битовый вектор соответствующим
узлом замены 5,-, / = 1, 8 . Каждый узел замены можно представить
в виде таблицы-перестановки шестнадцати чисел от
О до 15, представленных в виде двоичных векторов длины 4.
Восемь преобразованных 5 -блоками векторов последовательно
соединяются в 32-битовый вектор ^ (х ) . На втором
этапе с помощью регистра сдвига К производится циклический
сдвиг вектора 8(х) влево на 11 позиций.
222
Ьлочные системы шифрования
8 -блоки представляют собой ключевые элементы, которые
являются общими для каждой сети связи. Они должны
храниться в секрете.
Результатом зашифрования блока Т0 является блок Гш,
составленный из заполнений накопителей и Ы2 после 32-
го цикла шифрования. При этом биты блока Тш выводятся из
накопителей в следующем порядке:
Тш = (а, (32),а2(32),...,а32(32),6,(32),62(32),...,6з2 (32)).
Алгоритм шифрования, опеределяемый ГОСТом 28147-
89, из-за значительно большей длины ключа является существенно
более стойким, нежели алгоритм шифрования ОЕ8.
§ 8.3. Режимы использования блочных
шифров
Для решения разнообразных криптографических задач
блочные шифры используют в нескольких режимах работы.
Рассмотрим этот вопрос на примере шифра ОЕ8.
Алгоритм БЕ8 может использоваться в следующих четырех
режимах:
—режим электронной кодовой книги (ЕСВ — Е1ес1готс
Сос1е Воок);
—режим сцепления блоков (СВС — СгрИег В1оск СИат-
тв)\
— режим обратной связи по шифртексту (СРВ — С7-
рНег Реес1 Васк);
— режим обратной связи по выходу (ОРВ — Ои1ри1 Реес1
Васк).
Режим электронной кодовой книги (ЕСВ) отвечает
обычному использованию ОЕ8 как блочного шифра, осуществляющего
некоторую простую замену блоков открытого
текста. В режиме сцепления блоков (СВС) каждый блок
223
I лава в
Сп г > 1, шифртекста перед очередным зашифрованием
складывается по модулю 2 со следующим блоком открытого
текста М/+1. При этом вектор С0 полагается равным начальному
вектору IV (1пШа1 Уес1ог). Начальный вектор меняется
ежедневно и хранится в секрете. Блоки СР С2,... вырабатываются
по рекуррентной формуле С, = ОЕ8к (С/_| ® М 1).
Схематично этот режим изображен на рис. 30.
Расшифрование
Рис. 30
224
Ьлочные системы шифрования
В режимах СРВ и ОРВ алгоритм ОЕ8 функционирует по
аналогии с “шифром Вернама”, в режиме ОРВ — как синхронный
шифр (см. гл. 9), в режиме СРВ — как шифр с самосинхронизацией.
В режиме СРВ вырабатывается блочная “гамма”
2 0, 2 ]9...9 причем 2 0 полагается равным начальному вектору
I V , а при / > 1 блоки гаммы удовлетворяют соотношению
21=ОЕ8/с(С1_ |) . Блоки открытого текста шифруются по
правилу С, = М г ® , г > 1. Схематично этот режим изображен
на рис. 31.
<I!
О
о
V7
М,
ОЕ8*
м,
с,
БЕЗ*
> г
*©
Зашифрование
>
п
О о
\ /
^ г 4 ОЕ8к ( > 0
М,
"> >
м 2
Расшифрование
Рис. 31
225
I лава 8
В режиме ОРВ вырабатывается блочная “гамма”
2 0, 2 Х9..., причем 2 0 полагается равным начальному вектору
I V , а при / > 1 блоки гаммы удовлетворяют соотношению
2 { = ОЕ8к(2 1_{) . Блоки открытого текста шифруются по
правилу С, = 2 п г > 1.
Кроме перечисленных режимов, ЭЕ8 имеет также “режим
т-битовой обратной связи”, 1 < т < 64 . Этот режим
оперирует с ш-битовыми блоками Входной блок (64-
битовый регистр сдвига) вначале содержит вектор инициализации
I V , “выровненный по правому краю"’ (см. рис. 32).
ШшШмшт Расшифрование
Рис 32
226
Ьлочные системы шифрования
Блоки открытого текста шифруются по правилу
С = М, Ф Р1, где Р1 — вектор, состоящий из т старших
битов блока ОЕ8к(С1_]) . Обновление заполнения регистра
сдвига осуществляется путем отбрасывания старших т битов
и дописывания справа вектора Р1.
Указанные режимы имеют свои достоинства и недостатки.
Основное достоинство режима ЕСВ — простота реализации.
Недостаток — в возможности проведения криптоанализа
“со словарем ”. Дело в том что вследствие большой избыточности
в открытом тексте вполне возможны повторения 64-
битовых блоков. Это приводит к тому, что одинаковые блоки
открытого текста будут представлены идентичными блоками
шифртекста, что дает криптоаналитику возможность при наличии
достаточно большого числа пар открытого и шифрованного
текста восстанавливать с большой вероятностью блоки
открытого текста по шифртексту.
В режимах ЕСВ и ОРВ искажение при передаче одного
64-битового блока шифртекста С( приводит к искажению
после расшифрования соответствующего блока М г открытого
текста, но не влияет на следующие блоки. Это свойство
используется для шифрования информации, предназначенной
для передачи по каналам связи с большим числом искажений.
Вместе с тем при использовании режима ОРВ остается открытым
вопрос о периоде получаемой выходной гаммы, который
в некоторых предположениях может составлять величину
порядка 2 32.
В режимах СВС и СРВ искажение при передаче одного блока
шифртекста С( приводит к искажению на приеме не более двух
блоков открытого текста — М 1, М [+]. В то же время изменение
блока М( приводит к тому, что С/ и все последующие блоки
шифртекста будут искажены. Это свойство оказывается полезным
227
/ лава 8
для целей аутентификации. Такие режимы применяются для выработки
кода аутентификации сообщения (см. гл. 14).
Так, в режиме СВС берется вектор инициализации, состоящий
из одних нулей. Затем с помощью ключа к вырабатываются
блоки С19...,С„ шифртекста. Кодом аутентификации
сообщения (КАС) служит блок Сп .
Если требуется обеспечить лишь целостность сообщения,
отправитель передает блоки М 19...,М„ вместе с Сп . Тогда
противнику, желающему изменить сообщение, нужно соответствующим
образом изменить и блок Сп. Возможность
этого маловероятна, если только противник не располагает
секретным ключом к .
Если же нужно обеспечить шифрование и аутентификацию,
то отправитель сначала использует ключ к { для выработки
КА С , затем шифрует последовательность блоков
М п+1 = КАС на втором ключе к2, и получает последовательность
блоков С19...9Сл9С„+1 . Получатель должен
сначала расшифровать С1,...,С/|,Сл+1 на ключе к2, а затем
проверить (с помощью к ), что М п+Х — это КАС для
А1\9...9 А/п.
Можно поступить и иначе: сначала использовать к для
зашифрования М ,9...9М„ 9 получая С19...9СЙ, а затем к2 —
для получения КАС . Получатель же будет использовать к2
для проверки КА С , а затем к — для расшифрования
С С
Во всех перечисленных режимах вместо алгоритма ОЕ8
может быть использован любой алгоритм блочного шифрования,
в частности российский стандарт ГОСТ 28147-89.
228
Ьлочные системы шифрования
В российском стандарте также предусмотрено несколько
режимов использования: режим простой замены, режим
шифрования с обратной связью и режим гаммирования с
обратной связью, которые являются аналогами соответственно
режимов ЕСВ, СВС и СРВ. Для того чтобы избавиться от
указанной выше проблемы неопределенности длины периода
гаммы в режиме ОРВ, в российском стандарте введен режим
гаммирования, при котором блочный шифр используется в
качестве узла усложнения некоторой последовательности
гарантированного периода. Для выработки этой последовательности
обычно применяются линейные регистры сдвига
или счетчики по некоторому модулю.
Рис. 33
Уравнение шифрования имеет вид
где Р — преобразование, осуществляемое блочным шифром,
у 1 — блоки, сформированные узлом выработки исходной
гаммы из начального вектора у х, который передается в
начале сообщения в открытом или зашифрованном виде.
229
/ лава 8
Ошибка при передаче, состоящая в искажении символа,
приводит при расшифровании к искажению только одного
блока, поэтому сохраняются все преимущества шифра гаммирования.
§ 8.4. Комбинирование алгоритмов блочного
шифрования
Как было указано выше, алгоритм шифрования БЕ8 сегодня
уже не является достаточно стойким. Возникает естественный
вопрос: нельзя ли использовать его в качестве строительного
блока для создания другого алгоритма с более длинным
ключом? Уже в 80-х годах была предложена идея многократного
шифрования, т.е. использования блочного алгоритма
несколько раз с разными ключами для шифрования одного и
того же блока открытого текста.
Рассмотрим двукратное шифрование блока открытого
текста с помощью двух разных ключей. В этом случае сначала
шифруют блок М ключом к{9 а затем получившийся
шифртекст Ек (М ) шифруют ключом к2. В результате двукратного
шифрования получают криптограмму
С = Ек2 (Ек> (М)) .
Если множество преобразований, реализуемых блочным
шифром, является группой (относительно операции композиции
преобразований), то всегда найдется такой ключ А;,
что С = Ек(М ) . В таком случае двукратное шифрование не
дает преимущества по сравнению с однократным шифрованием.
В противном случае после двукратного шифрования
нужно будет определять оба использованных ключа. Следовательно,
трудоемкость перебора ключей по сравнению с
однократным шифрованием возводится в квадрат.
230
Ьлочные системы шифрования
Известно, что множество преобразований, реализуемых
полной схемой ОЕ8, не образует группу [Сагп90]. Там же
показано, что множество преобразований ОЕ8 порождает
группу подстановок (степени 264 ), мощность которой превышает
число 102499. Поэтому многократное шифрование с
помощью ОЕ8 имеет смысл.
Возможны варианты двойного и тройного шифрования с
использованием алгоритма БЕ8. В одном из них
предлагается шифровать блок М открытого текста три раза
с помощью двух ключей кх и к2. Уравнение шифрования в
этом случае имеет вид С = Ек (Эк2 (Ек (М ))) . Введение в
такую схему операции расшифрования обеспечивает
совместимость схемы со схемой однократного использования
ЭЕ8. Для этого достаточно выбрать одинаковые ключи.
При трехкратном шифровании можно применить три различных
ключа. Уравнение шифрования в этом случае принимает
вид С = Екз (Ек (М))) . При этом возрастает общая
длина результирующего ключа и соответственно возрастает
стойкость шифра. Следует отметить, что такое возрастание не
может быть безграничным, оно происходит до тех пор, пока
суммарное число ключей ( 2 56л) не превзойдет общее число
преобразований, реализуемых схемой, то есть общее число
простых замен, “из которых состоит"’ данный шифр замены.
§ 8.5. Методы анализа алгоритмов блочного
шифрования
Базовым при использовании блочных шифров является
режим простой замены. В связи с этим рассмотрим ряд вопросов,
связанных с эксплуатацией блочных шифров в этом
режиме и влияющих на их криптографическую стойкость.
Как отмечалось выше, серьезным недостатом режима
простой замены является то, что зашифрование одинаковых
231
\лава 8
блоков исходного текста дает идентичные блоки шифртекста.
В результате криптоаналитик лишь на основе шифрованных
данных может делать выводы о свойствах исходного
текста. Примером таких выводов может служить определение
факта рассылки писем с одинаковым содержанием в несколько
адресов. Если некоторые блоки открытого текста повторились,
то во всех зашифрованных сообщениях, независимо от
используемых ключей, на одинаковых местах будут встречаться
повторяющиеся блоки шифрованных текстов.
Другой пример — передача ключей в зашифрованном виде
по линиям связи. Повторение блоков в одном шифрованном
тексте показывает, что часть битов в передаваемом ключе
повторились и что в дальнейшем трудоемкость перебора
ключей при их тотальном опробовании может быть сокращена
за счет учета повторений.
Показательно, что при случайном выборе блоков открытого
текста их повторение является не столь уж редким событием.
Напомним известный парадокс “дней рождениг(\
который заключается в том, что если имеется выборка объема,
сравнимого с л[Ы , из множества из N элементов, то вероятность
того, что в ней окажутся два одинаковых элемента,
сравнима с 1/2. Этот парадокс показывает, что при случайном
выборе блоков открытого текста для получения повтора
достаточно взять в среднем порядка блоков, где N —
общее число блоков, которые теоретически могут встретиться
в открытом тексте. Применительно к алгоритмам БЕ8 и
ГОСТ, которые оперируют с двоичными векторами длины
64, это означает, что в среднем, уже среди 232 блоков открытого
текста, будут встречаться повторяющиеся. Следует отметить,
что при шифровании осмысленных текстов на естественных
языках повторения будут появляться еще чаще,
поскольку в осмысленных текстах в силу используемой лексики
и грамматических правил встречаются далеко не все
сочетания букв и знаков алфавита.
232
ьлочные системы шифрования
К блочным шифрам, используемым в режиме простой замены,
могут быть применены и некоторые методы анализа
шифров простой замены в обычных алфавитах. В частности,
при достаточно большой длине шифртекста можно применять
методы анализа, использующие статистические характеристики
открытых текстов. Например, вычисляя частоты появления
блоков в шифрованном тексте и проводя опробование
часто повторяющихся блоков, начиная с наиболее вероятных
сочетаний знаков в открытом тексте, можно составить словарь
соответствия между блоками открытого и шифрованного
текстов. Далее, развивая текст по смыслу с учетом избыточности
открытых текстов, найденные блоки открытого текста
можно дополнять соседними блоками. При этом одновременно
восстанавливается открытый текст и дополняется словарь
соответствия. Этот метод эффективен, когда наблюдается
стандартность переписки. Например, всегда стандартны заголовки
деловых бумаг, юридических и прочих документов.
Еще одна слабость блочных шифров в режиме простой
замены при шифровании осмысленных текстов связана с тем
фактом, что в открытом тексте могут появляться не все сочетания
знаков, что проявляется в фактическом сокращение
числа используемых соответствий между блоками открытого
и шифрованного текстов. Однако эта слабость легко устранима,
если перед шифрованием применить к открытому текст)
процедуру сжатия информации, например использовать стан
дартные алгоритмы архивации данных.
Следующим моментом, на который следует о б р а ти
внимание, является проблема последнего неполного блок*
данных при шифровании текстов, длины которых не кратнь
размеру блока. При использовании блочного шифра этот
неполный блок должен быть каким-либо образом дополнен дс
стандартной длины. Если при этом алгоритм дополнения вы
бран неудачно, например, блок дополняется одними нулями
то при определении соответствующего блока открытого тек
ста у криптоаналитика появляются дополнительные возмож
23
Iлава 8
ности. Эта проблема может показаться надуманной, поскольку
относится только к последнему блоку сообщения. Однако
именно в конце сообщения обычно ставится подпись и, следовательно,
появляются подходы к определению по шифртексту
авторства собщения.
Отдельно остановимся на методах анализа криптографических
алгоритмов, основанных на принципе многократного
использования блочных шифров. Р. Меркль и М. Хеллман
[Мег, Не1] на примере ЭЕ8 показали, как, используя метод
встречи посередине, можно вскрыть схему двукратного шифрования.
Рассмотрим метод вскрытия блочного шифра при использовании
двойного шифрования в общем случае.
Предположим, что известны блок М открытого текста и
соответствующий ему блок С шифрованного текста. Алгоритм
вскрытия неизвестных ключей кх и к2 состоит из двух
этапов.
На первом этапе перебираются все возможные варианты
ключа к . Для каждого варианта к ключа к вычисляются
значения АВК(к) = Ек(М ) , после чего значения к помещаются
в память по адресу АВЯ(к) .
На втором этапе опробуются возможные варианты ключа
к2. Для опробуемого варианта к ’ ключа к2 вычисляются
значения АВК(к') = В к,(С) и производится обращение в
память по адресу АВК(к'). Если по этому адресу памяти
записи отсутствуют, то происходит переход к опробованию
следующего варианта к ' ключа к2. Если же по адресу
АВК(к') в памяти хранится ключ к , то образуется допустимая
пара ключей (к, к 1), удовлетворяющая равенству
С = Ек,(Ек(М)).
234
Ьлочные системы шифрования
Заметим, что в ячейку памяти с номером АОЯ(к') могут
попасть несколько вариантов ключа к (для э т о т память
необходимо соответствующим образом организовать). Для
каждого из них пара (к,к') является допустимым ключом.
Несложно заметить, что для реализации данного алгоритма
требуется 2|АГ| опробований и столько же операций
обращения к памяти, где | АГ| — общее число ключей шифра.
Таким образом, вместо \К^ операций, требуемых при полном
переборе ключей, затраты метода встречи посередине составляют
порядка 4|^С| операций (операции опробования и обращения
к памяти для простоты считают приблизительно равносильными
по сложности). Заметим, что такой резкий эффект
снижения трудоемкости достигается за счет использования
большой (и специальным образом организованной) памяти.
В заключение отметим, что помимо перебора ключей и
метода встречи посередине, при исследованиях блочных
шифров успешно применяются методы линейного и дифференциального
анализа.
Идея метода линейного анализа состоит в линеаризации
уравнений шифрования, то есть замене сложных преобразований,
описывающих алгоритм шифрования, их приближениями
в классе линейных функций. Под приближением в
классе линейных функций (или линейным аналогом) понимается
линейная функция, значения которой для достаточно
большого числа наборов аргументов совпадают со значениями
данной функции шифрования. Чем выше вероятность совпадения
значений линейного аналога со значениями функции
шифрования при случайном и равновероятном выборе аргументов,
тем лучше качество аналога.
Таким образом, линейный анализ сводит задачу определения
ключей к решению системы линейных уравнений, в
235
/ лава 8
которой правые части уравнений известны с некоторой вероятностью.
Из общих принципов математической статистики
вытекает, что если распределение значений правых частей
уравнений системы отлично от равномерного распределения,
и имеется достаточно большое число уравнений, то решение
такой системы линейных уравнений может быть найдено статистическими
методами.
Блочные шифры строятся, как правило, по итеративному
принципу. Поэтому даже использование на каждой итерации
функций, не имеющих хороших аналогов, не гарантирует
отсутствия аналогов в результирующем преобразовании.
Проблема построения блочных шифров, для которых удается
доказать отсутствие линейных аналогов, является весьма
сложной задачей современной прикладной криптографии.
Методы дифференциального (или иначе, разностного)
анализа строятся в предположении, что криптоаналитик имеет
для анализа несколько текстов, зашифрованных на одном
ключе, и дополнительно предполагается известной информация
о том, как различаются между собой открытые тексты
(при этом сами открытые тексты могут быть неизвестны). В
этом случае криптоаналитик получает информацию о том, как
заданные отличия в открытых текстах проявляются в шифр-
текстах, или, другими словами, как разность аргументов
шифрующего преобразования отражается на изменении его
значений. Поскольку шифрующее преобразование однозначно
определяется ключом, то информация о зависимостях между
разностями значений аргументов и разностями соответствующих
значений функции шифрования может быть использована
при построении алгебраических и статистических
методов вскрытия ключей алгоритма шифрования.
Заметим, что аналогичная ситуация возникает в случае,
когда криптоаналитику удается получить результат зашифрования
некоторого сообщения на разных ключах с дополнительной
информацией о различиях использованных ключей. В
ряде работ некоторые разновидности такого подхода, полу236
ьлочные системы шифрования
чившие общее название метода дифференциальных искажений,
применялись для вскрытия ключей криптографических
алгоритмов, использовавшихся для защиты информации в
платежных системах на основе интеллектуальных карт.
§ 8.6. Рекомендации по использованию
алгоритмов блочного шифрования
При практическом использовании блочных шифров, помимо
чисто криптографических проблем, необходимо учитывать
особенности конкретной системы криптографической
защиты информации, ее функции и условия эксплуатации.
Эти факторы определяют выбор режима шифрования и условий,
в которых необходимо оценивать надежность построенной
системы защиты.
Основными достоинствами режима простой замены являются
простота реализации и тот факт, что изменения одного
блока шифртекста вызывают изменения только в одном блоке
открытого текста. К недостаткам этого режима, помимо упомянутых
выше, можно отнести также неустойчивость системы
защиты перед модификацией сообщения, заключающуюся
в перестановке блоков шифртекста. Такое нарушение целостности
данных может оказаться незамеченным, поскольку при
расшифровании каждого блока будет получен осмысленный
результат. В особенности это замечание касается передачи
формализованных сообщений.
Вследствие отмеченных недостатков блочные шифры
редко используются в режиме простой замены для шифрования
длинных сообщений. Режим простой замены применяется
в основном в системах передачи ключей и в платежных системах,
где сообщения состоят из небольшого числа блоков и,
следовательно, вероятность шифрования двух одинаковых
блоков открытого текста на одном ключе очень мала.
Для практического использования блочных шифров можно
предложить модификацию режима простой замены, за237
( лава 8
ключающуюся в замене части битов блоков открытого текста
их порядковыми номерами в сообщении. Такой подход несколько
снижает скорость передачи информации, поскольку
часть блока перестает нести содержательную информацию.
Но, с другой стороны, при такой модификации одинаковые
блоки открытого текста вследствие различия их порядковых
номеров будут представлены различными блоками шифрованного
текста.
К достоинствам режима гаммирования следует отнести
решение проблемы повторений, возникающих при зашифровании
одинаковых блоков сообщения, поскольку в режиме
гаммирования одинаковые блоки открытого текста преобразуются
в различные блоки шифртекста. Снимается также вопрос
о способе дополнения последнего неполного блока данных,
так как лишние биты гаммы просто отбрасываются. Перестановка
блоков шифртекста также будет обнаружена при
расшифровании. Свойство нераспространения ошибок является
более выраженным: искажение при передаче одного бита
блока приводит при расшифровании в режиме простой замены
к искажению всего блока, а в режиме гаммирования — к
искажению всего лишь одного бита.
Однако оборотная сторона эффекта нераспространения
искажений состоит в том, что появляется возможность целенаправленной
модификации шифртекста и открытого текста с
точностью до конкретного разряда. Кроме того, необходимо
обеспечить уникальность гаммы, что требует для всех сообщений
уникальных синхропосылок (иначе возможны повторения
используемой гаммы).
Чаще блочные шифры используются в режиме шифрования
с обратной связью, когда очередной блок шифртекста
зависит не только от ключа, но и от предшествующих блоков
шифртекста. Гаммирование с обратной связью устойчиво к
перестановкам блоков шифрованного текста и к целенаправленным
модификациям шифртекста. В таких системах отсутствует
проблема последнего неполного блока данных и одно238
Ьлочные системы шифрования
временно снимается острота проблемы обеспечения уникальности
синхропосылки.
Контрольные вопросы
1 . Каковы с точки зрения криптографии преимущества и
недостатки перехода к шифрованию сообщений в алфавитах
большой мощности?
2. Как реализуется предложенный К. Шенноном принцип
“перемешивания” при практической реализации алгоритмов
блочного шифрования?
3. Каковы основные недостатки алгоритма ЭЕ8 и пути их
устранения?
4. Как связан “парадокс дней рождений” с криптографическими
качествами блочных шифров в режиме простой
замены?
5. В каких случаях можно рекомендовать использовать
блочный шифр в режиме простой замены?
6. От каких потенциальных слабостей позволяет избавиться
использование блочных шифров в режимах шифрования
с обратной связью?
239
Глава 9
Поточные системы шифрования
Как отмечалось в гл. 8, класс блочных шифров наряду с
достоинствами имеет определенные недостатки. Один из них
связан с эффектом размножения ошибок, снижающим эксплуатационные
качества шифра. Еще один недостаток блочных
шифров в режиме простой замены связан с возможностью
применения метода анализа “со словарем ”. Такими недостатками
не обладают поточные шифры, осуществляющие
позначное шифрование в алфавитах небольшой мощности.
Кроме того, существующая практика показывает, что пока
лишь поточные шифры обеспечивают максимальные скорости
шифрования. Это важно при магистральном шифровании
больших потоков информации.
Эти, а также многие другие соображения делают поточные
шифры в некоторых ситуациях более предпочтительными,
чем блочные. Перейдем к подробному изучению вопросов,
связанных с поточными шифрами.
§ 9.1. Синхронизация поточных шифрсистем
При использовании поточных шифров простой замены
потеря (или искажение) отдельных знаков шифрованного текста
при передаче по каналу связи приводит лишь к локальным
потерям: все знаки шифртекста, принятые без искажений,
будут расшифрованы правильно. Это объясняется тем, что
алгоритм шифрования не зависит ни от расположения знаков
в тексте, ни от их конкретного вида.
Многоалфавитные поточные шифры также не распространяют
ошибок при искажении отдельных знаков шифрованного
текста, но оказываются неустойчивыми к пропускам
знаков шифрованного текста, поскольку это приводит к не240
I юточные системы шифрования
правильному расшифрованию всего текста, следующего за
пропущенным знаком. Учитывая наличие помех практически
во всех каналах передачи данных, в системах криптографической
защиты, использующих поточное шифрование, приходится
заботиться о согласованном порядке применения преобразований
при зашифровании и расшифровании, другими
словами, решать проблему синхронизации процедур зашифрования
и расшифрования.
По способу решения этой проблемы поточные шифрси-
стемы делят на синхронные и системы с салюсинхронизацией.
Для синхронных поточных шифрсистем выбор применяемых
шифрующих преобразований однозначно определяется
распределителем (см. гл. 3) и зависит только от номера такта
шифрования. Каждый знак шифртекста зависит только от
соответствующего знака открытого текста и номера такта
шифрования и не зависит от того, какие знаки были зашифрованы
до или после него. Поэтому применяемое при расшифровании
преобразование не зависит от последовательности
принятых знаков шифртекста. В этом случае размножение
ошибки полностью отсутствует: каждый знак, искаженный
при передаче, приведет к появлению только одного ошибочно
расшифрованного знака.
Вместе с тем при использовании синхронной системы потеря
знака шифртекста приведет к нарушению синхронизации
и невозможности расшифрования оставшейся части сообщения.
Поэтому для таких систем необходимо предусмотреть
специальные процедуры восстановления синхронности работы.
Обычно синхронизация достигается вставкой в передаваемое
сообщение специальных маркеров. В результате этого
знак шифртекста, пропущенный в процессе передачи, приводит
к неверному расшифрованию лишь до тех пор, пока не
будет принят один из маркеров. Другое решение состоит в
реинициализации состояний, как шифратора отправителя, так
и шифратора получателя при некотором предварительно согласованном
условии.
241
Г лава 9
Примерами синхронных систем являются регистры сдвига
с обратной связью, дисковые шифраторы или шифрмашина
Б. Хагелина С-36 (см. гл. 1).
Поточные шифрсистемы с самосинхронизацией имеют
возможность производить правильное расшифрование и в том
случае, когда синхронизация передающего и приемного шифраторов
нарушается вследствие потери знака шифртекста.
Наиболее распространенный режим использования шифрси-
стем с самосинхронизацией — это (уже знакомый нам) режим
обратной связи по шифртексту, при котором текущее состояние
системы зависит от некоторого числа /V предыдущих
знаков шифртекста. В этом режиме потерянный в канале знак
влияет на N последовательных состояний Посте приема N
правильных последовательных знаков из канала связи состояние
премного шифратора становится идентичным состоянию
передающего шифратора.
§ 9.2. Принципы построения поточных
шифрсистем
В силу ряда естественных причин, связанных с простотой
реализации и необходимостью достижения высоких скоростей
шифрования, наибольшее распространение получили
шифры, осуществляющие побуквенное зашифрование с помощью
некоторого множества подстановочных преобразований
алфавита открытых сообщений. Другими словами, речь
идет об эндоморфных поточных многоалфавитных шифрах
замены (см. гл. 3) с множествами шифрвеличин и шифробозначений,
совпадающими с алфавитом открытых сообщений.
Далее рассматриваемые поточные шифры мы будем предполагать
именно такими.
Для построения многоалфавитного поточного шифра замены
необходимо указать его распределитель (см. гл. 3), определяющий
порядок использования шифрующих преобразований,
и сами эти преобразования, то есть простые замены,
242
I юточные системы шифрования
составляющие данный шифр замены. Применительно к рассматриваемому
случаю правило зашифрования формулируется
следующим образом.
Пусть А — алфавит открытых сообщений, совпадающий
с множествами шифрвеличин и шифробозначений,
{(ра : А -» А} — совокупность из г биекций множества А ,
х = а]а2...а{ — произвольный открытый текст, к е К — выбранный
ключ зашифрования. Пусть
у,(кЯ) = а \к\..а ) к) { а (к) еМ г, у = Ц ) ( 1)
является распределителем, отвечающим данным значениям
к е К, I е N , где у/ : К х N —» И* — некоторое отображение
в множество 1ЧГ = {1,2,..., г} . Тогда правило зашифрования
Ек (х) определяется формулой Ек (х) = у , где
у - ЪХЪ2...Ъ1 и
Ъ] =(Ракк){а} \ У = 1, / . (2)
Таким образом, задача построения рассматриваемого
шифра сводится к выбору множества шифрующих преобразований
{(ра ) и отображения у/, задающего распределитель.
В соответствии со сказанным выше, поточная шифрсистема
представляется в виде двух основных блоков, отвечающих
за выработку распределителя и собственно зашифрование
очередного знака открытого текста. Первый блок вырабатывает
последовательность номеров шифрующих преобразований,
то есть фактически управляет порядком процедуры
шифрования. Поэтому этот блок называют управляющим блоком,
а вырабатываемую им последовательность номеров преобразований
— управляющей последовательностью (или
управляющей гаммой).
243
I лава 9
Второй блок в соответствии со знаком управляющей последовательности
реализует собственно алгоритм зашифрования
текущего знака. В связи с этим этот блок называют шифрующим
блоком.
Под номером преобразования следует понимать некий
набор символов, достаточный для однозначной идентификации
преобразования и удобный с точки зрения практической
реализации шифра. Например, номером преобразования может
быть двоичный вектор заданной длины.
Достаточно, чтобы в каждом такте шифрующий блок
обеспечивал возможность зашифрования лишь текущего знака
а] открытого текста в соответствии с (2). При этом совсем
не обязательно строить целиком подстановочное преобразование
а ^ на всем алфавите А .
Обычно управляющая гамма представляет собой псевдослучайную
последовательность, удовлетворяющую некоторой
рекуррентной зависимости. В общем случае рекуррентная последовательность
(на заданном множестве А ) определяется
формулой
х(/ + т) = / (х(/),...,х(/ + т - 1)), / > О,
в которой / : Ат —> А — некоторая функция от т переменных.
Для получения рекуррентных последовательностей используются
различные датчики псевдослучайных чисел. Наиболее
известным таким датчиком с хорошо изученными свойствами
является линейный конгруэнтный генератор над конечным
кольцом или полем. Закон его функционирования
представляется в виде
х(/ + 1) = а • х(/) + Ъ, / > 0 .
244
/ юточные системы шифрования
Обобщением линейного конгруэнтного генератора являются
конгруэнтные генераторы, определяемые формулой вида
х(/ + 1) = /(* ( /)) , / > 0, (3)
в которой / : Л —> А — произвольное отображение, легко
вычисляемое для любого аргумента. Достаточно полно исследованы
свойства таких генераторов, задаваемых полиномиальными
преобразованиями / .
Изучались также генераторы, определяемые неполиномиальной
рекуррентной зависимостью. Примером является целочисленный
генератор, основанный на 44методе середины
квадратов”, для которого вычисление х(/ + 1) с помощью (3)
сводится к отбрасыванию определенного числа знаков из десятичной
(или двоичной) записи числа х (/)2.
Исследования подобных, а также других генераторов,
определяемых некими алгоритмическими правилами, показывают,
что они уступают по своим (необходимым в криптографических
приложениях) аналитическим и статистическим качествам
рекуррентным последовательностям. Дело в том, что
аналитическое представление преобразований позволяет проводить
более глубокие исследования и строить последовательности
с лучшими криптографическими качествами. В настоящее
время большинство датчиков псевдослучайных чисел,
в том числе реализованных в программных продуктах
ведущих фирм, построены на основе регистров сдвига с линейными
функциями обратной связи, или коротко — линейных
регистров сдвига (ЛРС).
Вид алгоритмов, реализуемых шифрующими блоками поточных
шифрсистем, может изменяться в широких пределах.
При этом требования к свойствам шифрующего блока в значительной
степени зависят от качества управляющей последовательности.
С целью усложнения задачи восстановления управляющей
последовательности по виду применяемого шифрующего
245
( лава 9
преобразования может быть использован способ построения
шифрующего блока, при котором многим различным знакам
управляющих последовательностей отвечают одинаковые
шифрующие преобразования. В таком случае, даже если полностью
известно шифрующее преобразование, криптоаналитик
не сможет однозначно определить управляющую последовательность
и тем самым упростить задачу нахождения
ключей криптографического алгоритма.
Если множество шифрующих преобразований {(ра) достаточно
велико7, то можно обеспечить стойкость шифрования
даже при повторном использовании ключей. Для этого достаточно,
чтобы в множестве {<ра} содержались преобразования,
переводящие любую пару букв открытого текста в любую пару
букв шифрованного текста. Тогда по паре текстов, зашифрованных
на одном и том же ключе, нельзя получить информацию
об открытых текстах, поскольку любой паре букв
шифртекстов может соответствовать произвольная пара букв
открытых текстов.
Следует отметить, что указанные качества шифрующего
блока повышают криптографическую стойкость, но достигаются
за счет избыточности числа простых замен, составляющих
данный шифр замены. Действительно, если исключить
возможность повторного использования ключей и обеспечить
необходимые свойства управляющей последовательности, то
можно ограничиться множеством из |Д| подстановок {<ра} 9
нижние строки которых образуют латинский квадрат. В этом
случае мы приходим к введенному ранее шифру табличного
гаммирования.
Сформулируем ряд требований, обычно предъявляемых к
блокам поточной шифрсистемы, нарушение которых приво7
Как мы уже знаем, такое множество может совпадать с сим
метрической группой подстановок на данном алфавите А .
246
/ юточные системы шифрования
дит к появлению аналитических или статистических слабостей
алгоритма шифрования, снижающих его стойкость.
Требования к управляющему блоку:
— период управляющей гаммы должен превышать максимально
возможную длину открытых сообщений, подлежащих
шифрованию;
— статистические свойства управляющей гаммы должны
приближаться к свойствам случайной равновероятной последовательности;
— в управляющей гамме должны отсутствовать простые
аналитические зависимости между близко расположенными
знаками;
— криптографический алгоритм получения знаков управляющей
гаммы должен обеспечивать высокую сложность определения
секретного ключа.
Требование к шифрующему блоку:
— применение алгоритма шифрования должно носить
универсальный характер и не зависеть от вида шифруемой
информации.
Иногда выдвигается дополнительное требование:
— способ построения шифрующего блока должен обеспечивать
криптографическую стойкость шифра при перекрытиях
управляющей гаммы, в частности при повторном использовании
ключей.
Заметим, что выполнение перечисленных требований является
необходимым, но не достаточным условием криптографической
стойкости поточного шифра.
§ 9.3. Примеры поточных шифрсистем
Шифрсистема А5
А5 — шифрсистема гаммирования, применяемая для
шифрования телефонных сеансов в европейской системе мобильной
цифровой связи 08М (Огоир 8ресга1 МоЪИё). В открытой
печати криптосхема А5 официально не публикова247
I лава 9
лась. Британская телефонная компания передала всю техническую
документацию Брэдфордскому университету. Через некоторое
время детали о конструкции А5 стали просачиваться
в печать и, в конце концов, появились в Пч[ТЕКЛЧЕТ.
Описание алгоритма приведем по работе [Оо197]. Криптосхема
А5 приведена на рис. 34.
Крипт о схема А5
Рис. 34
Пусть / г (х) = //,/ * х 1 — функция обратной связи
1=0
ЛРС/, г =1,2,3. Известно, что г, = 19, г2 - 22, = 23 ,
У! (х) = X19 + х 5 + х 2 + X 4-1,
/ 2(х) = х 22 + х + 1,
/ 3(х) = х 23 + х 15 + х 2 + х + 1 .
248
/ юточные системы шифрования
г —I Пусть 8 1 (0) = (х1 (0)/=о обозначает начальное заполнение,
а х 1 = (х ь (0 )Г=о — соответствующую последовательность
максимального периода 2Г'-1, порождаемую ЛРС, законом
рекурсии
= 1 > г, .
1 = 1
Пусть 5 ,(0 = ($/,/(0)/*=1 обозначает состояние ЛР<^ в
момент (> 0 в схеме с движением “стоп/вперед”, описываемым
ниже, и пусть г, обозначает средний отвод в ЛРС; ,
используемый для управления движением. Известно, что
тх = 10, г2 = 11, = 12 . Тогда управляющая движением
регистров последовательность С(0 = (с(0)^=1 задается формулой
С ( 0 = # 0 1 ^ (/ - 1 ) , *2,г2 - ! ) ’ 53,аз ( ' ~ 0 ) ,
где § — это 4-значная функция от трех двоичных переменных,
такая, что = 0\У ), если при
/< у и к * / , / , и ^ (5 ,,52,53) = (1,2,3), если
Другими словами, знаки управляющей движением последовательности
С(7) определяют, какие регистры сдвигаются в /-
м такте работы схемы. Ясно, что в каждом такте сдвигаются,
по меньшей мере, два регистра. Выходной бит гаммы у(1)
вычисляется как сумма
У(0 = а 1,1 (0 + $2,1 (0 + л3,1 (0> / 2> 1.
249
I лава 9
В системах 08М алгоритм А5 используется для защиты
информации между абонентом и базовой станцией, так что
фактически в сеансе связи двух абонентов шифрование происходит
дважды. Это дает возможность использования атаки
на основе известного открытого текста. Кроме того, следует
отметить, что 64-битовый секретный сеансовый ключ (которым
служит совокупность начальных заполнений ЛРС ) генерируется
с помощью другого алгоритма, исходя из “основного”
(ша51ег) ключа, специфического для каждого пользователя,
и открытого случайного 128-битового ключа, передаваемого
в незащищенной форме с базовой станции абоненту. Тем
самым успешное вскрытие одного или нескольких сеансовых
ключей дает подходы к определению основного ключа пользователя.
Шифрсистема Гиффорда
Д. Гиффорд предложил схему поточного шифра, которая
использовалась с 1984 по 1988 г. агентством АззосгШес! Ргезз.
Криптосхема генератора (см. рис. 35) представляет собой 8-
байтовый регистр сдвига с линейной функцией обратной связи
/ и нелинейной функцией выхода к . Ключом являются
64 бита начального заполнения регистра. Схема реализует
шифр гаммирования.
В 1994 г. Кейном и Шерманом был предложен метод определения
ключа данной криптосхемы, использующий память
объема 218 бит и имеющий сложность 227 элементарных операций,
что существенно меньше сложности тотального перебора
всех 264 начальных состояний. Программа, реализующая
данный метод на сети из 8 станций 8рагс, находила ключ по
одному шифрованному сообщению достаточной длины в
среднем за 4 часа.
250
/ юточные системы шифрования
Рис. 35
§ 9.4. Линейные регистры сдвига
Широкое распространение в криптографических приложениях
линейных регистров сдвига над конечными полями и
кольцами обусловлено целым рядом факторов. Среди них
можно отметить:
— использование только простейших операций сложения
и умножения, аппаратно реализованных практически на всех
вычислительных средствах;
— высокое быстродействие создаваемых на их основе
криптографических алгоритмов;
— большое количество теоретических исследований
свойств линейных рекуррентных последовательностей (ЛРП),
свидетельствующих об их удовлетворительных криптографических
свойствах.
Введем ряд определений.
Последовательностью над полем Р будем называть любую
функцию и: N 9 -> Р , заданную на множестве целых неотрицательных
чисел и принимающую значения в поле.
251
Глава 9
Последовательность и называют линейной рекуррентной
последовательностью (ЛРП) порядка т> 0 над полем Р ,
если существуют константы / 09—9/ т-\ € Р такие, что
«(/ + т)= Ё / • и(/ + у ),/ > 0 .
7=0
ЛРП реализуется схемой линейного регистра сдвига, изображенной
на рис. 36.
Рис. 36
В очередном такте работы регистра значения, содержащиеся
в ячейках его накопителя, умножаются на соответствующие
коэффициенты ( / ^ ) и суммируются, после чего происходит
(левый) сдвиг информации в регистре, а в освободившуюся
крайнюю ячейку записывается вычисленное значение
суммы. Заметим при этом, что операции сложения и умножения
выполняются в поле Р.
Равенство, выражающее зависимость между знаками линейной
рекуррентной последовательности, называют законом
рекурсии, многочлен Р \/х )\ = х т — X! / , ' х } — характери-
7=0
стическим многочленом ЛРП и , а вектор и(о,т — 1) =
252
/ юточные системы шифрования
= (и(0),...,и(т — 1))— начальным вектором ЛРП (или начальным
заполнением ЛРС).
Характеристический многочлен ЛРП и , имеющий наименьшую
степень, называется ее минимальным многочленом,
а степень минимального многочлена — линейной сложностью
ЛРП и .
Линейная сложность ЛРП определяет минимальную длину
линейного регистра сдвига, реализующего данную последовательность.
Периодом последовательности и называется наименьшее
натуральное число для которого существует натуральное
число Л> О такое, что для всех / > 0 справедливо равенство
и(л -+"/ + /)= и(л + / ) .
Из вида закона рекурсии следует, что в случае, когда
Р — конечное поле из д элементов, максимальное значение
периода ЛРП порядка т равно д т — 1. В самом деле, нулевой
начальный вектор порождает последовательность, состоящую
из одних нулей, а число различных заполнений регистра
длины т равно д т.
Последовательности, имеющие максимально возможный
период, получили название линейных рекуррентных последовательностей
максимального периода или просто максимальных
линейных рекуррентных последовательностей.
Значения периодов линейных рекуррентных последовательностей
определяются свойствами их минимальных многочленов.
В частности, для того чтобы линейная рекуррентная
последовательность порядка т над полем из ^ элементов
имела максимальный период, необходимо и достаточно, чтобы
ее минимальный многочлен был примитивным многочленом
[Лид88]. Так называется неприводимый многочлен, корень
которого имеет в мультипликативной группе поля разложения
порядок дт - 1 .
253
Гпава 9
Несмотря на то, что имеется достаточно много критериев
проверки неприводимости многочленов над конечными полями и
методов их построения, доказать то, что заданный неприводимый
многочлен примитивен, удается в исключительных случаях.
Для конечного поля из ^ элементов будем использовать
стандартное обозначение СР (д ) .
Утверждение 1 . Если Р(х) — неприводимый многочлен над
полем СР{2) степени т , и 2т — 1 — простое число, то
Р(х) — примитивный многочлен.
Доказательство. Из неприводимости многочлена Р(х) следует,
что единица поля СР( 2т ) (которое является его полем
разложения) не является корнем этого многочлена. Так как по условию
(2т ~ 1) — простое число, все элементы поля СР(2м) ,
отличные от единицы, имеют в мультипликативной группе этого
поля порядок 2т - 1 . Следовательно, Р(х) — примитивный
многочлен.
Общий подход к построению примитивных многочленов состоит
в построении неприводимых многочленов и непосредственном
вычислении их периодов. Проверка максимальности периода
неприводимого многочлена может бьггь осуществлена с
помощью следующего утверждения, которое приведем без доказательства.
Утверждение 2. Неприводимый многочлен Р(х) примитивен
в том и только в том случае, когда для любого простого чис-
Ч т - \
ла р , делящего - 1 , многочлен х р не сравним с 1 по модулю
многочлена Р (х ) .
Построение примитивных многочленов представляет собой
сложную задачу, решение которой даже в частных случаях сопряжено
со значительными трудностями вычислительного
254
/ юточные системы шифрования
характера. На практике используются таблицы неприводимых
и примитивных многочленов над конечными полями (см., например,
[Неч99]).
Закон рекурсии дает удобный способ вычисления очередного
знака ЛРП через предыдущие, но при изучении ее
свойств более предпочтительной формой задания является
формула общего члена последовательности, представляющая
собой аналитическое выражение члена последовательности в
виде функции от его номера. Рассмотрим этот способ представления
на примере ЛРП над конечными полями с неприводимыми
характеристическими многочленами.
Пусть Р — ОР(ц) и О — поле из элементов, являющееся
расширением поля Р . Тогда функцией “след” из поля
т
<2 в поле Р называется отображение 1г^ (а) :() -* Р вида
В силу свойств конечных полей справедливы равенства
(1Гд (Х)У' = 1гд (х ) .
т т т
1г% (ах + Ъу) = а ■ 1г$ (х) + Ь-(г$ (у), а,ЬеР,
означающие, что функция “след” является линейным
отображением над полем Р .
Лемма 1 . Для любого ненулевого а е Р и любого Ье Р
т
число решений уравнения Iг^ (а- х ) -Ъ равно фп .
Доказательство. Обозначим через N ь число решений
рассматриваемого уравнения. Тогда для любого Ь е Р выполняется
неравенство Ыь < ц т~х, так как цт~х — степень мно255
Глава 9
гочлена /г^ ( а - х ) -Ь9 а многочлен над полем не может
иметь корней больше, чем его степень. С другой стороны, для
т
любого х € Р значение Iг^ (а • х) лежит в поле Р , а значит,
т
х является корнем уравнения 1г^ (а - х) = Ь при некотором
подходящем значении Ь . Следовательно,
Ц К ь = я т.
Ье<2
т_ 1
Полученное равенство (при условии, что N ъ < д для
любого Ъ ) может выполняться только в том случае, если для
всех значений Ь имеет место равенство Ыь — д т ~^. Лемма
доказана.
т-1
Теорема 1. Пусть Р(х) = х т — - х] — неприводи-
7=0
мый многочлен над полем Р степени т , в — корень Р{х) в
поле О . Тогда для ЛРП {^(0} с характеристическим многочленом
Р(х) сугцествует единственная константа а е Р ,
такая, что
т
и(() = 1г« ( а - в 1), /> 0 . (4)
Доказательство. То, что последовательность элементов
поля, заданная формулой (4), является линейной рекуррентной
последовательностью с характеристическим многочленом
Р(х) , следует из равенств
256
I юточные системы шифрования
т-1 т-1
X / , • «0‘ + у) = Е Л ' ‘^ )=
7=0 7=0
/ т - 11 Л
й й ' Х т , -в 1
7=0 у
= /г* (а -0 '-ет) = и(1 + т).
Заметим, что число всех линейных рекуррентных последовательностей
с характеристическим многочленом Р(х)
равно ^ т . Ровно столько же существует и различных констант
из поля ^ . Из количественных соображений для завершения
доказательства теоремы достаточно показать, что при
разных константах а из поля ^ будут получаться различные
последовательности.
Если для двух различных констант ах и а2 выполняется
равенство
т , т
(а1 • в ) = *г$ (а2 - в ) , />0 ,
то, пользуясь линейностью функции след, получаем соотношение
т
*гЦ ((°1 ~о2)'в ) = 0, />о,
которое противоречит лемме 1. Теорема доказана.
Пусть и — ЛРП максимального периода над полем Р и
у (а 1,...,а к) — число решений системы уравнений
257
Гпава 9
I и(г + у) = а ] , ) = 1 ,к,
[ 0<1<дт - \ ,
то есть число появлений мультиграммы а 1,...9а к на периоде
последовательности и .
Утверждение 3. Пусть Р(х) — примитивный многочлен
степени т над полем Р и в — корень Р(х) в поле ^ .
Тогда любая ненулевая мультиграмма {а\,...9а к ) встречается
на периоде ЛРП и ровно
у ( а 1,...,а 1с) = дт~к
раз, а число вхождений нулевой мультиграммы на единицу
меньше.
Доказательство. Так как порядок элемента в равен
— 1 , то множество { в 1, / = 09цт —2} содержит все ненулевые
элементы поля (). Поэтому из представления знаков
ЛРП и в виде
“(О = *г%т (а-в1), аеР,
следует, что значение у (а 1,...,а к) равно числу ненулевых
решений в поле <2 системы уравнений
/ юточные системы шифрования
Пусть 8{,...,ет — базис поля ^ , рассматриваемого как
векторное пространство над полем Р . Тогда последняя система
эквивалентна следующей системе линейных уравнений
от т переменных над полем Р :
т ■ ■ ■ /й *
(в} •ев) = а] ,
‘ ^=1
у = 1 ,к.
Покажем, что ранг этой системы линейных уравнений равен
к . Предположим, что между строками матрицы системы
существует нетривиальное линейное соотношение с коэффициентами
:
^ Г (г^т (0 1 -е, ) = 0, 5 = 1,т.
ы
Тогда для любого значения 5 = 19т выполняется соотношение
( е , - ^ с г в 1) = 0.
/=1
к
Обозначим 2 = ^ ^ с ( - в 1 . Тогда для любого набора
1=1
с1\,..., с1т получаем равенство
259
Глава 9
т т
о - 1 Х - ^ ) = 0 ’
5=1
ат
из которого следует, что 1г^ (2 • х) = 0 для любого л; е Р .
Согласно лемме 1, полученное равенство возможно только
в случае, когда 2 = 0, что, в силу неприводимости многочлена
Р(х) и условия к < т , означает, что сх = ... = ск = 0 .
Таким образом, ранг системы линейных уравнений равен к , и
требуемое утверждение вытекает из известных результатов о
числе решений систем линейных уравнений над полем. Утверждение
доказано.
Представленные результаты показывают, что линейные
рекуррентные последовательности над полем позволяют
обеспечить первые два из трех требований к псевдослучайным
последовательностям, используемым при построении
управляющих блоков поточных шифрсистем. За счет выбора
закона рекурсии можно гарантировать достаточную величину
периода получаемой псевдослучайной последовательности и
хорошие статистические качества. В самом деле, ее период
совпадает с числом всех ненулевых векторов длины, равной
степени минимального многочлена ЛРП, и каждый их этих
векторов встречается на периоде последовательности в точности
один раз.
Вместе с тем аналитическое строение ЛРП оказывается
очень простым. Для определения начального вектора по некоторому
отрезку последовательности достаточно решить несложную
систему линейных уравнений. Поэтому при использовании
линейных регистров сдвига в криптографических
приложениях необходимо предусматривать процедуры, повышающие
сложность аналитического строения вырабатываемых
ими рекуррентных последовательностей.
260
I юточные системы шифрования
§ 9.5. Алгоритм Берлекемпа — Месси
Основным параметром, характеризующим сложность
аналитического строения псевдослучайной последовательности,
является ее линейная сложность, то есть степень минимального
многочлена последовательности. Фактически минимальный
многочлен определяет закон рекурсии линейногс
регистра сдвига минимальной длины, с помощью которого
может быть получена данная псевдослучайная последовательность.
Любая периодическая последовательность может рассматриваться
как линейная рекуррентная последовательность
Поэтому для любой периодической последовательности существует
некоторый линейный регистр сдвига, который ее
гчрабатывает. Если элементы, образующие период последовательности,
выбираются случайно, то степень минимального
многочлена такой последовательности близка к величине ее
периода. Поэтому линейная сложность может рассматриваться
как характеристика сложности аналитического строенш
псевдослучайной последовательности. Низкую линейнук
сложность имеют слабые в криптографическом отношени*
последовательности. Вместе с тем высокая линейная сложность
не гарантирует отсутствия других недостатков. Напри
мер, для генерации последовательности, период которой име
ет вид (0,0,...,0,1) , требуется линейный регистр, длина которого
совпадает с длиной периода этой последовательности
однако ясно, что считать эту последовательность случайно?
нельзя.
Эффективным методом нахождения линейного регистр*
сдвига минимальной длины, генерирующего заданную после
довательность, является алгоритм Берлекемпа — Месси. При
ведем модификацию этого алгоритма, предложеннук
А. А. Нечаевым [Киг95].
Пусть Р — некоторое поле, е — единица поля Р . Обо
значим через и начальный отрезо!
26
Гпава 9
произвольной последовательности и элементов поля Р . Будем
говорить, что многочлен
т- 1
О(х) = х т - • х-1 е Р[х]
у=о
вырабатывает отрезок и{о,1 — 1^, если
т- 1 __________
и(г + т) = -и(/ + у) , / = 0 , / - т - 1 ,
у=о
то есть если данный отрезок последовательности является отрезком
некоторой линейной рекуррентной последовательности
с характеристическим многочленом Сг(х) .
Алгоритм Берлекемпа — Месси строит многочлен С (х )
наименьшей степени, вырабатывающий отрезок
Приведем одну из многочисленных модификаций алгоритма
со сложностью, оцениваемой величиной 6т 2(1 + о(1)) операций
поля Р .
Определим операцию умножения последовательности на
п
многочлен. Для произвольного многочлена Н(х) = • х ]
7=0
и последовательности V положим Н{х) • V = м>, где
>К0 = + г' ^ ° -
у=0
Будем говорить, что многочлен С(х) степени л? вырабатывает
1>т знаков последовательности и , если выполняется
равенство
262
I Юточные системы шифрования
С(х) -и = V = (0,...,0,у(/ - т ) , . . . ) ,
1-т
то есть если первые 1 — т знаков последовательности V рав
ны нулю, а следующий за ними отличен от нуля.
Для многочлена О(х) е Р \х ] степени т и последова
тельности и введем параметры 1и(С) и ки(С) =
= 1и (О) - т е N и {0,+оо}, где 1и (О) — число знаков после
довательности и, вырабатываемых многочленом 6?(х). Ясно
что ки(С) — максимальное число первых подряд идущю
нулей в последовательности Сг(х) • и (либо оо).
Будем индуктивно строить последовательность много
членов Со(х), (^ (х ),... неубывающих степеней
О = т0 < т{ < т2 <... .
Начальные условия: С0(х) — е, т0 = 0.
Этап 1. Если
С 0 ( х ) - и = и = и0 = (0!^ Д ! 1 0 (*0 к0 =к и (С),
ко фО
то полагаем
С1(х) = х к°*1 - и0(к0 +Х) -щ(к0У х - хк° -С0( х ) 9 тх =к0+1.
Если Ох (х) • и = 0, то есть если ки (О,) = оо, то Сх (х) —
искомый минимальный многочлен ЛРП и . В противном слу
чае строим С2 ( х ) .
Этап / + 1. Пусть многочлены С0(х), .. .,С{( х ) уже по
строены, и степень бе§ С (х) многочлена О/ (х) равна т]
причем 0 = т0 <тх <... < . Пусть выполняются соотноше
ния
26
Глава 9
С ) (х)-и = и] = (О^^Д и} {к] ),...),
к] 5*0
к} = М С/ ) < 00>
1и {С^ )-к^■\-т^< +оо .
Определим число Л1 = з(1) так, чтобы выполнялись условия
т1 - т( ] =... - т^+х >т% (такое 5 найдется, так как
тх > т0). Положим
0(+х ^ = 1°{ (х) - х к5~к‘ ■ Щ (к{) • и3 (к, )-1 • Ох (х), если к, < к , ,
\ х к(~к* • 0 ( (*) - и, (к( ) • и5(к8 )-1 • 0 5 (*), если к{ >к3.
Если С{+1( х ) -и = 0, то нужный многочлен построен. В противном
случае строим С(+2( х ) .
Теорема 2. Если и — линейная рекуррентная последовательность
над полем Р с минимальным многочленом
Р(х) степени т , то Р(х) = СТ (х ) для некоторого подходящего
значения т < 2т - 1 — к0.
Доказательство теоремы носит технический характер и
заключается в непосредственной проверке двух условий: каждый
следующий многочлен в предложенном алгоритме вырабатывает
больше знаков последовательности и , чем предшествующий;
любой многочлен, вырабатывающий столько же
знаков последовательности и , что и многочлен О} ( х ) , имеет
степень не меньше, чем степень многочлена О} (х ) .
264
11оточные системы шифрования
§ 9.6. Усложнение линейных рекуррентных
последовательностей
Алгоритм Берлекемпа—Месси позволяет для каждой ли
нейной рекуррентной последовательности построить выраба
тывающий ее линейный регистр сдвига минимальной длины
Однако при создании стойких криптографических алгоритмо]
необходимо гарантировать определенную величину линейно*
сложности не для одной конкретной ЛРП, а для целого класс!
псевдослучайных последовательностей, получаемых при раз
личных ключах. При этом, как правило, мощность класса рас
сматриваемых последовательностей бывает настолько велика
что применить алгоритм Берлекемпа—Месси к каждой после
довательности не представляется возможным. Поэтому важ
ной криптографической задачей является построение целы:
классов псевдослучайных последовательностей с высокой ли
нейной сложностью.
Описанные выше свойства линейных регистров сдвиг
показывают, что, несмотря на достаточно большой период 1
хорошие статистические качества, линейные рекуррентные
последовательности имеют очень простое строение. Поэтом;
в криптографических приложениях используют различны
способы усложнения аналитического строения линейных ре
куррент.
Фильтрующие генераторы
Первый способ заключается в применении к элемента/
линейной рекуррентной последовательности некоторой функ
ции / (см. рис. 37) (Р(х) — характеристический многочлеь
определяющий закон рекурсии ЛРС).
И
Глава 9
Р ЛРС Р(х )
Рис. 37
В литературе подобные узлы усложнения ЛРП получили
название фильтрующих генераторов. Их результирующей
последовательностью является нелинейно “фильтрованное”
содержимое регистра сдвига. “Фильтрующая” функция /
должна выбираться так, чтобы выходная последовательность
имела распределение, близкое к равномерному распределению,
и высокую линейную сложность.
Известно [Лид88], что любая функция над конечным полем
может быть задана некоторым полиномом. Поэтому при
изучении фильтрующих генераторов достаточно рассмотреть
только полиномиальные усложнения линейных рекуррент.
Пусть и — линейная рекуррентная последовательность
над полем Р из ^ элементов с характеристическим многочленом
Р(х) степени т , и функция имеет вид:
Тогда выходная последовательность фильтрующего генератора
определяется следующим равенством:
0< /1 <...</5< т
0< к^< <?-1
О < 8 <т
266
/ юточные системы шифрования
у (/) = /(м(/),...,м(/ + т)) =
X Г ,*1 + _1)*‘ и(/ + /в - 1)*в (5)
0< /|< <13<т
0< к^ <<7-1
1<5<Ш
Рассмотрим случай, наиболее интересный с практической
точки зрения, когда Р( х) — примитивный многочлен степени
т над полем Р . Поскольку, согласно (5), усложненная последовательность
является суммой произведений некоторых
линейных рекуррентных последовательностей, отличающихся
друг от друга сдвигами, продемонстрируем методику изучения
строения таких последовательностей на примере доказанной
А. А. Нечаевым теоремы о произведении линейной рекуррентной
последовательности на ее сдвиг.
Теорема 3. Пусть и — линейная рекуррентная последовательность
над полем Р = ОР(д) характеристики р с
примитивным характеристическим многочленом Р(х) степени
т , элементы которой задаются равенством
и { г ) ~ ( г { а - в 1), где в — корень Р(х) в поле СР(дт) из
дт элементов, а е СР(дт). Тогда элементы последовательности
V, задаваемой равенством
у(/) = и(7) • и(/ + к \ г > О,
удовлетворяют соотношению
у ( / ) = / г / ” а 20 *0 2' + ' % * ] " ' * + в / > О,
5=1
267
Глава 9
где Я: , т =
\Л, если т = 2Л,х = Л;
\т в остальных случаях.
Доказательство. Непосредственно проверяется справедливость
следующих равенств:
т- 1 „I т- 1
у(/) = и(г) • м(/ + к) = ]Г (а в 1) У^ ( а в кв 1) =
;=о 5=0
т-\т-\
= ^ ^ { а в 1( а в к9 У У =
5=0 1=о
/л -1 т - 1 _/
5 = 0 /=0
/И-1 О е
= 5 > ( ( а 0 ' ) |+<? ).
5=0
Для завершения доказательства теоремы достаточно
заметить, что если т = 2Л + 1 , то
• 1 . т-5 ъ„т-8
1г (а в 1)ис>
\
а если т - 2 /1 , то
= Гг ( а в 1)1+С}* .0*1, 5 = 1,Я,
= *г (о0 ') |+95 .0* , 5 = 1, Л-1,
при этом справедливо равенство
268
I юточные системы шифрования
й / " ( а 0 ,') 1+*А • в кч*' =1г%Л ( ав‘)]+йЯ - { в ^ + в к ).
Теорема доказана.
Следствие. Если в условиях теоремы 0 <к <т, т> 8,
то
Л
л/У(^)=ПА/*(дс)'
5=0
где М 8( х )— минимальный многочлен элемента над
полем ОР(д).
Доказательство. Непосредственно проверяется, что
при к <т порядок огс1 в к элемента в к удовлетворяет
неравенствам
пт _ \ ™
оЫ в к >1 -> 2 ( д 2 - 1),
т
и, следовательно, для всех з = выполняется условие
в**3 Ф0.
Заметим, что в этом случае линейная сложность последо-
т(т +1)
вательности V равна ------ .
В общем случае описание строения минимального многочлена
линейной рекуррентной последовательности удобно
проводить, исходя из свойств его корней.
Для примитивного многочлена Р(х) с корнем в обозначим
через Е ^ \ х ) многочлен вида
Р (г)(х)= Ц ( х - в к ) ,
Гд(кУ=Г
269
Глава 9
где УУч(к) обозначает #-ичный вес числа к , то есть число
ненулевых цифр в #-ичной записи числа к. Положим
Р <г>{х) = 1 \ р С - \ х ) .
к=о
Утверждение 4. Пусть и — линейная рекуррентная последовательность
над полем СР{д) с примитивным характеристическим
многочленом Р(х) степени т , в — корень
Р(х) в СР(дт). Тогда ранг последовательности V , полученной
из последовательности и усложнением с помощью
функции / ( х , хт ), с!е§ / ( х ) < г , не превосходит
с1е§ /г<г>(х), причем многочлен Р <г>(х) является характеристическим
многочленом последовательности V .
Доказательство. Рассуждая аналогично доказательству
теоремы 3 и подставляя выражения членов последовательно-
/
сти V через функцию “след” в произведение и(г + * * )* .
*=1
получаем, что каждый знак указанного произведения представляется
в виде суммы значений вида
с.0 Яп+я12+-+я'<* = с .0 5 (6)
где с — некоторая константа из поля ОР( дт),
/
О < гя < т, з = 1, с/, с1 = У "1[гь <г .
*=1
270
/ юточные системы шифрования
Следовательно, корни минимального многочлена указанного
произведения последовательностей имеют вид:
в ч '1 +ч '2 +...+Я Ч = в ^ , 0 < у , < ? ,
т-1
причем у, < д < г . А поскольку последовательность
КО = /(К0> -..,К * + т -1 )), / > О,
представляется в виде суммы последовательностей вида (6),
то минимальный многочлен ту(х) делит Р <г>(х). Откуда
следует оценка ранга ЛРП V .
Таким образом, несмотря на то, что фильтрованную последовательность
нельзя получить с помощью сдвигового регистра
с линейной обратной связью той же длины, что и исходный
регистр, ее всегда можно получить с помощью регистра
сдвига большей длины.
Заметим, что степень многочлена Р^г\ х ) равна числу
целочисленных наборов (/0,...5/да_]) , таких, что 0
т- 1
Уу‘, = г , и представляется в виде
у=0
к> О
Данная величина является верхней оценкой линейной
сложности класса выходных последовательностей фильтрующего
генератора, полученных при различных начальных
заполнениях регистра сдвига. Задача получения нижних оценок
ранга усложнений линейных рекуррент представляется
существенно более сложной. В частности, даже если ограничиться
классом последовательностей, полученных с помощью
271
Гпава 9
функций усложнения фиксированной степени нелинейности,
то в этом классе будут содержаться рекурренты, линейная
сложность которых меняется в диапазоне от т до
Ащр<г>{х) .
Таким образом, для получения псевдослучайных последовательностей
с высоким уровнем линейной сложности
функция усложнения фильтрующего генератора должна
иметь достаточно высокую степень нелинейности.
Комбинирующие генераторы
Второе направление синтеза псевдослучайных последовательностей
с высокой линейной сложностью связано с использованием
в одной схеме нескольких линейных регистров
сдвига. Генератор псевдослучайных последовательностей,
реализующий усложнение нескольких линейных рекуррент с
помощью одной общей функции усложнения, получил название
комбинирующего генератора (см. рис. 38 ).
Рис. 38
Рассмотрим один частный случай комбинирующего генератора,
когда функция усложнения / имеет степень нелинейности
/, и ее представление свободно от квадратов:
/(Х\ ...х( ) = Х X С ,. ■*/, ••••• х1к • (7)
к=1 1</| <...<1к <1
272
/ юточные системы шифрования
Теорема 4. Пусть и{ и( — ЛРП максимального периода
с примитивными характеристическими многочленами
(.г),..., Р{(х) над полем СТ(д) попарно взаимно простых
степеней: п8 = (1е§ /\Д х ), {п8, п ^ ~ 1 для 8Ф у\ л*, у = 1 ,/.
Тогда для функции усложнения вида (7) линейная сложность
последовательности V вида
40 = /(«1 (0»«2 (0,-, И/ СО)» г * о
равна
^ ^ ГК > 00
&=1 1< /] <...</^</ /=1
_ ГО.если С.-, =0,
где С, , = , '1" 'А л
1~* [ 1 ,еош * 0.
Доказательство. Согласно (7), последовательность V
представляется в виде суммы последовательностей вида
Л-7 к ' иЛ 0") ‘ и./2 0) ■ ‘ 0)> С71_ ]к ^ 0 , (9)
где 1 < к < 1 , 1 < у, < ... < у* < ( .
Если в произведение (9) вместо элементов линейных рекуррентных
последовательностей подставить их выражения
через функцию “след”, то получится представление в виде
суммы последовательностей вида с (, аД чЙ ■ Л )и , где
<х}— корень многочлена Р} (х) в поле СР(дт),
т = щ • п 2 •... -п5 , 0 < 1В < пк , 5 = \ , к , с — некоторая
константа из поля СР{дт ) .
273
А лава 9
Отсюда следует, что корни минимального многочлена
1\ 1к
произведения (9) имеют вид а ^ , 0 < /5 <п^ ,
з = 1, к . Непосредственно проверяется, что все такие элементы
являются попарно различными и могут быть представлены
г
в виде (а^ при подходящем значении г . В силу
свойств многочленов над конечными полями отсюда следует,
что минимальный многочлен произведения (9) является неприводимым
многочленом степени •п ^ .
Можно заметить, что при различных наборах индексов
1 < }\ <...< 1 <к<! , минимальные многочлены для последовательностей
вида (9) попарно взаимно просты, поскольку
они неприводимы и имеют различные степени. Таким
образом, минимальный многочлен последовательности V равен
произведению этих неприводимых многочленов, а линейная
сложность последовательности V описывается формулой
(6). Теорема доказана.
Композиции линейных регистров сдвига
Рассмотрим еще один тип генераторов, представляющий
собой композицию линейных регистров сдвига. Так называется
схема, в которой выход одного из регистров подается на
вход другого регистра (см. рис. 39).
Р (х ) 0 ( х )
Р и с .39
274
/ юточные системы шифрования
Функционирование такой схемы описывается следующим
образом. Пусть V — ЛРП, вырабатываемая первым регистром
сдвига, закон рекурсии которого определяется характеристическим
многочленом Р ( х ) .
Пусть задано начальное состояние второго регистра сдвига,
закон рекурсии которого определяется характеристиче-
/77-1
ским многочленом С (х ) = х т • Тогда выходная по-
следовательность композиции регистров сдвига задается соотношением
/77-1
М? + т) = ] Г М‘ + ^)8^ + у(0> г^О.
Непосредственно из определения композиции регистров
сдвига вытекает, что минимальный многочлен выходной последовательности
делится на минимальный многочлен последовательности
V и делит произведение Р( х)-С( х ) .
Схемы с динамическим изменением закона рекурсии
Рассмотренные способы усложнения линейных рекуррент
объединяет общая идея повышения линейной сложности исходных
последовательностей за счет применения дополнительных
функций усложнения. При этом законы функционирования
самих регистров остаются неизменными.
Альтернативный способ усложнения ЛРП состоит в изменении
закона рекурсии в процессе работы криптографического
алгоритма. Привлекательным представляется использование
нелинейной логики в цепи обратной связи регистровых
преобразований. Однако общая теория подобных схем еще
недостаточно разработана, в связи с чем трудно гарантировать
необходимые свойства соответствующих последовательностей.
275
Один из путей построения подобных схем основан на динамическом
изменении закона рекурсии линейного регистра
сдвига.
Рассмотрим, например, вопрос о строении псевдослучайной
последовательности, получаемой с помощью линейного
регистра сдвига, закон функционирования которого меняется
в зависимости от четности номера вырабатываемого знака.
Рассмотрим два многочлена А(х) = х т + х ] ,
В(х) = хт + ' ^Ъкх к степени т и последовательность V,
удовлетворяющую условиям:
т- 1
у(2/ + т) = - ] Г а} • у(2/ + у),
7=0
т-1
у(2/ + 1 + т) = у(27 + 1 + * ) , / > 0.
к=0
I лава 9
Ясно, что в четных тактах закон рекурсии последовательности
V определяется характеристическим многочленом
А(х) , а в нечетных тактах -
ном В(х).
Образуем многочлены
следующим образом:
Л(0)Ск) = ^ а 2]х 2],
7^0
В{0\ х ) = ^ Ь 2]х 2^
7-0
- характеристическим многочле-
А(0)(х), Л0)(х), В(0)(х), В0)(х)
^ 0)(х) = ' ^ а 2у+1х 2-/+\
7^0
Я(1)(*) = 2 > 2у+1* 2у+1-
276
/ юточные системы шифрования
Несложно проверить, что получаемая в результате последовательность
V является линейной рекуррентной последовательностью
с характеристическим многочленом
Н(х) = А{1)(х)В{1)(х) - А {0)(х)В{()\ х).
К классу генераторов с динамическим изменением закона
рекурсии относятся также линейные регистры сдвига с неравномерным
движением информации. Так называются регистры,
для которых число тактов работы до получения (/ + 1)-го
знака выходной последовательности зависит либо от значения
числа г , либо от состояния регистра в такте /. Получаемая в
результате последовательность будет некоторой выборкой с
переменным шагом из исходной ЛРП, вырабатываемой линейным
регистром сдвига.
В одном из возможных вариантов значение шага выборки
меняется в соответствии с некоторой последовательностью
периода /. В этом случае удается описать минимальные многочлены
получаемых псевдослучайных последовательностей
[Оо188].
Теорема 5. Пусть — набор из / > 2 чисел
/-1
множества 0 ,ф1 — 2 и В = ^ с^^ . Пусть при г - к ' 1 - ^ г
7=0
элементы последовательности V задаются формулой
г-1
(с0 ^ ),
где с — ненулевой, а в — примитивный элементы поля
&Р(цп). Пусть, кроме того, простые делители числа I де-
277
Глава 9
лят
д - - \
■, но не делят (дп — 1,0 ) . Пусть, наконец,
( Ф -Ю )
цп = 1 (тос14), если I кратно четырем. Тогда минимальный
многочлен М у (х) последовательности V имеет вид
Му (х) = Р(х(), где Р(х) —минимальный многочлен элемента
в ° .
т
Доказательство. Пусть Р(х) = • Тогда
5=0
Р(х*) = • Умножая последний многочлен на после-
5=0
довательность V и полагая г = к( + г , получаем:
№ / )у ](/)=№ ')у ](^ + г )=
т т
=^ / А {+А =^ / А к(+г+ш)=
5=0
т
5=0
5=0
г-1
171 / л с(^, +зй
= % Г , - « ( ( с в г* ) =
5=0
г-1
т
= 1Г,‘1" с в ( ] Г / 50 ’ ° )
5=0
= 0 .
278
/ юточные системы шифрования
Отсюда следует, что многочлен Р(х1) является характеристическим
для последовательности V . Кроме того, в условиях
теоремы, он является неприводимым. Это следует из
свойств неприводимых многочленов над конечными полями
[Лид88]. Таким образом, Р(х1) является минимальным многочленом
последовательности V , что и требовалось доказать.
Схемы с элементами памяти
Дополнительные возможности для усложнения ЛРП открывает
использование в криптографических алгоритмах элементов
памяти.
Один из наиболее широко известных классов датчиков
псевдослучайных чисел, построенных с использованием памяти,
составляют генераторы Макларена—Марсалъи. Принцип
работы таких генераторов в самом общем виде можно
сформулировать следующим образом.
Пусть имеются три последовательности и массив памяти.
Будем записывать элементы первой последовательности в память
по адресам, которые определяются элементами второй
последовательности. Элементы выходной последовательности
получаются при считывании значений, хранящихся в массиве
памяти, в соответствии с элементами третьей последовательности.
Таким образом, первая последовательность определяет,
какие знаки заносятся в память, вторая последовательность
управляет процессом записи этих элементов в память, а третья
— процессом считывания из памяти элементов выходной
последовательности.
Рассмотрим частный случай, когда процессами записи и
считывания управляет одна и та же последовательность. Схема
работы такого генератора изображена на рис. 40.
279
Глава 9
Ро
1 *
1’
Р<- 1
Рис. 40
Пусть и и V — последовательности над полем Р , а выходная
последовательность у вырабатывается с использованием
<7 ячеек памяти К0,...9КЧ_}. Если — заполнение
у -й ячейки памяти перед началом / -го такта работы схемы,
то преобразование информации в / -м такте описывается формулами
г (0 = Лу(/)(0 »
Г К, (/), если /' * у(/),
[«(/), если ] = у(/>-
Таким образом, последовательность V определяет адреса,
по которым в память записываются элементы последовательности
и.
Рассмотрим вопрос о периодах выходных последовательностей
генератора Макларена—Марсальи указанного типа.
Пусть последовательность и имеет период г , а адресная
последовательность V принимает значения 0Д,...,д--1 и
имеет период (. Начальное заполнение памяти
/?о(0),...,Т?^_1(0) выбирается произвольно.
Пусть /0 — такое наименьшее натуральное число, что для
любого к е {0,1,..., # - 1} существует / е 0, ^ такое, что
280
/ юточные системы шифрования
у(Т) = к . Другими словами, через /0 тактов работы схемы
память будет заполнена только элементами последовательности
и .
В дальнейших рассуждениях будем рассматривать работу
схемы, начиная с такта /0 + 1 .
Теорема 6. Пусть т — период последовательности и ,
/ — период последовательности V, причем (г,/) = 1 , (<т.
Тогда для значения периода Т выходной последовательно-
/ -
сти у выполняется равенство Т=тз, где 5 = — и а < е е .
с/
Доказательство. Для />/0 определим параметры /, равенствами
= т т { / € ТУ : у(/-/)^Ч0 } •
Тогда у (г) = и{1 - ). Несложно заметить, что для любых значений
/ и у выполняются соотношения
гО'+у‘0 = ^(/+у/) О'+У0 =**/) 0' +у'0 = «О' +Л- 1 () •
Таким образом, каждая регулярная выборка с шагом I из
последовательности у совпадает с некоторой регулярной выборкой
с шагом I из последовательности и . Отсюда и из условия
(г,/) = 1 следует, что г делит Т .
С другой стороны, для любого / справедливы равенства
у(1 + т() = ^ 0+г() (/' + г 0 = Я„(1) (/ + П ) = и(1 + т {- 1,) =
= м ( / - / , ) = (0 = п о следовательно
, Т — Т8, где .V | / .
281
Гпава 9
Пользуясь условием периодичности и определением величин
/,, для любого / > /0 получаем, что
7(г + 7Г5) = х (/) = мО'-/;),
г (1 + /Т з) = и(/ + уг 5 - /|+уг,) = и{1 - /,+уг,).
Так как (г,/) = 1, то из условия и(г - /,) = и(г - /,+ ), 7^0,
следует, что для любых значений ^ , /2, таких, что /, е 0,^ — 1 ,
/2 е 0, г — 1 , выполняется равенство
И(*‘2 -*»,) = И(*2 "Л + ^ ) -
Отсюда, с учетом неравенства / < г, получаем, что
^1 ~ ^ \ +Р
для /, е 0, / - 1 .
Это означает, что все регулярные выборки с шагом я из
последовательности V, начинающиеся с одного и того же
элемента с е 0,д - 1 , совпадают. Тогда период любой выборки
из последовательности V равен числу различных элементов
из множества { 0, 1,..., д - 1 }, встречающихся в ней.
Будем говорить о выборке с шагом 5 из последовательности
V , начинающейся с элемента у(г) как (/,5) -выборке.
Обозначим подмножество элементов множества
{ 0, I,...,# - 1 } , встречающихся в фиксированной ( / » -
выборке, через 5/7(7» , а его мощность через к,. Множество
5/7(7» назовем носителем (/,5*)-выборки. Заметим, что либо
5р(/,л1) = либо 5/7(7» п 5/7( у » = 0 , /,у е »
282
/ юточные системы шифрования
Будем считать, что первые г выборок (г < л*) имеют различные
носители, а любая из оставшихся 5- г выборок совпадает
с одной из первых г выборок. Тогда
^ = к^ +к2 + ... + кг Д > 1 , / е 1, г .
Так как период / последовательности V равен
5• НСЩА^,к2 кг) , то для получения нижних оценок периода
выходной последовательности у остается найти верхнюю
оценку величины с1 = НОК(^ Д 2,...ДЛ).
Очевидно, что НОК (кх, к2 кг) < к{ -к2.-. .якг9 откуда
Г Г
Таким образом, с/ < Максимум функции
\ г ;
/ \
/ ( х )= ~ действительного переменного на отрезке [1,я]
\ х )
достигается при х =— и максимальное значение й равно еч/е.
е
Теорема доказана.
§ 9.7. Методы анализа поточных шифров
Рассмотрим некоторые методы анализа поточных шифр-
систем на примере шифров гаммирования.
В первую очередь необходимо исследовать вероятностные
характеристики гаммы. Как мы уже знаем (см. гл. 6),
имеются подходы к получению оценок вероятностей элементов
неравновероятной гаммы по шифртексту, которые можно использовать
при бесключевом чтении.
283
I лава 9
Второй подход связан с попытками линеаризации уравнений
гаммообразования, то есть сведения задачи нахождения ключей
криптографических алгоритмов к решению некоторой системы
линейных уравнений.
При таком подходе определяющую роль играет линейная
сложность исследуемых последовательностей. Значение линейной
сложности определяет размеры системы линейных уравнений,
которую надо решить для определения ключа по известной
шифрующей гамме. Поэтому линейная сложность определяет
эффективность криптоатаки на основе известного открытого текста
для шифров гаммирования в классе методов линеаризации.
Это обусловливает актуальность разработки методов построения
псевдослучайных последовательное гей с высокой линейной
сложностью.
К вопросу о статистических зависимостях в шифрующей
гамме примыкают методы анализа, основанные на наличии у
функции усложнения хороших приближений в классе линейных
функций. Примером отображений, не имеющих линейных статистических
аналогов хорошего качества, является класс бент-
функций.
В случае наличия у функции усложнения линейного приближения
криптоаналитик может заменить исследуемую схему схемой
с линейной функцией усложнения. Если усложнению подвергалась
линейная рекуррентная последовательность, то при такой
замене результирующая гамма является суммой линейной
рекурренты и некоторой случайной последовательности с “завышенной”
вероятностью появления нуля. Тем самым задача сводится
фактически к возможности определения ключа по “искаженному”
выходу линейного регистра сдвига. Если число искажений
невелико, то их появление не оказывает существенного
влияния на сложность определения ключа.
Отметим, что функция усложнения может обеспечивать высокий
уровень линейной сложности и хорошие статистические
качества результирующей гаммы (например, равновероятность
появления ее элементов), но при этом она может иметь прибли284
/ юточные системы шифрования
жение в классе линейных функций с большой вероятностью совпадения
значений, что сводит на нет перечисленные положительные
качества.
При оценке криптографических качеств поточных шифров,
помимо алгебраических и статистических свойств шифрующей
гаммы, необходимо учитывать также наличие между знаками
гаммы зависимостей комбинаторного характера. Например, при
использовании в качестве гаммы линейной рекуррентной последовательности
с малым числом ненулевых коэффициентов в законе
рекурсии может иметь место ситуация, когда значительное
число знаков гаммы зависит лишь от небольшого числа знаков
ключа. Если такая ситуация имеет место, то криптоаналитик получает
возможность проверки гипотез о значениях части ключа,
основываясь на статистических свойствах открытых сообщений,
что является несомненной слабостью соответствующего алгоритма
шифрования.
Таким образом, при создании криптографически стойких поточных
шифрсистем необходимо учитывать возможности применения
криптоаналитиком всей совокупности статистических, аналитических
и комбинаторных свойств используемых преобразований.
При этом дополнительные трудности создают постоянно
возрастающие возможности вычислительной техники, позволяющие
провести экспериментальные исследования тех характеристик
поточных шифров, которые не удается изучить теоретически.
В связи с этим необходимо подчеркнуть, что приведенные в
данной книге требования к поточным шифрам являются необходимыми,
но далеко не достаточными для создания стойких шифров.
Вывод о криптографической стойкости конкретного шифра
может быть сделан только на основе его комплексных исследований,
проведенных с привлечением квалифицированных специа-
листов-криптографов.
285
\лава 9
Контрольные вопросы
1. В чем заключаются достоинства и недостатки систем поточного
шифрования по сравнению с блочными шифрами?
2. Почему возникает проблема синхронизации поточных шифров?
3. Что с точки зрения криптографического алгоритма определяет
управляющий блок?
4. Какой необходимый минимум функциональных возможностей
должен быть заложен в шифрующем блоке?
5. За счет чего можно обеспечить стойкость алгоритма шифрования
при повторном использовании ключей?
6. Какие причины обусловили широкое использование линейных
регистров сдвига в качестве управляющих блоков поточных
шифрсистем?
7. Какой период имеет ненулевая линейная рекуррентная последовательность
над полем СР(2) с характеристическим многочленом
х5+х2+\? Какова частота появления триграммы (0,1,1)
на периоде этой последовательности?
8. Какова длина отрезка, необходимого для восстанавления минимального
многочлена заданной линейной рекуррентной последовательности
с помощью алгоритма Берлекемпа—
Месси?
9. Для каких целей применяются усложнения линейных рекуррентных
последовательностей?
10. Какую минимальную степень нелинейности должна иметь
булева функция от т переменных в фильтрующем генераторе,
чтобы после ее применения к знакам линейной рекуррентной
последовательности над полем СР{2) с примитивным характеристическим
многочленом Р(х) степени т линейная
сложность выходной последовательности была бы больше
/и3?
11. Какие существуют типы генераторов Макларена—Мар-
сальи?
286
Глава 10
Шифрование в аналоговой телефонии
Существуют два класса систем связи: цифровые и аналоговые.
Все наши предыдущие исследования были связаны с
цифровыми сигналами, то есть сигналами, имеющими конечное
число дискретных уровней. Аналоговые сигналы являются
непрерывными. Типичным примером такого сигнала является
речевой сигнал, передаваемый по обычному телефону. Информацию,
передаваемую аналоговыми сигналами, также необходимо
защищать, в том числе и криптографическими методами.
Имеются два различных способа шифрования речевого
сигнала. Первый состоит в перемешивании (скремблировании)
сигнала некоторым образом. Это делается путем изменения
соотношений между временем, амплитудой и частотой, не
выводящих за пределы используемого диапазона. Второй способ
состоит в преобразовании сигнала в цифровую форму, к
которой применимы обычные методы дискретного шифрования.
Зашифрованное сообщение далее передается по каналу с
помощью модема. После расшифрования полученной криптограммы
вновь восстанавливается аналоговая форма сигнала.
Прежде чем перейти к деталям, необходимо остановиться
на некоторых особенностях речевых сигналов.
§ 10.1. Особенности речевых сигналов
Непрерывные сигналы характеризуются своим спектром.
Спектр сигнала — это эквивалентный ему набор синусоидальных
составляющих (называемых также гармониками или
частотными составляющими). Спектр сигнала получается
разложением функции, выражающей зависимость формы сиг287
Iлава 10
нала от времени, в ряд Фурье. Спектр периодического сигнал
а— линейчатый (дискретный), он состоит из гармоник с
кратными частотами. Спектр непериодического сигнала —
непрерывный. Типичный спектр речевого сигнала показан на
рис. 41:
Частотные составляющие в диапазонах 3^4 кГц и менее
300 Гц быстро убывают. Таким образом, очень высокие частотные
компоненты имеют существенно меньший вклад в
сигнал, чем частоты в диапазоне 50(Ь-3000 Гц.
Если ограничиться частотами, не превышающими 3 кГц,
и использовать высокочувствительный анализатор, то спектр,
производимый некоторыми звуками, имеет вид зубчатой кривой
приблизительно следующего вида (см. рис. 42)
288
Шифрование в телефонии
Мы видим несколько пиков графика, называемых формантами.
Изменение этих частотных компонент во времени можно
изобразить на трехмерном графике (при добавлении третьей
координаты — времени).
Речевой сигнал является переносчиком смысловой информации.
Эта информация при прослушивании речевого
сигнала может быть записана в виде текста сообщения. Слуховое
восприятие речевого сигнала более богато и несет как
основную текстовую информацию, так и дополнительную в
виде ударений и интонаций. Элементарными единицами слуховой
информации являются элементарные звуки — фонемы,
а смысловыми единицами — звучащие слоги, слова и фразы.
Для каждого языка имеется свой набор фонем. Например, в
русском и английском языках имеется около 40 фонем.
Множество фонем разбивается на три класса. Гласные
образуют одно семейство, согласные и некоторые другие фонетические
звуки (для английского языка — это, например,
звуки сИ, зК) образуют два класса, называемые взрывными
звуками и фрикативными звуками. Гласные производятся
движением голосовых связок под воздействием потоков воздуха.
Проходя через гортань, они превращаются в серию вибраций.
Затем воздушный поток проходит через некоторое
число резонаторов, главными из которых являются нос, рот и
горло, превращаясь в воспринимаемые человеческим ухом
фонемы. Возникающие звуки зависят от формы и размеров
этих резонаторов, но в значительной степени они характеризуются
низкочастотными составляющими.
Гласные звуки производятся в течение длительного времени.
Как правило, требуется около 100 мс для достижения
его пиковой амплитуды. Взрывные звуки производятся путем
“перекрытия” воздушного потока с последующим его выпусканием
с взрывным эффектом. Блокирование воздушного потока
может осуществляться различными способами — языком,
нёбом или губами. Например, звук “п” произносится при
блокировании воздушного потока губами. Взрывные звуки
289
/ лава 10
характеризуются их высокочастотными составляющими. До
90% их пиков амплитуды имеют длительность, не превышающую
5 мсек. Фрикативные звуки производятся частичным
перекрытием воздушного потока, что дает звук, похожий
на “белый шум”. Этот звук затем фильтруется резонаторами
голосового тракта. Фрикативный звук обычно богат пиками
амплитуды длительностью 20+50 мс и сконцентрирован по
частоте от I до 3 кГц. Пример фрикатива — звук “ссс..
Другой важной характеристикой человеческой речи является
частота основного тона. Это — частота вибраций голосовых
связок. Среднее значение этой частоты колеблется у
разных людей, и у каждого говорящего имеется отклонение в
пределах октавы выше или ниже этой центральной частоты.
Обычно у мужчины частота основного тона колеблется около
1300 Гц, у женщины она выше.
Речевые сигналы не только передают информацию, но и
дают сведения о голосовых характеристиках говорящего, что
позволяет идентифицировать его по голосу. Можно использовать
высоту, форманты, временную диаграмму и другие характеристики
речевого сигнала, чтобы попытаться сформировать
сигнал, схожий с оригиналом. Это воспроизведение
может быть в некоторой степени неестественным и некоторые
индивидуальные характеристики говорящего будут утеряны.
Такие принципы репродукции лежат в основе вокодера, о котором
будет сказано далее.
§ 10.2. Скремблирование
Рассмотрим сначала первый способ шифрования речевых
сигналов в их аналоговой форме. При оценке стойкости шифрования
речевых сигналов в аналоговой форме необходимо, в
первую очередь, учитывать возможности человеческого восприятия
при прослушивании результирующего сигнала и попытке
восстановить какую-либо информацию. Это восприятие
очень субъективно: одни люди воспринимают на слух
290
Шифрование в телефонии
значительно лучше других. Например, хорошо известно, что
родители понимают “речь” своих детей задолго до того, как ее
начинают понимать другие люди. В связи с этим говорят о так
называемой остаточной разборчивости сигнала.
Оценивая надежность шифрования целесообразно несколько
раз подряд прослушать скремблированные телефонные
сообщения. Дело в том, что человеческий мозг способен
адаптироваться к “добыванию” информации и быстро анализировать
услышанное. Часто бывает так, что после второго
или третьего прослушивания человек начинает распознавать
отдельные слова или слоги. Возможно, что смесь различных
фрагментов приведет к пониманию смысла сообщения. Имеются
даже эксперты для восприятия скремблированных сообщений.
Простейшей формой рассматриваемых преобразований
являются преобразования сигнала в частотной области: инверсии,
циклические инверсии и частотные перестановки.
§ 10.3. Частотные преобразования сигнала
Простейшим является преобразование инверсии спектра.
Оно осуществляется следующим образом. Рассмотрим, например,
сигнал, расположенный в диапазоне 30(Ь-3000 Гц (см.
рис. 43).
291
I лава 10
Попытаемся преобразовать сигнал таким образом, чтобы
поменялись местами высокие и низкие частоты. Для этого
рассмотрим отдельные гармоники нашего сигнала. Если
Ут -соз(сот1) — одна из гармоник, подаваемая вместе с сигналом
Ус - соз{сос1) на вход устройства, называемого смесителем,
то его выходом будет сигнал Ус •Ут -со$(сос1)-со$(о)т1) .
Согласно известному равенству
соз А • соз В = ~ соз (А + В) + —■ соз(^ - В) ,
выход смесителя выражается в виде
| КК, С05(й)с +сот)1 + ^У сУт СОЗ(<ус -б)т)1.
Величины Ус и сот можно выбирать. Положив Ус = 1 и
сос > сот, мы получим следующий амплитудно-угловой
спектр выхода смесителя (см. рис. 44).
292
Шифрование в телефонии
При рассмотрении каждой гармоники сигнала и соответствующего
выхода смесителя получим следующий график(см.
рис. 45).
А
Между несущей частотой / с находятся два диапазона,
называемые верхним и нижним диапазонами соответственно.
Верхний диапазон аналогичен исходному сигналу, лишь перемещенному
вверх (каждая частотная компонента увеличивается
на / с). Нижний диапазон является зеркальным отражением
исходного сигнала. Теперь, выбирая подходящую несущую
частоту и используя смеситель для перемещения верхнего
диапазона, мы можем получить инвертированный речевой
сигнал (см. рис. 46).
1— >
О / с-3000 /с-300 / с / с+300 /6 +3000 /
Рис. 45
О / с -3000 / с -300 ^
Рис. 46
293
I лава 10
Выбором несущей частоты для различных сигналов каждый
из них может быть перенесен в другой частотный диапазон.
Это дает возможность передавать несколько телефонных
сигналов по одному каналу.
Преобразование инверсии не зависит от секретного ключа.
Это — кодирование, являющееся нестойким против атак
противника, обладающего аналогичным оборудованием. Развитие
идеи инверсного кода, позволяющее ввести секретный
ключ, состоит в использовании так называемой циклической
инверсии. Суть преобразования циклической инверсии заключается
в следующем.
Как мы уже заметили, если инвертированный сигнал находится
в том же диапазоне, что и исходный сигнал (300 ч-
3000 Гц), то несущая частота равна 3300 Гц. Для другой несущей
частоты, скажем 4000 Гц, получим инвертированный
сигнал со спектром, изображенным на рис. 47.
Рис. 47
Этот сигнал не попадает в исходную полосу. Можно договориться
переносить часть спектра, превышающую 3000 Гц,
в нижнюю часть исходного спектра (см. рис. 48).
294
Шифрование в телефонии
Рис. 48
В таком переносе части спектра и заключается идея циклической
инверсии. Типичный инвертор имеет от 4 до 16 различных
несущих частот. Это дает такое же число возможных
циклических сдвигов. С помощью ключа можно выбирать несущую
частоту так, как это делается для шифра простой замены.
Можно использовать также генератор псевдослучайных
чисел, который выбирает изменяемую несущую частоту.
Обычно для этого используют интервал в 10 или 20 мс. Реализующее
такой метод устройство называют циклическим инверсным
переключателем диапазона.
Подобные системы имеют две серьезные слабости. Во-
первых, в каждый момент времени имеется лишь небольшое
число возможных несущих частот, в силу чего исходный сигнал
может быть восстановлен их перебором с помощью сравнительно
простого оборудования. Во-вторых, что более важно,
остаточная разборчивость выходного сигнала для такого
метода неприемлемо высока, что проявляется при непосредственном
прослушивании.
Третий способ изменения сигнала в частотной области
состоит в делении диапазона. Спектр сигнала делится на некоторое
число равных поддиапазонов, которые могут переставляться
местами друг с другом. К этому можно добавить
также возможность инвертирования для некоторых поддиапазонов.
Эту идею проиллюстрируем следующим примером.
295
I лава 10
Пример
Рассмотрим сигнал, изображенный на рис. 49, а. В нашем
примере частотный диапазон разбит на пять равных частей,
которые переставляются в соответствии с указанной нумерацией,
при этом первая и пятая части инвертированы (см. рис.
49,6).
Всего в нашем примере имеется 5! возможных перестановок
и 25 возможностей для инвертирования. Итого —
5!-25 = 3840 вариантов преобразований сигнала. Это, конечно,
не очень много. Хуже обстоит дело с остаточной разборчивостью.
Если использовать лишь перестановки полос, то для
большинства из них остаточная разборчивость достигает 10%,
что, конечно, не дает гарантии стойкости.
Л у У
0 300 1000 2000 3000 /
Рис 49, б
Некоторые причины этого легко понять. Так будет, например,
если некоторые поддиапазоны остаются неизменными.
Кроме того, известно, что обычно более 40% энергии сиг-
296
Шифрование в телефонии
нала лежит в первых двух поддиапазонах, соответствующих
первой форманте. Как только криптоаналитик найдет правильные
позиции первых двух поддиапазонов и переместит
их на нужные места, он частично восстановит сигнал и получит
неплохой шанс понять фрагмент сообщения.
Можно попытаться улучшить систему защиты за счет использования
некоторого числа различных перестановок, которые
меняются через короткие промежутки времени с помощью
генератора псевдослучайных чисел. Часто для реальных
систем лучшие (с точки зрения низкой остаточной разборчивости)
перестановки хранятся в КОМ (памяти только для чтения),
имеющейся внутри устройства.
Несмотря на то, что генератор может вырабатывать последовательность
очень большого периода, и размер ключа
может быть выбран достаточно большим, даже в этом случае
остаточная разборчивость большой доли преобразований так
велика, что система не может в полной мере обеспечить необходимую
надежность защиты.
То же можно сказать вообще о любом скремблере,
использующем лишь действия с частотной областью. Их применение
ограничивается лишь ситуациями, когда целью является
препятствие пониманию разговора для случайного слушателя
или даже противника, не обладающего подходящим
оборудованием. Как будет видно из дальнейшего, более совершенные
системы или увеличивают ширину спектра сигнала,
или вводят временные задержки в передачу. Подобные
изменения влекут свои собственные проблемы и поэтому частотные
скремблеры могут быть использованы только тогда,
когда не требуется гарантированная стойкость.
К сказанному следует добавить замечание о числе поддиапазонов,
используемых частотным скремблером. В предыдущем
примере их было пять. Ясно, что с ростом этого числа
значительно увеличилось бы число возможных перестановок,
что привело бы к возрастанию стойкости системы. Однако
введение слишком большого числа поддиапазонов связано с
297
I лава ю
большими практическими трудностями. Дело в том, что на
приеме необходимо восстановить исходный сигнал. Фильтры
же и другие компоненты схемы вносят шумы и не являются в
точности линейными системами. Любые преобразования сигнала,
производимые при передаче, являются несовершенными
и приводят к ухудшению его качества на выходе. Скремблеры
особенно чувствительны к подобным искажениям. Поэтому
увеличение числа поддиапазонов делает систему или вообще
непригодной, или неэкономичной.
§ 10.4. Временные преобразования сигнала
Рассмотрим теперь скремблеры, воздействующие на временные
компоненты сигнала. В их основе лежат следующие
принципы.
Сначала аналоговый сигнал делится на равные промежутки
времени, называемые кадрами. Каждый кадр, в свою очередь,
также делится на еще меньшие части, называемые сегментами.
Входной сигнал преобразуется путем перестановки
сегментов внутри каждого кадра. Для этого речевой сигнал на
передающем конце записывается на магнитофонную ленту,
которая “разрезается” на равные части, пронумерованные по
порядку. Затем они перемешиваются и “склеиваются” в некотором
другом порядке. Воспроизведенный со склеенной ленты
сигнал передается по каналу связи и на приемном конце
снова записывается на магнитофонную ленту, которая, в свою
очередь, разрезается на те же части, как и при передаче. Части
“склеиваются” в порядке возрастания номеров и сигнал восстанавливается.
Проиллюстрируем этот процесс следующим примером.
Пример
На рис. 50 кадр разделен на 8 сегментов. Затем сегменты
переставляются в соответствии с перестановкой
(1,8,3, 5, 7, 4, 2, 6).
298
Шифрование в телефонии
При настройке системы необходимо выбрать длины кадров
и сегментов. Так как внутри сегмента сигнал не разрушается,
то сегменты желательно выбирать настолько короткими,
чтобы в них не содержались целые фрагменты сообщения,
например отдельные слова. С другой стороны, длина сегмента
серьезно влияет на качество звучания передаваемого сигнала,
что объясняется чисто техническими причинами. Чем меньше
сегмент, тем ниже качество звучания. Поэтому в выборе длины
сегмента необходим разумный компромисс.
Скремблированный
выход
Рис. 50
При выборе длины кадра необходимо учитывать фактор
временной задержки между входным аналоговым сигналом,
поступающим в аппаратуру, и восстановленным аналоговым
сигналом на приеме. Для того чтобы разобраться в этом, вернемся
к последнему примеру (см. рис. 50).
Пусть сегмент составляет в нашем примере интервал
времени в Г с. Тогда ввод восьми речевых сегментов на вход
скремблера занимает 8Г с. Перестановка сегментов могла
быть такой, что восьмой сегмент оказался бы первым (то есть
подлежащим передаче по каналу связи в первую очередь). В
таком случае передача не может начаться прежде, чем в
299
/ лава 10
скремблер не будет введен весь кадр. Для этого потребуется
8Т с. С начала передачи кадра до ее окончания требуется еще
8Т с. Поэтому временная задержка неизбежна. Получатель не
может начать расшифрование до получения всего кадра. Таким
образом, даже если не учитывать время передачи, задержка
составляет 16Гс на каждый сегмент речи. В общем
случае для системы, оперирующей с т сегментами на кадр,
время задержки может составлять 2тТ с. С точки зрения
пользователя это нежелательно, и подобная задержка должна
быть минимизирована. Однако для повышения надежности
засекречивания желательны достаточно длинные кадры. Для
того чтобы убедиться в этом, заметим следующее.
При обсуждении свойств фонем мы могли заметить, что
свойства речевого звука сохраняются в течение достаточно
большого интервала времени (структура формант медленно
изменяется). Если кадр настолько мал, что он состоит из
единственного тона, то независимо от того, как мы его будем
скремблировать, результатом будет являться единственный
непрерывный тон (с определенной потерей качества звука в
результате нашего вмешательства). Нам не удастся добиться
достаточного рассеивания сегментов в связи с их небольшим
числом. Это может привести к тому, что значительные части
слов окажутся неизменными, что позволит слушателю распознать
часть сообщения.
Нет также очевидного способа выбора длины сегментов.
На практике необходимо экспериментально проверять любой
выбор длины сегмента. Обычно неплохим тестом для этого
служит попытка воспроизвести на слух результат скрембли-
рования произнесенных в произвольном порядке чисел от 1 до
10. Ясно, что эта задача значительно проще той, когда требуется
узнать сообщение, о котором ничего не известно. Эксперименты
показывают, что если длина кадра недостаточно велика,
то рассматриваемые системы плохо выдерживают такой
тест. В большинстве случаев в аппаратуре данного типа кадры
делятся на число сегментов, заключенное в пределах от 8 до
300
Шифрование в телефонии
16, причем обычно длительность каждого сегмента составляет
от 20 до 60 мс.
Помимо выбора длин кадров и сегментов важным параметром
является перестановка. Очевидно, что одни перестановки
лучше других, и необходимо определить, как их следует
выбирать и как управлять их выбором. Как и для преобразований
инвертирования и частотных перестановок, имеется
несколько вариантов использования базовой системы. Можно
выбрать одну фиксированную перестановку для преобразования
каждого кадра. Другой вариант связан с выбором (при
помощи ключа) нескольких перестановок и периодическим их
использованием. Лучшим способом является использование
псевдослучайного генератора для выбора перестановки, применяемой
для преобразования каждого кадра в отдельности.
Для такого варианта актуален вопрос о длине периода соответствующей
последовательности перестановок, так как повторное
использование одной и той же перестановки нежелательно.
В свою очередь, с этим связан выбор числа сегментов
в кадре. Например, если это число равно 8 и каждый сегмент
имеет длительность в 40 мс, то через 3,6 час. непрерывной
работы перестановки начнут повторяться.
Как мы уже отмечали, далеко не все перестановки являются
“хорошими” с точки зрения надежности шифрования.
Например, если прослушать сигнал после применения каждой
из двух подстановок
12345678^) 12345678^1 (1)
13245768, .36258471,
то мы нашли бы в первом случае значительно более высокую
остаточную разборчивость, чем во втором.
Замечание. В (1) рассматриваемые перестановки являются
нижними строками подстановок, в которых верхние строки
301
Глава Ю
представляют собой исходные порядки сегментов, а нижние
— порядки сегментов после перестановки.
Причина указанного различия перестановок ( I) состоит в
том, что в первой из них символы I, 4, 5, 8 остаются неподвижными,
а остальные смещаются лишь на соседние позиции,
тогда как во второй происходит лучшее перемешивание.
Рассмотренный пример приводит к естественной количественной
мере “качества” перестановки. Пусть для произвольной
подстановки а символ а (0 обозначает позицию, на
которую а перемещает / -й сегмент. Тогда смещение символа
I после перестановки равно |/ - а (/)|, а среднее смещение
после перестановки характеризуется величиной
Для первой подстановки из (1) среднее смещение $(а)
равно 0,5, для второй — 2,5. Величина 5(ог) называется
сдвиговым фактором подстановки а . Замечено, что перестановки,
приводящие к выходному сигналу с низкой остаточной
разборчивостью, имеют большой сдвиговый фактор, хотя обратное
может быть неверным. В качестве примера приведем
подстановку а восьми элементов со сдвиговым фактором 4,
которая плохо выдерживает “тесты на слух”:
Помимо своего низкого сдвигового фактора первая подстановка
в (1) имеет и другие нежелательные свойства. Рассмотрим,
например, соседние сегменты 4 и 5. В скремблиро-
ванном кадре они расположены в том же порядке, что и в исходном.
Если сегменты имеют длительность в 40 мс, то рассматриваемая
пара сегментов составляет около 80 мс. Как мы
^12345678^
,57683241 (2)
302
Шифрование в телефонии
уже отмечали, большинство фонем могут быть узнаваемы в
таком интервале времени. В той же подстановке, а также в
подстановке (2), сегменты 6 и 8 являются соседними. Это
также нежелательно. Дело в том, что вообще при прослушивании
в скремблированном сигнале пары соседних сегментов
типа /, / + 2 человеческий мозг в состоянии, как правило, восстановить
пропущенный сегмент / + 1 , то есть восстановить
соответствующую часть сообщения. Нечто подобное имеет
место и в других случаях.
Таким образом, в рассмотренных ситуациях также идет
речь о некоторой остаточной разборчивости. Это свидетельствует
о сложности формализации определения “хороших” с
точки зрения защиты перестановок, а следовательно, и сложности
их подсчета. Поэтому имеются существенные различия
в подсчете числа “хороших” перестановок, это может зависеть
от субъективных предпочтений разработчика.
Теперь нужно решить вопрос о способе выбора перестановок
с помощью ключа. Имеются два естественных способа
такого выбора. Первый состоит в выборе произвольной перестановки
данной степени с последующим ее тестированием. В
зависимости от того, подходит она или нет, перестановка используется
для преобразования кадра. Другой способ состоит
в предварительном отборе всех “хороших” перестановок в
ЯОМ (памяти лишь для чтения), имеющейся в самом оборудовании,
и их выбором для использования с помощью псевдослучайной
последовательности. Рассмотрим оба способа.
Наиболее неблагоприятным для первого способа является
фактор времени. В конце промежутка времени, равного длительности
кадра, мы должны выбрать следующую подходящую
перестановку. При этом нежелательно повторение той
же перестановки, что в принципе возможно даже для случайной
управляющей последовательности. Поэтому необходим
контроль, устраняющий появление неподходящих перестановок.
Ожидание подходящей перестановки требует дополнительных
временных затрат, что нежелательно.
303
I лава Ю
Второй метод использует лишь те перестановки, которые
записаны в КОМ. Если их запас не слишком велик, то это
улучшает шансы противника. В случае когда кадр состоит из
не слишком большого числа сегментов, скажем 8, и имеется
возможность хранить все “хорошие” перестановки, второй
метод предпочтителен. Чтобы понять еще одно преимущество
второго метода, необходимо рассмотреть вопрос о возможностях
перехватчика, обладающего той же аппаратурой и полным
набором “хороших” перестановок.
Предположим, что одной из перестановок, хранящихся в
КОМ, является вторая перестановка из (1), и мы ее использовали
для перемешивания кадра. Перехватчик, желая определить
используемую перестановку, может перебирать перестановки,
обратные к хранимому запасу перестановок. Если наша
память содержит также нижнюю строку подстановки
( 12345678"!
(3)
^36258417)
то перехватчик может опробовать и ее (вместо использованной).
Результатом последовательного применения исходной
подстановки и обратной к подстановке (3) является подстановка
^12345678^
Ч12345687) '
Она так близка к тождественной подстановке, что практически
всегда дает возможность противнику восстановить
исходный кадр. Помимо (3) есть и другие перестановки,
“близкие” к истинной. В случае когда кадр состоит из 8 сегментов,
таких пар “близких” перестановок имеется достаточно
много и ситуация достаточно опасна (с точки зрения защиты).
Дело в том, что мы должны скорректировать определение
“хорошей” перестановки и тем самым уменьшить их число в
памяти. Надо избегать записывать в память пары перестано304
Шифрование в телефонии
вок, соответствующих подстановкам а и /?, для которых
произведение а • /Г 1 или /? • а~х близко к тождественной подстановке.
Если ЯОМ заполняется с учетом сделанной коррекции
и число хранимых перестановок достаточно велико, то
второй метод их выбора для перемешивания кадров становится
более предпочтительным.
§ 10.5. Стойкость систем временных
перестановок
Рассмотрим сначала вопрос о возможности восстановления
информации, содержащейся в скремблированном сигнале,
путем непосредственного прослушивания. С точки зрения
разработчика необходимо найти баланс между минимальной
остаточной разборчивостью и минимальной временной задержкой.
Для уменьшения остаточной разборчивости имеется ряд
способов. Один из них состоит в простом реверсировании порядка
следования сегментов. Наблюдения показывают, что
при использовании такого способа уровень успешного прослушивания
уменьшается почти на 10%. Другой метод также
имеет отношение к частотной области. Здесь имеется в виду
совместное использование частотного и временного перемешивания
в одной двумерной системе. Хотя такой метод
уменьшает уровень успешного прослушивания почти на 20%,
он более дорог в реализации. Отметим при этом, что любые
изменения сигнала уменьшают качество воспроизведения и
что частотные искажения, в частности, сильно зависят от шумов
и нелинейности при передаче.
Используя подобные методы или их комбинацию, можно
уменьшить остаточную разборчивость до такого уровня, что
будет невозможно воспринимать на слух никакое сообщение.
Теперь рассмотрим вопрос о стойкости системы против более
изощренных атак.
305
I лава Ю
Одна из них состоит в попытках переупорядочить речевой
сигнал кадр за кадром. Эта задача решается с использованием
прибора, называемого сонографом. Этот прибор воспроизводит
сонограмму каждого кадра. Сонограмма — это трехмерный
график в системе координат время (по горизонтали), частота
(по вертикали), амплитуда (по третьей координате), использующий
“серую шкалу”. В этой шкале черный цвет представляет
максимальную амплитуду и белый цвет — минимальную.
Изменения амплитуды представляются изменениями оттенков
серого цвета. Светлее оттенок, соответствующий меньшей амплитуде.
Таким образом, хотя сонограмма имеет три измерения,
она обычно представляется в двумерном виде.
Дескремблирование некоторого числа кадров путем опробования
содержания КОМ может позволить определить часть
псевдослучайной последовательности, достаточной для определения
ключа. Для противодействия этому необходим соответствующий
генератор псевдослучайной последовательности,
стойкий к подобной угрозе.
Предположим, что наша система стойка к описанному подходу.
Это означает, что единственный путь, при котором
криптоаналитик может получить сообщение, состоит в деск-
ремблировании каждого кадра. Но тогда, очевидно, время, необходимое
для восстановления сообщения, прямо пропорционально
числу кадров. Криптоаналитик может автоматизировать
процесс перебора перестановок, содержащихся в КОМ, для
проверки критерия того, что полученный сигнал является речевым
сигналом (это можно сделать, например, по сонограмме).
Для защиты от этой возможности вновь встает вопрос об увеличении
числа “хороших” перестановок, что требует увеличения
длительности кадра и временной задержки при передаче.
Как мы убедились ранее, временная задержка при передаче
преобразованного кадра может быть в два раза больше длительности
самого кадра. Это является следствием того, что для
некоторых перестановок сегмент мог быть задержан на полную
длительность кадра. С целью уменьшения подобной задержки
306
Шифрование в телефонии
можно еще более ограничить множество используемых перестановок,
добиваясь того, чтобы каждый сегмент задерживался
“не слишком долго”. Это достигается при использовании перестановок
с относительно небольшими смещениями для каждого
символа.
Подытожим рассмотрение скремблеров.
Скремблеры характеризуются аналоговым выходом, лежащим
в том же диапазоне, что и исходный сигнал. Кроме того,
они обычно имеют характерные спектральные характеристики
и выходной сигнал, представляющий собой последовательность
фонем открытой речи (с измененным порядком следования).
Их стойкость зависит как от типа скремблирования,
так и от способа его реализации. В частности, использование
зависящего от ключа псевдослучайного генератора для
скремблирования может значительно увеличить уровень стойкости.
Надежность любого выбранного метода скремблирования
зависит в значительной степени от типа и качества канала
связи. Скремблеры варьируются от простейших инверторов до
сложных частотно-временных систем относительно высокой
стойкости. Обычно они применяются как системы шифрования
временной стойкости.
§ 10.6. Системы цифровой телефонии
Для преобразования речевого сигнала в цифровую форму
берутся отсчеты, то есть значения сигнала через равные промежутки
времени г . Интервал т должен быть настолько мал,
чтобы сигнал не успевал намного измениться между отсчетами.
Этот интервал часто называют временным шагом или интервалом
Найквиста. Минимальную частоту взятия отсчетов, то
есть величину, обратную временному шагу дискретизации, определяет
теорема В.А.Котельникова, согласно которой частота
отсчетов должна быть вдвое больше максимальной частоты
звукового спектра. В телефонии такая частота ограничивается
3,4 кГц. Поэтому частота отсчетов должна быть не менее 6800
307
I лава 10
в секунду, или 6,8 кГц. Процесс взятия отсчетов называют дискретизацией
по времени.
Для цифровой оценки отсчетов используется процесс дискретизации
по уровню. Каждый отсчет можно представить
числом, соответствующим значению отсчета звукового напряжения.
Например, если звуковое напряжение измерять в милливольтах,
то число целых милливольт и будет отсчетом, а 1
мВ — шагом дискретизации по уровню. Отношение максимальной
амплитуды звукового напряжения к шагу квантования
дает максимальное число, которое нужно получить при отсчетах.
Оно определяет динамический диапазон передаваемого
сигнала. Для передачи речи с удовлетворительным качеством
достаточен динамический диапазон 30-С? 5 дб, что соответствует
числу шагов квантования 30 при отсчетах. Для
передачи одного отсчета двоичным кодом в этом случае достаточно
1о§2 3 0 « 5 разрядов. Для качественной передачи
музыки число квантований должно быть не менее 10000, что
соответствует динамическому диапазону 80 дб. В этом случае
для передачи одного отсчета потребуется 1о§210000 «14 разрядов.
Переход на цифровую передачу существенно улучшает качество
связи. Но не даром. Оценим поток информации при телефонном
разговоре.
Полагая полосу звуковых частот равной, как и выше,
3,4 кГц и частоту взятия отсчетов 6,8 кГц, получаем 6800 отсчетов
в секунду. При 30 шагах квантования по уровню каждый
отсчет занимает 5 разрядов. Следовательно, в секунду передается
34000 двоичных разрядов, или бит информации. Скорость
передачи информации, измеренную в бит/с, можно выразить
формулой С = 2Р 1о § 2 N , где Р — максимальная частота
звукового спектра, N — число уровней квантования. Чтобы
передать цифровой сигнал со скоростью 34 Кбит/с, нужна полоса
частот, пропускаемых каналом связи, не менее 34 кГц.
308
Шифрование в телефонии
Таким образом, при переходе к цифровому сигналу произошел
как бы обмен полосы частот на отношение сигнал/шум,
но обмен достаточно выгодный. Расширяя полосу частот в 10
раз при переходе к цифровой передаче, мы намного снижаем
допустимое отношение сигнал/шум или сигнал!помеха в канале
связи, и это при общем существенном улучшении качества передачи.
В заключение сделаем одно замечание. Для аналоговоцифровых
преобразователей входной сигнал отсчитывается
через регулярные интервалы времени и затем передается цифровая
“аппроксимация”. Имеется и другой способ передачи
информации. Если, например, входным сигналом является синусоида
с частотой / , то вместо того, чтобы посылать цифровую
аппроксимацию, мы могли бы просто сообщить получателю
о параметрах синусоиды и предложить ему самому построить
такой сигнал. Этот принцип заложен в основе аппаратов,
называемых соответственно вокодерами и липредорами. С помощью
таких аппаратов синтезируются цифровые речевые системы
с низкоскоростным выходом (1,2 -г 4,8 Кбит/с).
Контрольные вопросы
1. Какие два разных способа шифрования аналоговых сигналов
Вы знаете?
2. Какие преобразования используются при скремблировании
аналоговых сигналов?
3. В чем (с точки зрения надежности защиты) состоят слабости
преобразований сигналов в частотной области, во временной
области?
4. Какая фундаментальная теорема лежит в основе цифровой
обработки сигналов?
5. Какой метод шифрования аналоговых сигналов обеспечивает
гарантированную стойкость?
309
Глава 11
Системы шифрования
с открытыми ключами
Системы шифрования с открытыми ключами называют
также асимметричными системами. Они следующим образом
используются для организации конфиденциальной связи
в сети пользователей.
Каждый из корреспондентов системы обладает ключом
к = (к3, кр ) , состоящим из открытого ключа къ и секретного
ключа кр. Открытый ключ определяет правило зашифрования
Ек, а секретный ключ — правило расшифрования Ок
(см. гл. 2). Эти правила связаны соотношением
(Еь (М)) = С для любого открытого текста М и любого
шифрованного текста С. Знание открытого ключа не позволяет
за приемлемое время (или с приемлемой сложностью) определить
секретный ключ.
Для удобства записи обозначим правила зашифрования и
расшифрования (на выбранном ключе к ) произвольного корреспондента
А символами ЕА и Оа соответственно.
Корреспондент В, желая послать конфиденциальное сообщение
М корреспонденту А, получает копию Ед , вычисляет
шифртекст С ~ Е Л{М), который направляет по каналу
связи корреспонденту А. Получив сообщение С, корреспондент
А применяет к нему преобразование Оа , получая открытый
текст М.
Открытый ключ не требуется сохранять в тайне. Необходимо
лишь обеспечить его аутентичность, что, как правило,
310
Системы с открытыми ключами
сделать легче, чем обеспечить рассылку и сохранность секретных
ключей.
Как мы уже отмечали ранее, системы шифрования с открытыми
ключами осуществляют блочное шифрование, поэтому
открытый текст перед зашифрованием разбивается на
блоки выбранного размера, которые последовательно преобразуются
таким же образом, как это происходит при использовании
блочного шифра в режиме простой замены (см.
§ 8.3).
Асимметричные системы шифрования обеспечивают значительно
меньшие скорости шифрования, нежели симметричные,
в силу чего они обычно используются не столько для
шифрования сообщений, сколько для шифрования пересылаемых
между корреспондентами ключей, которые затем используются
в симметричных системах.
Рассмотрим конкретные примеры систем шифрования с
открытыми ключами.
§ 11.1. Шифрсистема К8А
Система Я8А была предложена в 1978 г. [Клу78] и в настоящее
время является наиболее распространенной системой
шифрования с открытым ключом. Напомним ее определение,
приведенное в гл. 2 (определение 4).
Пусть п — # — целое число, представимое в виде произведения
двух больших простых чисел р, с] . Выберем числа
е и с/ из условия
е-с! = 1(шо &(р{п)), ( 1)
где ф(п) = (р — 1) • (д -1 ) — значение функции Эйлера от
числа п. Пусть к = (п,р^,е,с1) — выбранный ключ, состоящий
из открытого ключа къ = (п,е) и секретного ключа
311
/ лава 17
кр = (п,р,д,с1) . Пусть М — блок открытого текста и С —
соответствующий блок шифрованного текста. Тогда правила
зашифрования и расшифрования определяются формулами:
С = Ек(М) = М е(тоАп), Эк(С) = С а(тойп) . (2)
Заметим, что в соответствии с (2) Ик (С) = М . Это вытекает
из следующих рассуждений. Для любого целого числа
М и любого простого р справедливо сравнение
М р = М(шоё р ) . (3)
В самом деле, (3) равносильно сравнению
М р - М = 0(шо<1 р)
или сравнению
М (М р~' -1) = 0(тос1 р ). (4)
Если НОД(М,р ) = р , то р делит М , и поэтому
М = 0(шо(1 р ) , откуда следует (4). Если же НОД(М,р) — \,
то, согласно малой теореме Ферма (см. Приложение 3),
М р~х = 1(тос1 р ) , откуда также следует (4).
Согласно (1), существует целое число г , такое, что
е = г • ср(п) + 1. Отсюда и из (3) получаем следующую цепочку
равенств и сравнений:
Са =(МеУ =МЫ =М Г(р{п)+х = м г{р~т ~])+] =
= М гр{я~Х) *м~гц^ х =(МРУ (Я~Х) -М'Г(1+Г+Х г (5)
3 м г(ч~]) -М- гч+г+{ = М{тоА р).
312
Системы с открытыми ключами
Аналогично можно показать, что
с Л = м ш оа ц . (б>
Поскольку р и ^ — разные простые числа, то на основании
известных свойств сравнений из (5), (6) получаем:
С* =Мшос1и.
Отсюда и следует корректность определения (2).
Для того чтобы лучше представить себе технические детали,
возникающие при зашифровании и расшифровании,
приведем пример работы с К8А.
Пример
Зашифруем аббревиатуру К8А, используя /7 = 17,
<7 = 31. Для этого вычислим п = р^ = 527 и
ср(п) = ( р - -1) = 480 . Выберем, далее, в качестве е
число, взаимно простое с (р{п), например е = 7. С помощью
алгоритма Евклида найдем целые числа и и V, удовлетворяющие
соотношению е • и + (р{п) • V = 1:
480 = 7-68 + 4,
7 = 4-1 + 3,
4 = 3-1 + 1,
1 = 4 — 31 = 4 — (7 — 4-1)-1 =
= 4-2-7 -1 = (480-7-68)-2-7-1 =
= 480-2-7-137,
у = 2, и = - 137.
313
I лава 11
Поскольку —137 = 343(шо<1480), то <7 = 343. Проверка:
7 • 343 = 2401 = 1(тос1480).
Теперь представим данное сообщение в виде последовательности
чисел, содержащихся в интервале 0,526 . Для этого
буквы и А закодируем пятимерными двоичными векторами,
воспользовавшись двоичной записью их порядковых
номеров в английском алфавите:
К = 18 = (10010), 5 = 19 = (10011), А = 1 = (00001).
Тогда К8А = (100101001100001). Укладываясь в заданный
интервал 0,526, получаем следующее представление:
К8А = (100101001),(100001) = (М, = 297, М 2 = 33).
Далее последовательно шифруем М х и М 2:
С, = Ек (М,) = М хе = 2977 (той 527) = 474.
При этом мы воспользовались тем, что
2977 = ((2972 )3 297)(шоё527) =
= ((2003 (то<1527)297)(тоё527),
С2 = Ек{Мг) = М 2е = 337(тос1527) = 407.
В итоге получаем шифртекст: у х = 474, у 2 — 407.
При расшифровании нужно выполнить следующую последовательность
действий. Во-первых, вычислить
314
Системы с открытыми ключами
Д (С 1) = (С,)343(шос1527).
Отметим, что при возведении в степень удобно воспользоваться
тем, что 343 = 256 + 64 + 16 + 4 + 2 + 1. На основании
этого представления получаем:
4742 яе 174(шос1527), 4744(шоё527) е= 237,
4748(тос1 527) е= 307,474|6(тод527) ее 443,
47432(тос1527) ее 205, 474м (той 527) ее 392,
474128(тос1527) = 307, 474256(тос1527) ее 443,
в силу чего
47 4 343(тос1527) г
Э (443 • 392 • 443 • 237 • 174 • 474)(тос1527) ее 297.
Аналогично
407343(то<1527) = 33.
Возвращаясь к буквенной записи, получаем после расшифрования
К8А.
Проанализируем вопрос о стойкости системы К8А.
Нетрудно показать, что сложность нахождения секретного
ключа системы К8А определяется сложностью разложения
числа п на простые множители. В связи с этим нужно выбирать
числа р и ^ таким образом, чтобы задача разложения
числа п была достаточно сложна в вычислительном плане.
Для этого рекомендуются следующие требования:
315
I лава 11
1) числа р и # должны быть достаточно большими, не
слишком сильно отличаться друг от друга и в то же время
быть не слишком близкими друг другу;
2) числа р и # должны быть такими, чтобы наибольший
общий делитель чисел р — 1 и # — 1 был небольшим; желательно,
чтобы НОД(р -1 , д -1 ) = 2 ;
3) р и д должны быть сильно простыми числами (сильно
простым называется такое простое число г , что г +1
имеет большой простой делитель, г — 1 имеет большой простой
делитель 5, такой, что число 5 - 1 также обладает достаточно
большим простым делителем).
В случае когда не выполнено хотя бы одно из указанных
условий, имеются эффективные алгоритмы разложения п на
простые множители (см. [Сал96], [Неч99]).
В настоящее время самые большие простые числа, вида
п — # , которые удается разложить на множители известными
методами, содержат в своей записи 140 десятичных
знаков. Поэтому, согласно указанным рекомендациям, числа
р и д в системе К.8А должны содержать не менее 100 десятичных
знаков.
Следует подчеркнуть необходимость соблюдения осторожности
в выборе модуля Я8А (числа п ) для каждого из
корреспондентов сети. В связи с этим можно сказать следующее.
Читатель может самостоятельно убедиться в том, что,
зная одну из трех величин: /?, # или ср(п), можно легко найти
секретный ключ К8А. Известно также, что, зная секретную
экспоненту расшифрования с/, можно легко разложить модуль
п на множители. В этом случае удается построить вероятностный
алгоритм разложения п . Отсюда следует, что каждый
корреспондент сети, в которой для шифрования используется
система Я8А, должен иметь свой уникальный модуль.
316
системы с открытыми ключами
В самом деле, если в сети используется единый для всех
модуль п , то такая организация связи не обеспечивает конфиденциальности,
несмотря на то что базовая система Я8А
может быть стойкой. Выражаясь другими словами, говорят о
несостоятельности протокола с общим модулем. Несостоятельность
следует из того, что знание произвольной пары
экспонент (е19с!{) позволяет, как было отмечено, разложить
п на множители. Поэтому любой корреспондент данной сети
имеет возможность найти секретный ключ любого другого
корреспондента. Более того, это можно сделать даже без разложения
п на множители [Сал96].
Как отмечалось ранее, системы шифрования с открытыми
ключами работают сравнительно медленно. Для повышения
скорости шифрования Я8А на практике используют малую
экспоненту зашифрования.
Если выбрать число е небольшим или таким, чтобы в его
двоичной записи было мало единиц, то процедуру шифрования
можно значительно ускорить. Например, выбрав е = 3
(при этом ни р — 1 , ни # - 1 не должны делиться на 3), мы
сможем реализовать шифрование с помощью одного возведения
в квадрат по модулю п и одного перемножения. Выбрав
е = 216 4-1 = 65537 — число, двоичная запись которого содержит
только две 1, мы сможем реализовать шифрование с
помощью 16 возведений в квадрат по модулю п и одного перемножения.
Если экспонента е выбирается случайно, то
реализация шифрования по алгоритму Я8А потребует 5 возведений
в квадрат по модулю п и в среднем х/2 умножений
по тому же модулю, где 5 — длина двоичной записи числа
п . Вместе с тем выбор небольшой экспоненты е может привести
к негативным последствиям. Дело в том, что у нескольких
корреспондентов могут оказаться одинаковые экспоненты
е .
317
Глава 11
Пусть, например, три корреспондента имеют попарно
взаимно простые модули п}, п 2, п 3 и общую экспоненту
е = 3. Если еще один пользователь посылает им некое циркулярное
сообщение М , то криптоаналитик противника может
получить в свое распоряжение три шифрованных текста
у 1 = М 3(тойП' ), I = 1,2,3. Далее он может найти решение у
системы сравнений
у = У^тойщ) ,
< у = у 2(тойп2),
у = у г(то&пг),
лежащее в интервале 0 < у < щ * п2 • пъ. По китайской теореме
об остатках (см. Приложение 3) такое решение единственно, а
так как М ъ < щ •п2 • л3, то у = М 3. Само М можно найти,
вычисляя кубический корень: М = \[у .
Отметим, что выбор малой экспоненты расшифрования
с1 также нежелателен в связи с возможностью определения
с1 простым перебором. Известно также, что если с! <л[п , то
экспоненту с1 легко найти, используя непрерывные дроби.
§11.2. Шифрсистема Эль-Гамаля
Шифрсистема Эль-Гамаля была предложена в 1985 г.
[Е1085] и является фактически одним из вариантов метода
выработки открытых ключей Диффи-Хеллмана (который будет
рассмотрен далее). Криптографическая стойкость данной
системы основана на сложности проблемы логарифмирования
в мультипликативной группе конечного простого поля.
318
системы с открытыми ключами
В соответствии с терминологией, введенной в гл. 2, шифрсистема
Эль-Гамаля (Х ,К,У,Е , 0 ) определяется следующим
образом. Для нее
Х = ? р, У = Г р х Г р, К = { ( р , а , р , а ) \ а а =Р(тойр)},
где р — достаточно большое простое число, а — порождающий
элемент группы %*р , а — целое число из интервала
1 < а < р — 2 . Ключ к = (/?, а , /?, а) представляется в виде
открытого ключа къ = (р 9а,/3) и секретного ключа кр = (а ).
Правило зашифрования на ключе к определяется формулой
Ек(М) = (СРС2),
где
С, = а г(тод. р \ С2=М • /Зг(той р ) ,
а г — случайно выбираемое число (рандомизатор) из интервала
0 < г < р — 2 .
Правило расшифрования на ключе к определяется формулой
Д (С 1,С2) = С2-(СГГ1(шос1/7).
Несложно проверить, что такое определение корректно,
то есть что выполняется равенство й к{Ек{М)) = М при любых
к в К и М € X .
Введение в правило зашифрования рандомизатора г делает
шифр Эль-Гамаля шифром многозначной замены (см.
гл. 5). В связи со случайным характером выбора параметра г
подобную схему шифрования называют еще схемой вероятностного
шифрования. Для нее открытый текст и ключ не
определяют шифртекст однозначно.
319
I лава 11
Для выработки открытого и секретного ключей каждый
из абонентов системы осуществляет следующие операции:
1) выбирает большое простое число р и некоторый порождающий
элемент а группы 2 ^;
2) случайно выбирает целое число а, \ <а< р — 2 ,и вычисляет
(3 = а а(тоб р ) ;
3) публикует открытый ключ ( р ,а ,/? ) , оставляя в секрете
число а .
Следует отметить, что в приведенной системе необходимо
использовать различные значения рандомизатора г для
зашифрования различных открытых текстов М и М \ В
самом деле, в противном случае соответствующие шифртек-
сты (С],С2) и (С],С2) оказываются связанными соотношением
С2 -(С2)~1 = М-(Л/ ’)~1 и М 1 может быть легко вычислен,
если известен М .
Как уже отмечалось, стойкость системы Эль-Гамаля определяется
сложностью решения задачи дискретного логарифмирования
в X* . В настоящее время эта задача практически
нереализуема для значений р , содержащих не менее 150
десятичных знаков. Рекомендуется также, чтобы число р — 1
содержало большой простой делитель.
Система Эль-Гамаля может быть обобщена для применения
в любой конечной циклической группе С . Криптографическая
стойкость такой обобщенной схемы определяется
сложностью задачи логарифмирования в группе С . При этом
групповая операция в С должна быть легко реализуемой. В
качестве С чаще всего выбираются следующие три группы:
1 ) мультипликативная группа Х*р целых чисел по модулю
простого числа р\
320
Системы с открытыми ключами
2) мультипликативная группа ОР{2т)* конечного поля
ОР(2т) характеристики 2 ;
3) группа точек эллиптической кривой над конечным полем.
Вероятностный характер шифрования можно отнести к
достоинствам системы Эль-Гамаля, так как схемы вероятностного
шифрования обладают, как правило, большей стойкостью
по сравнению со схемами с детерминированным процессом
шифрования. Недостатком системы является удвоение
длины открытого текста при шифровании.
§ 11.3. Шифрсистема Мак-Элиса
Идея, лежащая в основе данной системы, состоит в выборе
корректирующего кода, исправляющего определенное
число ошибок, для которого существует эффективный алгоритм
декодирования. С помощью секретного ключа этот код
“маскируется” под общий линейный код, для которого, как
известно, задача декодирования не имеет эффективного решения.
В системе Мак-Элиса параметрами системы, общими для
всех абонентов, являются целые числа к , п и ^. Для получения
открытого и соответствующего секретного ключа каждому
из абонентов системы следует осуществить следующую
последовательность действий:
1) выбрать порождающую матрицу С = Скхп двоичного
-линейного кода, исправляющего / ошибок, для которого
известен эффективный алгоритм декодирования;
2) случайно выбрать двоичную невырожденную матрицу
= ^кхк »
3) случайно выбрать подстановочную матрицу Р - Рпхп;
4) вычислить произведение матриц Сх = 8 О Р .
321
[лава 11
Открытым ключом является пара (Сх, ( ) , секретным —
тройка (5, С,Р) .
Для того чтобы зашифровать сообщение М , предназначенное
для абонента А , абоненту В следует выполнить следующие
действия:
1 ) представить М в виде двоичного вектора длины к ;
2) выбрать случайный бинарный вектор ошибок 2 длины
п , содержащий не более / единиц;
3) вычислить бинарный вектор С = М Оа + 2 и направить
его абоненту А.
Получив сообщение С, абонент А вычисляет вектор
Сх =С Р~\ с помощью которого, используя алгоритм декодирования
кода с порождающей матрицей О, получает далее
векторы М х и М = М х -8 ~х.
Чтобы убедиться в корректности приведенного алгоритма
расшифрования, достаточно заметить, что
С, =С-Р~Х = (М -С а +2 ) -Р~ х =
= (М -8 -С - Р + 2 ) - Р~х =
= (М - 8 ) в + 2 -Р ~ х,
где 7, ■ Р 1 — вектор, содержащий не более I единиц. Поэто-
му алгоритм декодирования кода с порождающей матрицей
С декодирует С в М х = М • 8 .
В качестве кода, исправляющего ошибки в системе Мак-
Элиса, можно использовать код Гоппы (см., например,
[Пит64]). Известно, что для любого неприводимого полинома
%(х) степени I над полем ОР(2т) существует бинарный
код Гоппы длины п — 2т и размерности к > п - т1 , исправляющий
до / ошибок включительно, для которого имеется
322
Системы с открытыми ключами
эффективный алгоритм декодирования. В настоящее время не
известны эффективные алгоритмы дешифрования системы
Мак-Элиса, использующей код Гоппы, при правильном выборе
параметров системы.
Вместе с тем рекомендуемые параметры для этой системы
[Меп97 ] — « = 1024, / = 38, А: >644 — приводят к
тому, что открытый ключ имеет размер около 2 19 бит, а длина
сообщения увеличивается при шифровании примерно в 1,6
раза, в связи с чем данная система не получила широкого распространения.
§11.4. Шифрсистемы на основе “проблемы
рюкзака"
“Проблема рюкзака” (или “ранца”) может быть сформулирована
следующим образом. Пусть задано множество натуральных
чисел А = {а1?а 2,...,а„} и натуральное число 5 \
Требуется установить, имеется ли такое подмножество множества
А , сумма элементов которого была бы равна 5 . Эквивалентной
является следующая формулировка: существует
ли такой набор чисел х7е { 0,1}, /< « , для которого
Данная проблема получила свое название в связи с тем,
что поставленная задача может быть переформулирована
также в следующем виде. Имеется набор предметов с известными
весами и рюкзак, который может выдержать вес, не
превышающий заданной величины. Можно ли выбрать набор
предметов для погрузки в рюкзак так, чтобы они в точности
имели максимально возможный вес.
“Проблема рюкзака” является весьма сложной, ее решение
с полиномиальной сложностью в настоящее время не известно.
п
/=1
323
/ лава 11
Идея построения системы шифрования на основе ‘"проблемы
рюкзака” заключается в выделении некоторого подкласса
задач об укладке рюкзака, решаемых сравнительно
легко, и “маскировки” задач этого класса (с помощью некоторого
преобразования параметров) под общий случай. Параметры
подкласса определяют секретный ключ, а параметры
модифицированной задачи — открытый ключ. В качестве
легко решаемой задачи Р. Меркль и М. Хеллман в 1978 г.
[Мег81] предложили задачу об укладке “супервозрастающего”
рюкзака. Изложим ее суть.
Назовем супервозрастающей последовательность натуральных
чисел (6, ,Ь2 Ъп ), обладающую свойством
/-1
Ъ1 > , 2 < / < п .
7=1
Можно убедиться в том, что “проблема рюкзака” для супервозрастающей
последовательности может быть решена с
помощью процедуры, состоящей в выполнении следующих
шагов:
1. Положить / = п .
2. Если / > 1, то положить х 1 равным 1 и 5 равным
5 - Ъ1, если 8 >Ъп и положить х г равным 0 в противном
случае.
3. Положить г равным / -1 и возвратиться к шагу 2.
В системе, основанной на проблеме рюкзака, величина п
является параметром системы.
Для вычисления открытого и соответствующего секретного
ключа каждый из абонентов системы осуществляет следующую
последовательность действий.
324
Системы с открытыми ключами
1. Выбирает супервозрастающую последовательность
п
(ЪХ,Ъ2 ) и модуль т , такой, что т > У^ Ъ 1 .
/=1
2. Выбирает случайное число IV, I <РГ < т — 1, такое,
что НОД(1Г,т) = 1.
3. Выбирает случайную перестановку к чисел
{1,2,...,и}.
4. Вычисляет = Ж • 6^ /) тоб /я для / = 1, л .
Открытым ключом является набор ( а ,,а 2,...,аЛ) , секретным
ключом — набор (7Г,т,1У,(Ъх,...,ЪпУ) .
Чтобы зашифровать сообщение М9 предназначенное для
абонента А , абонент В осуществляет следующие шаги с помощью
открытого ключа (а 15а 2,...,а„) абонента А :
1. Представляет М в виде бинарной последовательности
М = М хМ 2...Мп длины п .
п
2. Вычисляет С = ^ /М 1 •а1 и направляет его к А .
/=1
Абонент А , получив С , вычисляет Н = С тюб т , а
затем, решая “проблему рюкзака” для супервозрастающей
последовательности, находит числа е {0,1}, такие, что
1 = 1
Биты последовательности М 1 вычисляются по формуле
= г *(,)> 1 = Ъп.
Корректность проведенной процедуры расшифрования
вытекает из следующих рассуждений. Поскольку
325
I лава 11
Н ш К - ' - С ш Ц Г - ' ^ М г ч ш ^ М , - К и)(тойт)
1=1 1=1
п
и 0 <Н <т,то Н = ^ М Г Ъя^ , и, следовательно, алгоритм
/=1
решения “проблемы рюкзака” действительно находит биты
открытого текста, переставленные в соответствии с перестановкой
п .
Вместе с тем доказано, что существует алгоритм полиномиальной
сложности, который может быть использован противником
для получения открытого текста М по шифртексту
С . Этот алгоритм, исходя из а1, находит пару таких целых
чисел их,т], ч то отношение щ/щ близко к отношению и/т
(где и = И/'~1 тодт, а IV, т являются частью секретного
ключа). Кроме того, числа Вг = щ • а1 (тос!т), 1 < / < п , образуют
супервозрастающую последовательность. Эта последовательность
затем используется противником вместо
(&1 для дешифрования сообщения.
Контрольные вопросы
1. В чем состоят преимущества систем с открытыми ключами
перед симметричными шифрсистемами?
2. Сложностью какой математической задачи определяется
стойкость системы К8А?
3. К какому типу принадлежит схема шифрования, используемая
в системе Эль-Гамаля? В чем ее преимущества?
4. Чем вызваны трудности в практической реализации системы
Мак-Элиса?
5. Придумайте алгоритм вычисления аа(шос1 «), имеющий
сложность 0 (1п п).
6. Постройте пример шифра Эль-Гамаля для р = 127. Зашифруйте
и расшифруйте выбранное Вами т < 126.
326
Глава 12
Идентификация
Все протоколы идентификации включают двух участников:
1) А — доказывающего — участника, проходящего идентификацию,
и
2) В — проверяющего — участника, проверяющего аутентичность
доказывающего.
Целью протокола является проверка того, что проверяемым
действительно является^.
С точки зрения проверяющего возможными исходами
протокола являются либо принятие решения об идентичности
доказывающего А, либо завершение протокола без принятия
такового решения.
Протоколы идентификации могут быть разбиты на три
большие категории в зависимости от того, на чем основана
идентификация.
1. Протоколы, основанные на известной обеим сторонам
информации. Такой информацией могут быть пароли,
личные идентификационные номера (РШ от английского
регзопа1 Шеп1фсаИоп питЪег\ секретные или открытые
ключи, знание которых демонстрируется во время выполнения
протокола.
2. Протоколы, использующие некоторые физические приборы,
с помощью которых и проводится идентификация.
Таким прибором может быть магнитная или интеллектуальная
пластиковая карта, или прибор, генерирующий меняющиеся
со временем пароли.
3. Протоколы, использующие физические параметры, составляющие
неотъемлемую принадлежность доказывающего.
В качестве таковых могут выступать подписи, отпе327
Глава 12
чатки пальцев, характеристики голоса, геометрия руки и
т. д. Протоколы, использующие такие параметры, не носят
криптографического характера и не будут далее рассматриваться.
Одной из основных целей идентификации является обеспечение
контроля доступа к определенным ресурсам, таким,
как банковские счета, телекоммуникационные каналы, компьютерные
программы, базы данных, здания, сооружения и
т.д. Идентификация также обычно является неотъемлемой
частью протокола распределения ключей.
Протоколы идентификации тесно связаны с протоколами
цифровой подписи, но проще их. Последние имеют дело с
меняющимися по содержанию сообщениями и обычно включают
элементы, обеспечивающие невозможность отказа от
подписанного сообщения. Для протоколов идентификации
содержание сообщения, по существу, фиксировано — это
заявление об аутентичности доказывающего А в текущий
момент времени.
§ 12.1. Фиксированные пароли (слабая
идентификация)
Обычная парольная схема основывается на не зависящих
от времени паролях и устроена следующим образом. Для каждого
пользователя имеется пароль, обычно представляющий
собой последовательность длиной от 6 до 10 знаков алфавита,
которую пользователь в состоянии запомнить. Эта последовательность
выступает в качестве общего секрета пользователя
и системы. Для того чтобы получить доступ к системному
ресурсу (база данных, принтер и т.д.), пользователь представляет
свой идентификатор и пароль и прямо или косвенно
определяет необходимый ресурс. При этом идентификатор
пользователя выступает как заявка на идентификацию, а пароль
— как подтверждение этой заявки. Различные пароль328
Ибентификация'
ные схемы отличаются между собой по методам хранения
парольной информации в системе и методам ее проверки.
В число угроз данной схеме идентификации, допускающих
возможность проникновения в систему, входят раскрытие
пароля (вне системы) и перехват информации с линий
связи (внутри системы). Угрозой является также опробование
паролей, в том числе с использованием словарей.
Остановимся подробнее на методах хранения паролей в
системе. Наиболее очевидным из них является хранение паролей
в открытом виде в файле, защищенном от записи и считывания
системными средствами. При обращении пользователя
система сравнивает введенный пароль с паролем данного
пользователя, хранимым в файле. Недостаток этого метода
состоит в том, что пароли не защищены от привилегированных
пользователей системы.
Для устранения этого недостатка используются зашифрованные
файлы паролей пользователей. При этом может
использоваться либо непосредственное зашифрование паролей
с помощью того или иного криптографического алгоритма,
либо вычисление значения хэш-функции (см. гл. 13) пароля.
Заметим, что использование шифрования перед передачей
пароля по незащищенному каналу связи хотя и защищает сам
пароль, но не защищает от возможности вхождения противника
в систему путем навязывания перехваченного зашифрованного
пароля.
Поскольку степень защиты указанной системы определяется
сложностью перебора паролей, то на практике используется
целый ряд приемов для усложнения противнику этой
процедуры.
Правила составления паролей
Типичным требованием, предъявляемым при составлении
паролей, является ограничение на минимальную длину паролей.
Примером может служить требование, чтобы пароль
329
I лава 12
имел длину не менее 9 букв или цифр. Другими требованиями
могут быть наличие в пароле хотя бы одного символа из каждого
регистра (верхнего, числового, не алфавитно-цифрового
и т. д.), а также требование, чтобы пароль не мог быть словом
из имеющегося словаря или частью идентификационной информации
доказывающего.
Очевидно, что сложность проникновения в систему определяется
сложностью простейшего из паролей зарегистрированных
пользователей. Лучшими из возможных паролей являются
те, которые выбираются случайно и равновероятно из
всех слов в данном алфавите. Такой выбор может быть реализован
с помощью физического датчика случайных чисел.
Усложнение процедуры проверки паролей
Для того чтобы усложнить атаки, включающие опробование
большого числа паролей, функция, обеспечивающая проверку
паролей (например, однонаправленная функция), может
быть усложнена путем применения нескольких итераций более
простых функций. Вместе с тем число этих итераций не
должно быть слишком большим, чтобы не затруднить доступ
в систему законным пользователям. Необходимо также следить
за тем, чтобы в результате этих процедур не упростилась
задача определения паролей.
“Подсоленные” пароли
Для уменьшения эффективности атак с использованием
словаря каждый пароль, при помещении его в словарь, может
быть дополнен «-битовой случайной последовательностью,
называемой “солью” (она изменяет “вкус” пароля) перед применением
однонаправленной функции. Как хэшированный
пароль, дополненный “солью”, так и “соль” записываются в
файл паролей. Когда в последующем пользователь предъявляет
пароль, система находит “соль” и применяет однонаправленную
функцию к паролю, дополненному “солью”.
330
идентификация
Хотя сложность опробования каждого варианта пароля
при дополнении “солью” не изменяется, тем не менее добавление
“соли” усложняет атаку с целью получения хотя бы
одного пароля из многих. Это происходит потому, что в словаре
должно содержаться 2п вариантов каждого опробуемого
слова, что влечет за собой большие требования к памяти, содержащей
зашифрованный словарь, и соответственно увеличивает
время на его изготовление.
Парольные фразы
Для того чтобы увеличить неопределенность используемых
паролей и вместе с тем не нарушить такое их важное
качество, как возможность запоминания человеком, часто
используются парольные фразы. В этом случае в качестве
пароля используется целое предложение вместо короткого
слова. Парольные фразы хэшируются до фиксированной длины
и играют ту же роль, что и обычные пароли. При этом
фраза не должна просто сокращаться до фиксированной длины.
Идея этого метода состоит в том, что человеку легче запомнить
фразу, чем случайную последовательность букв или
цифр. Парольные фразы обеспечивают большую безопасность,
чем короткие пароли, но требуют большего времени
для ввода.
§ 12.2. Атаки на фиксированные пароли
Повторное использование паролей
Принципиальной слабостью схем, неоднократно использующих
фиксированные пароли, является возможность получения
противником этих паролей одним из следующих способов:
— путем просмотра при введении с клавиатуры,
— путем получения документов, содержащих эти пароли,
331
I лава 12
— путем перехвата их из каналов связи, используемых
пользователями для связи с системой, или из самой системы,
поскольку пароли используются в открытом виде.
Все это дает возможность противнику осуществить доступ
к системе, имитируя законного пользователя.
Таким образом, фиксированные пароли нельзя использовать
в случае их передачи по незащищенным каналам связи, в
особенности по эфир^.
Заметим, что при использовании процедуры идентификации
на абонентском пункте для получения доступа к ресурсу
сервера (например, при идентификации кредитной карточки
банкоматом в режиме оп-Нпе) системный ответ (“идентификация
А” или “завершение протокола без идентификации”) должен
быть также защищен, как и представляемый пароль. Он
должен меняться во времени, чтобы не дать противнику возможность
использовать системный ответ “идентификация А”.
Тотальный перебор паролей
Простейшей атакой противника на систему с фиксированными
паролями является перебор всех возможных вариантов
до тех пор, пока истинный пароль не будет найден. Особенно
опасна эта атака в режиме о#-Нпе, поскольку в этом
случае не требуется непосредственного контакта доказывающего
с проверяющим, и поэтому число безуспешных попыток
проверки пароля в единицу времени не может быть ограничено,
как это обычно делается при проверке в режиме оп-Нпе.
Эффективность указанной атаки впрямую зависит от числа
попыток до обнаружения первого пароля, обеспечивающего
доступ в систему или к ее ресурсу, а также от временной
сложности реализации каждой из таких попыток.
Атаки с помощью словаря
Вместо тотального перебора всех возможных паролей
противник может прибегнуть к их перебору в порядке убыва332
идентификация
ния вероятности их использования. Этот метод обычно эффективен
в том случае, когда пароли выбираются пользователем
и, как правило, являются неравновероятными. Во многих
случаях эти пароли выбираются из словаря. Обычные словари
содержат, как правило, не более 150 тыс. слов, что намного
меньше числа всех всего лишь 6-буквенных паролей.
В этом случае противником может быть реализована так
называемая атака с использованием словаря. Для повышения
эффективности атаки противником создается и записывается
на диск хэшированный файл слов из используемого для выбора
паролей словаря. Хэшированные значения из файла системных
паролей могут быть отсортированы (используя обычные
алгоритмы сортировки) и сравнены со словами из созданного
файла. Атаки с использованием словаря, как правило,
приводят не к нахождению пароля фиксированного пользователя,
а к нахождению одного или нескольких паролей, обеспечивающих
доступ в систему.
Личные идентификационные номера
Личные идентификационные номера относятся к категории
фиксированных паролей. Они обычно используются в
приложениях, связанных с пластиковыми картами, для доказательства
того, что данный участник является действительным
владельцем карты и как таковой имеет право доступа к
определенным системным ресурсам. Ввод личного идентификационного
номера требуется во всех случаях, когда используется
пластиковая карта. Это обеспечивает дополнительный
рубеж безопасности, если карта утеряна или похищена.
В силу исторических обстоятельств (и для удобства пользователей)
личный идентификационный номер является цифровым
и содержит от 4-х до 8 цифр. Для того чтобы обеспечить
защиту от его тотального перебора, применяются дополнительные
организационные меры. Например, большинство
банкоматов при троекратном вводе неправильного номера
333
/ лава 12
блокируют кредитную карту. Для ее разблокирования требуется
ввести уже более длинный номер. Поскольку люди, как
правило, не могут запомнить ключи настолько длинные, чтобы
с их помощью можно было бы обеспечить необходимую
информационную безопасность системы, часто используется
следующая двухступенчатая процедура идентификации пользователя.
Сначала с помощью личного идентификационного номера
проверяется личность лица, вводящего пластиковую карту,
а затем содержащаяся в пластиковой карте дополнительная
ключевая информация используется для идентификации его в
системе (как действительного владельца пластиковой карты,
имеющего определенные права доступа в системе). Таким
образом, пользователь, имеющий пластиковую карту, должен
помнить только короткий личный идентификационный номер,
в то время как более длинный ключ, содержащийся на
карте, обеспечивает необходимый уровень криптографической
безопасности при идентификации в системе, использующей
незащищенные каналы связи.
Одноразовые пароли
Повышению надежности идентификации служит использование
одноразовых паролей, то есть паролей, которые могут
быть использованы для идентификации только один раз. Такие
схемы обеспечивают защиту от противника, использующего
перехват паролей из незащищенного канала.
Существуют три схемы использования одноразовых паролей:
1 ) пользователи системы имеют общий список одноразовых
паролей, который доставляется по защищенному от перехвата
каналу связи;
2) первоначально пользователь и система имеют один
общий секретный пароль. Во время идентификации, использующей
пароль /, пользователь создает и передает в систему
334
Идентификация
новый пароль ( I + 1 ), зашифрованный на ключе, полученном
из пароля /;
3) пользователи системы используют одноразовые пароли
на основе однонаправленной функции.
При использовании третьей схемы пользователь начинает
с секретного пароля и с помощью однонаправленной функции
Н(м?) вырабатывает итерации
ад, я ( а д ) , я(Я(...(ад...) - н п (*о.
п
Паролем для /-й идентификации, 1 < / < п , является
^ = Н п~1(ч>).
Для того чтобы идентифицировать себя при /*-й попытке,
А передает В строку (А, /, щ). В проверяет соответствие полученного
/ номеру попытки и равенство Н(уу1 ) = >г/_1 . Если оба
равенства выполнены, В идентифицирует А и запоминает
(/, м?г) для следующей попытки идентификации.
Заметим, что последний протокол не защищает от активного
противника, который перехватывает, сохраняет и блокирует
передачу информации от А кВ для последующей попытки
подмены собой пользователя А. Поэтому этот протокол
может быть использован только для идентификации пользователя
системой, идентичность которой уже установлена.
§ 12.3. “Запрос-ответ” (сильная
идентификация)
Идея построения криптографических протоколов идентификации
типа “запрос-ответ” состоит в том, что доказывающий
убеждает проверяющего в своей аутентичности путем
демонстрации своего знания некоторого секрета без
предъявления самого секрета. Знание секрета подтверждается
выдачей ответов на меняющиеся с течением времени запросы
проверяющего. Обычно запрос — это число, выбирае-
335
Глава 12
мое проверяющим при каждой реализации протокола. Если
канал связи контролируется противником, любое допустимое
число реализаций протокола идентификации не должно давать
противнику возможность извлечения информации, необходимой
для последующей ложной идентификации. В таких
протоколах обычно используются либо случайные числа,
либо числа из неповторяющихся (обычно возрастающих) последовательностей,
либо метки времени. Остановимся подробно
на последних двух вариантах.
Числа из неповторяющихся последовательностей используются
как уникальные метки сообщений, обеспечивающие
защиту от навязывания ранее переданных сообщений. Такие
последовательности чисел используются независимо для каждой
пары доказывающего и проверяющего. Кроме того, при
передаче информации от А кВ пот В к А также используются
различные последовательности чисел.
Стороны следуют заранее определенной политике по выработке
таких последовательностей. Сообщение принимается
только тогда, когда его число (метка сообщения) не было
использовано ранее (или в определенный предшествующий
период времени) и удовлетворяет согласованной политике.
Простейшей политикой является такая: последовательность
начинается с нуля и каждое следующее число увеличивается
на единицу. Менее жесткая политика состоит в том, что принятые
числа должны только монотонно возрастать. Это позволяет
работать с учетом возможности потери сообщений из-
за ошибок в каналах связи.
Недостатком метода использования последовательностей
чисел является необходимость запоминания информации,
касающейся каждого доказывающего и каждого проверяющего,
а также невозможность обнаружения сообщений, специально
задержанных противником.
Метки времени используются для обеспечения гарантий
своевременности и единственности сообщений, а также для
336
ИОентификация
обнаружения попыток навязывания ранее переданной информации.
Они также могут быть использованы для обнаружения
попыток задержки информации со стороны противника.
Протоколы, использующие метки времени, реализуются
следующим образом. Сторона, направляющая сообщение,
снимает показания своих системных часов и криптографически
“привязывает” их к сообщению. Получив такое сообщение,
вторая сторона снимает показания своих системных часов
и сравнивает их с показаниями, содержащимися в сообщении.
Сообщение принимается, если его временная метка
находится в пределах приемлемого временного окна — фиксированного
временного интервала, выбранного из расчета
времени, необходимого для обработки и передачи максимально
длинного сообщения и максимально возможной рассинхронизации
часов отправителя и получателя. В отдельных
случаях для приема сообщения необходимо, кроме указанного
выше, обеспечить выполнение условия, чтобы та же самая
(или более ранняя) метка времени не приходила ранее от того
же самого абонента.
Надежность методов, основанных на метке времени, зависит
от надежности и точности синхронизации системных
часов, что является главной проблемой в таких системах.
Преимуществами указанных систем является меньшее число
передаваемых для идентификации сообщений (как правило,
одно), а также отсутствие требований по сохранению информации
для каждой пары участников (как в числовых последовательностях).
Временные метки в протоколах могут быть
заменены запросом, включающим случайное число, и ответом.
“Запрос-ответ” с использованием симметричных
алгоритмов шифрования
Механизм реализации идентификации с помощью алгоритмов
“запрос-ответ” требует, чтобы доказывающий и про337
I лава 12
веряющий имели общий секретный ключ. В небольших системах
такими ключами может быть обеспечена каждая пара
корреспондентов заблаговременно. В больших системах установление
общего ключа может быть обеспечено путем передачи
его по защищенному каналу обоим корреспондентам из
доверенного центра.
Для описания алгоритмов введем следующие обозначения:
2л — случайное число, вырабатываемое А;
1а — временная метка А;
Ек — алгоритм шифрования на ключе к;
Ш (В) — идентификатор В.
1. Односторонняя идентификация с использованием временной
метки.
Доказывающий А передает проверяющему В свою временную
метку и идентификатор, зашифрованные на общем
ключе:
А-> В:Ек (1а ,Ш(В)).
Проверяющий В, расшифровав данное сообщение, проверяет
соответствие допустимому интервалу временной метки и совпадение
полученного и собственного идентификаторов. Последнее
необходимо для того, чтобы не дать противнику возможности
немедленно переадресовать сообщение к А,
2. Односторонняя идентификация с использованием случайных
чисел.
Временные метки могут быть заменены случайными числами
с помощью дополнительной пересылки:
(1) А <— В : 2Н,
(2) А ^ В : Е к{гвМ{В ) \
В данном протоколе проверяющий В, расшифровав сообщение,
проверяет, соответствует ли полученное число случайному
числу, переданному им на шаге (1). После этого он про338
идентификация
веряет, соответствует ли его идентификатор полученному
идентификатору.
Для предотвращения криптоанализа Ек с помощью специально
подобранных открытых текстов А может ввести в (2)
свое случайное число так же, как в следующем протоколе.
3. Взаимная идентификация с использованием случайных
чисел.
Эта процедура описывается с помощью следующего протокола:
(1) А <— В : 2В,
(2) А -+ В :Е к(2А, г в ,Ш(В)),
(3) А<- В :Ек {гА, г в ).
Получив сообщение на шаге (2), проверяющий В рас-
шифровывает его и осуществляет те же проверки, что и выше.
После этого он использует на шаге (3). Доказывающий А,
расшифровав (3), проверяет соответствие полученных случайных
чисел тем, которые использовались ранее в ( 1) и (2).
“Запрос-ответ” с использованием асимметричных
алгоритмов шифрования
В протоколе идентификации, построенном на основе
шифрсистемы с открытым ключом, доказывающий может
продемонстрировать владение секретным ключом одним из
двух способов:
— при расшифровании запроса, зашифрованного на его
открытом ключе;
— при проставлении под запросом своей цифровой подписи
(см. гл. 15).
Рассмотрим эти два способа более подробно.
Пусть к — некоторая однонаправленная функция и Ел и
В л — алгоритмы зашифрования и расшифрования абонента^.
Первый способ основан на следующем протоколе:
339
I лава 12
(1) А <г- В : И(г), ЩВ), Еа (2, Ш(В%
(2) А -> В : 2.
Проверяющий В выбирает случайное число г, вычисляет
к{2) и запрос с = Еа (г, Ш(В)). Доказывающий А расшифровывает
с и проверяет совпадение значений хэш-функции и
идентификаторов. Если получено различие, то А прекращает
протокол. В противном случае А посылает 2 проверяющему В.
В идентифицирует Л, если полученное от А число г совпадает
с имеющимся у него числом.
Использование однонаправленной хэш-функции предотвращает
попытки криптоанализа с помощью выбранного
открытого текста.
Рассмотрим теперь протокол, использующий цифровую
подпись. Пусть 2А, 1а обозначают соответственно случайное
число и метку времени доказывающего А, 8А обозначает алгоритм
цифровой подписи А. Будем считать, что алгоритм
проверки цифровой подписи доказывающего известен проверяющему.
Для идентификации могут быть использованы следующие
три протокола.
1. Односторонняя идентификация с использованием временных
меток:
(1) А ^ В : 1а,ЩВ) , 8а(1аМ В ) ) .
Получив сообщение, пользователь В проверяет, что временная
метка находится в допустимом интервале, Ш (В) совпадает
с его собственным идентификатором, а также то, что
цифровая подпись под этими двумя полями верна.
2. Односторонняя идентификация с использованием случайных
чисел:
(1) А <— В : г в ,
(2) А -> В : гА,Ш(В),8 А( гА, г в ,Ш(В)).
340
Идентификация
Получив сообщение, пользователь В проверяет, что Ы (В)
соответствует его идентификатору и что цифровая подпись
под строкой (2а, 2в9 Ш (В)) верна.
3. Взаимная идентификация с использованием случайных
чисел:
(1) А<—В : г в ,
(2) А В : 2А,М(В),8А(гА, 2в ,Ш(В)),
(3) А < -В :Ш(А),8в(2н,2а,1с1(А)).
§ 12.4. Протоколы с нулевым разглашением
Недостатком протоколов с фиксированным паролем является
то, что доказывающий А передает проверяющему В
свой пароль, вследствие чего В может в последующем выдать
себя за А. Протоколы типа “запрос-ответ” ликвидируют этот
недостаток. При их выполнении А отвечает на запросы В,
меняющиеся во времени, не давая В информации, которую
тот может использовать, чтобы выступать от имени А. Тем не
менее А может выдать некоторую частичную информацию о
своем секрете.
Протоколы с нулевым разглашением призваны решить эту
проблему, давая возможность доказывающему продемонстрировать
знание секрета, не выдавая о нем никакой информации. Точнее
говоря, выдается только один бит информации, обозначающий
то, что доказывающий знает секрет.
В протоколах с нулевым разглашением термин “доказательство”
имеет смысл, отличный от традиционно принятого в математике.
Доказательство имеет вероятностный характер. Это означает,
что утверждение имеет место с некоторой вероятностью, которая
может быть выбрана сколь угодно близкой к единице.
Примером такого протокола является протокол Фиата —
Шамира. Он основывается на сложности задачи извлечения квадратного
корня по модулю большого составного числа п с неиз341
I лава 12
вестным разложением на множители. Как известно, эта задача
эквивалентна задаче разложения числа п на множители.
А доказывает В знание секрета 5 с помощью I итераций следующего
трехшагового протокола.
Доверенный центр Т выбирает модуль п=р^ и сообщает его
всем доказывающим. При этом числа р и д остаются секретными.
Каждый доказывающий А выбирает секрет 5, которым является
число, взаимно простое с п , 1 < 5 < п - 1, вычисляет значение V =
82 тоб п и объявляет V своим открытым ключом.
Следующие три шага производятся независимо / раз, причем
В принимает доказательство владения А секретом 8, если все эти
итерации приводят к положительному ответу.
1. А выбирает случайно 2, 1 < 2 < и - 1, и посылает В число х =
г2 т о<1п.
2. В случайно выбирает бит с и направляет его А.
3. А вычисляет и направляет В число у, равное либо 2, если с =
О, либо 28 шод п , если с - 1 .
В дает положительный ответ, если у Ф 0 и
у 2 = хус(тос1 п ) .
Заметим, что в зависимости от значения бита с выполнено одно
из двух условий: у 2 = х (т о <1 п) или у 2 = хг(тос1 п) , так
как V = 82 (тос!п) . Проверка равенства у = 0 исключает случай г
= 0.
Корректность протокола может быть обоснована следующими
рассуждениями.
Наличие запроса с требует, чтобы А был в состоянии ответить
на любой из двух вопросов, ответ на один из которых требует знания
секрета лг, а ответ на другой предотвращает попытку обмана.
Противник, выдающий себя за А, может попытаться обмануть
проверяющего, выбрав любое число г и передав В число х = 2%.
342
Идентификация
Тогда он сможет ответить на запрос “с = 1”, направив правильный
ответ “у = г”, но не сможет ответить на запрос “с = 0”, ответ на
который требует знания корня квадратного из числах по модулю п.
Доказывающий А, знающий 5, в состоянии ответить на оба
вопроса. Если же он не знает $, то в лучшем случае — на один из
двух вопросов. Таким образом, обман удается с вероятностью, не
превышающей 1/2. При /-кратной итерации протокола вероятность
обмана может быть доведена до величины, не превышающей 2 .
Ответ “у = 2” не зависит от секрета 5 доказывающего А, а ответ
66у = 28 тоб я” также не несет информации о 5, так как случайное 2
не известно проверяющему В.
Идеи, лежащие в основе протоколов с нулевым разглашением,
могут быть сформулированы следующим образом.
Доказывающий А выбирает случайный элемент из заранее
оговоренного множества, как свой секретный ключ для данной
итерации протокола, вычисляет, используя его как аргумент некоторой
однонаправленной функции, ее значение, и предъявляет это
значение проверяющему. Этим обеспечивается случайность и
независимость различных итераций протокола и определяется
набор вопросов, на каждый из которых доказывающий готов дать
ответ. Протокол построен так, что только доказывающий А, владеющий
секретом $9 в состоянии ответить на все эти вопросы, и ни
один ответ не дает информации о секрете. На следующем этапе В
выбирает один из этих вопросов и А дает на него ответ, который
затем проверяется В. Осуществляется необходимое число итераций
протокола с целью снизить до приемлемого уровня вероятность
обмана.
Другими словами, в основе протоколов с нулевым разглашением
лежит комбинация идей протоколов типа “режь и выбирай”
(этот термин происходит от стандартного метода, которым дети
делят кусок пирога: один режет, а другой выбирает) и протоколов
типа “запрос-ответ”.
343
I лава 12
§ 12.5. Атаки на протоколы идентификации
В заключение приведем перечень атак на протоколы идентификации
и методов их отражения, часть из которых уже упоминалась
выше.
1. Подмена — попытка подменить одного пользователя другим.
Методы противодействия состоят в сохранении в тайне от
противника информации, определяющей алгоритм идентификации.
2. Повторное навязывание сообщения (гер1ау) — подмена или
другой метод обмана, использующий информацию ранее проведенного
протокола идентификации того же самого или другого
пользователя.
Методы противодействия включают использование протоколов
типа “запрос-ответ”, использование временных меток, случайных
чисел или возрастающих последовательностей чисел.
3. Комбинированная атака {\п1ег1еахчщ аПаск) — подмена
или другой метод обмана, использующий комбинацию данных из
ранее выполненных протоколов, в том числе протоколов, ранее
навязанных противником.
Метод противодействия состоит в обеспечении целостности
проводимых протоколов и отдельных сообщений.
4. Атака отражением — комбинированная атака, использующая
посылку части информации только что проведенного протокола
доказывающему.
Методы противодействия включают введение в протокол
идентификационной информации проверяющего, использование
различных ключей для приема и передачи сообщений.
5. Задержка передачи сообщения (/огсес/ с/е1ау) — перехват
противником сообщения и навязывание его в более поздний момент
времени.
Методы противодействия включают использование случайных
чисел совместно с ограничением временного промежутка для
ответа, использование временных меток.
344
ИОентификация
6. Атака с использованием специально подобранных текстов—•
атака на протоколы типа “запрос-ответ”, при которой
противник по определенному правилу выбирает запросы с целью
получить информацию о долговременном ключе доказывающего.
Эта атака может включать специально подобранные открытые
тексты, если доказывающий должен подписать или зашифровать
запрос, и специально подобранные шифрованные тексты, если
доказывающий должен расшифровать запрос.
Методы противодействия этой атаке состоят во включении
случайных чисел в запросы или ответы, а также в использовании
протоколов с нулевым разглашением.
7. Использование противником своих средств в качестве
части телекоммуникационной структуры — атака, при которой в
протоколе идентификации между А и В противник С входит в
телекоммуникационный канал и становится его частью при реализации
протокола между А и В. При этом противник может подменить
информацию, передаваемую между А и В. Эта атака особенно
опасна в случае установления А и В общего ключа по протоколу
Диффи — Хеллмана.
Противодействие этой атаке состоит в использовании защищенного
канала для установления общего ключа между
А и В.
В заключение заметим следующее. Идентификация может
быть гарантирована только в момент времени после завершения
протокола. При этом имеется опасность того, что противник подключится
к линии связи после окончания процесса идентификации,
выдавая себя за законного пользователя. Для исключения
этой возможности следует совместить процесс идентификации с
процессом установления общего сеансового ключа, который должен
быть использован для защиты передаваемой информации до
следующей реализации протокола идентификации.
345
I лава 12
Контрольные вопросы
1. На какие группы могут быть разбиты алгоритмы идентификации?
2. В чем состоят недостатки систем с фиксированными паролями?
3. За счет чего повышается надежность идентификации при использовании
пластиковой карты и личного идентификационного
номера?
4. Каковы возможные схемы использования одноразовых паролей?
5. Для каких целей используется временная метка в протоколе
типа “запрос-ответ”?
6. Чем могут быть заменены временные метки в протоколах типа
“запрос-ответ”?
7. Какая идея лежит в основе протоколов с нулевым разглашением?
8. Какие типы атак могут бьггь использованы при нападении на
протоколы идентификации?
346
Глава 13
Криптографические хэш-функции
§ 13.1. Функции хэширования и целостность
данных
Хэш-функции — это функции, предназначенные для
“сжатия” произвольного сообщения или набора данных, записанного,
как правило, в двоичном алфавите, в некоторую битовую
комбинацию фиксированной длины, называемую
сверткой. Хэш-функции имеют разнообразные применения
при проведении статистических экспериментов, при тестировании
логических устройств, при построении алгоритмов быстрого
поиска и проверки целостности записей в базах данных
(см., например, [Кну99]). Например, для осуществления
быстрого поиска нужного сообщения в большом списке сообщений
различной длины удобнее сравнивать друг с другом
не сами сообщения, а короткие значения их сверток, играющих
одновременно роль контрольных сумм. Основным требованием
к таким хэш-функциям является равномерность распределения
их значений при случайном выборе значений аргументов.
В криптографии хэш-функции применяются для решения
следующих задач:
— построения систем контроля целостности данных при
их передаче или хранении,
— аутентификации источника данных.
При решении первой задачи для каждого набора данных
вычисляется значение хэш-функции (называемое кодом аутентификации
сообщения или имитовставкой), которое передается
или хранится вместе с самими данными. При получении
данных пользователь вычисляет значение свертки и
347
I лава 13
сравнивает его с имеющимся контрольным значением. Несовпадение
говорит о том, что данные были изменены.
Хэш-функция, служащая для выработки имитовставки,
должна позволять (в отличие от обычной контрольной суммы)
осуществлять обнаружение не только случайных ошибок в
наборах данных, возникающих при их хранении и передаче,
но и сигнализировать об активных атаках злоумышленника,
пытающегося осуществить навязывание ложной информации.
Для того чтобы злоумышленник не смог самостоятельно вычислить
контрольное значение свертки и тем самым осуществить
успешную имитацию или подмену данных, хэш-функция
должна зависеть от секретного, не известного злоумышленнику,
параметра —- ключа пользователя. Этот ключ должен
быть известен передающей и проверяющей сторонам. Такие
хэш-функции будем называть ключевыми.
Имитовставки, формируемые с помощью ключевых хэш-
функций, не должны позволять противнику создавать поддельные
(сфабрикованные) сообщения (/ЪЬпсаНоп) при атаках
типа имитация (трегяопаНоп) и модифицировать передаваемые
сообщения (мосИ/юаИоп) при атаках типа “подмена”
(зиЫШийоп).
При решении второй задачи — аутентификации источника
данных — мы имеем дело с не доверяющими друг другу
сторонами. В связи с этим подход, при котором обе стороны
обладают одним и тем же секретным ключом, уже неприменим.
В такой ситуации применяют схемы цифровой подписи,
позволяющие осуществлять аутентификацию источника данных.
Как правило, при этом сообщение, прежде чем быть
подписано личной подписью, основанной на секретном ключе
пользователя, “сжимается” с помощью хэш-функции, выполняющей
функцию кода обнаружения ошибок (см. далее). В
данном случае хэш-функция не зависит от секретного ключа и
может быть фиксирована и известна всем. Основными требованиями
к ней являются гарантии невозможности подмены
подписанного документа, а также подбора двух различных
348
Хэш-функции
сообщений с одинаковым значением хэш-функции (в этом
случае говорят, что такая пара сообщений образует коллизию).
Формализуя сказанное, введем следующее определение.
Обозначим через X множество, элементы которого будем называть
сообщениями. Обычно сообщения представляют собой
последовательности символов некоторого алфавита, как правило,
двоичного. Пусть У — множество двоичных векторов
фиксированной длины.
Хэш-функцией называется всякая функция Н:Х —> К,
легко вычислимая и такая, что для любого сообщения М значение
Н(М) = Н (свертка) имеет фиксированную битовую
длину.
Обычно число возможных сообщений значительно превосходит
число возможных значений сверток, в силу чего для
каждого значения свертки имеется большое множество прообразов,
то есть сообщений с заданным значением хэш-
функции. Заметим, что при случайном и равновероятном
выборе сообщений условие равномерности распределения
значений хэш-функции эквивалентно наличию одинакового
числа прообразов для каждого значения свертки.
Как правило, хэш-функции строят на основе так называемых
одношаговых сжимающих функций у = / ( х п х2) двух
переменных, где х, и у — двоичные векторы длины т и п
соответственно, причем п — длина свертки. Для получения
значения Н{М) сообщение М сначала разбивается на блоки
длины т (при этом если длина сообщения не кратна /??, то последний
блок неким специальным образом дополняется до
полного), а затем к полученным блокам М 1? М 2,.., М м
применяют следующую последовательную процедуру вычисления
свертки:
Я 0 = у,
Н, =/(М„//,_,), 1 = (1)
ИМ) = н ы.
349
I лава 13
Здесь V — некоторый фиксированный начальный вектор.
Если функция / зависит от ключа, то этот вектор можно положить
равным нулевому вектору. Если же функция / не зависит
от ключа, то для исключения возможности перебора
коротких сообщений (при попытках обращения хэш-функции)
этот вектор можно составить из фрагментов, указывающих
дату, время, номер сообщения и т. п.
При таком подходе свойства хэш-функции к полностью
определяются свойствами одношаговой сжимающей функции
/
Особо выделяют два важных типа криптографических
хэш-функций — ключевые и бесключевые. Первые применяются
в системах с симметричными ключами. Ключевые хэш-
функции называют кодами аутентификации сообщений
(КАС) (тезза^е аШкепИсаИоп соде (МАС)). Они дают возможность
без дополнительных средств гарантировать как правильность
источника данных, так и целостность данных в
системах с доверяющими друг другу пользователями.
Бесключевые хэш-функции называются кодами обнаружения
ошибок (тодфсаИоп де1есИоп соде (МВС) или
татриШюп де(есИоп соде, тезза§е Ше%гНу соде (М/С)). Они
дают возможность с помощью дополнительных средств (например,
шифрования, использования защищенного канала
или цифровой подписи) гарантировать целостность данных.
Эти хэш-функции могут применяться в системах как с доверяющими,
так и не доверяющими друг другу пользователями.
Рассмотрим их более подробно.
§ 13.2. Ключевые функции хэширования
В криптографических приложениях к ключевым функциям
хэширования предъявляются следующие основные требования:
— невозможность фабрикации;
— невозможность модификации.
350
Хэш-функции
Первое требование означает высокую сложность подбора
сообщения с правильным значением свертки. Второе — высокую
сложность подбора для заданного сообщения с известным
значением свертки другого сообщения с правильным
значением свертки.
Иногда эти свойства объединяют в одно более сильное
свойство — свойство вычислительной устойчивости. Это
требование означает высокую сложность подбора для заданного
множества сообщений {х19..,х,} (быть может, пустого) с
известными значениями сверток еще одного сообщения х,
х Ф X;, / = 1,...,/, с правильным значением свертки (возможен
случай И(х) = И(х1) , / € (1,..., /}).
Заметим, что здесь и всюду ниже слова “высокая сложность”
означают такую вычислительную сложность задачи,
при которой ее решение с использованием вычислительной
техники за реальное время невозможно.
Ключевые функции применяются в ситуациях, когда стороны
доверяют друг другу и могут иметь общий секретный
ключ. Обычно в этих условиях не требуется, чтобы система
обеспечивала защиту в случае отказа получателя от факта получения
сообщения или его подмены. Поэтому от ключевых
хэш-функций не требуется устойчивости к коллизиям.
Обычные атаки на ключевые хэш-функции заключаются
в имитации, то есть в передаче сфабрикованных сообщений в
пустом канале, а также в подмене передаваемых сообщений с
целью навязывания приемной стороне ложных сообщений.
Заметим, что из свойства вычислительной устойчивости
вытекает невозможность определения ключа, используемого
хэш-функцией, так как знание ключа дает возможность вычислять
значение свертки для любого набора данных. В то же
время обратное утверждение неверно, так как подбор значения
функции хэширования возможен в некоторых случаях без
предварительного определения ключа.
351
I лава 13
В качестве примера рассмотрим широко распространенную
хэш-функцию, построенную на основе одношаговой
сжимающей функции вида
/ к(х,Н) = Ек( хФН) ,
где Ек — алгоритм блочного шифрования.
Для вычисления значения И(М) сообщение М представляется
в виде последовательности ^-битовых блоков
М\,М2>-'№ы • Если при этом длина сообщения не кратна длине
блока, то последний блок неким специальным образом дополняется
до полного блока. Алгоритм вычисления свертки имеет
следующий вид:
н 0 =0,
Я, = Е к(М,®Н,_1), 1 = 1,..., Я , (2)
к (М) = Н ы.
Данный алгоритм фактически совпадает с режимом шифрования
со сцеплением блоков (см. гл. 8), с той лишь разницей,
что в качестве результата берется не весь шифртекст
Н Х^Н2, .. ,НМ, а только его последний блок. Такой режим в
ГОСТе 28147-89 называется режимом выработки имитовставки.
Еще одной основой для построения ключевых хэш-
функций могут служить бесключевые хэш-функции. При этом
для вычисления значения свертки ключ приписывается к исходному
сообщению.
Заметим, что если ключ просто дописывать в начало или
в конец исходного сообщения, то это может приводить к потенциальным
слабостям, позволяющим в некоторых случаях
осуществлять модификацию сообщений.
352
Хэш-функции
Пусть, например, ключ к добавляется к началу сообщения
согласно формуле кк{х) = к(к,х) . Если функция И построена
на основе одношаговой сжимающей функции по формуле ( 1 ),
то по известным значениям М и Н = к{к, М) можно вычислять
значения этой функции для любых сообщений вида
{ММ') с дописанным произвольным окончанием М\ Это объясняется
итеративностью процедуры вычисления функции, в
силу которой для нахождения значения Н'=к{кМ*М') не
требуется знание ключа к, достаточно воспользоваться уже
вычисленным “промежуточным” значением Н. Поэтому такая
функция не устойчива к модификации.
В случае когда ключ добавляется в конец сообщения согласно
формуле Н = кк(М) = к(М, к ) , знание коллизии для
функции А, то есть пары х 19х 2, х 1 * х 29 такой, что
к( хх) = к(х2), позволяет вычислять значения к(х], к) =
= к(х2 9 к) для любого ключа к. Поэтому трудоемкость модификации
сообщения М= X] оценивается не величиной 2"),
а сравнима с трудоемкостью поиска коллизии, оцениваемой
величиной о (2 л/2), так как в данном случае применима атака,
основанная на парадоксе “дней рождений”.
В связи с этим более предпочтительными являются способы
введения ключа, при которых ключ вставляется в сообщение
не один, а, по крайней мере, два раза. В [Меп97] указываются
два таких способа:
Н = к(к, у,М,к) ,
Н = И(к,у1,И(к,у2,М ) ) ,
где у, у\ и у2 — дополнения ключа к до размера, кратного
длине блока п. Для определенных бесключевых хэш-функций
к такой подход позволяет строить эффективно вычислимые и
устойчивые к атакам ключевые хэш-функции. Недостатком
353
/ лава 13
такого метода является слишком большая длина п свертки.
Дело в том, что для целей проверки целостности обычно выбирают
длину свертки п в пределах 32-Н54, а для аутентификации
необходимо условие п > 128.
В заключение отметим, что существуют ключевые хэш-
функции, не использующие какую-либо основу типа блочного
шифрования или вычисления бесключевой хэш-функции, а
разработанные независимо с учетом эффективной реализации
на современных ЭВМ. Примером служит ключевая хэш-
функция, используемая в алгоритме МАА (Мезза^е Ашкеп-
Нса1ог А1%огИкт\ утвержденном стандартом 180 8731-2.
§ 13.3. Бесключевые функции хэширования
Обычно требуется, чтобы бесключевые хэш-функции обладали
следующими свойствами:
1 ) однонаправленность,
2) устойчивость к коллизиям,
3) устойчивость к нахождению второго прообраза,
означающими соответственно высокую сложность нахождения
сообщения с заданным значением свертки; пары сообщений
с одинаковыми значениями свертки; второго сообщения с
тем же значением свертки для заданного сообщения с известным
значением свертки.
Например, хэш-функция СЯС-32, представляющая собой
контрольную сумму, является линейным отображением и поэтому
не удовлетворяет ни одному из этих трех свойств.
Использование в качестве бесключевой хэш-функции
рассмотренной выше функции (2), построенной на основе алгоритма
блочного шифрования в режиме выработки имитовставки,
также нецелесообразно, так как обратимость блочного
шифрования позволяет подбирать входное сообщение для
любого значения свертки при фиксированном и общеизвестном
ключе.
Для построения примера хэш-функции, удовлетворяющей
свойству 1 ), рассмотрим функцию, заданную формулой
354
Хэш-функции
8к(х) = Ек(х)®х 9 где Ек — алгоритм блочного шифрования.
Такая функция является однонаправленной по обоим аргументам.
Поэтому на ее основе можно построить хэш-функцию
по правилу ( 1), определив одношаговую сжимающую функцию
одной из следующих формул:
/ ( х ,Н ) = Ен ( х )@х
ИЛИ
/ ( .Х, Н ) = Ех( Н ) ® Н .
Первая из этих функций лежит в основе российского
стандарта хэш-функции, а вторая — в основе американского
стандарта 8НА.
Справедливо следующее
Утверждение 1. Если функция хэширования к построена
на основе одношаговой сжимающей функции/ по правшу ( 1),
то из устойчивости к коллизиям функции / следует устойчивость
к коллизиям функции А.
Действительно, если у функции А имеется коллизия, то на
некотором шаге / должна существовать коллизия у функции /
(при определении коллизий функцию / ( х ]9х2) следует рассматривать
как функцию от одного переменного, полученного
конкатенацией переменных х х, х2 в один входной вектор).
Укажем взаимозависимость между свойствами 1) и 2).
Утверждение 2. Если хэш-функция устойчива к коллизиям,
то она устойчива к нахождению второго прообраза.
Действительно, если для заданной пары сообщение-
свертка можно подобрать второй прообраз, то полученная пара
сообщений будет составлять коллизию.
Утверждение 3. Устойчивая к коллизиям хэш-функция
не обязана быть однонаправленной.
В качестве примера несжимающей функции приведем
функцию А(х) = х , которая, очевидно, является устойчивой
355
I лава 13
к коллизиям и к нахождению второго прообраза, но не является
однонаправленной.
В качестве примера сжимающей хэш-функции рассмотрим
функцию А, определенную условиями
к(х) = (1, х ) , если битовая длина х равна п,
к(х) = (0,# (х )), если битовая длина х больше п,
где #(х) — сжимающая и-битовая функция, устойчивая к коллизиям.
Функция к также является устойчивой к коллизиям и
к нахождению второго прообраза, но, очевидно, не является
однонаправленной.
Утверждение 4. Пусть к : X ->У — хэш-функция и
| X | > 2 1У |. Тогда если существует эффективный алгоритм
обращения функции к, то существует вероятностный алгоритм
нахождения коллизии функции к с вероятностью успеха,
большей 1/2.
Доказательство. Будем случайно и равновероятно выбирать
сообщение х, вычислять у = к (х ) , х' = к~х(у) и сравнивать
х с х ' . Покажем, что данный алгоритм имеет вероятность
успеха р > 1 / 2 . Под успехом мы понимаем построение
х' , отличного от х.
Пусть X = Х х и ... и Х т — разбиение X на классы, состоящие
из сообщений с одинаковыми значениями хэш-
функции. Ясно, что т < \У\. Легко заметить, что выполняются
следующие соотношения:
Р |у^ |2V-» V2^ \х ~| ^ \х \ I — ЛV=
/ = 1 1л / ! I I / = 1
\Х\-т \Х\-\Г\ 1
= , ^ - > • 1*1 2
Утверждение доказано.
356
Хэш-функции
Заметим, что трудоемкость подбора прообраза для однонаправленной
функции или трудоемкость поиска второго
прообраза оцениваются величиной о (2"). В то же время трудоемкость
поиска коллизии оценивается величиной
так как в данной ситуации применима атака, основанная на
парадоксе “дней рождений”.
Рассмотрим конкретные примеры хэш-функций, построенных
на основе некоторых алгоритмов преобразования блоков.
Пусть Ек — алгоритм блочного шифрования, п — размер
блока, / — размер ключа и О — некоторое отображение, ставящее
в соответствие вектору длины п вектор длины /. Рассмотрим
следующие одношаговые сжимающие функции, построенные
на основе алгоритма
а) /(*> Щ = Ех (Н ) ® Н (Дэвис — Мейер);
б) / ( х ,Н ) = Е0(Н)( х )® х (Матиас — Мейер — Осеас);
в) / ( * ,Н ) = Ев(Н)(х) Ф х Ф Н (Миагучи — Принель).
Значением любой из хэш-функций, построенных по правилу
( 1 ) из приведенных одношаговых сжимающих функций,
является вектор длины п, равной размеру блока. В случае если
эта величина оказывается недостаточной, ее можно увеличить,
заменив одношаговую функцию/ на функцию/! с удвоенной
размерностью значений. Это можно сделать, например,
путем двукратного применения функции / с последующим
перемешиванием полублоков согласно формуле:
/Ч * ,Я РЯ2) = * ( /( * ,Я ,),/(х ,Я 2)),
в которой ж переставляет произвольные полублоки а, Ь, с, с/
по правилу л((а,Ь),(с,с1)) = (#, с1,с,Ь) . Такой подход, ис357
I лава 13
пользующий схему (б), реализован в конструкции одношаговой
функции МОС-2.
Другие примеры бесключевых хэш-функций дают известные
алгоритмы МБ-4, МО-5 и 8НА. Они оперируют с
блоками длины я, совпадающей с длиной результирующего
значения свертки, причем п = 128 для алгоритма МБ-4 и п = =
160 для МО-5 и 8НА. Указанные алгоритмы спроектированы
специально с учетом эффективной реализации на 32-
разрядных ЭВМ.
При их использовании исходное сообщение М разбивается
на блоки длиной т - 512 бит. Последний блок формируется
путем дописывания к концу сообщения комбинации 10...0
до получения блока размера 448 бит, к которому затем добавляется
комбинация из 64 бит, представляющая битовую длину
сообщения. Затем вычисляется значение свертки согласно
процедуре ( 1) с использованием одношаговой сжимающей
функции, заданной формулой / ( х ,Н) = Ех(Н)@Н, где х —
блок сообщения длины т = 512 бит, Я — блок из п бит, а Ех—
некоторое преобразование множества блоков. Значение начального
вектора определяется в описании преобразования Ех.
В стандарте хэш-функции ГОСТ Р 34.11-94 приняты значения
п = т = 512. Одношаговая сжимающая функция
/ ( х ,Я ) , используемая для вычисления последовательности
значений Я, = / (х,, Я /Ч), построена на базе четырех параллельно
работающих схем блочного шифрования (ГОСТ
28147-89), каждая из которых имеет 256-битовый ключ и оперирует
с блоками размера 64 бита. Каждый из ключей вычисляется
в соответствии с некоторой линейной функцией от
блока исходного сообщения х1 и значения Нг.\. Значение Я,
является линейной функцией от результата шифрования, блока
исходного сообщения х, и значения Н1Л. После вычисления
значения Ни для последовательности блоков М]9М2,..9Мм
применяют еще два шага вычисления согласно формуле
я = к(М) = /(2 е м „, /(I, н И)),
358
хэш-функции
где 2 — сумма по модулю два всех блоков сообщения, а Ь —
длина сообщения.
§ 13.4. Целостность данных
и аутентификация сообщений
Термин “аутентификация” означает установление подлинности.
Он может относиться ко всем аспектам взаимодействия:
сеансу связи, сторонам, передаваемым сообщениям и
т. д. Применительно к самой информации аутентификация
означает проверку того, что данные, передаваемые по каналу
связи, являются подлинными по своему источнику и содержанию,
по времени создания, времени пересылки и т. д.
Рассмотрим эти свойства более подробно.
Целостность данных — свойство, позволяющее убедиться
в том, что данные не изменялись неавторизованным способом
с тех пор, как они были созданы, переданы или сохранены
авторизованным источником. Под изменениями обычно
понимают пропуски, вставки, замены и перестановки фрагментов
сообщения.
Аутентификация источника данных — получение подтверждения
того, что рассматриваемый документ был создан
именно указанным соответствующим образом источником
информации. Подчеркнем, что при этом не требуется проверка
времени создания и единственности документа, важно
только то, что он был создан в некоторый (обычно неопределенный)
момент времени в прошлом. Нарушение “единственности
документа” подразумевает его повторную передачу или
повторное использование. Если источник сообщений фиксирован,
то вместо термина “аутентификация источника данных”
используют термин “аутентификация сообщений”.
Целостность данных и аутентификация источника данных
тесно связаны друг с другом. Действительно, если данные
подверглись модификации, то у них автоматически изменился
источник. Если же не установлен источник, то без ссылки на
него нельзя разрешить проблему целостности. В связи с этим
359
Глава 13
будем считать по определению, что аутентификация источника
данных включает проверку целостности данных.
Рассмотрим примеры.
1. Для обеспечения целостности хранимых данных (М) можно
добавить к ним значение криптографической хэш-
функции (М,кк(М)), зависящей от ключа, известного
только владельцу информации. Такой способ автоматически
решает проблему аутентификации источника данных.
2. Для обеспечения целостности передаваемого сообщения
можно так же, как и в п. 1 , использовать хэш-функцию,
зависящую от секретного ключа, известного отправителю
и получателю. Аутентификация источника гарантируется
тем, что секретный ключ известен только двум сторонам.
При этом, однако, исключается возможность разрешения
споров, связанных с отказом от авторства. Поэтому аутентификация
источника с помощью ключевой хэш-функции
возможна только при взаимодействии доверяющих друг
другу сторон.
3. При аутентификации источника можно использовать
симметричное шифрование, добавляя предварительно к
исходному сообщению некоторый секретный, известный
только отправителю и получателю, идентификатор. Такой
способ, однако, не гарантирует целостности получаемых
данных. Дело в том, что шифрование может допускать
возможность модификации данных при передаче. Кроме
того, для его реализации требуется секретный канал для
обмена подобными идентификаторами.
4. Аутентификация источника возможна также при совместном
использовании бесключевой хэш-функции и симметричного
шифрования. Для этого достаточно воспользоваться
одной из следующих форм передаваемого сообщения:
Е к(М,к(МУ) или (М ,Е к{Н{М) )). В рассматриваемом
случае можно повторить те же комментарии, что и
в п. 2. К этому следует добавить, что алгоритм шифрова360
Хэш-функции
ния Ек должен быть стойким к атакам на основе известного
открытого текста.
5. На практике чаще, чем предыдущие, применяются схемы,
использующие бесключевые хэш-функции в сочетании с
асимметричным шифрованием. Подобным образом на основе
схемы (М ,Е к(к(М)У) строятся алгоритмы вычисления
цифровой подписи. Подобные схемы позволяют
решать проблему аутентификации источника как при
взаимодействии доверяющих друг другу, так и не доверяющих
друг другу сторон.
6. Возможно совместное использование ключевой хэш-
функции и симметричного шифрования в соответствии с
одной из следующих схем:
Е к{(М,Нк2(М) ) ,
(Ек1(М),Нк2(М) ) ,
(Ек](М),Нк2(Ек1(М) ) ) ,
и т. д. При таком подходе не только ключи шифрования
(к\) и хэш-функции (к2) должны быть независимыми, но и
сами алгоритмы шифрования и вычисления значения
хэш-функции также должны иметь существенные различия.
В противном случае возникают дополнительные соотношения,
которые можно использовать для отбраковки
ключей.
В заключение рассмотрим вопрос о дополнительном гарантировании
единственности и своевременности передачи
сообщений. В этом случае используется термин “аутентификация
транзакции ”, означающий аутентификацию сообщения
с подтверждением единственности и своевременности передачи
данных. Такой тип аутентификации предоставляет возможность
защиты от повторного использования ранее переданных
сообщений, что является необходимым в тех случаях,
когда подобная угроза может привести к нежелательным по-
361
Iлава 13
следствиям. Примером таких приложений являются электронные
банковские платежи или системы автоматизированного
управления подвижными объектами.
Для обеспечения единственности и своевременности
передачи сообщений обычно используются дополняющие аутентификацию
параметры, которые вставляются в передаваемые
сообщения. Это могут быть метки времени или некоторые
последовательности чисел. Если метки времени позволяют
установить время создания или передачи документа, то
последовательность чисел гарантирует правильность порядка
получения сообщений. Помимо этого для аутентификации
последующих сообщений могут использоваться случайные
числа, передаваемые в предыдущих сообщениях. Такой способ
позволяет организовать “жесткое сцепление” идущих
друг за другом сообщений. Подробно этот подход уже был
рассмотрен в гл. 12.
§ 13.5. Возможные атаки на функции
хэширования
Простейшая атака с целью создания поддельного сообщения,
применимая к любой хэш-функции, состоит в следующем.
Злоумышленник может осуществить генерацию некоторого
числа (гу) сообщений, вычислить значения их сверток и
сравнить получившиеся значения с известными значениями
сверток некоторого множества (из г2) переданных ранее сообщений.
Атака окажется успешной при получении хотя бы
одного совпадения. Вероятность успеха Р можно оценить на
основании парадокса “дней рождений”. Известно, что эта вероятность
оценивается по формуле
г\*1
Р * 1 - е 2* ,
362
Хэш-функции
где п — длина свертки, е — основание натуральных логарифму
мов. Наибольшей эта вероятность становится при гх ~г2 - 2 2.
В этом случае ее значение приблизительно равно 0,63.
Ранее указывалось, что во многих случаях хэш-функции
строятся на основе одношаговых сжимающих функций. Поэтому
имеется тесная связь атак на хэш-функцию с атаками на
соответствующую одношаговую сжимающую функцию. В
частности, последняя должна обладать практически всеми
теми же свойствами, которыми обладает и сама хэш-функция.
Итеративный способ построения хэш-функций позволяет
иногда при ее обращении или построении коллизий использовать
метод “встречи посередине”. Для защиты от этой опасности
в конце сообщения обычно дописывают блоки с контрольной
суммой и длиной сообщения.
Возможны атаки, использующие слабости тех схем, на
базе которых построены хэш-функции. Например, для построения
коллизий хэш-функций, основанных на алгоритмах
блочного шифрования, можно использовать наличие слабых
ключей или свойство дополнения (как это имеет место у алгоритма
ЭЕ8), наличие неподвижных точек (для которых
Ек( х ) = х ), коллизии ключей (то есть пар различных ключей,
для которых выполняется равенство Ек (х) = Ек, (х ) ) и т. п.
Контрольные вопросы
1. Для каких целей применяются хэш-функции?
2. Перечислите основные требования, предъявляемые к хэш-
функциям.
3. Почему нельзя использовать в качестве хэш-функций линейные
отображения?
4. Сравните требования, предъявляемые к ключевым и бес-
ключевым хэш-функциям.
363
Гпава 13
5. Можно ли использовать в качестве бесключевой хэш-
функции ключевую хэш-функцию с фиксированным ключом?
6. Можно ли использовать в качестве ключевой хэш-
функции функцию вида Нк (М ) = к (к (М) , к) ?
Глава 14
Цифровые подписи
§ 14.1. Общие положения
Цифровая подпись для сообщения является числом, зависящим
от самого сообщения и от некоторого секретного, известного
только подписывающему субъекту, ключа. При этом
предполагается, что она должна быть легко проверяемой и
что осуществить проверку подписи должен иметь возможность
каждый без получения доступа к секретному ключу.
При возникновении спорной ситуации, связанной с отказом
подписывающего от факта подписи им некоторого сообщения
либо с попыткой подделки подписи, третья сторона должна
иметь возможность разрешить спор.
Цифровая подпись позволяет решить следующие три задачи:
— осуществить аутентификацию источника сообщения,
— установить целостность сообщения,
— обеспечить невозможность отказа от факта подписи
конкретного сообщения.
Использование термина “подпись” в данном контексте
оправдано тем, что цифровая подпись имеет много общего с
обычной собственноручной подписью на бумажном документе.
Собственноручная подпись также решает три перечисленные
задачи, однако между обычной и цифровой подписями
имеются существенные различия. Сведем основные различия
между обычной и цифровой подписями в таблицу.
365
I лава 14
Собственноручная подпись Цифровая подпись
Не зависит от подписываемого
текста, всегда одинакова
Зависит от подписываемого
текста, практически всегда
разная
Неразрывно связана с подписывающим
лицом, однозначно
определяется его
психофизическими свойствами,
не может быть утеряна
Определяется секретным
ключом, принадлежащим
подписывающему лицу,
может быть утеряна владельцем
Неотделима от носителя
(бумаги), поэтому отдельно
подписывается каждый экземпляр
документа
Легко отделима от документа,
поэтому верна для
всех его копий
Не требует для реализации
дополнительных механизмов
Требует дополнительных
механизмов, реализующих
алгоритмы ее вычисления и
проверки
Не требует создания поддерживающей
инфраструктуры
Требует создания доверенной
инфрастуктуры сертификатов
открытых ключей
Для реализации схемы цифровой подписи необходимы
два алгоритма:
— алгоритм вычисления цифровой подписи
и
— алгоритм ее проверки.
Главные требования к этим алгоритмам заключаются в
исключении возможности получения подписи без использования
секретного ключа и гарантировании возможности проверки
подписи без знания какой-либо секретной информации.
Надежность схемы цифровой подписи определяется
сложностью следующих трех задач:
366
цифровые подписи
— подделки подписи, то есть нахождения значения подписи
под заданным документом лицом, не являющимся владельцем
секретного ключа;
— создания подписанного сообщения, то есть нахождения
хотя бы одного сообщения с правильным значением подписи;
— подмены сообщения, то есть подбора двух различных
сообщений с одинаковыми значениями подписи.
Имеется множество различных схем цифровой подписи,
обеспечивающих тот или иной уровень стойкости. Основные
подходы к их построению будут рассмотрены ниже.
Принципиальной сложностью, возникающей при использовании
цифровой подписи на практике, является проблема
создания инфраструктуры открытых ключей. Дело в том,
что для алгоритма проверки подписи необходима дополнительная
открытая информация, связанная с обеспечением
возможности открытой проверки подписи и зависящая от секретного
ключа автора подписи. Эту информацию можно назвать
открытым ключом цифровой подписи. Для исключения
возможности подделки этой информации (открытого ключа)
лицами, которые хотят выступить от лица законного владельца
подписи (секретного ключа), создается инфраструктура,
состоящая из центров сертификации открытых ключей и
обеспечивающая возможность своевременного подтверждения
достоверности принадлежности данной открытой информации
заявленному владельцу и обнаружения подлога.
Создание сертификационных центров с технической точки
зрения не представляет большой сложности. Они строятся
во многом аналогично центрам сертификации, которые используются
в криптографических системах с открытыми ключами.
Однако с юридической точки зрения здесь имеется
множество проблем. Дело в том что в случае возникновения
споров, связанных с отказом от авторства или подделки подписи,
такие центры должны нести юридическую ответственность
за достоверность выдаваемых сертификатов. В частности,
они должны возмещать понесенные убытки в случае
367
I лава 14
конфликтных ситуаций, когда алгоритм проверки подписи
подтверждает ее правильность. В связи с этим сложилась
практика заключения договоров между участниками информационного
взаимодействия с применением цифровых подписей.
В таком договоре должно быть четко указано:
— кто должен нести ответственность в случае, если подписанные
сделки не состоятся;
— кто должен нести ответственность в случае, если система
окажется ненадежной и будет взломана, то есть будет
выявлен факт подделки секретного ключа;
— какова ответственность уполномоченного по сертификатам
в случае, если открытый ключ будет сфальсифицирован;
— какова ответственность владельца секретного ключа в
случае его утраты;
— кто несет ответственность за плохую реализацию системы
в случае повреждения или разглашения секретного ключа;
— каков порядок разрешения споров и т. п.
Поскольку данные проблемы носят юридический, а не
технический характер, то для их разрешения нужен юридически
правильно заключенный договор, оформленный стандартным
образом на бумаге.
В настоящее время предложено несколько принципиально
различных подходов к созданию схем цифровой подписи.
Их можно разделить на три группы:
1) схемы на основе систем шифрования с открытыми
ключами;
2) схемы со специально разработанными алгоритмами
вычисления и проверки подписи;
3) схемы на основе симметричных систем шифрования.
Рассмотрим их более подробно.
368
цифровые подписи
§ 14.2. Цифровые подписи на основе
шифрсистем с открытыми ключами
Идея использования систем шифрования с открытыми
ключами для построения систем цифровой подписи как бы
заложена в постановке задачи. Действительно, пусть имеется
пара преобразований (Е, В \ первое из которых зависит от
открытого ключа, а второе — от секретного. Для того чтобы
вычислить цифровую подпись 5* для сообщения, владелец
секретного ключа может применить к сообщению М второе
преобразование В: 8 = В (М) . В таком случае вычислить
подпись может только владелец секретного ключа, в то время
как проверить равенство Е(8) = М может каждый. Основными
требованиями к преобразованиям Е и В являются:
— выполнение равенства М = Е(В(М) ) для всех сообщений
М;
— невозможность вычисления значения В{М) для заданного
сообщения М без знания секретного ключа.
Отличительной особенностью предложенного способа
построения цифровой подписи является возможность отказаться
от передачи самого подписываемого сообщения М, так
как его можно восстановить по значению подписи. В связи с
этим подобные системы называют схемами цифровой подписи
с восстановлением текста.
Заметим, что если при передаче сообщение дополнительно
шифруется с помощью асимметричного шифра, то пара
преобразований (Е, В), используемая в схеме цифровой подписи,
должна отличаться от той, которая используется для
шифрования сообщений. В противном случае появляется возможность
передачи в качестве шифрованных ранее подписанных
сообщений. При этом более целесообразно шифровать
подписанные данные, чем делать наоборот, то есть подписывать
шифрованные данные, поскольку в первом случае про369
I лава 14
тивник получит только шифртекст, а во втором — и открытый,
и шифрованный тексты.
Очевидно, что рассмотренная схема цифровой подписи на
основе пары преобразований (Е, О) удовлетворяет требованию
невозможности подделки, в то время как требование невозможности
создания подписанного сообщения не выполнено:
для любого значения каждый может вычислить значение
М = Е(8) и тем самым получить подписанное сообщение.
Требование невозможности подмены сообщения заведомо
выполняется, так как преобразование Е взаимно однозначно.
Для защиты от создания злоумышленником подписанного
сообщения можно применить некоторое взаимно-однозначное
отображение К : М I—> М , вносящее избыточность в представление
исходного сообщения, например, путем увеличения
его длины, а затем уже вычислять подпись 5 = В (М ) . В
этом случае злоумышленник, подбирая $ и вычисляя значения
М — Е ( 8 ) , будет сталкиваться с проблемой отыскания таких
значений й , для которых существует прообраз М. Если
отображение К выбрано таким, что число возможных образов
Й значительно меньше числа всех возможных последовательностей
той же длины, то задача создания подписанного
сообщения будет сложной.
Другой подход к построению схем цифровых подписей на
основе систем шифрования с открытым ключом состоит в использовании
бесключевых хэш-функций. Для заданного сообщения
М сначала вычисляется значение хэш-функции
И(М) , а затем уже значение подписи 5 = 0 (Н(М) ) . Ясно,
что в таком случае по значению подписи уже нельзя восстановить
сообщение. Поэтому подписи необходимо передавать
вместе с сообщениями. Такие подписи получили название
цифровых подписей с дополнением. Заметим, что системы
подписи, построенные с использованием бесключевых хэш-
функций, заведомо удовлетворяют всем требованиям, предъ370
цифровые подписи
являемым к цифровым подписям. Например, невозможно создание
сообщения с известным значением подписи, поскольку
бесключевая хэш-функция должна быть однонаправленной.
В качестве системы шифрования с открытыми ключами
можно использовать, например, систему К8А.
§ 14.3. Цифровая подпись Фиата — Шамира
Рассмотрим подход к построению схемы цифровой подписи,
основанной на сложности задач факторизации больших
целых чисел и извлечения квадратного корня в кольце вычетов.
Идея построения схемы принадлежит А. Фиату и
А. Шамиру (см. гл. 12). Приведем одну из модификаций схемы,
предложенную ими совместно с У. Фейджем. В ней реализуется
цифровая подпись с дополнением.
Пусть к — некоторая хэш-функция, преобразующая исходное
сообщение в битовую строку длины т. Выберем различные
простые числа р и # и положим п = рд . В качестве
секретного ключа каждый абонент должен сгенерировать т
различных случайных чисел а {,а2 е Ъп . Открытым
ключом объявляется набор чисел ЪХ,Ъ2 е Ъп, где
Ь1 = ( а ~1)2 тоАп , / = 1,...,т .
Алгоритм вычисления цифровой подписи для сообщения
М состоит в выполнении следующих действий:
1. Выбрать случайное число г, \ < г < п - \ .
2. Вычислить и - г 2 гтнх! п .
3. Вычислить к(М,и) = ^ = (з{9з29—9зт) .
т
4. Вычислить / = г]- } а']‘ то<1 п .
/=1
5. Подписью для сообщения М положить пару (.у, ().
371
I лава 14
Алгоритм проверки подписи состоит в выполнении следующих
действий:
1. По открытому ключу й,,62,...,Ьт т о ё л и значению /
вычислить
т
и> = *2\ \ Ь*1 т о д п •
/=1
2 . В ы ч и с л и т ь / ? (М , и>) =
3. Проверить равенство ^ = У .
Достоинствами описанной схемы являются возможность
выработки цифровых подписей для нескольких различных
сообщений с использованием одного секретного ключа, а
также сравнительная простота алгоритмов вычисления и проверки
подписи. Например, для схемы цифровой подписи, основанной
на алгоритме К8А, соответствующие алгоритмы
требуют выполнения значительно большего числа умножений.
Попытка компрометации этой схемы сталкивается с необходимостью
решения сложной задачи нахождения квадратных
корней по модулю п.
Недостатком схемы является большая длина ключа, которая
определяется числом т. Если двоичная запись числа п
содержит / знаков, то длина секретного ключа составляет т1
бит, а открытого ключа — (т +1)/ бит. При этом необходимо
учитывать, что для обеспечения достаточной стойкости данной
схемы цифровой подписи числа / и т должны иметь в
своей двоичной записи несколько сотен бит.
§ 14.4. Цифровая подпись Эль-Гамаля
Схема цифровой подписи Эль-Гамаля основана на сложности
другой задачи — вычисления значения логарифма в
конечном поле (см. также § 1 1 .2).
Пусть р — простое число и а — примитивный элемент
поля 2 . Выберем случайное число а в интервале
372
цифровые подписи
\ < а < р - 2 и вычислим значение р = а а шос! р . Число а
является секретным ключом, а набор {р, а, /3) — открытым
ключом.
Подпись для сообщения М вычисляется с помощью следующего
алгоритма:
1. Выбрать случайное целое число г, 1 < г < р - 2 .
2. Вычислить у - а г шос! р .
3. Для х = М вычислить 8 = (х - ау)г~х тос!(р - 1).
4. Подписью для сообщения М положить пару (у; 8).
Алгоритм проверки подписи заключается в проверке
сравнения Р Уу 3 = а х{то<\р). Если оно верно, то подпись
принимается, если нет, то отвергается.
Основным достоинством такой схемы цифровой подписи
является возможность выработки цифровых подписей для
большого числа сообщений с использованием одного секретного
ключа. При этом попытка компрометации схемы сталкивается
с необходимостью решения сложной математической
задачи, связанной с нахождением решений показательных
уравнений, в частности — с нахождением значения логарифма
в поле Ъ р .
Сделаем два замечания.
Первое касается выбора числа г. Оно должно уничтожаться
сразу после вычисления подписи. Действительно, зная
число г и значение подписи, легко вычислить секретный
ключ а:
а = ( х - гб)у~х тос1(р -1 ).
Поэтому подпись может быть полностью скомпрометирована.
Кроме того, число г должно быть действительно случайным и
не должно повторяться для различных подписей, полученных
при одном значении секретного ключа. В противном случае
также можно вычислить секретный ключ а.
373
Глава 14
Второе замечание связано с тем, что реально при вычислении
подписи на шаге 3 алгоритма в качестве х целесообразнее
использовать свертку х = к (М ) , а не само сообщение М.
Это защищает схему подписи от возможности подбора сообщений
с известным значением подписи. Существует несколько
способов такого подбора. Например, если выбрать случайно
числа /, у, удовлетворяющие условиям 0 < / < р — 1 ,
О < ] < р — 1 , (у, р - 1) = 1 , и положить
у = а 1 т о йр,
8 - - у у -1 тос1 (р - 1),
х = - у у~ х тос!{р - 1),
то легко убедиться в том, что пара ( у 8) является верной цифровой
подписью для сообщения М = х .
Схема цифровой подписи Эль-Гамаля послужила образцом
для построения большого семейства во многом сходных
по своим свойствам схем подписи. В их основе лежит проверка
сравнения вида
а Ар в = у с {той р ) ,
в котором тройка (А,В,С) совпадает с одной из перестановок
чисел ±х, ±8 и ±у при некотором выборе знаков. Например,
исходная схема Эль-Гамаля получается при А = х , В = - у и
С = 8 . На базе схем подписи из этого семейства построены и
стандарты цифровой подписи США и России. Так, в американском
стандарте Э88 {Г>щИа1 ВщпаШге 8Шп8аг8) используются
значения А = х , В = у и С = 8 , а в российском
стандарте — значения А = - х , В = 8 и С = у .
Еще одним достоинством схемы Эль-Гамаля является
возможность уменьшения длины подписи путем замены пары
374
цифровые побписи
чисел (/, 3) на пару чисел (у шос1 д, 5 шос! д ) , где д является
некоторым простым делителем числа р -1 . При этом проверочное
равенство по модулю р следует заменить на модифицированное
равенство по модулю д:
( а Ар в той р )то й д = у с т о й д .
Именно так сделано в американском стандарте цифровой
подписи Б 88.
§ 14.5. Одноразовые цифровые подписи
Рассмотренные системы цифровой подписи, основанные
на сложности задач разложения целых чисел на множители,
вычисления квадратного корня или логарифмирования в конечных
полях, имеют один потенциальный недостаток. Он
состоит в возможности построения новых эффективных алгоритмов
для решения этих математических задач. Поэтому в
реальных схемах длину ключа выбирают с определенным
превышением необходимой величины для обеспечения достаточного
запаса стойкости. Это, в свою очередь, значительно
усложняет алгоритмы вычисления и проверки подписи. Поэтому
представляется весьма привлекательной задача построения
схем цифровой подписи на основе симметричных
систем шифрования, свободных от подобных недостатков.
Рассмотрим, например, схему цифровой подписи Диффи —
Лампорта на основе симметричных систем шифрования.
Пусть требуется подписать сообщение М = тхт2..,тп^
т1 е {0,1}, / = 1 ,...,н. Согласно схеме Диффи — Лампорта подписывающий
сначала выбирает 2п случайных секретных ключей
* = [(*ю,*1 ,),...,(*я0Л|)]
375
I лава 14
для используемой им симметричной шифристемы, затем
п пар случайных чисел
5 = [(5|0,5 11),...,(5и0,5|11)],
где 8у € {0,1}, / = 1, ] - 0,1 , и вычисляет значения
К0 = Еку (8 0')» 1 = 1’"*’П’ 1 = ° ’1 •
Наборы и Л = [(7?10,/г11),...,(7?л0,7?л1)] являются открытыми
и помещаются в общедоступном месте так, чтобы каждый
мог прочитать их, но записать их туда мог бы только автор
подписи.
Подпись для сообщения М имеет вид { к ^ ^ . ^ к пт ).
Чтобы убедиться в ее правильности, следует проверить
равенства
Ку = Е ку (8 у ) ’ } = Щ> г = 1 - ,п .
Недостатком этой схемы является слишком большой размер
подписи, который может превышать размер самого подписываемого
сообщения. Имеется несколько способов избавиться
от этого недостатка (см. [Бер92]). Рассмотрим некоторые
из них.
Во-первых, можно хранить не 2п значений секретных
ключей, а лишь один секретный ключ к. Для этого можно
воспользоваться, например, одной из следующих схем формирования
последовательности К:
ку = Ек (/, /), у = 0,1, / = 1,..., п ;
376
цифровые подписи
\ЕкО ~ 1Д)» 3 ~ 0>
и (/,0), ) = 1, *10=Я*«», / = и , « .
Во-вторых, можно аналогичным образом свернуть набор
открытых значений 5. В-третьих, можно подписывать не само
сообщение, а его свертку, если воспользоваться какой-либо
хэш-функцией. Можно использовать и другие подходы, позволяющие
сократить как длину подписи, так и размеры открытого
и секретного ключей.
Вместе с тем подобные модификации не устраняют главного
недостатка рассматриваемых подписей, состоящего в
том, что после проверки подписи либо весь секретный ключ,
либо его часть становятся известными проверяющему. Поэтому
рассмотренная схема цифровой подписи является по
существу одноразовой.
Контрольные вопросы
1. Что общего между обычной и цифровой подписями? Чем
они различаются?
2. Какие задачи позволяет решить цифровая подпись?
3. В чем заключается принципиальная сложность в практическом
применении систем цифровой подписи?
4. Почему в криптографических системах, основанных на
открытых ключах, нельзя использовать одинаковые ключи
для шифрования и цифровой подписи?
5. Проверьте, что указанный в тексте способ подбора подписанных
сообщений для схемы Эль-Гамаля действительно
дает верные цифровые подписи.
377
Глава 15
Протоколы распределения ключей
Различают следующие типы протоколов распределения
ключей:
— протоколы передачи (уже сгенерированных) ключей;
— протоколы (совместной) выработки общего ключа (открытое
распределение ключей);
— схемы предварительного распределения ключей.
Различают также протоколы распределения ключей между
отдельными участниками и между группами участников
информационного взаимодействия.
§15.1. Передача ключей с использованием
симметричного шифрования
Имеются протоколы, в которых стороны осуществляют
передачу ключей при непосредственном взаимодействии, то
есть двусторонние протоколы или, иначе, протоколы типа
“точка-точка”, и протоколы с централизованным распределением
ключей, в которых предусмотрена третья сторона, играющая
роль доверенного центра.
Двусторонние протоколы
Рассмотрим сначала двусторонние протоколы передачи
ключей с использованием симметричного шифрования. Различают
протоколы, в которых стороны заранее располагают
какой-либо известной им обоим секретной информацией, и
протоколы, не требующие этого условия.
Пусть стороны А и В заранее обладают общей секретной
информацией. Допустим, что это — секретный ключ кАВ.
378
/ 1ротоколы распределения ключей
Тогда для передачи ключа к стороны могут использовать одностороннюю
передачу:
А - + В : Еклв(кА,В),
где Е — алгоритм шифрования, / — метка времени, В —
идентификатор абонента В (для краткости вместо Ш(В) будем
использовать лишь один символ В).
Подчеркнем, что если не передавать метки времени, то
злоумышленник может осуществить повторную передачу того
же сообщения. Если же не указывать идентификатора адресата,
то злоумышленник может вернуть отправителю перехваченное
сообщение, что в некоторых ситуациях может
быть опасным, поскольку абонент А не сможет установить,
что это сообщение получено не от абонента В.
Заметим, что в приведенном протоколе вместо шифрования
можно было использовать ключевую хэш-функцию, зависящую
от общего ключа:
А —^ В I к © •
Если дополнительно требуется аутентификация сеанса, то
можно использовать следующий протокол типа “запрос-
ответ”:
(1) В - * А: г в ,
(2) А - + В : Е клв(к,гв ,В) ,
где гв — случайное число, сгенерированное абонентом В и
переданное абоненту А в начале сеанса. При использовании
хэш-функции подобный протокол может выглядеть так:
379
/лава 75
(1) В - > А : гв ,
(2) А - > В : к ® к кАВ(гв ,В).
Если требуется двусторонняя аутентификация, то можно
модифицировать последний протокол, предоставив возможность
стороне А путем генерации своего случайного числа гА
и введения его в сообщение на шаге (2) протокола убедиться в
том, что он имеет дело именно с абонентом В.
Исходный протокол можно модифицировать так, чтобы
искомый ключ к генерировался не одной стороной, а являлся
результатом двустороннего обмена.
Пусть абонентами А и В помимо случайных чисел г^ и
г$ генерируют также случайные числа кд и к$ соответственно.
Тогда в результате выполнения протокола
(1) В - + А : г в ,
(2) А - > В :Е кАв(кл,гл,гв,В),
(3) В^> А:ЕкАи(кв,гв,гл,А),
каждая из сторон может вычислить общий ключ с помощью
некоторой функции / по правилу к - / ( кА,кв). Подчеркнем,
что в этом протоколе ни одна из сторон не может знать заранее
значения ключа.
Приведем теперь “бесключевой” протокол А. Шамира,
позволяющий передать ключ без использования какой-либо
общей секретной информации.
Пусть имеется некоторое коммутирующее шифрующее
преобразование Е. Это означает, что при всех сообщениях х и
ключах к\ и кг выполняется равенство
Ек^ Е кг{х)) = Екг(Екх{х)).
380
I 1ротоколы распреОеления ключей
Тогда пользователи А и В могут реализовать следующий
трехшаговый протокол для передачи секретного ключа кот А
к В:
(1) А-+В:Екл (к),
(2) В -> А: Екв (Екл (к)),
(3) А ^ В : О кА(Екв(ЕкА(/с))).
Заметим, что в этом протоколе можно использовать не
каждое коммутирующее преобразование Е. Например, легко
заметить, что для преобразования ( к ) = к 0 Г протокол
оказывается заведомо нестойким. Поэтому в протоколе Ша-
мира рекомендуется использовать преобразование вида
Е ^ а ( к ) = к а т о й р , в котором константа а определяется
ключом кА.
Трехсторонние протоколы
Рассмотрим протоколы распределения ключей между парами
участников с использованием третьей стороны Г, называемой
центром. В этом качестве обычно выступает некоторый
выделенный узел сети, или сервер, которому доверяют
все участники. Центр Т хранит ключи всех абонентов сети.
Поэтому схема ключевых взаимоотношений графически
представляет собой звезду.
Один из первых протоколов такого типа был предложен в
работе [Нее78]. Он заключается в выполнении следующих
шагов:
(1) Л—>Т: А,В,гл,
(2) Т—>А: Ек^ (гл,В,к,Екв1 ( к ,А)) ,
381
/ лава 1Ь
(3) А - > В : Е кй/(к,Л) ,
(4) В - у А: Ек(гв) ,
(5) А ^ В : Е к(гв - 1) .
В результате выполнения трех первых шагов протокола
пользователи А и В получают сгенерированный центром Т
общий ключ к для организации взаимодействия. Четвертый и
пятый шаги предназначены для аутентификации пользователя
А и подтверждения правильности получения ключа обеими
сторонами.
Слабость этого протокола заключается в возможности
повторной передачи абоненту В сообщения, переданного на
шаге (3). При этом абонент В не имеет возможности установить,
что полученный ключ к уже был использован. Поэтому
в случае компрометации этого ключа злоумышленник может
аутентифицироваться и передавать сообщения от имени А.
Недостаток этого протокола устранен в протоколе
КегЪегоз. Рассмотрим сначала базовый протокол, применяемый
в протоколе аутентификации и распределения ключей
КегЪегоз. Он состоит из следующих шагов:
(1) А ^ Т : А,В,гЛ,
(2) Г—» А: Ек т(к,гЛ,Ь ,В ) , билет,
(3) А —у В: билет, аутентификатор,
(4) В->А: Ек(/,к,).
Здесь “билетом” названа величина ЕквТ(к,А,1) , ^аутентификатором"
— величина Ек(А, ( ,к1) , I — метка времени;
Ь — период времени действия билета, гА — случайное
число, сгенерированное абонентом А и вставленное в передаваемое
сообщение для взаимной аутентификации, а кА» кц —
случайные числа, сгенерированные абонентами А и В соот382
/ /ротоколы распределения ключей
ветственно, и используемые либо в качестве ключа шифрования
информации другой стороне, либо для выработки общего
ключа кАВ = / ( к п кв) с помощью некоторой функции/
В полном протоколе КегЬегох описанный выше базовый
протокол используется два раза. Дело в том что в нем предусмотрено
два сервера (см. рис. 51). Первый — “сервер аутентификации”,
обозначаемый А8, выдает так называемые “билеты
для получения билетов” (<§/)> содержащие ключи, предназначенные
для длительного использования. Второй сервер,
Т08, — “сервер выдачи билетов”, выдает обычные билеты
для доступа к сетевым ресурсам и обращения к другим пользователям.
Рис. 51
Сообщения, передаваемые согласно этому протоколу, вы
глядят следующим образом:
(1) А-+А8: А,ТС8,гА,
(2) А8-*А: ЕкАА8(кАТ08,гА,Ц,ТС8),1%1,
(3) А —> Т08: Щ1, аутентификаторь В,ГА,
(4) Т08-+А: Е Ка т08 (к,гА' ,Ь2,В) , билет,
(5) А —> В: билет, аутентификатор2,
383
I лава 1Ь
(6) В^А: Ек ((2, к в ),
где
= ЕкА8,ТС8 (кАЮ5 > Л, I , ),
аутентификатору = Екл ) ,
билет = Екв:гС8 (К >А,Ь2),
аутентификатор2 - Е^ (А ,^2 > ) •
Благодаря введению второго сервера нагрузка на первый
сервер уменьшается во много раз. Первый сервер должен
быть наиболее защищенным, поскольку он хранит главные
ключи всех пользователей. Серверов второго типа может
быть несколько, и они могут соответствовать определенной
подсети или определенному типу ресурса.
Приведем еще один протокол распределения ключей с
использованием сервера (см. [01лу87]), предпочтительный для
случая, когда сервер находится в более удобном расположении
для второго абонента. Протокол состоит в выполнении
следующих действий:
(1 )А^В: г,А ,В ,ЕкАТ(гл , г , А ,В),
(2)В-^Т: г,А,В,Еклт( гА, г , А,В) ,Еквт(гв , г ,А,В),
(3) ЕкАТ(гА, к \ Е квт{гв ,к) ,
(4) В —*А: Еклт(гА, к ) .
Пользователь А генерирует два случайных числа: первое (гА)
используется, как и раньше, для взаимной аутентификации, а
второе (г) — для аутентификации сеанса связи (вместо него
может быть использована метка времени).
384
11ротоколы распреОеления ключей
Этот протокол можно дополнить еще одним шагом для
обеспечения взаимной аутентификации сторон и подтверждения
правильности полученного ключа:
(4') В -*А: Ек^ (гА, к), Ек (г, гв),
(5) А — Ек( г ) .
§ 15.2. Передача ключей с использованием
асимметричного шифрования
Рассмотрим варианты использования асимметричного
шифрования для передачи секретных ключей симметричных
криптосистем.
Протоколы без использования цифровой подписи
Для передачи ключа к можно использовать следующий
одношаговый протокол:
А->В: Екв(к9{9А),
где Е — алгоритм шифрования с открытым ключом, / —
метка времени, вставляемая для предотвращения возможности
повторного использования ключа.
Для осуществления взаимной аутентификации и подтверждения
правильности получения ключа можно воспользоваться
протоколом из |ТЧее78]:
( 1) А-+В: Е в ( к х,А ) ,
(2) В-*А: Е А(кь к 2),
(3) А —* В: Е в (к2) .
Производя расшифрование полученных сообщений на втором
и третьем шагах, стороны убеждаются в том, что они имеют
385
I лава 1Ь
дело именно с нужной стороной и что другая сторона правильно
расшифровала полученное значение ключа.
Протоколы с использованием цифровой подписи
При использовании цифровой подписи аутентифицированный
протокол передачи ключей может содержать только
одно сообщение и иметь, например, один из следующих трех
видов:
А-*В: Еи(к,1,8Л(В,к,1))
(шифрование подписанного ключа);
А-*В: Ен(к,1,),8А(В,к,1)
(зашифрование и подпись ключа);
А ^ В : I, Ен (А, к), 8А (В, (,ЕИ (А,к))
(подпись зашифрованного ключа).
Сертификаты открытых ключей
Как правило, при использовании открытых ключей хранят
не сами ключи, а их сертификаты. Сертификат представляет
собой набор данных
С л ={л,кА,и8Кп(А,кА,1)),
состоящий из идентификатора абонента А, его открытого
ключа кА и, быть может, еще какой-либо дополнительной
информации, например, времени ( выдачи сертификата и срока
его действия, заверенных цифровой подписью доверенного
центра ТА или заслуживающего доверия лица. Сертификат
386
/ / ротоколы распределения ключей
предназначен для исключения возможности подмены открытого
ключа при его хранении или пересылке.
Получив такой сертификат и проверив цифровую подпись,
можно убедиться в том, что открытый ключ действительно
принадлежит данному абоненту.
Международный стандарт СС1ТТ Х.509 определяет следующий
протокол аутентификации с одновременным распределением
ключей:
(1) А -+ В : С А, ИА, В А{рА),
(2) В-+А: СВ, Б В, 8 в (Ов ),
(3) А - + В : гв , В , 8 а {гв ,В ) ,
где СА и С в — сертификаты сторон, 8А и 8В — цифровые
подписи сторон,
В А = (1 л ’гА’В> ^ а1а\ , Е в (кх)),
я в = О в ,гв ,А, га , Жг*а2 ,Е А(к2))
/
— наборы передаваемых и подписываемых данных. В поля
с1Ма заносится дополнительная информация для аутентификации
источника. Третий шаг протокола требуется стороне В
для подтверждения того, что она действительно взаимодействует
со стороной А.
§ 15.3. Открытое распределение ключей
Открытое распределение ключей позволяет двум абонентам
выработать общий секретный ключ путем динамического
взаимодействия на основе обмена открытыми сообщениями
без какой-либо общей секретной информации, распределяемой
заранее. Важным преимуществом открытого распределения
является также то, что ни один из абонентов заранее не
387
I лава 75
может определить значения ключа, так как ключ зависит от
сообщений, передаваемых в процессе обмена.
Первый алгоритм открытого распределения ключей был
предложен У. Диффи и М.Хеллманом [01^76]. Для его выполнения
стороны должны договориться о значениях большого
простого числа р и образующего элемента а мультипли-
кативной группы Ъ р - {1,2,..., р — 1} . Для выработки общего
ключа к они должны сгенерировать случайные числа х,
\ < х < р — 2 , и у , \ < у < р — 2 , соответственно. Затем они
должны обменяться сообщениями в соответствии с протоколом:
( 1) А -+В: а х т о й р ,
(2) В-+А: а у т о ё /> .
Искомый общий ключ теперь вычисляется по формуле:
Недостатком этого протокола является возможность атаки
типа “злоумышленник в середине”, состоящей в следующем.
Предположим, что злоумышленник имеет возможность
осуществлять подмену передаваемых абонентами сообщений.
Тогда, выбрав числа х* и у* и подменив сообщения
а х т о ё р и а у т о ё р на а х* т о ё р и а у* т о ё р соответственно,
он может сформировать ключи
к = (а у ) х = (р х ) у т о ё р .
к{ = (ах ) у* т о ё р
и
для связи с пользователями А и В соответственно. В результате
злоумышленник получает возможность полностью кон388
/ фотоколы распреоеления ключей
тролировать обмен сообщениями между абонентами А и В.
При этом они не смогут обнаружить подмену и будут уверены,
что связываются непосредственно друг с другом.
Рассмотрим два протокола, устраняющие этот недостаток.
Первый протокол, называемый 8Т8 (81аИоп-1о-81аИоп),
предполагает, что пользователи применяют цифровую подпись,
которой подписываются передаваемые по протоколу
Диффи—Хеллмана сообщения:
(1) А—>В\ах тод р,
(2) В А: а у то(1р, Ек(8в (а у , а х)),
(3) А-+В: Е к(8А(ах,а у ) ) .
Здесь 8А и 8 в — цифровые подписи пользователей А и
В соответственно, к — искомый общий ключ. Они позволяют
гарантировать достоверность получения сообщения именно
от того пользователя, от которого это сообщение получено.
Шифрование значений подписей пользователей введено для
того, чтобы обеспечить взаимное подтверждение правильности
вычисления значения ключа.
Еще один подход также предполагает наличие у абонентов
открытых ключей, но вместо цифровой подписи предлагается
использовать модифицированную процедуру выработки
общего ключа. Рассмотрим протокол МТ1 (названный так в
честь его авторов: Т. Мацумото, И. Такашима и X. Имаи, см.
[МаЙб]).
Предположим, что пользователи А и В имеют секретные
ключи а, 1 < а < р - 2 , и Ь, \<Ъ < р ~ 2 , соответственно, и
публикуют свои открытые ключи = а а шос! р и
гв = а ьто&р. Для выработки общего секретного ключа к
они должны сгенерировать случайные числа х, \ <х< р - 2 ,
389
I лава 1Ь
и у, \<у < р - 2 , соответственно, а затем обменяться следующими
сообщениями:
(1) А —> В: а х шоб р,
(2) В ^ А : а у то й р .
Искомый общий ключ вычисляется по формуле:
к = {ау ) а2хв = {ах ) ь2уА = а хЬ+уа той р.
Теперь любая подмена сообщений приведет к тому, что
все стороны получат различные значения ключа, что, в свою
очередь, приведет к невозможности чтения всей передаваемой
информации.
§ 15.4. Предварительное распределение
ключей
Большинство криптографических систем требуют проведения
предварительного распределения секретных ключей.
Для предварительного распределения стороны могут обменяться
ключами при личной встрече, либо поручить доставку
ключей специально назначенному доверенному курьеру, либо
использовать для передачи некоторый выделенный защищенный
канал. В зависимости от назначения криптографической
системы иногда оказывается удобным распределять не сами
ключи, а некоторые вспомогательные ключевые материалы,
на основании которых каждый участник или группа участников
могут самостоятельно вычислить необходимый ключ, используя
для этого некоторую установленную заранее проце-
ДУРУ-
Рассмотрим ситуации, в которых необходимо проводить
предварительное распределение ключей.
390
/ юотоколы распребеления ключей
Схемы предварительного распределения ключей
в сети связи
Если число абонентов сети засекреченной связи невелико,
то и число распределяемых ключей также невелико. Для
больших же сетей распределение ключей становится очень
серьезной проблемой. Она заключается в том, что для сети, в
которой работают п абонентов, необходимо выработать заранее
и хранить в дальнейшем п ( п - 1)/2 ключей. Кроме того,
каждому абоненту сети необходимо передать ключи для связи
с остальными п - 1 абонентами, которые абонент должен постоянно
хранить. Например, для сети со 100 абонентами
нужно сгенерировать и хранить почти 5000 ключей, причем
каждый абонент при этом должен хранить у себя 99 ключей.
Для уменьшения объема хранимой ключевой информации
применяются различные схемы предварительного распределения
ключей в сети связи. Их суть заключается в том, что в
действительности вначале происходит распределение не самих
ключей, а некоторых вспомогательных ключевых материалов,
занимающих меньшие объемы. На основании этих
материалов каждый абонент сети может самостоятельно вычислить
по некоторому алгоритму необходимый для связи
ключ. Такой подход позволяет уменьшить объемы как хранимой,
так и распределяемой секретной информации.
В качестве примера рассмотрим схему Блома [В1о83] распределения
ключей между п абонентами, для которой процедура
вычисления ключа заключается в вычислении значения
некоторого симметрического многочлена над конечным полем.
Выберем поле Р, имеющее конечное, но достаточно
большое число элементов, и зафиксируем п различных элементов
гь ..., гпеР, отличных от нуля. Каждый элемент г,
припишем /-му абоненту сети, / =\,п. Эти элементы не являются
секретными и могут храниться на общедоступном сервере
сети. Выберем теперь многочлен над полем Р степени
2 т, \ < т < п , вида
391
/ лава 1ь
т т
/ (Х ’У) = 'Е 'Е аг х' у ' ’
1=0 7=0
где ац = а , / ^у, у = 0,т . Его коэффициенты являются секретными
и должны храниться только в центре распределения
ключей. Каждый абонент А получает в качестве ключевых
материалов набор ( а ^ \ а \А\ состоящий из коэффициентов
многочлена
ёА (х) =/(х,гА) = а (0А' + а\А)х +...+ а[А) хк .
Для связи между абонентами А и В теперь можно использовать
общий ключ кАВ:
кАв = кВА = / ( гА, гв) = 8в(га) = §А (гв),
который могут легко вычислить оба абонента.
При использовании данной схемы каждый абонент должен
хранить ш+1 секретных значений вместо п - 1 , общее же
число секретных коэффициентов многочлена / равно
т(т+1 )/2.
Имеют место следующие результаты.
Лемма. Пусть имеется матрица Вандермонда
1 г \ ' О
1 гг г } ... гг2т
гт+1 Гт+1 - ’ 'гтт+ \ у
Если элементы г и г2, ..., гт у попарно различны и отличны от
нуля, тогда обратима над полем Е.
392
/ 1ротоколы распределения ключей
Теорема 1. Схема Блома предварительного распределения
ключей между п абонентами, использующая многочлен
степени т, 1 < т < п , является стойкой к компрометации
ключей т абонентов. Это означает, что при раскрытии
ключевых материалов, принадлежащих любым т абонентам,
злоумышленник, зная их значения, не сможет определить ни
один из ключей для связи между остальными (п - т) абонентами.
Доказательство. Запишем выражение для общего
ключа абонентов А и В, вычисляемого по формуле
многочлена/ (х, у) и является симметричной.
Абонент А имеет секретный набор (а{А\ а\А\ а ^ А)\
представляющий собой коэффициенты многочлена
Предположим, что известны ключевые материалы, принадлежащие
т абонентам. Покажем, что по ним нельзя опрет
т
кАВ = / ( ГА^Гв) = У ^ а, /ЛГН >
/=0 7=0
в матричном виде:
\ ат§ ат0 а тт) т \ ГВ )
Здесь матрица Л = (а;/) составлена из коэффициентов
ёл (*) =/{х,гА) = а (А) + а\А)х +...+ а (А) хт,
или иначе
Га )-А.
393
I лава 1Ь
делить ни один из ключей для связи между оставшимися (п -
т) абонентами.
Пусть, например, известны секретные наборы ключевых
материалов т абонентов — А,В,...,С. Будем искать ключ для
связи между абонентами V и IV, не входящими в множество
{А,В,...,С}. Для этого рассмотрим матричное равенство
(кКАА кАВ ... )кАС кК АЦ^
^ВА квв ^ВС кво
^СА ксв ... )К с кси
кт ... кт кт/)
/
ГА 4 ... гАт) ( 1 1 ... 1 1 ^
1 ГВ г1 .. ГА гв ... гс ги
... •Л- Л 4 4
1 ГС 4 .. ...
V Гцг 4 •• ГУ/ ) Г гвт
В матрице из левой части равенства не известен только
искомый ключ кцгц. В правой части неизвестная матрица Л
умножается слева и справа на обратимые матрицы, так как по
лемме их определители не равны нулю.
Выражая теперь матрицу Л из данного равенства, замечаем,
что при произвольно заданном значении ключа кт из поля
Р матрица Л находится как произведение трех матриц.
(Проверьте, что данная матрица должна быть симметричной
матрицей, составленной из коэффициентов многочлена.)8
Таким образом, при каждом значении ключа кт может
быть найден многочлен/( .х, у), при котором данный ключ по8
Указание замените в нижней строке рассматриваемого матричного
равенства символ IV на II и заметьте, что нижняя строка полученной матрицы
будет линейной комбинацией строк исходной матрицы
394
/ 1ротоколы распределения ключей
лучается в качестве решения. Это свидетельствует о невозможности
получения информации об этом ключе на основании
известных значений.
С другой стороны, если известны ключевые материалы,
принадлежащие т + 1 абонентам, то, очевидно, из рассматриваемого
равенства матрица (а ) всегда находится однозначно.
Теорема доказана.
Теорема 2. Если схема предварительного распределения
ключей между п абонентами является стойкой к компрометации
ключей т абонентов, I < т < п , и использует I-
битовые ключи, то каждый абонент должен хранить не менее
1{т + 1) бит ключевых материалов.
Докажите эту теорему самостоятельно в качестве упражнения.
Из теорем 1 и 2 следует, что для заданного числа т схема
Блома дает минимальное по объему количество хранимых у
абонента ключевых материалов.
Рассмотрим еще одну схему предварительного распределения
ключей, которая также позволяет значительно сократить
общее число хранимых и передаваемых секретных ключей.
Она называется КОР (кеу ЗШпЪийоп раПегт) и основана
на схеме пересечений множеств (см. [Оуе95]).
Пусть имеется п, п > 2 , абонентов (пользователей) и
множество секретных ключей К, I К | = ц. Будем считать, что
все ключи перенумерованы числами 1,2,..., ц. Выберем некоторое
семейство {8}9...,8п} подмножеств множества
{1,2,..., ц) . Предварительно абоненту / по защищенному каналу
передается множество секретных ключей с номерами из
подмножества 8» 1 = \,п. Таким образом, семейство
{81 представляет собой таблицу с номерами ключей
каждого пользователя. Хотя данная таблица является несекретной,
она должна быть защищена от модификаций и подделок.
395
I лава 1Ь
Если абонент / хочет связаться с абонентом у, то он использует
для выработки общего ключа множество ключей,
номера которых содержатся в пересечении п Если каждый
ключ представлен некоторой битовой строкой, то для
формирования общего связного ключа можно взять, например,
их сумму, или значение некоторой хэш-функции от строки,
составленной из ключей, номера которых входят в пересечение
множеств *??, п8,.
Схемой распределения ключей типа КОР, или КЭР(и,д)-
схемой, назовем всякое семейство {8],...,8п} подмножеств
множества К, удовлетворяющее следующему условию:
если при некоторых /, у, г е {1, ..., п} выполнено включение
8 ^ 8 с; 8Г, то либо г = г, либо у = г.
Это условие означает, что общий ключ двух абонентов не
должен быть известным никакому другому абоненту.
Семейство подмножеств называется семейством Шпер-
нера, если ни одно из них не содержится в другом.
Теорема 3. Семейство { 8 1у...,8 п} подмножеств
множества К, \ К \ = ^, образует КЭР{п^Усхему в том и
только в том случае, если множество { 5 ,0 5) | 1 < / <у < п }
образует семейство Шпернера.
Докажите теорему 3 самостоятельно в качестве упражнения.
Теорема 4 (8регпег, 1928). Если подмножества
{5^ ,...,5^} множества К, IК I = д, образуют семейство
Шпернера, то
т < С
Равенство достигается только в случае, если множество
{5'],..., 8т} совпадает с множеством всех уу-элементных подмножеств
множества К, где м = д/2 при четном д и =
(д+1)/2 или (д - 1)/2 при нечетном
396
/ юотоколы распределения ключей
Доказательство. Пусть семейство подмножеств
множества К состоит из максимально возможного
числа элементов. Покажем, что существует семейство Шпернера
с не меньшим, чем т, числом множеств, каждое их кото-
рых имеет мощность
Обозначим = шах |5, | . Предположим, что > -
/=1,л
что подмножества 51, 5/, / < я , состоят из и> элементов.
Рассмотрим подмножества К\, ..., Ки множества К, каждое из
которых состоит из м>-1 элементов и содержится хотя бы в
одном из подмножеств 5 ь 5/. Нетрудно видеть, что семейство
Ки •••? Ки, 5/+1, 5/и
также образует семейство Шпернера. Покажем, что и>( .
Каждое подмножество 5/ содержит ровно подмножеств
. С другой стороны, каждое подмножество входит не более
чем в (д - +1 ) подмножеств 5,. Поэтому, вычисляя двумя
способами число ребер в двудольном графе, вершинами
которого являются подмножества 51,...,5/ и Кш а ребра
соединяют вложенные подмножества Ку с: 5 ,, получаем неравенство
IV/ < (д - м? 4* 1 )и. Отсюда следует, что
или
Л
+ 1 < < (д - уг + \)и <
/ я_ \
я -
V _2_ )
и,
и >Г
■"
1_____
+ 1
Ч~
Я
_2 _
(>(
397
I лава 75
Таким образом, можно считать, что в семействе
{8 8 п } все элементы состоят не более чем из эле-
шим, чем числом элементов, то, переходя к семейству
ментов.
Если в семействе {8 8 п } имеется множество с мень-
. 2 .
{5"у ,...,8'п }, состоящему из подмножеств 8 \ = К \ 8 п которое
также составляет семейство Шпернера, и, повторяя приведенные
выше рассуждения, получаем семейство, в котором
все множества имеют одинаковое число элементов. Теорема
доказана.
Теорема 5. Для любой КОР(п,с[)-схемы каждый абонент
должен иметь не менее 1о§2 я ключей. Если п > 4, то ^ > 2
1о§2 п.Д оказательство. Если у какого-либо абонента имеется
множество, состоящее менее чем из 1о§2 п ключей, то с их помощью
можно построить не более чем п - 2 различных подмножеств
ключей. Поэтому он не сможет сформировать различные
ключи для связи с п - 1 абонентами.
Вторая оценка получается из очевидного неравенства
г'[я!2\ > с 1 ,
которое справедливо в силу предыдущей теоремы.
Схемы разделения секрета
Схема разделения секрета представляет собой схему
предварительного распределения ключей между уполномоченными
группами пользователей, в которой ключ заранее
определен и одинаков для каждой уполномоченной группы.
При этом каждый пользователь получает свою долю или
“часть секрета”. Схема включает два протокола: протокол
398
/ 1ротоколы распределения ключей
формирования долей (разделения секрета) и распределения их
между пользователями и протокол восстановления секрета
группой пользователей. Схема должна позволять восстанавливать
ключ только тем группам пользователей, которые
имеют на это полномочия, и никакая другая группа не должна
иметь возможности для восстановления ключа или получения
о нем какой-либо информации.
Основное назначение схемы разделения секрета — защита
ключа от потери. Обычно для защиты от потери делают
несколько копий ключа. С возрастанием числа копий ключа
возрастает вероятность его компрометации. Если число копий
мало, то велик риск потери ключа. Поэтому лучше “разделить”
ключ между несколькими лицами так, чтобы допускалась
возможность восстановления ключа при различных обстоятельствах
несколькими уполномоченными группами с
заранее оговоренным составом участников. Тем самым исключается
риск безвозвратной потери ключа.
Еще одно положительное качество схем разделения секрета
заключается в разделении ответственности за принятие
решения, которое автоматически вводится при определении
состава уполномоченных групп. Такая коллективная ответственность
нужна для многих приложений, включая принятие
важных решений, касающихся применения систем оружия,
подписания корпоративных чеков или допуска к банковскому
хранилищу.
В простейшем случае, когда имеется только одна группа,
состоящая из I пользователей, уполномоченная формировать
ключ, схему разделения секрета можно построить следующим
образом. Предположим, к примеру, что ключ представляет
собой двоичный вектор л* длины т. Выберем случайным образом
^ векторов 8\, так, чтобы их сумма совпадала с вектором
з9 и распределим их между пользователями. Теперь, собравшись
вместе, они могут легко восстановить значение
ключа д, в то время как никакая группа, состоящая из меньшего
числа пользователей, не сможет этого сделать. Действительно,
в данном случае отсутствие хотя бы одной доли при399
I лава 1Ь
водит к полной неопределенности относительно значения
секрета, поскольку для каждого значения искомого секрета
найдется возможный вариант значения отсутствующей доли.
Заметим, что если бы мы в предыдущем примере просто
разбили вектор на / частей, то такая схема не могла быть схемой
разделения секрета, так как знание любой доли давало бы
частичную информацию о секрете я
Другой пример схемы разделения секрета дает пороговая
схема Шамира [8Ьа79].
Пусть 1 <{ <п . Схема разделения секрета между п пользователями
называется (п,1)-пороговощ если любая группа из /
пользователей может восстановить секрет, в то время как никакая
группа из меньшего числа пользователей не может получить
никакой информации о секрете.
Для построения (я,/)-пороговой схемы А. Шамир предложил
использовать многочлен степени / - 1 над конечным полем
с достаточно большим числом элементов. Как известно,
многочлен степени / - 1 можно однозначно восстановить по
его значениям в I различных точках, но при этом меньшее
число точек использовать для интерполяции нельзя.
Выберем поле Р и зафиксируем п различных несекретных
элементов гь ..., гпеР, отличных от нуля. Каждый элемент
г1 приписан /-му абоненту сети, / = 1, п . Выберем также
/ случайных элементов а0,...,а/_/ поля Р и составим из них
многочлен/ ( х) над полем Р степени / - 1, 1 <1<п,
(-1
/(* ) =
/=0
Положим 5 =Л0) = а0. Вычислим теперь значения
*1=/(п), 5П=/ {Г„)
и распределим в качестве долей между участниками наборы
(г„ я,), 1= \ ,п.
400
I 1ротоколы распределения ключей
Для восстановления секрета 5 можно воспользоваться интерполяционной
формулой Лагранжа [Лид88]. Путь имеются I
пар (х/9 V , ) , где = /(х ,). Тогда формула Лагранжа имеет вид
Так как я = /(0 ), то из формулы Лагранжа получаем равенства
причем коэффициенты с1 не зависят от коэффициентов мно-
гочленаХх) и могут быть вычислены заранее.
С помощью полученной формулы любая группа из / пользователей
может легко восстановить секрет. В то же время
можно показать, что никакая группа из меньшего числа пользователей
не может получить никакой информации о секрете
(докажите это самостоятельно).
Схема Шамира удобна тем, что она позволяет легко увеличивать
число пользователей. Для этого не нужно ничего
менять, кроме множества {г\9 ..., гп}, к которому следует добавить
новые элементы г„+ь ..., гп+„. Заметим, что компрометация
одной доли делает из (и,/)-пороговой схемы
( л - 1, / - 1 )-пороговуюсхему.
§ 15.5. Способы установления ключей
для конференц-связи
Еще один тип распределения ключей между группами
пользователей дают протоколы распределения ключей для
проведения конференц-связи. Несмотря на внешнюю схожесть
с протоколами разделения секрета, они имеют несколько
принципиальных отличий. Если протоколы разделения
401
I лава 1Ь
секрета осуществляют предварительное распределение одного
и того же ключевого значения (секрета) по секретным каналам
между привилегированными группами пользователей,
то протоколы конференц-связи осуществляют динамическое
распределение ключей по открытым каналам связи между
привилегированными группами пользователей. При этом
ключи должны быть различными для каждой группы.
Тривиальный пример распределения ключей для проведения
конференц-связи дает использование централизованного
распределения ключей с помощью одного из трехсторонних
протоколов передачи ключей, используемых для симметричных
шифрсистем. Для реализации такого подхода нужно
выделить одного из пользователей группы и возложить на
него функции центра генерации и распределения ключей. Естественно,
что при этом возрастают требования к доверенности
и безопасности выделенного пользователя, что вносит
серьезную асимметрию между участниками конференц-связи.
Другой подход основан на использовании идеи открытого
распределения ключей.
Приведем примеры протоколов, в которых все участники
группы имеют одинаковые полномочия и выполняют симметричные
функции.
Простейший пример такого протокола для группы из трех
участников можно получить, слегка модифицировав протокол
открытого распределения ключей Диффи — Хеллмана. Участники
протокола заранее договариваются о значениях большого
простого числа р и образующего элемента а мультипликативной
группы 2* = {1,2,...,/? - 1} . Для выработки общего
ключа к пользователи А, В и С должны сгенерировать соответственно
случайные числа х, у и 2, 1 < х 9у 9г < р - 2 . Затем
они должны обменяться сообщениями согласно следующему
протоколу:
402
Протоколы распределения ключей
(1) А—* В: X - а х т о ё р ,
(2) В—* С: У = а у т о ё р ,
(3) С —* А'. 2 = а : т о ё р ,
(4) Л —► В: 2'= 2 х т о ё р ,
(5) В ^С : Х '= Х утой р ,
(6) С—>Л: У’= У2то6р.
Искомый общий ключ к = а ху2 т о ё р теперь вычисляется
пользователями А, В и С по формулам:
к = (Г1) * т о ё р ,
к = (2 ') ^ т о ё /?,
к = (Х ?) г т о ё р
соответственно.
Рассмотрим теперь протокол формирования общего ключа
для конференц-связи группы из I пользователей С/,-1 ,
предложенный в статье [Впп90]. Как и в предыдущем протоколе,
каждый пользователь (У, должен сгенерировать секретное
случайное число г„ 1 < гг < р — 2 , и вычислить открытую
экспоненту — а г' т о ё р . Положим
А = а г^ = ( 2 т, Г ' .
Тогда общий ключ к имеет вид
к = а т+ГЛ* +Г,~[Г° т о ё р = А<)А1 ...А,_х т о ё р .
403
/лава 75
Протокол состоит из следующих шагов:
(1) каждый пользователь II, рассылает г, остальным I— 1
пользователям;
(2) каждый пользователь II, вычисляет значение
Х 1 ~ (г/+1 / 1 г_хУ' т о ё р и рассылает его остальным г - \
пользователям;
(3) каждый пользователь II, вычисляет значение общего
ключа к по формуле
к, - (2М)"' • х \ - ' • Л-';,2 •... • лгД.,_з • х 1 , _ г той р .
Покажем, что данное значение является искомым ключом.
В самом деле,
Л 1 . У1~х . У1~2 . у 2 . у] /~1 ^ I л -1 • • • 1+1-2 ”
= 4-, • (А-,Х, ) • Хы)..... (А,_,Х, Хм ■ Хш_2) =
= 4-144,1-4-2 = -4 4 -4 -4 -1 ■
Поэтому А:/ = к .
Протокол требует передачи 2/(/ - 1) сообщений, причем
каждый пользователь должен отправлять сообщения всем остальным.
Можно модифицировать протокол для случая обмена
сообщениями по схеме двунаправленного кольца.
Рассмотренный протокол не решает задачи аутентификации,
поскольку в нем не заложено процедур для взаимной аутентификации
сторон.
§ 15.6. Возможные атаки на протоколы
распределения ключей
При анализе протоколов обычно рассматривают несколько
видов атак. Одну из них мы уже упоминали при рассмот404
/ 1ротоколы распределения ключей
рении протокола Диффи — Хеллмана. Она называется “злоумышленник
в середине” и заключается в полной подмене
всех сообщений между сторонами. Для защиты от нее необходимо
дополнить протокол средствами взаимной аутентификации
сторон. Это могут быть либо дополнительные, либо
встроенные процедуры взаимной аутентификации. Использование
дополнительных процедур в протоколе не всегда удобно,
так как злоумышленник может подменять не все сообщения,
а только относящиеся к выработке ключа. Более предпочтительно,
чтобы аутентификация была заложена в сами
процедуры выработки ключа, и в случае активного вмешательства
протокол заведомо давал бы различные значения
ключа сторонам и злоумышленнику.
Еще один тип атак связан с повтором или обратным отражением
ранее переданных сообщений — “атака отражением”.
Для защиты от таких атак протоколы специально делают
несимметричными, включая в зашифрованные сообщения
идентификаторы сторон либо изменяя процедуры так, чтобы
стороны должны были выполнять разные действия.
Возможны также атаки, при которых нарушитель, выступая
от имени одной из сторон и полностью имитируя ее действия,
получает в ответ сообщения определенного формата,
необходимые для подделки отдельных шагов протокола. В
данном случае успех атаки определяется тем, насколько протокол
устойчив к подобным подменам. Поэтому для защиты
от таких атак используют различные форматы сообщений,
передаваемых на разных шагах протокола, а также вставляют
в них специальные идентификационные метки и номера сообщений.
Наконец, в протоколах с использованием третьей стороны
возможны атаки, основанные на подмене доверенного сервера.
Например, одна из сторон, имеющая доверительные отношения
с сервером, выступает от его имени, подменяет его
трафик обмена с другими сторонами и в результате получает
возможность раскрывать значения генерируемых центром
ключей. Эта атака может быть успешной для протоколов, в
405
I лава 1Ь
которых аутентификация при доступе к серверу основана
только на идентификаторах сторон и случайных числах,
генерируемых при каждом взаимодействии. Для защиты от
таких атак применяют средства привязки ключей не к одной,
а к обеим взаимодействующим сторонам путем передачи обоих
идентификаторов в зашифрованном виде.
В целом при анализе протоколов распределения ключей
применяют различные методы. Это и эвристические подходы,
основанные на имеющемся наборе практических приемов и
известных атаках, зарекомендовавших себя при анализе других
протоколов. Обоснование стойкости протоколов часто
проводится путем доказательства различных результатов о
сведении задачи вскрытия протокола к известным труднорешаемым
математическим проблемам либо путем оценки
сложности задач в рамках некоторой модели вычислений.
Многие свойства протоколов можно сформулировать с помощью
теоретико-информационных понятий, связанных с
оценкой количества информации, которая становится известной
в результате анализа передаваемых сообщений. Наконец,
в [Виг90] предложен формальный метод анализа протоколов,
получивший название ВАМ-логики. В нем все шаги протокола
и передаваемые сообщения записываются в некотором стандартном
формализованном виде, а затем осуществляется их
формальный анализ при некоторых типовых предположениях
о возможном поведении сторон. Данные формальные доказательства
относятся в основном к корректности протоколов и
не всегда могут рассматриваться как доказательство их безопасности.
Контрольные вопросы
1. Каковы преимущества централизованного распределения
ключей?
2. Какие шифры нельзя использовать в протоколе Шамира?
3. Каков недостаток протокола Нидхэма — Шредера?
406
Протоколы распределения ключей
4. С какой целью вводится второй сервер в протоколе
КегЬегоз?
5. Как можно использовать цифровую подпись для защиты
протоколов передачи ключей?
6. Каковы назначение и структура сертификата открытого
ключа?
7. Каков основной недостаток протокола распределения
ключей Диффи — Хеллмана и каковы пути его устранения?
8. Что такое схема разделения секрета?
9. В чем общность и в чем отличия схемы разделения секрета
и способов распределения ключей для протокола конференц-
связи?
10. Перечислите основные атаки на протоколы распределения
ключей.
407
Глава 16
Управление ключами
Управление ключами состоит из процедур, обеспечивающих:
— включение пользователей в систему;
— выработку, распределение и введение в аппаратуру
ключей;
— контроль использования ключей;
— смену и уничтожение ключей;
— архивирование, хранение и восстановление ключей.
Управление ключами играет важнейшую роль в криптографии
как основа для обеспечения конфиденциальности обмена
информацией, идентификации и целостности данных.
Важным свойством хорошо спроектированной системы
управления ключами является сведение сложных проблем
обеспечения безопасности многочисленных ключей к проблеме
обеспечения безопасности нескольких ключей, которая
может быть относительно просто решена путем обеспечения
их физической изоляции в выделенных помещениях и защищенном
от проникновения оборудовании. В случае использования
ключей для обеспечения безопасности хранимой информации
субъектом может быть единственный пользователь,
который осуществляет работу с данными в последовательные
промежутки времени. Управление ключами в сетях связи
включает, по крайней мере, двух субъектов — отправителя и
получателя сообщения.
Целью управления ключами является нейтрализация таких
угроз, как:
1 ) компрометация конфиденциальности секретных ключей;
408
Управление ключами
2) компрометация аутентичности секретных или открытых
ключей. При этом под аутентичностью понимается знание
или возможность проверки идентичности корреспондента,
для обеспечения конфиденциальной связи с которым используется
данный ключ;
3) несанкционированное использование секретных или
открытых ключей, например использование ключа, срок действия
которого истек.
Управление ключами обычно осуществляется в контексте
определенной политики безопасности. Политика безопасности
прямо или косвенно определяет те угрозы, которым
должна противостоять система. Кроме того, она определяет:
— правила и процедуры, которыми необходимо руководствоваться
и которые необходимо выполнять в процессе автоматического
или ручного управления ключами,
— ответственность и подотчетность всех субъектов, участвующих
в управлении, а также
—- все виды записей, которые должны сохраняться для
подготовки необходимых сообщений и проведения проверки
действий, связанных с безопасностью ключей.
Одним из инструментов, используемых для обеспечения
конфиденциальности ключей, является разделение ключей по
уровням следующим образом.
1. Главный ключ — высший ключ в иерархии, который
не защищается криптографически. Его защита осуществляется
с помощью физических или электронных средств.
2. Ключи для шифрования ключей — секретные или открытые
ключи, используемые для засекречивания перед передачей
или при хранении других шифровальных ключей. Эти
ключи сами могут быть зашифрованы с помощью других
ключей.
3. Ключи для шифрования данных — используются для
защиты данных пользователей.
Ключи более высоких уровней используются для защиты
ключей или данных на более низких уровнях, что уменьшает
409
I лава 16
ущерб при компрометации ключей и объем ключевой информации,
нуждающейся в физической защите.
Одной из важных характеристик системы управления
ключами являются сроки действия ключей. Под сроком действия
ключа понимается интервал времени, в течение которого
он может быть использован законным пользователем.
Сокращение сроков действия ключей необходимо для
достижения следующих целей:
— ограничения объема информации, зашифрованной на
данном ключе, которая может быть использована для криптоанализа;
— ограничения размера ущерба при компрометации ключей;
— ограничения объема машинного времени, которое может
быть использовано для криптоанализа (в случае, если нет
требований по длительному сохранению ключа и информации,
защищенной на этом ключе).
С учетом срока действия ключей, в дополнение к указанной
выше классификации ключей по уровням, может быть
введена также следующая классификация.
1. Ключи с длительным сроком действия. К ним относится
главный ключ, час го — ключи для шифрования ключей.
2. Ключи с коротким сроком действия. К ним относятся
ключи для шифрования данных.
Как правило, в телекоммуникационных приложениях используются
ключи с коротким сроком действия, а для защиты
хранимых данных — с длительным сроком действия.
Следует иметь в виду, что термин “короткий срок действия”
относится только к сроку действия ключа, а не к промежутку
времени, в течение которого ключ должен оставаться в
секрете. Например, к ключу, используемому для шифрования
в течение только одного сеанса связи, часто предъявляется
требование, чтобы зашифрованная на нем информация не
могла быть вскрыта на протяжении нескольких десятков лет.
В то же время электронная подпись проверяется немедленно
410
Управление ключами
после передачи сообщения, поэтому ключ подписи должен
сохраняться в тайне в течение достаточно короткого срока.
§ 16.1. Жизненный цикл ключей
Ключевая информация должна быть сменена до момента
истечения срока действия ключа. Для этого может быть использована
действующая ключевая информация, протоколы
распределения ключей и ключевые уровни (см. выше).
Для того чтобы ограничить ущерб от компрометации
ключей, по возможности следует избегать зависимостей между
действующей и устанавливаемой ключевой информацией.
Например, не рекомендуется защищать очередной сеансовый
ключ с помощью действующего сеансового ключа. При хранении
секретных ключей должны быть приняты меры по
обеспечению их конфиденциальности и аутентичности. При
хранении открытых ключей должны быть приняты меры, позволяющие
проверить их аутентичность. Конфиденциальность
и аутентичность могут быть обеспечены криптографическими,
организационными и техническими мерами.
В зависимости от конкретных приложений могут выдвигаться
различные требования к необходимости и длительности
хранения используемых ключей. Так, например, открытые
ключи, используемые для проверки цифровой подписи, в ряде
случаев необходимо хранить длительное время, даже возможно
дольше, чем соответствующие секретные ключи, чтобы
была возможность проверки отдельных подписей. В то же
время во многих приложениях секретные ключи цифровой
подписи не следует хранить длительное время, а тем более
архивировать их, поскольку попадание их к посторонним лицам
может повлечь отказ от подписанного документа. Проблема
отсутствия секретного ключа цифровой подписи из-за
его преждевременного уничтожения (без компрометации)
сравнительно легко может быть решена путем генерации нового
ключа, поскольку уничтоженный ключ не требуется для
411
I лава 1Ь
проверки ранее произведенных подписей. Аналогично этому
открытые ключи, используемые для засекречивания информации,
не нуждаются в архивировании. С другой стороны,
секретные ключи, используемые для расшифрования, должны
определенное время храниться, поскольку в противном случае
засекреченная информация будет утрачена.
Все криптосистемы, за исключением простейших, в которых
используемые ключи зафиксированы раз и навсегда, нуждаются
в периодической замене ключей. Эта замена проводится
с помощью определенных процедур и протоколов, в
ряде которых используются и протоколы взаимодействия с
третьей стороной. Последовательность стадий, которые проходят
ключи от момента установления до следующей замены,
называется жизненным циклом ключей и приведена ниже.
1. Регистрация пользователей. Эта стадия включает обмен
первоначальной ключевой информацией, такой, как общие
пароли или РШ-коды, путем личного общения или
пересылки через доверенного курьера.
2. Инициализация. На этой стадии пользователь устанавливает
аппаратное оборудование и/или программные средства
в соответствии с установленными рекомендациями и
правилами.
3. Генерация ключей. При генерации ключей должны быть
приняты меры по обеспечению их необходимых криптографических
качеств. Ключи могут генерироваться как
самостоятельно пользователем, так и специальным защищенным
элементом системы, а затем передаваться пользователю
по защищенному каналу.
4. Установка ключей. Ключи устанавливаются в оборудование
тем или иным способом. При этом первоначальная
ключевая информация, полученная на стадии регистрации
пользователей, может либо непосредственно вводиться в
оборудование, либо использоваться для установления защищенного
канала, по которому передается ключевая ин412
Управление ключами
формация. Эта же стадия используется в последующем
для смены ключевой информации.
5. Регистрация ключей. Ключевая информация связывается
регистрационным центром с именем пользователя и сообщается
другим пользователям ключевой сети. При этом
для открытых ключей создаются сертификационным центром
ключевые сертификаты, и эта информация публикуется
тем или иным способом.
6. Обычный режим работы. На этой стадии ключи используются
для защиты информации в обычном режиме.
7. Хранение ключа. Эта стадия включает процедуры, необходимые
для хранения ключа в надлежащих условиях, обеспечивающих
его безопасность до момента его замены.
8. Замена ключа. Замена ключа осуществляется до истечения
его срока действия и включает процедуры, связанные с
генерацией ключей, протоколами обмена ключевой информацией
между корреспондентами, а также с доверенной
третьей стороной. Для открытых ключей эта стадия
обычно включает обмен информацией по защищенному
каналу с сертификационным центром.
9. Архивирование. В отдельных случаях ключевая информация
после ее использования для защиты информации может
быть подвергнута архивированию для ее извлечения
со специальными целями (например, рассмотрения вопросов,
связанных с отказами от цифровой подписи).
10. Уничтожение ключей. После окончания сроков действия
ключей они выводятся из обращения, и все имеющиеся их
копии уничтожаются. При этом необходимо следить, чтобы
в случае уничтожения секретных ключей тщательно
уничтожалась и вся информация, по которой возможно их
частичное восстановление.
11. Восстановление ключей. Если ключевая информация
уничтожена, но не скомпрометирована (например, из-за
неисправности оборудования или из-за того, что оператор
413
/ лава 1Ь
забыл пароль) должны быть предусмотрены меры, дающие
возможность восстановить ключ из хранимой в соответствующих
условиях его копии.
12. Отмена ключей. В случае компрометации ключевой информации
возникает необходимость прекращения использования
ключей до окончания срока их действия. При
этом должны быть предусмотрены необходимые меры
оповещения абонентов сети. При отмене открытых ключей,
снабженных сертификатами, одновременно производится
прекращение действия сертификатов.
§ 16.2. Услуги, предоставляемые доверенной
третьей стороной
В жизненном цикле управления ключами важную роль
играет так называемая доверенная третья сторона, на функциях
которой мы ниже остановимся подробнее. Эти функции
могут быть определены следующим образом.
1. Сервер имен абонентов — обеспечивает придание каждому
из абонентов индивидуального имени.
2. Регистрационный центр — обеспечивает включение каждого
из абонентов в данную сеть засекреченной связи и
выдачу ему соответствующей ключевой информации.
3. Центр производства ключей.
4. Ключевой (идентификационный) сервер — обеспечивает
установку общего сеансового ключа между двумя абонентами
путем передачи этого ключа по защищенному каналу,
образуемому сервером с каждым из абонентов. При
этом может осуществляться и идентификация абонентов.
5. Центр управления ключами — обеспечивает хранение,
архивацию, замену и отмену ключей, а также аудит действий,
связанных с жизненным циклом ключей.
6. Сертификационный центр — обеспечивает аутентичность
открытых ключей путем придания им сертификатов,
заверенных цифровой подписью.
414
Управление ключами
7. Центр установки временных меток — обеспечивает привязку
временной метки к электронному сообщению или
транзакции, заверяя тем самым их наличие в определенный
момент времени.
8. Центр нотаризации — обеспечивает невозможность отказа
от сделанного в определенный момент заявления, зафиксированного
в электронной форме.
Остановимся подробнее на последних двух функциях.
Установка временных меток
Центр установки временных меток обеспечивает пользователей
заверенными временными метками (в момент представления
этому центру документа в электронной форме), которые
могут служить подтверждением наличия документа в
определенный момент времени. Такие метки могут быть использованы
для проверки наличия подписанных контрактов в
определенный момент времени или подтверждения наличия
лабораторных записей в делах, связанных с патентами, а также
для обеспечения невозможности отказа от сделанной ранее
электронной подписи.
Основная идея такого подхода состоит в следующем. Доверенная
третья сторона Т добавляет временную метку 1\ к
представленному электронному документу или файлу данных,
подписывает составленный таким образом документ (тем
самым ручаясь за то, что он существовал в определенное временной
меткой время) и возвращает подписанный документ
вместе с меткой 1\ абоненту, представившему первоначальный
документ. Последующая проверка состоит в проверке правильности
подписи третьей стороны Т.
Если в качестве документа представлять доверенной
третьей стороне Т не сам документ, а значение вычисленной
от него хэш-функции, то будет обеспечена конфиденциальность
этого документа при передаче по незащищенным каналам
связи, а также снизятся требования к пропускной способ415
Iлава 1Ь
ности используемых каналов и объему памяти, необходимому
для хранения подписанных документов.
Нотаризация цифровых подписей
Термин “нотаризация” происходит от слова нотариус, который,
как известно, должен подтверждать правильность копий
представленных документов для представления их третьим
лицам — арбитрам.
Центр нотаризации служит для предотвращения опасности
отказа подписавшего документ от своей цифровой подписи
в последующем, при изменении обстоятельств. При
использовании нотаризационного центра предполагается наличие
третьего лица — арбитра, который не входит в центр
нотаризации, но доверяет нотаризационному центру.
Заметим, что имеется существенная разница между следующими
двумя внешне сходными задачами.
1. Сторона А убеждается, что цифровая подпись 5 была
сделана в момент времени /0.
2. Сторона А пытается убедить других в момент времени
> Аъ что подпись 5* была действительна в момент времени /о-
Первая задача решается стандартным способом с использованием
симметричной шифрсистемы в отсутствие не доверяющих
друг другу сторон.
Особенностью второй задачи как раз и является наличие
не доверяющих друг другу сторон. При этом, поскольку цифровой
подписи можно доверять только при условии неразглашения
секретного ключа, возникает опасность, что подписавший
сообщение может намеренно разгласить свой секретный
ключ, а затем объявить цифровую подпись поддельной.
Для предотвращения этой угрозы используется дентр нотаризации,
который функционирует следующим образом.
Абонент, получивший подпись на документе (или ^ значении
вычисленной от него хэш-функции), представляет его в центр
нотаризации. Центр нотаризации проверяет подпись, готовит
416
Управление ключами
составной документ, состоящий из исходного документа, информации,
подтверждающей правильность его цифровой подписи,
и временной метки. Затем подписывает этот составной
документ своей цифровой подписью. Через определенный
промежуток времени, который может быть определен для
оповещения в случае компрометации секретных ключей, документ,
подписанный нотаризационным центром, должен
признаваться истинным всеми сторонами, доверяющими данному
центру, даже в случае объявления о компрометации секретных
ключей.
Контрольные вопросы
1. В чем состоят цели управления ключами?
2. В чем состоит политика безопасности?
3. Как могут быть классифицированы ключи в зависимости
от предназначения и сроков их действия?
4. Какие стадии включает в себя жизненный цикл ключей?
5. Какие услуги могут быть предоставлены доверенной
третьей стороной?
417
Глава 17
Некоторые практические аспекты
использования шифрсистем
§17.1. Анализ потока сообщений
В ряде случаев, когда противник не может дешифровать
информацию, передаваемую между абонентами системы
шифрованной связи, он тем не менее в состоянии извлечь полезную
информацию из анализа интенсивности потока зашифрованных
сообщений между различными абонентами
этой системы.
Так, например, усиление потока сообщений в военной
системе связи может служить одним из признаков подготовки
наступательной операции, внезапное увеличение потока сообщений
между двумя компаниями является признаком появления
объекта, являющегося предметом их общего интереса и
т. д.
В некоторых практических ситуациях возникает необходимость
скрытия потока сообщений между абонентами системы.
Такое скрытие может быть осуществлено либо путем
сокращения (и, в идеале, прекращения передачи информации)
по каналам, доступным для перехвата противником, либо путем
добавления сообщений, не имеющих какого-либо смысла
(пустые сообщения). Идеальным же средством скрытия потока
сообщений является использование непрерывного линейного
шифрования канала связи между каждой парой абонентов
сети. Вместе с тем эта мера приводит к значительному
удорожанию связи, поскольку требует круглосуточного использования
каналов.
418
Некоторые практические аспекты
§ 17.2. Ошибки операторов
Практика криптоанализа свидетельствует о том, что многие
системы шифрованной связи, обеспечивающие надежную
защиту информации при исправной работе, не смогли противостоять
усилиям криптоаналитиков из-за ошибок шифровальщиков
или неисправностей оборудования этих систем.
Простейшим примером ошибки шифровальщика является
ситуация, описанная в гл. 6. Приведем еще один пример из
этой области. Предположим, что оператор дисковой шифр-
машины ошибочно установил угловое положение первого
диска, зашифровал телеграмму и отправил ее получателю.
Получатель, получив телеграмму и установив правильные угловые
положения дисков, естественно, не смог расшифровать
эту телеграмму, о чем и послал уведомление отправителю.
Если, получив такое уведомление, отправитель установит
диски в правильное положение и снова направит зашифрованную
телеграмму получателю, то он даст возможность противнику,
ведущему перехват, легко прочитать эту телеграмму
и, кроме того, установить часть ключа используемой шифр-
машины. Противник может распознать такое событие, наблюдая
за потоком сообщений, зная шифрмашину и определяя
путем анализа те ошибки шифровальщиков, появление
которых наиболее вероятно. При этом следует иметь в виду,
что слабая обученность шифровальщиков и стрессовая ситуация
значительно увеличивают вероятности ошибок.
При эксплуатации ручных и электромеханических систем
для избежания таких ошибок предусматривались методы самопроверки
шифровальщика. Так, он должен был зашифровать
(но не передавать) некоторое тестовое сообщение (например,
состоящее из определенного числа символов) после
установки ключа и перед началом передачи реального сообщения.
Полученный результат сравнивался с правильно зашифрованной
версией того же сообщения, рассылаемой вместе
с ключом.
419
I лава 7/
В современных электронных шифраторах подобные процедуры
проверки проводятся автоматически, так же как и
блокировки всех опасных с криптографической точки зрения
ошибочных действий шифровальщика.
§ 17.3. Физические и организационные меры
при использовании шифрсистем
Для того чтобы криптографические средства защиты
обеспечивали надежную защиту информации, необходимо,
помимо их высокой криптографической стойкости, позаботиться
о том, чтобы противник не мог обойти эти средства
путем анализа физических процессов, сопровождающих их
работу, или получения шифровальных ключей через операторов,
обслуживающих эти устройства.
Выходной сигнал электронного шифратора гаммирования
представляет собой последовательность импульсов двух видов,
один из которых соответствует нулю, а другой — единице.
В силу особенностей реализации электронных схем импульсы,
соответствующие одному и тому же знаку, обычно
несколько отличаются друг от друга. Эти отличия не должны
превосходить определенных пределов для того, чтобы другие
части системы могли их распознать. Однако для шифраторов
одного этого требования мало. Например, при реализации
схемы сложения по модулю 2 может сложиться ситуация, когда
из-за несовершенства электронной схемы противник сможет
различать четыре типа сигналов, соответствующих результатам
операций
(О + 0) той 2, (0 + 1 ) той 2,
(1 + 0)тос12 , (1 + 1 ) шо<1 2 .
Хотя в результате операции (0+1) той 2 должен появляться
такой же сигнал, как и в результате операции ( 1 + 0) той 2,
420
Некоторые практические аспекты
различия в форме этих сигналов могут привести к тому, что
противник сможет дешифровать систему, даже в случае использования
одноразовой гаммы. Поэтому к электронным
шифраторам должно предъявляться требование, согласно которому
импульсы, отображающие одинаковые величины, были
бы настолько одинаковыми, насколько это возможно.
Работа криптографической аппаратуры, как и работа других
электронных устройств, сопровождается электромагнитным
излучением. Это излучение может быть перехвачено и
подвергнуто анализу с целью получения информации о шифруемом
тексте или используемых ключах. Поэтому необходимо
принимать меры для того, чтобы в том месте, где может
находиться приемная аппаратура противника, уровень сигнала,
излучаемого криптографической аппаратурой, не позволял
бы противнику извлечь из него полезную информацию. Этого
можно добиться путем снижения уровня сигналов, излучаемых
аппаратурой, а также экранированием, искусственным
зашумлением и т. д. Подобное же внимание необходимо уделять
устранению утечки звука, света и других потенциальных
носителей информации.
Если к криптографическому оборудованию возможен
доступ посторонних лиц, то оно должно помещаться в специальный
контейнер, защищающий его от физического воздействия.
Такой контейнер должен защищать от тайного проникновения,
не препятствуя, однако, охлаждению и обеспечивая
необходимый уровень экранирования. Для предотвращения
тайного считывания ключа должны быть предусмотрены специальные
устройства, устанавливающие ключ в “нулевое”
состояние при попытке открыть контейнер или при обнаружении
других физических воздействий.
Таким образом, задача создания электронного шифрующего
устройства, обеспечивающего надежную защиту информации,
является сложной многопрофильной задачей, требующей
разносторонних знаний разработчика в области
421
I лава 7 7
криптографии, физики, радиотехники, конструирования электронных
приборов и т. д.
Криптографическая система не сможет обеспечить надежной
защиты информации, если лица, имеющие доступ к
засекречиваемой информации или шифровальным ключам,
передают эту информацию противнику. Поэтому соблюдение
требований режима секретности персоналом шифровальной
службы является важнейшим условием надежной защиты информации.
При этом должна быть обеспечена регистрация
всех действий персонала, связанных с доступом к защищенной
информации, и периодически осуществляться проверка
правильности осуществления этого доступа.
Контрольные вопросы
1. Какая информация может быть получена из анализа потока
сообщений?
2. Какие средства могут быть использованы для скрытия
потока сообщений?
3. Какие меры для защиты от ошибок операторов могут
применяться при использовании ручных и электронных
систем?
4. Какие физические и организационные меры необходимо
применять для защиты криптографического оборудования?
422
Глава 18
Квантово-криптографический
протокол открытого
распределения ключей
Квантовый канал и его свойства
Применение в системах передачи информации таких элементарных
квантовых систем, как поляризованные фотоны,
позволяет получить совершенно новый криптографический
эффект, который нельзя достичь при использовании обычных
средств передачи информации. Используя принцип неопределенности
Гейзенберга, можно получить канал связи, в котором
невозможно какое бы то ни было прослушивание без наличия
нарушений при передаче, которые не были бы обнаружены
с очень большой вероятностью. Такой канал позволяет
осуществить безопасное распределение ключей между законными
пользователями канала связи.
В криптографических исследованиях традиционно считается,
что каналы связи доступны злоумышленнику, и он может
беспрепятственно осуществлять перехват и копирование
информации без обнаружения пользователями факта вмешательства.
В противоположность этому, когда передаваемая
информация кодируется неортогональными квантовыми состояниями,
например одиночными фотонами с направлениями
поляризации 0°, 45°, 90° и 135°, получается такой канал
связи, что передаваемые по нему данные даже теоретически
не могут ни читаться, ни копироваться нарушителем. Нарушитель
не может извлечь никакой, даже частичной, информации
об этих данных таким способом, который не поддавался
423
/ лава 1Ь
бы контролю, и который не смогли бы обнаружить законные
пользователи канала.
Несмотря на то, что направление поляризации является
величиной непрерывной, принцип неопределенности Гейзенберга
не допускает такого измерения состояния любого одиночного
фотона, которое раскрывало бы более одного бита
информации (в вероятностном смысле) об угле его поляризации.
Например, если луч света с осью поляризации, направленной
под углом а, попадает на фильтр, ориентированный
под углом р, то все отдельно взятые фотоны ведут себя независимо
и совершенно непредсказуемым образом, проходя через
такой фильтр с вероятностью соз2(а~Р), и поглощаясь, соответственно,
с вероятностью 8 т2(а-(3).
Детерминировано фотоны ведут себя только тогда, когда
направляющие поляризации фотона и фильтра либо параллельны
друг другу (тогда все фотоны проходят через фильтр),
либо перпендикулярны (в этом случае все фотоны поглощаются).
При этом применить клонирование фотона с целью
получить ансамбль из одинаково поляризованных фотонов
так, чтобы впоследствии можно было выполнить над ними
различные измерения, невозможно. Существование такого
ансамбля не согласуется с основными положениями квантовой
механики.
С практической же точки зрения достаточно понимать,
что имеются два простых прибора. Один из этих приборов
может отличать горизонтально поляризованные фотоны от
вертикально поляризованных фотонов, а другой может отличать
фотоны с разной диагональной поляризацией. Однако
если первый прибор используется для определения состояния
диагонально поляризованного фотона (а второй — для прямоугольно
поляризованного), то в такой ситуации фотон поведет
себя совершенно случайным и непредсказуемым образом,
и подобное измерение угла его поляризации с одинаковой
вероятностью может дать любое из двух возможных значений.
424
Квантово-криптографическии протокол
Протокол открытого распределения ключей
Цель открытого распределения ключей по квантовому
каналу заключается в том, чтобы, используя квантовый канал,
обеспечить передачу последовательности случайных битов
между двумя пользователями, которые до этого не имели никакой
совместно используемой секретной информации. Если
квантовая передача не нарушалась, то пользователи могут с
уверенностью применять эту согласованную секретную последовательность
в качестве секретного ключа в любой традиционной
криптосистеме. С другой стороны, если обнаружится,
что передача была нарушена, то пользователи могут не
принимать во внимание полученную двоичную последовательность
и должны попытаться произвести квантовую передачу
еще раз.
Рассмотрим более подробно, каким образом два пользователя
(обозначим их А и В) могут осуществить открытое
распределение ключей с использованием квантового канала.
Мы предполагаем наличие нарушителя С.
В качестве первого шага А выбирает произвольную битовую
строку и произвольную последовательность поляризационных
базисов (прямоугольных и диагональных). Затем А
посылает В ряд фотонов, каждый из которых является носителем
одного бита информации этой выбранной двоичной
строки. Значение каждого бита определяется поляризацией
соответствующего ему фотона в базисе, номер позиции которого
в выбранной последовательности (поляризационных базисов)
совпадает с порядковым номером бита в строке. Так,
например, горизонтально или под углом в 45° поляризованные
фотоны могут использоваться в качестве носителя двоичного
нуля, в то время как вертикально или под углом в 135°
поляризованные фотоны будут определять двоичную единицу-
Если С захочет измерить поляризацию тех фотонов, которые
А посылает В, то он не будет знать, в каких базисах это
425
I лава 18
необходимо делать. С другой стороны, В также не знает, какие
базисы нужно использовать. Поэтому при получении фотонов
пользователь В для каждого фотона случайным образом
решает, в каком базисе (прямоугольном или диагональном)
проводить измерения. После этого он интерпретирует результат
либо как двоичный нуль, либо как двоичную единицу, в
зависимости от исхода соответствующего измерения. Получающийся
в результате ответ, вообще говоря, носит элемент
случайности, так как при попытке измерить в прямоугольном
базисе угол поляризации диагонально поляризованного фотона
(или наоборот) вся заключенная в нем информация будет
потеряна. Таким образом, в итоге В получает корректные
данные лишь приблизительно для половины фотонов, которые
он измеряет (а именно для тех, для которых он правильно
угадал базис поляризации).
Последующие шаги протокола выполняются в обычном
открытом канале связи. Будем считать, что этот канал восприимчив
только к прослушиванию, но не к введению новых
или изменению порядка поступающих сообщений. Сначала А
и В определяют посредством открытого обмена сообщениями,
какие из фотонов были получены в действительности и какие
из них измерялись В в том базисе, в котором их и нужно было
измерять. Если квантовая передача не была искажена, то А и
В смогут в результате определить биты, закодированные этими
фотонами, несмотря на то, что никакая информация о значениях
этих битов никогда не передавалась по открытому каналу
связи.
Таким образом, порядок открытого распределения ключей
по квантовому каналу представляется в виде следующего
протокола.
Передача по квантовому каналу
Пользователь А:
1. Случайно выбирает битовую строку.
2. Случайно выбирает последовательность базисов поляризации
передаваемых фотонов.
426
Квантово-криптографическии протокол
3. Передает поляризованные фотоны пользователю В.
Пользователь В:
4. Случайно выбирает последовательность базисов поляризации
фотонов для измерения принимаемых фотонов.
5. Получает последовательность битов при измерении принятых
фотонов.
Обсуждение по открытому каналу
Пользователь В:
6. Сообщает пользователю А базисы измерений полученных
фотонов.
Пользователь А:
7. Отмечает, какие базисы были угаданы правильно.
8. Посылает пользователю В информацию о номерах битов,
которые можно использовать.
Пользователь В:
9. Указывает пользователю А некоторые, выбранные наугад,
биты ключа.
Пользователь А:
10. Подтверждает эти биты.
Из-за того что прямоугольно и диагонально поляризованные
фотоны чередуются в квантовой передаче случайным образом,
любой нарушитель рискует при перехвате изменить
передачу таким способом, что это приведет к расхождению
между А и В. Часть битов, значения которых при отсутствии
вмешательства со стороны С должны были совпадать, на самом
деле будут отличаться. Отметим, что при пересылке любого
фотона никакое измерение его состояния нарушителем,
которому исходный базис поляризации этого фотона не известен
заранее, не может определить соответствующее значение
ключевого бита с вероятностью большей, чем 1/ 2 .
Остается выяснить, как А и В смогут определить, являются
ли получившиеся у них в результате описанного выше протокола
битовые строки идентичными. Идентичность битовых
427
I лава 18
строк показывает с высокой вероятностью, что в квантовом
канале нарушения не произошло или что это нарушение имело
место на очень малом числе фотонов. Различие строк означает,
что квантовый канал подвергнут прослушиванию.
Простое решение этой проблемы заключается в том, что
А и В могут открыто сравнить некоторые из битов, значения
которых, по их мнению, должны совпадать. Позиции таких
“особо проверяемых” битов должны быть выбраны случайно,
причем уже после того, как квантовая передача будет завершена.
Это лишит противника информации о том, какие фотоны
он может измерять без опаски. Недостаток подобного способа
заключается в рассекречивании части полученных битов.
Если совокупность позиций битов, используемых при этом
сравнении, является произвольным подмножеством (скажем,
одной трети) всех правильно полученных битов, то перехват
более десятка фотонов, позволяющий избежать обнаружения,
маловероятен. Если все сравнения подтверждаются, то А и В
могут заключить, что квантовая передача прошла без перехвата.
Следовательно, оставшиеся биты, которые были посланы
и получены в одном и том же базисе, могут использоваться
в качестве ключа в системах защиты информации.
Приложение 1
Открытые сообщения и их характеристики
Как уже отмечалось во введении, криптография занимается
защитой сообщений, содержащихся на некотором материальном
носителе. При этом сами сообщения представляют
собой последовательности знаков (или слова) некоторого алфавита.
Различают естественные алфавиты, например русский
или английский, и специальные алфавиты (цифровые,
буквенно-цифровые), например двоичный алфавит, состоящий
из символов 0 и 1. В свою очередь, естественные алфавиты
также могут отличаться друг от друга даже для данного
языка.
Алфавиты открытых сообщений
Наиболее привычны буквенные алфавиты, например русский,
английский и т. д. Приведем сведения об алфавитах некоторых
естественных европейских языков.
Полный русский алфавит состоит из 33 букв:
АБ В ГД Е ЁЖЗИЙК ЛМНОПР
СТУФХЦЧШЩЪЫ ЬЭЮЯ
Вместе с тем используются и сокращенные русские алфавиты,
содержащие 32, 31 или 30 букв. Можно отождествить
буквы Е и Ё, И и Й, Ь и Ъ. Часто бывает удобно включить в
алфавит знак пробела между словами, в качестве которого
можно взять, например, символ
Английский алфавит состоит из 26 букв:
АВСОЕРОНПКЬММОР( )Я8ТиУ\УХУ2
429
/ филожение 7
Иногда используется сокращенный 25-буквенный алфавит,
в котором отождествлены буквы I и Д.
Во французском языке практически не используются буквы
К и XV. Эти буквы встречаются только в некоторых словах
иностранного происхождения, например 1гатм?ау, кИо,
меекепс/. Поэтому часто используют 24-буквенный алфавит
(без К и XV).
В немецком языке исключительно редки буквы О, X и V.
Буква 0 появляется в виде начальной буквы лишь в некоторых
малоупотребительных словах, большей частью иностранного
происхождения, например дие11е, диаПа, диШп%.
Помимо латинских букв немецкий язык использует еще три
буквы: б,а,ё, которые часто заменяют эквивалентами ОЕ, АЕ
и ЕГЕ соответственно, например в словах каетр/еп, тоеЪе1,
%1иеск. Буквы X и V практически не используются, поэтому
часто обходятся лишь 24 буквами (без X и V).
Испанский язык содержит некоторые особые буквы: СН,
ЬЬ, N1, которые можно заменить эквивалентами: С,Н; Ь,Ь; N.
Как и во французском языке, буквы К и XV исключительно
редки, и поэтому часто используется 24-буквенный алфавит.
В итальянском языке крайне редки буквы 1, К, XV, X и V.
Поэтому используется либо 21-буквенный алфавит, либо 22-
буквенный (без .1, К, У).
Реже встречается греческий алфавит. Он состоит из 24
букв (см. табл. 1).
Любопытно отметить, что полинезийский язык Самоа
имеет алфавит, содержащий всего 16 букв, из которых около
60% — гласных. В арабском языке и иврите согласные вообще
не используются. Они опускаются в письменном тексте и
восстанавливаются читателем по смыслу.
430
Открытые сообщения и их характеристики
Т аб л и ц а 1. Греческий алфавит
А(а) _ . В((3) Г(У) _ А(8) Е(с) ... 2 ( 0
альфа бетта гамма дельта эпсилон дзета
Н(л) 0(6) КО К(к) т М(ц)
эта тэта йота каппа лямбда мю
М(у) . .. т . О(о) П(тс) р(р) Д а )
ню кси омикрон пи ро сигма
Г(т) . Г(о) ф(ф) Х(Х) т о О(со)
тау эпсилон .... -Фи. _ хи пси омега
Код Бодо, применяемый для передачи сообщений с помощью
телетайпов и телексов, использует 32-значный алфавит:
Т аб л и ц а 2. Упрощенный Бодо-подобный алфавит
00000 00001 00010 00011
А В С О
00100 00101 00110 00111
Е Р О Н
01000 01001 01010 01011
I 5 К Ь
01100 01101 01110 01111
М N О Р
10000 10001 10010 10011
0 Я 8 Т
10100 10101 10110 10111
V V ДУ X
11000 11001 11010 11011
У Ъ
11100 11101 11110 11111
? + ( )
431
Приложение 7
Первым идею двоичного кодирования букв алфавита использовал
современник В. Шекспира Фрэнсис Бэкон. Он
предложил двухбуквенное кодирование.
Т аб л и ц а 3.Двухбуквенный алфавит Ф. Бэкона
А - ааааа ГТ - аЬааа Я - Ьаааа
В - ааааЪ К - аЬааЪ 8 - ЬаааЬ
С - аааЬа Ь - аЬаЬа Т - ЬааЬа
О - аааЬЬ М - аЬаЬЬ ЦУ - ЬааЬЬ
Е - ааЬаа N - аЬЬаа \У - ЬаЬаа
Р - ааЬаа О - аЬЬаЬ X - ЬаЬаЬ
О - ааЬЬа Р - аЬЬЬа У - ЬаЬЬа
Н - ааЬЬЬ <3 - аЬЬЬЬ Ъ - ЬаЬЬЬ
Цифровое кодирование букв применял упоминаемый в
историческом очерке И. Тритемий.
Т аб л и ц а 4. Трехзначный алфавит Тритемия
А - 1 1 1 3 — 2 1 1 8-311
В - 112 К -212 Т -3 1 2
С-113 Ь - 213 ЕГ-313
0 - 1 2 1 М-221 V - 321
Е - 122 N - 2 2 2 ^ - 322
Р - 123 0 -2 2 3 X - 323
С-131 Р - 231 У - 331
Н - 132 <3-232 2 -3 3 2
I - 133 Я -233 & - 333
В вычислительной технике распространены 128-битовые
и 256-битовые алфавиты, использующие представление знаков
алфавита в виде 7- или 8-значных двоичных комбинаций.
432
Открытые сообщения и их характеристики
Наиболее известен код А8СИ (Атепсап 8{апс1аг(: Сойе Еог
1п1Ьгта{юп 1п1егсЬап§е) — американский стандартный код
информационного обмена. Приведем фрагмент этого кода.
Т аб л и ц а 5.КодАЗСП
Символ Восьмеричная
запись
Двоичная
запись
А 1 0 1 0 1 0 0 0 0 0 1
В 1 0 2 0 1 0 0 0 0 1 0
С 103 0 1 0 0 0 0 1 1
и 104 0 1 0 0 0 1 0 0
Е 105 0 1 0 0 0 1 0 1
Е 106 0 1 0 0 0 1 1 0
1 061 0 0 1 1 0 0 0 1
2 062 0 0 1 1 0 0 1 0
3 063 0 0 1 1 0 0 1 1
4 064 0 0 1 1 0 1 0 0
& 046 0 0 1 0 0 1 1 0
056 0 0 1 0 1 1 1 0
# 043 0 0 1 0 0 0 1 1
054 0 0 1 0 1 1 0 0
В практике передачи сообщений по техническим каналам
связи используется множество других кодов, основанных на
двоичном кодировании.
Буквенный алфавит, в котором буквы расположены в их
естественном порядке, обычно называют нормальным алфавитом.
В противном случае говорят о смешанных алфавитах.
В свою очередь, смешанные алфавиты делят на системати433
Приложение 1
чески перемешанные алфавиты и случайные алфавиты. К
первым относят алфавиты, полученные из нормального на
основе некоторого правила, ко вторым — алфавиты, буквы
которых следуют друг за другом в хаотическом (или случайном)
порядке.
Смешанные алфавиты обычно используются в качестве
нижней строки подстановки, представляющей собой ключ
шифра простой замены (см. гл. 5). Для запоминания ключа
(это надежнее, чем хранение ключа на некотором носителе)
применяется несложная процедура перемешивания алфавита,
например, основанная на ключевом слове. Одним из первых
такой способ построения систематически перемешанного алфавита
предложил Ардженти (см. гл. 1).
Частотные характеристики текстовых сообщений
Криптоанализ любого шифра невозможен без учета особенностей
текстов сообщений, подлежащих шифрованию.
Глубинные закономерности текстовых сообщений исследуются
в теории информации. Наиболее важной для криптографии
характеристикой текстов является избыточность текста,
введенная К. Шенноном. Именно избыточность открытого
текста, проникающая в шифртекст, является основной слабостью
шифра.
Более простыми характеристиками текстов, используемыми
в криптоанализе, являются такие характеристики, как
повторяемость букв, пар букв {биграмм) и вообще т-ок
{т-грамм\ сочетаемость букв друг с другом, чередование
гласных и согласных и некоторые другие. Такие характеристики
изучаются на основе эмпирических наблюдений текстов
достаточно большой длины.
Для установления статистических закономерностей проводилась
большая серия экспериментов по оценке вероятно434
Открытые сообщения и их характеристики
стей появления в открытом тексте фиксированных т-грамм
(для небольших значений т).
Суть экспериментов состоит в подсчете чисел вхождений
каждой из пт возможных т-грамм в достаточно длинных
открытых текстах Т = Ц 2—Ц ? составленных из букв алфавита
{а/, а2,...,ап}. При этом просматриваются подряд идущие т-
граммы текста:
^ 3 " * С + 1 9 *1-т+\*1-т+2” ^ Г
Если Э(а1а12...а1 ) — число появлений т-граммы
а, а, ...а, в тексте Г, а Ь — общее число Ч '2 1т подсчитанных т-
грамм, то опыт показывает, что при достаточно больших Ь
частоты
*9(а. а. ...а. ) 4 1 2 1т 7 / 1 \
для данной т-граммы мало отличаются друг от друга. В силу
этого относительную частоту ( 1) считают приближением вероятности
Р(а1а12...а1 ) появления данной т-граммы в случайно
выбранном месте текста (такой подход принят при статистическом
определении вероятности). Например, при т = 1
хорошее приближение вероятностей появления букв достигается
на текстах длинной в несколько тысяч букв.
Ниже приводится таблица частот букв (в процентах)
ряда европейских языков. Данные заимствованы из книги
[Ваи39] (см. табл. 6).
Некоторая разница значений частот в приводимых в
различных источниках таблицах объясняется тем обстоятельством,
что частоты существенно зависят не только от длины
текста, но и от его характера. Так, в технических текстах редкая
буква Ф может стать довольно частой в связи с частым
435
/ /риложение 1
использованием таких слов, как функция, дифференциал,
диффузия, коэффиг^ент и г. п.
Т аб л и ц а 6. Частоты букв европейских языков
Буква алфавита
Франц.
язык
Немец.
язык
Англ.
язык
Испан.
язык
Итал.
язык
А 7,68 5,52 7,96 12,90 1 1 , 1 2
В 0,80 1,56 1,60 1,03 1,07
С 3,32 2,94 2,84 4,42 4,11
Э 3,60 4,91 4,01 4,67 3,54
Е 17,76 19,18 1 2 , 8 6 14,15 11.63
Е 1,06 1,96 2,62 0,70 1,15
С 1 , 1 0 3,60 1,99 1 , 0 0 1,73
Н 0,64 5,02 5,39 0,91 0,83
I 7,23 8 , 2 1 7,77 7,01 12,04
} 0,19 0,16 0,16 0,24 -
К - 1,33 0,41 - -
Ь 5,89 3,48 3,51 5,52 5,95
М 2,72 1,69 2,43 2,55 2,65
N 7,61 1 0 , 2 0 7,51 6 , 2 0 7,68
О 5,34 2,14 6,62 8,84 8,92
Р 3,24 0,54 1,81 3,26 2 , 6 6
1,34 0 , 0 1 0,17 1,55 0,48
Я 6,81 7,01 6,83 6,95 6,56
8 8,23 7,07 6,62 7,64 4,81
Т 7,30 5,86 9,72 4,36 7,07
и 6,05 4,22 2,48 4,00 3,09
V 1,27 0,84 1,15 0,67 1,67
\У - 1,38 1,80 - -
X 0,54 - 0,17 0,07 -
У 0 , 2 1 - 1,52 1,05 -
ъ 0,07 1Д7 0,05 0,31 1,24
436
Открытые сообщения и их характеристики
Еще большие отклонения от нормы в частоте употребления
отдельных букв наблюдаются в некоторых художественных
произведениях, особенно в стихах. Поэтому для надежного
определения средней частоты буквы желательно иметь
набор различных текстов, заимствованных из различных источников.
Вместе с тем, как правило, подобные отклонения
незначительны, и в первом приближении ими можно пренебречь.
В связи с этим подобные таблицы, используемые в криптографии,
должны составляться с учетом характера переписки.
А С Е С I К М 0 0 3 1 ) \ Л / У
Рис. 1. Частоты букв английского языка (в процентах)
Наглядное представление о частотах букв дает диаграмма
встречаемости. Так, для английского языка, в соответствии с
табл. 6, такая диаграмма изображена на рис. 1 .
Для русского языка частоты (в порядке убывания) знаков
алфавита, в котором отождествлены Е с Ё, Ь с Ъ, а также име437
11риложение 1
ется знак пробела (-) между словами, приведены в следующей
таблице (см. [Ягл.73]):
Т аб л и ц а 7. Частоты букв русского языка
(в 32-буквенном алфавите со знаком пробела)
- О Е,Ё А
0,175 0,090 0,072 0,062
И Т Н С
0,062 0,053 0,053 0,045
Р В Л К
0,040 0,038 0,035 0,028
М Д П У
0,026 0,025 0,023 0 , 0 2 1
Я Ы 3 Ь,Ъ
0,018 0,016 0,016 0,014
Б Г Ч И
0,014 0,013 0 , 0 1 2 0 , 0 1 0
X Ж Ю Ш
0,009 0,007 0,006 0,006
Ц Щ Э Ф
0,004 0,003 0,003 0 , 0 0 2
Т аб л и ц а 8. 10 наиболее частых букв европейских языков
Французский язык ЕДАД/ГДДАЦО 79,9%
Немецкий язык ЕД,1,8,Т,А,НАН 77,2%
Английский язык Е,Т,А,1,МД,0,8,Н,0 75,3%
Испанский язык Е,АО,8,1,ЯД,БАС 78,3%
Итальянский язык 1,Е,А,ОД,Т,Я,Ц8,С 79,9%
438
Открытые сообщения и их характеристики
На основании табл. 7 получаем следующую диаграмму
частот (см. рис. 2).
Частоты букв русского 32-буквенного
алфавита (со знаком пробела)
Б Г Е,Ё 3 Й Л Н П С У X Ч Щ Ь . Ъ Ю
I
Рис. 2. Диаграмма частот букв русского языка
Имеется мнемоническое правило запоминания десяти
наиболее частых букв русского алфавита. Эти буквы составляют
нелепое слово СЕНОВАЛИТР. Можно также предложить
аналогичный способ запоминания частых букв английского
языка, например, с помощью слова ТЕТК18-НСЖЭА
(см. табл. 8).
Устойчивыми являются также частотные характеристики
биграмм, триграмм и четырехграмм осмысленных текстов.
Приведем таблицы частот биграмм для русского (табл. 9)
и английского языков (табл. 10) (таблицы заимствованы из
книги [Рп85]). Для удобства они разбиты на четыре части по
следующей схеме:
439
11риложение 7
ЧАСТЬ 1 ЧАСТЬ 2
ЧАСТЬ 3 ЧАСТЬ 4
Хорошие таблицы ^-грамм легко получить, используя
тексты электронных версий многих книг, содержащихся на
СЭ-дисках.
Для получения более точных сведений об открытых текстах
можно строить и анализировать таблицы Л-грамм при
к> 2 , однако для учебных целей вполне достаточно ограничиться
биграммами. Неравновероятность к-грамм (и даже
слов) тесно связана с характерной особенностью открытого
текста — наличием в нем большого числа повторений отдельных
фрагментов текста: корней, окончаний, суффиксов,
слов и фраз. Так, для русского языка такими привычными
фрагментами являются наиболее частые биграммы и триграммы:
СТ, НО, ЕН, ТО, НА, ОВ, НИ, РА, ВО, КО,
СТО, ЕНО, НОВ, ТОВ, ОВО, ОВА
Полезной является информация о сочетаемости букв, то
есть о предпочтительных связях букв друг с другом, которую
легко извлечь из таблиц частот биграмм.
Имеется в виду таблица, в которой слева и справа от каждой
буквы расположены наиболее предпочтительные “соседи”
(в порядке убывания частоты соответствующих биграмм).
В таких таблицах обычно указывается также доля гласных и
согласных букв (в процентах), предшествующих (или следующих
за) данной букве.
440
Открытые сообщения и их характеристики
Т аб л и ц а 9. Таблица частот биграмм русского языка
ЧАСТЬ 1
А Б В Г Д Е Ж 3 И “ТУ и К Л М Н 0 П
А 2 1 2 35 8 14 7 6 15 7 7 19 27 19 45 5 1 1
Б 5 9 1 6 6 2 2 1
В 35 1 5 3 3 32 2 17 7 1 0 3 9 58 6
Г 7 3 3 5 1 5 1 50
д 25 3 1 1 29 1 1 13 1 5 1 13 2 2 3
Е 2 9 18 И 27 7 5 1 0 6 15 13 35 24 63 7 16
Ж 5 1 6 1 2 5 6
3 35 1 7 1 5 3 4 2 1 2 9 9 1
И 4 6 2 2 5 1 0 2 1 2 23 19 1 1 19 2 1 2 0 32 8 13
И 1 1 4 1 3 1 2 4 5 1 2 7 9 7
К 24 1 4 1 4 1 1 26 1 4 1 2 6 6 2
Л 25 1 1 1 1 33 2 1 36 1 2 1 8 30 2
м 18 2 4 1 1 2 1 1 2 23 3 1 3 7 19 5
н 54 1 2 3 3 34 58 3 1 24 67 2
0 1 28 84 32 47 15 7 18 1 2 29 19 41 38 30 9 18
п 7 15 4 9 1 46
ЧАСТЬ 2
р С Т У Ф X Ц Ч Ш щ ы Ь Э Ю Я
А 26 31 27 3 1 10 6 7 10 1 2 6 9
Б 8 1 6 1 11 2
В 6 19 6 7 1 1 2 4 1 18 1 2 3
Г 7 2
д 6 8 1 10 1 1 1 5 1 1
Е 39 37 33 3 1 8 3 7 3 3 1 1 2
Ж 1
3 3 1 2 4 4
И И 29 29 3 1 17 3 11 1 1 1 3 17
И 3 10 2 1 3 2
К 10 3 7 10 1
Л 3 1 6 4 1 2 30 4 9
м 2 5 3 9 1 2 5 1 1 3
н 1 9 9 7 1 5 2 36 3 5
0 43 50 39 3 2 5 2 12 4 3 2 3 2
п 41 1 6 2 2
441
Приложение 1
ЧАС ГЬ 3
А Б В Г Д Е Ж 3 И й К Л м Н О п
р 55 1 4 4 3 37 3 1 24 3 1 3 7 56 2
с 8 1 7 1 2 25 6 40 13 3 9 27 11
т 35 1 27 1 3 31 1 28 5 1 1 11 56 4
У I 4 4 4 И 2 6 3 2 8 5 5 5 1 5
ф 2 2 2 1
X 4 1 4 1 3 1 2 3 4 3 3 4 18 5
ц 3 7 1 0 2 1
ч 1 2 23 13 2 6
ш 5 11 14 1 2 2 2
щ 3 8 6 1
ы 1 9 1 3 1 2 2 4 7 л:> 6 6 3 2 1 0
ь 2 4 1 1 2 2 2 6 3 13 2 4
э 1 1
ю 2 1 2 1 3 1 1 1 1 1 3
я 1 3 9 1 3 3 1 5 3 2 3 3 4 6 3 6
ЧАСТЬ 4
р С Т У Ф X ц Ч ШЩЫ Ь Э Ю Я
Р 1 5 9 16 1 1 1 2 8 3 5
С 4 11 82 6 1 1 2 2 1 8 17
т 26 18 2 1 0 1 11 2 1 4
У 7 14 7 1 8 3 2 9 1
ф 1 1
X 3 4 2 2 1 1
ц 1 1
ч 7 1 1 1
ш 1 1
щ 1
ы 3 9 4 1 16 1 2
ь 1 1 1 3 1 4 1 3 1
э 1 9
ю 1 1 7 1 1 4
я 3 6 1 0 2 1 4 1 1 1 1 1
442
Открытые сообщения и их характеристики
Т аб л и ц а 10. Таблица частот биграмм английского языка
ЧАСТЬ I
А В С О Е Р 0 Н I К Ь м
А 4 2 0 28 52 2 11 28 4 32 4 6 62 23
В 13 0 0 0 55 0 0 0 8 2 0 2 2 0
С 32 0 7 1 69 0 0 33 17 0 1 0 9 1
Э 40 16 9 5 65 18 3 9 56 0 1 4 15
Е 84 2 0 55 125 51 40 19 16 50 1 4 55 54
Р 19 3 5 1 19 2 1 1 3 30 2 0 11 1
С 2 0 4 3 2 35 1 3 15 18 0 0 5 1
Н 1 0 1 1 3 0 270 5 1 6 57 0 0 0 3
I 40 7 51 23 25 9 1 1 3 0 0 2 38 25
5 3 0 0 0 5 0 0 0 1 0 0 0 0
К 1 0 0 0 И 0 0 0 13 0 0 0 0
Ь 44 2 5 1 2 62 7 5 2 42 1 1 53 2
М 52 14 1 0 64 0 0 3 37 0 0 0 7
ЧАСТЬ 2
N О Р Р Я 8 Т V V № X У ъ
А 167 2 14 0 83 76 127 1 25 8 1 9 1
В 0 11 0 0 15 4 2 13 0 0 0 15 0
С 0 50 3 0 10 0 28 11 0 0 0 3 0
О 6 16 4 0 21 18 53 19 5 15 0 3 0
Е 146 35 37 6 191 149 65 9 26 31 12 5 0
Р 0 51 0 0 26 8 47 6 3 3 0 2 0
0 4 21 1 1 20 9 21 9 0 5 0 1 0
Н 2 44 1 0 3 10 18 6 0 5 0 3 0
I 202 56 12 1 46 79 117 1 22 0 4 0 3
} 0 4 0 0 0 0 0 3 0 0 0 0 0
К 2 2 0 0 0 6 2 1 0 2 0 1 0
Ь 2 25 1 1 2 16 23 9 0 1 0 33 0
м 1 17 18 1 2 12 3 8 0 1 0 2 0
443
11риложение 1
ЧАСТЬ 3
А В С Э Е Р 0 Н I 5 К ь М
N 42 1 0 47 1 2 2 63 19 106 1 2 30 1 6 6 9
0 7 1 2 14 17 5 95 3 5 14 0 0 19 41
Р 19 1 0 0 37 0 0 4 8 0 0 15 1
0 0 0 0 0 0 0 0 0 0 0 0 0 0
я 83 8 16 23 169 4 8 8 77 1 1 0 5 26
8 65 9 17 9 73 13 1 47 75 3 0 7 11
Т 57 2 2 7 1 76 5 2 330 126 1 0 14 1 0
V 11 5 9 6 9 1 6 0 9 0 1 19 5
V 7 0 0 0 72 0 0 0 28 0 0 0 0
№ 36 1 1 0 38 0 0 33 36 0 0 4 1
X 1 0 2 0 0 1 0 0 3 0 0 0 0
У 14 5 4 2 7 1 2 2 6 1 0 0 0 3 7
2 1 0 0 0 4 0 0 0 0 0 0 0 0
ЧАСТЬ 4
N О Р <3 я 8 Т и V X У 2
N 7 54 7 1 7 44 124 6 1 15 0 1 2 0
О 134 13 23 0 91 23 42 55 16 28 0 4 1
Р 0 27 9 0 33 14 7 6 0 0 0 0 0
Р 0 0 0 0 0 0 0 17 0 0 0 0 0
Я 16 60 4 0 24 37 55 6 1 1 4 0 28 0
8 1 2 56 17 6 9 48 116 35 1 28 0 4 0
Т 6 79 7 0 49 50 56 2 1 2 27 0 24 0
и 31 1 15 0 47 39 31 0 3 0 0 0 0
V 0 5 0 0 0 0 0 0 0 0 0 3 0
8 15 0 0 0 4 2 0 0 1 0 0 0
X 0 1 5 0 0 0 3 0 0 1 0 0 0
У 5 17 3 0 4 16 30 0 0 5 0 0 0
ъ 0 0 0 0 0 0 0 0 0 0 0 0 0
444
Открытые сообщения и их характеристики
Таб л и ц а 11. Сочетаемость букв русского языка
Г С Слева Справа г С
3 97 л, д, к, т в Р н А л,, н, с, т, р, в, к, м 12 88
80 20 я, е, у и а 0 Б 0 Ы, е, а, р, у 81 19
68 32 я,т, а е и 0 В 0 а, и, ы, с, н, л, р 60 40
78 22 Р. У, а и е 0 Г 0 а, р, л, и, в 69 31
72 28 Р, я, у, а и е 0 д е а, и, о, н, у, р, в 68 32
19 81 м, и, л, д т Р н Е н т, р, с, л, в, м, и 12 88
83 17 р, е, и а У 0 Ж е и, д, а, н 71 29
89 11 0 е а и 3 а н, в, о, м, д 51 49
27 73 Р, т, м, и 0 л н И с н, в, и, е, м, к, з 25 75
55 45 ь, в, е, о а и с к 0 а, и, р, у, т, л, е 73 27
77 23 г, в, ы, и е 0 а л и е, о, а, ь, я, ю, у 75 25
80 20 я, ы, а и е 0 м и е, о, у, а, н, п, ы 73 27
55 45 Д, ь, н, о а и е н 0 а, и, е, ы, н, у 80 20
11 89 р, п, к в т н 0 в с, т, р, и, д, н, м 15 85
65 35 в, с, у, а и е 0 п 0 р, е, а, у, и, л 68 32
55 45 и, к, т, а п 0 е р а е, о, и, у, я ,ы, н 80 20
69 31 с, т, в, а е и 0 с т к, о, я, е, ь, с, н 32 68
57 43 ч, у, и, а е 0 с т 0 а, е, и, ь, в, р, с 63 37
15 85 п, т, к, д, н, м Р У т п, с, д, н, ю, ж 16 84
70 30 н, а е 0 и ф и е, о. а, е, о, а 81 19
90 10 У, е, о, а, ы и X 0 и, с, н, в, п, р 43 57
69 31 е, ю н а и ц и е, а, ы 93 7
82 18 е, а У и 0 ч е и, т, н 66 34
67 33 ь, у, ы, е, о а и в ш е и, н, а, о, л 68 32
84 16 е, б, а, я, ю щ е и, а 97 3
0 100 м. р, т, с б в н ы л х, е, м, и, в, с, н 56 44
0 100 н с т л ь н к, в, п, с, е, о, и 24 76
14 86 с, ы, м, л, д т Р н э н т, р, с, к 0 100
58 42 ь, о, а и л У ю Д т, щ, ц, н, п 11 89
43 57 о, н, р, л а и с я в с, т, п, д, к, м, л 16 84
445
/ 1риложение 1
Т аб л и ц а 12. Сочетаемость букв английского языка
г С Слева Справа Г С
19 81 1,сДт,п,з,\лДг,е,11 А П,1,5, Г, 1,6,0,01 6 94
55 45 у,Ь,пД,иДо,з,а,е В е,1,и,о,а,у,Ь,г 70 30
61 39 и,о,з,п,а,1,1,е С Ьде,ад1,г,1,к 59 41
52 48 г,1,1,а,п,е 0 е,1Д,ади 54 46
8 92 с,Ь,е,т,уДз,1,п,1:,г,11 Е гДз,п,аД,т,е,с,о 21 79
69 31 з,пДДаде,о Р 4деда,гД,и 52 48
36 64 оДи,где,а,п С еДо,г,аДД,\л/дз 42 58
7 93 д,е,\л/,5,с,1 Н е,адо 90 10
13 87 Т,т,\л/,е,п,1Д5,г,11,1 1 пД,здс,г,е,т,а,1 17 83
28 72 у.жД.з.п.е.с.Ьдс и д а д т .ж 88 12
53 47 у,и,1,п,а,г,о,с К едп,аД,з 68 32
52 48 т,р,ЦЬ,и,о,е,1,а 1- еду,о,аДи 65 35
69 31 зД т .гд а .о .е м е,а,од р ,т 71 29
89 11 и,е,о,а,1 N с1Д,д,е,а,з,одс 32 68
21 79 оД1,рДп.е,сД,з |,гД О пД,г,иД,т,1,5,\лло 18 82
47 53 г,1Д,п,1,р,т,а,о,и,е,з Р о,е,а,г,1,и,р,Цз 59 41
20 80 о,п,1,е,с1,г,з 0 и 100 0
70 30 рди,1,аде В е д а ,Ц з ,у 61 39
48 52 сЦ.одг.п.зла.е 3 Де.одз.аДр.и 41 59
43 57 и,о, е)Д,^,е,1,п,з, а Т ЬДде.аДд 38 62
35 65 рД,ЦЬДз,о и п,зД,г,1,р,Ь,с 8 92
88 12 г,и,о,аде V едо.а 99 1
48 52 дДу,п,5,1де \л/ а .И д ед п 80 20
95 5 и,пде X р,Ца,и,с,к,о 38 62
24 76 Ь,п,аД,е,г,1 У а д зД ,\А /Д |,еД т 38 62
88 12 о,п,а,1 г е,\,\ы 86 14
446
Открытые сообщения и их характеристики
При анализе сочетаемости букв друг с другом следует
иметь в виду зависимость появления букв в открытом тексте
от значительного числа предшествующих букв. Для анализа
этих закономерностей используют понятие условной вероятности.
Наблюдения над открытыми текстами показывают, что
для условных вероятностей выполняются неравенства
Р(а,х) * Р(а,х /а ,2), р( а,, /а,2)* р(ац /а ,а ,2),... .
Систематически вопрос о зависимости букв алфавита в
открытом тексте от предыдущих букв исследовался известным
русским математиком А. А. Марковым (1856 — 1922).
Он доказал, что появления букв в открытом тексте нельзя
считать независимыми друг от друга. В связи с этим
А. А. Марковым отмечена еще одна устойчивая закономерность
открытых текстов, связанная с чередованием гласных и
согласных букв. Им были подсчитаны частоты встречаемости
биграмм вида гласная-гласная (г, г) , гласная-согласная (г, с ) ,
согласная-гласная (с, г ) , согласная-согласная (с,с) в русском
тексте длиной в 105 знаков. Результаты подсчета отражены в
следующей таблице:
Т аб л и ц а 13. Чередование гласных и согласных
г С Всего
Г 6588 38310 44898
с 38296 16806 55102
Из этой таблицы видно, что для русского языка характерно
чередование гласных и согласных, причем относительные
частоты могут служить приближениями соответствующих
условных и безусловных вероятностей:
447
I1риложение 1
р(т с) « 0,663, р ( с/г) « 0,872,
р(т) » 0,432, р ( с) « 0,568.
После А. А. Маркова зависимость появления букв текста
вслед за несколькими предыдущими исследовал методами
теории информации К. Шеннон. Фактически им было показано,
в частности, что такая зависимость ощутима на глубину
приблизительно в 30 знаков, после чего она практически отсутствует.
Таб л и ца 14. Доля гласных букв в литературном тексте
Французский язык 44,27%
Немецкий язык 39,27%
Английский язык 39,21%
Испанский язык 47,95%
Итальянский язык 46,80%
Приведенные выше закономерности имеют место для
обычных “читаемых” открытых текстов, используемых при
общении людей. Как уже отмечалось ранее, эти закономерности
играют большую роль в криптоанализе. В частности, они
используются при построении формализованных критериев
на открытый текст, позволяющих применять методы математической
статистики в задаче распознавания открытого текста
в потоке сообщений. При использовании же специальных алфавитов
требуются аналогичные исследования частотных характеристик
“открытых текстов”, возникающих, например,
при межмашинном обмене информацией или в системах передачи
данных. В этих случаях построение формализованных
критериев на “открытый текст” — задача значительно более
сложная.
В качестве примера приведем частотные характеристики
букв английского алфавита, входящих в состав кода А8СН.
448
Открытые сообщения и их характеристики
1...............................................
■1 . ____ _11 к 1 и... г...... ......
=4=1
г||з| ш г а
Рис.З. Частоты символов А8СИ (буквы)
(светлым — в статье по компьютерной тематике;
темным — в тексте программы на языке Паскаль)
Помимо криптографии частотные характеристики открытых
сообщений существенно используются и в других сферах.
Например, клавиатура компьютера, пишущей машинки или
линотипа — это замечательное воплощение идеи ускорения
набора текста, связанное с оптимизацией расположения букв
алфавита относительно друг друга в зависимости от частоты
их применения.
449
Приложение 2
Пример
Рассмотрим криптограмму, текст которой расположен в
строках табл. 1 (см. стр. 454).
Для успешного решения задачи найдем частотные характеристики
криптограммы, построив соответствующую матрицу
биграмм (см. табл. 2 на стр. 455). Обратим при этом внимание
на то, что в данном тексте используется обычный русский
алфавит, состоящий из 30 букв. Поэтому матрица будет
иметь размеры 30x30, строки и столбцы которой занумерованы
буквами 30-буквенного алфавита.
В табл. 1 текст криптограммы выписан построчно с интервалом
в две строки. Промежуточная строка потребуется
далее для записи букв открытого текста под соответствующими
буквами шифрованного текста.
Построим диаграмму встречаемости букв криптограммы.
Подсчет дает следующие значения относительных частот
букв (в процентах):
А Б В Г Д Е Ж 3 И К Л М Н О
1,80 7,54 6,9 11 2,1 8,9 4,1 6,1 5,1 1,5 3,6 0,2 9,5 2
П Р С Т У Ф X Ц Ч Ш Щ Ы Ь Э Ю Я
0 6,4 3,4 4,6 1,2 1 0 1,5 0,5 3,8 0 1 3,8 0,5 1,3 Л1
На основании этих данных получаем такую картину
(рис. 1 )
450
11ример
Буквы алфавита
Рис, 1, Диаграмма встречаемости букв криптограммы
Построенная диаграмма очень близка по характеру к диаграмме
открытого текста (см. рис. 1 Приложения 1). Кроме
того, матрица биграмм является достаточно рельефной. Это
свидетельствует о том, что скорее всего использован шифр
простой замены. Нам ничто не мешает проверить эту гипотезу.
В матрице биграмм имеется ярко выраженный лидер: биграмма
ЗИ встретилась 11 раз. Естественно предположить,
что она заменяет биграмму СТ открытого текста (наиболее
часто встречающуюся в русском литературном тексте). Явным
лидером по частоте встречаемости является буква Г.
Предположим, что она заменяет букву О.
Проверим эти гипотезы, сделав соответствующие замены
букв криптограммы. В результате получим картину, отраженную
в табл. 3 (см. стр. 456).
451
/ 1риложение г
Обратим внимание на некоторые получившиеся фрагменты
открытого текста: 0?0?0ТТ и СТ? (15-я строка), ?СТО
(6-я строка), СОС? (26-я строка), на основании которых можно
выдвинуть гипотезы о том, что вторая по частоте буква
шифр-текста Н — гласная (причем совпадающая с одной из
букв И, Е, А), а пятая по частоте буква шифртекста В — согласная
(и поэтому она, скорее всего Н, так как С и Т уже задействованы).
Обратим также внимание на два частых удвоения: ЕЕ (4
раза) и ВВ (6 раз). Самыми частыми в открытом тексте являются
удвоения ИИ, НН, ОО, СС. Это дает основание полагать,
что В заменяет букву Н открытого текста.
Буква Е — третья по частоте в криптограмме, поэтому
вполне вероятно, что она заменяет одну из букв И, Е или А
открытою текста. Учитывая сделанное замечание об удвоениях,
сделаем предположение о том, что Е заменяет букву И.
Дополним последнюю таблицу новыми предположениями
о заменах (см. табл. 4 на стр. 457).
Обратим внимание на то, что биграмма ВБ встречается в
криптограмме 9 раз. По нашему предположению В заменяет в
криптограмме букву открытого текста Н. Согласно таблице
биграмм открытого текста (см. табл. 11 Приложения 1), самыми
частыми биграммами с первой буквой Н являются НО,
НА, НИ. Буквы О и И уже задействованы, поэтому оправдана
гипотеза о том, что ВБ заменяет биграмму открытого текста
НА.
Мы уже замечали, что Н заменяет одну из букв А, Е, И
открытого текста. С учетом предыдущего остается лишь одна
возможность: Н заменяет букву Е.
Внесем полученные результаты в табл. 5 (см. стр. 458).
Здесь лавинообразно определяются многие другие буквы.
Так, из второй строки легко заметить, что Ш заменяет букву
Д открытого текста, Т — букву Л. Из рассмотрения четвертой
строки следует, что Ь заменяет М, из восьмой строки — что Р
452
Пример
заменяет В, а С — букву К, из восемнадцатой — что Ж заменяет
Р и т. д.
Теперь легко закончить работу, убедившись в том, что
наши гипотезы оправдались (см. табл. 6 на стр. 459).
В рассмотренном примере достаточно точно сработала
статистика. Это объясняется большой длиной сообщения, содержащего
в нашем случае 611 знаков. Нам не понадобились
многие стандартные приемы, применяющиеся при решении
подобных задач для текстов меньшей длины, о которых было
упомянуто в комментариях к алгоритму 1 .
Ключом использованного в примере шифра является следующий
подстановочный алфавит:
А Б В Г д Е ж 3 и К Л м н О п
Б А Р ы ш н я к Е С Т ь в г д
р с т У ф X ц ч ш щ ы ь э ю я
ж 3 и л м о п У ф X ц ч щ э ю
составленный на основе ключевой фразы БАРЫШНЯ
КРЕСТЬЯНКА, совпадающей с названием одноименной повести
А.С. Пушкина. Заметим, что особенности таких (систематически
перемешанных) алфавитов существенно помогают
в восстановлении текстов. Соответствующая технология подробно
изложена в [КаЬ67]. Там же содержится пример вскрытия
простой замены, использующий значительно более тонкие
рассуждения, чем приведенные в нашем примере.
453
/ 1риложение 2
Таблица 1
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25
1
2
Р Г ш В I Е Г К Г И Ш Б Т Н В В Ц О В Ь Ф Р О Ы Л
3
4
А И ж В Е Е В Б О I III Е Г Г 3 ч Е Ь Н В Е Н Р Р Б
5
6
В Б д Н И Ж г Р Е У Б А Н Ж Н 3 И Г Р Б Р ь Г Т Г
7
8
Ш Г 3 И Е 3 р Г Н Р 3 Т Л Я Е т I В Р Ы Р Б ж Ш Е
9
10
Ь Р ц Ф Н т р Г И 3 И Б Р С Л р В Б У Б Т Н ы Г Ш
11
12
Б Л н О Б т р 3 Р г Э Ш Н Ж Н р В Э Е 3 И Н О д Г
13
14
Ж Г в Г И и л III Б в н Р Ц н К я Б Т Г В А Ц 1 я Н
15
16
В ь и В Б А н III В [ Е III Р г ж ю В С Н С Г И Г ж Б
17
18
Ю л ь Н Ж т Б Р Ж г Ш Б О р и г Р ж Н ь Ю С Б с Г
19
20
В в Б О Г ш Е Т 3 ю Р Г и ч н к Я н Ь д Г т Н О Г
21
22
к ю Е 3 И р Н В В п Н Л д ж Б я В н В р Ю 3 С г Ж
23
24
г н Ы г Л и Н Ф Р т Е Г в р Ц 3 И ж Г р Т ш Г ь Д
2^
26
г 3 Г А 3 и Р Н В в Г Ь л д Т Б В л К Б Р н т л 3
27
28
н А Ю 3 л с Г В В л э М Б А Ж Е С л Л И Ж г Е т ш
29
30
г 0 Г ш ц Е 3 И Б т д Г У Ь И Б И ч 3 Н А ю Л ь в
31
32
н Р Ф Е ь У Н Т Г р н с Г ь р I Р 3 н Ь Г с Г т г
33
34
и С Н Р У Н Ь Е В н д ж Н с г 3 Т г р Е Т Е н ь л
35
36
3 г 3 Н ш Е д Ж Е н к я Б р ф Е И с в Н Ь Л ы г 3
37
38
и Е и Ч 3 3 р Г Е ь р 3 Н ь н Е 3 и р Б Ь Е Е 3 г
39
40
А Б с Б ь Е р А Л ш в Е Г в о Г Ш Е т Р д Т Е 3 г
41
42
Р Г Е С л Ж и С н д I д Ж Б к III В Е с Б ь В Б ш н
43
44
Р Б Т 3 н Ж и Л с ь К 3 Л С В Б ш Г ь Б ф В Н Е ж
45
46
Б А Г и ц 3 Б ь к Б Д р 3 Ц р Б т Ж Б 3 О Г Ш ь в
47 Е У Н ы г В Н У Е и Б т с Ж г Ь н 3 Н В Б И 3 с Е
48
49 0 Р Н ш г Ь Г 3 И н Р
454
/ 1ример
Т аб л и ц а 2
А Б В Г ДЕ Ж 3 И К Л М Н О П Р С Т У Ф X Ц ЧШЩы Ь ЭЮЯ I
А 1 I I 1 1 3 1 2 11
Б 4 4 2 1 1 3 1 1 3 5 2 8 1 2 2 4 1 1 46
В 1 9 6 4 6 2 7 1 2 1 2 1 42
Г 2 8 1 6 4 7 7 1 2 1 7 1 3 1 9 6 1 67
д 5 1 4 1 2 13
е 3 2 1 4 1 К) 3 2 4 2 3 3 8 2 1 1 3 1 54
ж 5 1 7 2 2 1 4 1 1 1 25
3 1 4 1 11 2 7 1 3 2 2 1 1 1 37
и 4 1 3 2 3 2 1 2 3 3 3 1 2 1 31
к 2 1 1 1 1 3 9
л 1 2 1 2 2 1 1 1 1 3 2 1 2 1 1 22
м 1 1
н 2 7 2 6 5 2 1 3 1 3 5 3 3 1 1 3 3 7 58
0 1 1 6 1 2 1 12
п 0
р 1 6 2 9 1 2 2 2 1 5 1 1 1 3 1 1 39
с 3 2 7 2 1 3 3 21
т 2 7 1 3 1 2 2 3 3 1 2 1 28
У 2 2 3 7
ф 1 4 1 6
X 0
Ц 3 2 1 1 1 1 9
ч 1 1 1 2
ш 6 2 5 6 2 1 1 23
щ 0
ы 3 1 1 1 6
ь 1 2 3 2 4 1 3 4 1 1 1 23
э 1 1 1 3
ю 1 1 2 2 1 1 8
я 2 1 1 2 6
455
/ 1риложение 2.
Т аб л и ц а 3
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25
1 Р Г ш в Г Е Е К Г И Ш Б Т Н В в Ц О В Б Ф Е О Ы Л
2 О о О т
3 А н ж в Е Е В Б о г ш Е Т Г 3 ч Е Ь Н В Е Н Е Р Б
4 о О С
5 В Б д н И ж Г Р Е У Б А Н ж н 3 И Г Р Б Р Ь Г т Г
6 1 О с Т О О О
7 Ш Г 3 и Е 3 Р Г Н Е 3 Т Л я Е т Г в Р Ы Р Б Ж ш Е
8 О с 1 с О С о
9 Е Р ц Ф Н т Р Г И 3 и Б р с Л р в Б У Б Т Н Ы г Ш
10 О т с т о
11 Б Л н О Б т Р 3 р г э Ш н ж Н р в Э Е 3 И Н О д Г
12 с о С т О
13 Ж г в г И и Л ш Б в н Р ц н К я Б т Г В А Ц Т Я н
14 о о Т т О
15 В Б и в Б А н ш В г Е Ш р г Ж ю В с и с Г И Г ж Б
16 т о о О т О
17 Ю Л ь н Ж т Б р Ж г Ш Б О р и г Р Ж н ь ю с Б с Г
18 о т о О
19 В в Б О Г ш Е т 3 ю Р Г и ч н к Я н ь д г т Н О г
20 О с О т о о
21 К ю Е 3 и р Н в в ц Н Л д ж Б я В н в Е ю 3 С г ж
22 с т с о
23 Г н Ы г л и Н ф Е т Е г в р Ц 3 И ж г Е т ш Г ь д
24 О о г о с т о О
25 г 3 Г А 3 и Р н В в Г ь л д Т Б в л к Б р н т л 3
26 о с О с т О с
27 н А ю 3 л с Г в В л э м Б А Ж Е с л л И ж г Е т ш
28 с О Т о
29 г О г ш ц Е 3 и Б т д г У Е и Б и ч 3 н А ю Л ь в
30 0 О с т о т г с
31 н Е ф Е ь У н т Г р н с г Ь р Г р 3 н ь Г с Г т г
32 О о О с О О о
33 и С н Р У н ь Е в н д ж н С г 3 т г р Е т Е н ь я
34 т о с о
35 3 Г 3 Н щ Е д Ж Е н к я Б Р ф Е н с в Н ь л ы г 3
36 с О с о с
37 и Е и Ч 3 3 р г Е ь Е 3 Н Ь н Е 3 и р Б ь Е Е 3 г
38 т с С о с с г с о
39 А Б с Б ь Е р А Л ш В Е Г В О Г ш Е т Р д Т Е 3 г
40 О О с о
41 р Г ь С л ж и С Н д Г д ж Б к ш в Е с Б ь В Б ш н
42 О т О
43 р Б т 3 н Ж и л С Е к 3 л С в Б ш Г ь Б ф В Н Е ж
44 С т с О
45 Б А г и ц 3 Б ь К Б д Е 3 Ц р Б т ж Б 3 О Г Ш Е в
46 о т С с С О
47 Е У н ы г в н У Е и Б Т с Ж г Ь н 3 н В Б и 3 с Е
48 о т о с т С
49 О Р н ш г ь г 3 И н Е
50 о о с т
456
Пример
Т аб л и ц а 4
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25
1 Р Г ш В 1 Е Е К Г И Ш Б Т Н В в ц о В Б Ф Е о Ы л
2 о я О я Я О т Я я Я Я
3 А н ж в Е р В Б О г Ш Е Т Г 3 ч ь ь н В Р н Е Р Б
4 я Я я я о Я О с Я Я Я Я
5 В Б л н И ж г Р Е У Б А Н ж н 3 и г р Б Р ь г Т Г
6 я т О Я с т о я О
7 ш Г 3 и Е 3 р Г н Е 3 Т Л я ь т г в р Ы Р Б ж Ш Е
8 0 с 7 Я с О Я С я О я Я
9 Е р ц Ф н т р г и 3 и Б р с л р в Б У Б т Н ы Г ш
10 И О т с г я О
11 Б л н 0 Б т р 3 р г э Ш н ж н р в э Е 3 и Н о д г
12 с О я Я С г я
13 Ж г в г И и л ш Б в н Р ц н к я Б т г В А Ц т я н
14 о я о Г г я о я
15 В Б и в Б А н ш В г Е Ш р г ж ю В с н с Г И г ж Б
16 я т я Я о Я о я о Г о
17 ю Л ь н Ж т Б р ж г ш Б о р и г р ж н ь ю с Б с Г
18 О т о О
19 в в Б о Г ш Е т 3 ю р Г и ч н к я н ь д г т Н о г
20 я я о Я с О т о о
21 к ю Е 3 и р н В в ц н Л д ж Б я в н в Е ю 3 С г ж
"221 Я с г я я я я Я с о
23 г н ы г л и н ф Е т Е г в р ц 3 и ж г Е т ш г ь д
24 о о г Я Я о я с г о Я о
25 г 3 г А 3 и р н в в г ь л д т Б в л к Б р н т л 3
26 о с о с т я я о я с
27 н А ю 3 л с г В в л э м Б А ж Е с л л И ж г Е т ш
28 с о я я я Г О Я
29 г 0 г ш ц Е 3 и Б т д г У Е и Б и ч 3 н А ю л ь в
30 о о я с т о Я т г с я
31 н Е ф Е ь У н т Г р н с г ь р Г р 3 н ь Г с г т г
32 Я Я О о О с О о о
33 и С н Р У н ь Е в н д ж н с г 3 т г р Е т Е н ь л
34 т я я о с О Я я
35 3 г 3 н ш Е д ж Е н к я Б р ф Е н с в н ь л ы г 3
36 с о с Я Я Я о с
37 и Е и ч 3 3 р г Е ь Е 3 Н ь н Е 3 и р Б ь Е Е 3 г
38 т Я т с с о Я Я с Я с т Я Я с о
39 А Б с Б ь Е р А Л ш в Е Г в О Г ш Е т Р д т Е 3 г
40 Я я я О я О я Я с о
41 р Г Е С л ж и с н д г д ж Б к ш в Е с Б ь в Б ш н
42 О я т о я я я
43 р Б т 3 н ж и л с Е к 3 л С в Б ш г ь Б ф в Н Е ж
44 С т я с я О я я
45 Б А г и ц 3 Б ь к Б д Е 3 Ц р Б т ж Б 3 О г Ш Е в
46 о т с Я с С о Я я
47 Е У н ы г в н У Е и Б т с Ж г Ь н 3 н В Б и 3 с Е
48 Я о я Я т о с я г С я
49 0 Р н ш г ь г 3 и н Е
50 О О с г Я
457
I1риложение 2
Т аб л и ц а 5
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25
1 Р Г ш В Г Е Е К Г и Ш Б Т Н В В Ц О В Б Ф Е О Ы Л
2 Я Я Я я Я Я т Л Е Я Я Я Л Я
3 А н ж В Е Е в Б 0 г Ш Е Т Г 3 ч Е Ь н В Е н Е Р Б
4 Е я Я Я я А я Я Я с Я Е я Я Е Я Л
5 В Б д н И ж г Р Е У Б А Н ж н 3 И Г Р Б Р Ь Е т Г
6 я А Е т я Я А Е Е с г Я Л Я я
7 ш Г 3 И Е 3 р Г н Е 3 Т Л я Е т Е в Р ы Р Б Ж ш Е
8 Я с т И с Я Е Я С Я Я я Л Я
9 Е р ц ф н т р г И 3 и Ь Р с Л р в Б У Б т н ы г ш
10 Я Е я г с г Л я Л Л Е я
11 Б л н 0 Б т р 3 р Е э III н ж н р в э Е 3 и Н О Д г
12 Л Е А с Я Е Е я Я с г Е я
13 Ж г В г И и л ш Б в н Р и н К я Б т Г в А Ц т Я н
14 я я я т г А я Е Е Л я я Е
15 В Б и в Б А н ш в г Е 111 р Г ж ю в с н с Г И Е ж Б
16 я А т я А Е Я я И я я Е я т Я Л
17 ю Л ь н Ж Т Б р ж г ш Б о р и г р ж н ь ю с Б с Г
18 Е А я Л т я Е Л я
19 в В Б 0 Г ш Е т 3 ю р Е и ч н к я н Ь д Е т н О Е
20 я я А Я Я с Я т Е Е Я Е Я
21 к ю Е 3 и р н В в ц н Л д ж Б я в н В Е ю 3 С г ж
22 Я с т Е я я Е Л я Е я Я с я
23 г н Ь1 г л и Н ф Е т Е 1 в р ц 3 и Ж Е Е т ш Е ь д
24 я Е я г Е Я Я Я я я г Я Я Я
25 г 3 г А 3 и Р н в в Г ь л д т Б в Л к Б р н т А 3
26 я с я с г Е я я я л я Л Е с
27 н А ю 3 л с Г в в л э м Б А ж Е с л л И ж Е Е Т ш
28 Е с Я я я Л Я т Я Я
29 г 0 г ш ц Е 3 и Б т д г У Е и Б и ч 3 н А ю Л Ь в
30 я Я Я с г Л я Я т Л г с Е я
31 н Е ф Е ь У н т г р н с г ь р Е р 3 н ь Е с Е Т Е
32 Е И Я Е я Е я Я с Е Я Я Я
33 И С н р У н ь Е в н д ж н с г 3 т г Р Е т Е н ь л
34 т Е Е Я я Е Е я с о Я Я Е
35 3 г 3 н ш Е д ж Е н к я Б р ф Е н с В н ь л Ы г 3
36 с я с Е Я Я Е Л Я Е я Е я с
37 и Е и ч 3 3 р г Е ь Е 3 н ь н Е 3 и р Б ъ Е Е 3 г
38 т Я т с с я Я Я с Е Е Я с т Л Я Я с я
39 А Б с Б ь Е р А Л ш в Е Г в О Г ш Е т Р д т Е 3 г
40 А А Я я Я Я я я Я Я с я
41 Р Г Е С л ж и С н д Е д ж Б к ш в Е с Б ь в Б ш н
42 Я Я г я Я Л я Я Л я Л Е
43 Р Б т 3 н ж и Л с Е к 3 л с в Б ш Г ь Б ф в н Е Ж
44 А С Е т Я с я Л я Л я Е Я
45 Б А г и ц 3 Б ь к Б д Е 3 ц р Б т ж Б 3 О Е Ш Е в
46 А я г с А А Я с Л Л с Я Я я
47 Е У н ы г в Н У Е И Б т с ж г ь н 3 н в Б и 3 С Е
48 Я Е Я я Е Я Г А я Е с Е я Л т с Я
49 0 Р н ш г ь Г 3 и н Е
50 Е я Я с г Е Я
458
/ 1ример
Т аб л и ц а 6
{... 1 2 3 4 5 6 <7 8 9 10 11 1! н |\ 14 15 16 г 13 1 20 0 1 72 ^3 24 125
1 Р 1 III В Г Е Е ь Г И ШI т 1 и В в р о в Б ф О Ы Л
*> Я О Л Н Я Я Я 3 О т д Л 3 А Я я ь / V я л ш И \ Г д
3 А н Ж В с ь в Б О г ш ь 1 Г 3 ч Е р н в г н р р Б
4 К Е р и и я я Л \ О д Я л О 7 ь Я V/ р я я А я я 4
5 В Б д н и ж г Р р \ г А н ж Н 3 И г р Б р ь г т г
6 я Л п Е т р о Я я ч л Я ь р Р с г О я л я м я л Я
7 ш Г 3 И ь 3 р г н и 3 т 1 я I т г в р ы р Б ж III Е
8 п Я с т я с в о а Я с 7 У ж Я л я я я г я л р д И
9 е р ц ф н т р I и 3 и Б р с Л р в ь У ь I н ы I III
10 я в ы ш Е л в О т с г Л я А У я я л */ л Л А р Я Д
11 Б л н О Б т р 3 р г л ш н Ж II р в э р 3 И н о д Г
12. А У Е А А л в с я я /я д р р Р я я я; И с / А V я я
13 ж г в Г И и л ш Б в н р ц н К я Б т г в А Ц 1 я н
14 р я н я т т У и Л я Е я ы а; 3 ж Л 7 я я ь А/ л ж I А
15 в Б и в Б А н ш в г Е ш р г ж ю в с н с г И Г ж 1 Б
16 и А т н А я Е л я я Я д я я р я я к р р я 7 я р Л
17 ю Л ь н Ж т Б р ж г ш Б о р И г р ж н ь ю С Б с Г
18 я У м Е Р л А я р я л Л V я т я я р р м я Р Л к я
19 в в Б О Г ш Ь т 3 ю р г и и н к я н ь д г т н О г
20 я я А V я л Я л с я я я г Ь р 3 ж р д/ я я л р А я
21 к ю Е 3 и р н в в ц н л д Ж Б я в н в ь ю 3 с Г ж
22 3 я И С г я Е я я ы А д я р Л ж я А я я я с к я р
23 г н ы г л и II ф Е 1 Е г в р ц 3 И ж г Е т ш I ь д
24 Я Е / я У т Я ш Я л Я я я я ы с г р я я л д Я д/ я
2'* г 3 г А 3 и Р н в в Г ь л д т Б в л к Б р н т л 3
26 я с я Б с г Я Е я я я д/ У я л л я д 3 л я р л У с
27 н А ю 3 л с Г в в л э м Б А ж Е с л л И ж г Е т ш
28 Р Б я С У к я я я д /я ф л Я р Я А* У У т р я Я 7 д
29 г О г ш ц Е 3 и Б т д г У Е И Б И ч 3 н А ю л ь в
30 я V я д ы я с г Л л я я я Я г Л г ь с р р я У д/ я
31 н Е ф Е ь У II т г р н с г ь р Г р 3 н ь г с г т г
32 Е И ш И м V Е л я я я к я я я я я с р д/ я А я л я
33 И С н р У н Ь Е в н д ж н с г 3 г г р Е т Е н ь л
34 т к Е в ч Р д/ Я я а я р Е А я с л я я я л Я р д/ У
3^ 3 г 3 н III Е д ж Е II к я Б Р ф Е н с в н ь л ы г 3
36 с я с Е д Я я р Я Е 3 ж Л Я ш И р к я р д/ У г я с
37 и Е и ч 3 3 р г Е Ь Е 3 н ь н Е 3 И р Б ь Е Е 3 г
38 т И т ь г с я я Я м я с Е д/ Е Я т: 7 я л я Я Я с я
39 А Б с Б ь Е р А п ш в р Г в О Г ш р т р д т Е 3 г
40 Б А к А м Я я Я У Д я я Я я X я д А/ л я я л Я г я
41 Р Г Е С л ж и с н д г д ж Б к ш в Е с Б ь в Б ш н
42 В Я И К д р т к я я я я р Л 3 д я я к л д/ я Л д р
43 Р Б т 3 н ж и п с Е к 3 л с в Б ш г ь Б ф в н Е ж
44 В А л с Е р 7 д А Я 3 7 У Р я Л д я ч Л ш я А я р
45 Б А г и ц 3 Б ь К Б д Е 3 ц р Б т ж Б 3 О г Ш р в
46 Л Б Я т ы с Л V/ 3 4 я я с А/ я Л л р л с а: я д я я
47 Е У н ы г в н У Е И Б г с Ж г ь И 3 н в Б И 3 с Е
48 Я ч Е г я я Е ч Я Г л л к Р я я р г р я 4 7 т: к я
49
50
О
X
р
в
нЕ
ш
д
гя
ь
д/
Г
я
3
с
и
т
н
а
Е
Я
459
Приложение 3
Элементы алгебры и теории чисел
Модулярная арифметика
Пусть а и п — натуральные числа. “Разделить число а на
число п с остатком” — это значит найти целые числа а и г,
удовлетворяющие условию
а = # • я + /% где 0 <г <п.
При этом число ^ называют неполным частным, а г - остатком
от деления числа а на число п.
Если остаток г равен нулю, то говорят, что число п делит
число а, или, по-другому, п является делителем числа а,
Целые числа а и Ь называют сравнимыми по модулю п,
если их остатки при делении на п совпадают. Обычно для
обозначения этого факта используется запись
а = Ь (той п) .
Отсюда, в частности, следует, что число п делит разность чисел
а и Ь. Для обозначения остатка часто используют бесскобочную
запись
Ъ = а той п .
Операцию нахождения числа Ъ = а той п называют приведением
числа а по модулю п.
Множество целых чисел а 09...,ай_19 таких, что для любого
целого числа Ь найдется к е {0,...,#-1} со свойством
ак = Ь(той п), называется полной системой вычетов по мо460
Цементы алгебры и теории чисел
дулю п. Обычно используется полная система вычетов
{0, 1,... , п - \ } .
Разложение чисел на простые множители
Натуральное число а, большее 1, называется простым,
если оно не имеет натуральных делителей, отличных от 1 и
самого числа а.
Любое натуральное число, отличное от 1, либо является
простым, либо может быть представлено в виде произведения
простых чисел. Это представление определено однозначно с
точностью до порядка сомножителей в произведении.
Следует отметить, что в настоящее время нет достаточно
эффективных алгоритмов разложения произвольного целого
числа на простые множители даже в случае, когда известно,
что оно разлагается в произведение двух простых чисел. Отсутствие
эффективных алгоритмов с доказуемыми оценками
сложности позволяет использовать задачу разложения натуральных
чисел на простые множители при обосновании стойкости
некоторых криптографических алгоритмов.
Алгоритм Евклида нахождения наибольшего общего
делителя
Наибольшее целое число, делящее одновременно целые
числа а и Ъ, называется их наибольшим делителем и обозначается
НОД(а, Ь) или просто (<а, Ь). Если (а, Ь)= 1, то а и Ь называются
взаимно простыми числами.
Алгоритм Евклида нахождения наибольшего общего делителя
двух целых чисел заключается в проведении следующей
последовательности операций деления с остатком:
а = ^ . Ъ + г, где 0 < г < Ь ,
Ъ = Я \ 'Г + Г\, г д еО < Г |< г ,
г = <?2 •г 1+ г2 > где 0 < г2 < ^ ,
г\ =Чъ' г2 +гЪ’ гДе Ой г 3 <г2,
461
Приложение з
гк = Як+2 • гк+\ + гк+2> где 0 < гк+2 < гк+1.
Г\ ~ Яз * Г2 + ’ ГДе 0 < г3 < г2.
Корректное завершение алгоритма гарантируется тем, что
остатки от делений образуют строго убывающую последовательность
натуральных чисел. Из приведенных равенств следует,
что
(а, Ь) = (Ъ, г) = (г, г, ) = ... = (гя_, ,гп) = гп .
Поэтому наибольший делитель чисел а и Ь совпадает с гп.
Как следствие из алгоритма Евклида, можно получить
утверждение, что наибольший делитель целых чисел а и Ь
может быть представлен в виде линейной комбинации этих
чисел, т. е. существуют целые числа и и V такие, что справедливо
равенство
а • и + Ь • V = гп .
Вычисление обратного элемента по заданному модулю
Если целые числа а и п взаимно просты, то существует
число а \ удовлетворяющее сравнению а -а' = 1(тос1 п) . Число
а' называют обратным к а по модулю п и используют обозначение
а ' ] (т о й п) . Вычислить а' можно, например, воспользовавшись
представлением наибольшего общего делителя
чисел а и п в виде их линейной комбинации:
а • и 4- Ъ • п = 1. Взяв наименьшие неотрицательные вычеты
обеих частей этого равенства по модулю п, получим, что искомое
значение а* удовлетворяет сравнению а' = и (т о й п).
462
Цементы алгебры и теории чисел
Вычисление обратных величин по некоторому модулю
может быть выполнено более просто, если использовать некоторые
факты из теории чисел.
Функцией Эйлера называется функция (р(п\ определенная
на множестве натуральных чисел и равная количеству целых
чисел в промежутке [1, п\9 взаимно простых с п.
Если известно, что п - р к{ *...• р к‘ , где р {,...,р 1 — различные
простые числа, то формула вычисления функции Эйлера
имеет вид
7=1
Справедлива малая теорема Ферма: если п — простое
число и НОД(а, п) = 1, то
а п~~х = 1 ( т о ё п) .
Обобщение малой теоремы Ферма, полученное Эйлером,
утверждает: если НОД(а, п) = 1, то
а п~х 5= 1 ( т о ё п) .
С учетом приведенных фактов получаем, что наиболее
просто значение а~х ( т о ё п) находится из соотношения
а~х = ( т о ё п) .
Китайская теорема об остатках
Любое целое неотрицательное число, не превосходящее
произведения натуральных чисел т р т 2, .. ., т , , можно однозначно
восстановить, если известны его вычеты по этим модулям.
Этот результат, полученной в I веке китайским мате463
I 1риложение 3
матиком Сун Це, носит название китайской теоремы об остатках.
Математическая формулировка этого результата такова:
Теорема. Пусть — попарно взаимно простые
числа. Тогда для любых целых чисел ах,а2,...,а( сравнения
х = а { (т о й тх) ,
х = а( (т о й т()
имеют в интервале [0,А/-1], М = тх -т2 единственное
общее решение вида
х = • N ] • М ^ ( т о ё М ),
М, = а
т]
Алгебраические структуры
Множество элементов С с заданной на нем бинарной
операцией называется группой, если выполнены три условия:
1) операция ” ассоциативна, то есть (а • Ь) • с = а - (Ь • с) ,
2) существует элемент е из С, такой, что для любого § из
С выполняются равенства е • § = § * е = § ,
3) для любого # из (7 существует элемент ^ из С со
свойством # • я ' = # = е .
Обычно используется обозначение (Су).
Элемент е из С называют нейтральным элементом группы,
а элемент — обратным элементом к Для обратного
элемента обычно используется обозначение ё'= %-1. Следует
464
Элементы алгебры и теории чисел
отметить, что в группе О нейтральный элемент и элемент, обратный
к элементу определены однозначно.
С точки зрения решения уравнений основное свойство
группы состоит в том, что в ней однозначно разрешимы уравнения
вида
а • х = Ъ,
У’С1- Ь
при любых а .Ь е С .
Заметим, что если при всех а, Ь и с эти уравнения однозначно
разрешимы относительно х и у, то (С, •) называется
квазигруппой. Для квазигруппы не обязательно выполняются
условия 1)—3) из определения группы. Вместе с тем ассоциативная
квазигруппа всегда является группой.
Операция называется коммутативной, если для любых
двух элементов а и Ь из С выполнено равенство а • Ъ = Ъ - а.
В этом случае группа О называется коммутативной или абелевой.
Примером группы является множество комплексных корней
степени п из 1 с операцией умножения корней как комплексных
чисел.
Множество К с двумя бинарными ассоциативными операциями
сложения “+” и умножения называется кольцом,
если выполнены следующие условия:
— множество К с бинарной операцией сложения является
абелевой группой,
— операция удовлетворяет условию дистрибутивности
относительно операции т. е. {а + Ь) • с - а • с 4- Ъ • с и
а-(Ь + с) = а-Ъ + а- с.
Если операция коммутативна, то кольцо называется
коммутативным.
Примером кольца является множество 2„, образующее
полную систему вычетов целых чисел по модулю п с операциями
сложения и умножения по модулю п, причем это кольцо
является коммутативным.
465
I филожение 3
Нейтральный элемент кольца относительно операции “+”
называют нулем кольца и обозначают через 0. При умножении
на 0 любого элемента кольца будет получаться 0.
Можно отдельно рассмотреть множество всех ненулевых
элементов кольца с операцией умножения Для этого
множества можно ввести понятия нейтрального и обратного
элементов относительно операции умножения Нейтральный
элемент кольца относительно операции называют
единицей кольца и обозначают через 1 .
Единица существует не в любом кольце. Например, в
кольце четных целых чисел единица отсутствует. Если в
кольце существует единица, то в общем случае обратные элементы
определены не для всех элементов кольца.
Полем называется коммутативное кольцо с единицей, отличной
от нуля, в котором любой ненулевой элемент обратим.
Кольцо вычетов целых чисел по модулю п является полем
в том и только в том случае, когда п — простое число. Другими
примерами полей являются хорошо известные множества
рациональных, действительных и комплексных чисел с обычными
операциями сложения и умножения.
Группы подстановок
Подстановкой непустого множества М называют любое
биективное (взаимно однозначное) отображение множества М
в себя. Множество всех подстановок на множестве М обозначают
через 8(М).
Множество 8(М) относительно операции суперпозиции
отображений образует группу. Если М — конечное множество
мощности и, то говорят, что 8(М) — симметрическая
группа подстановок степени п.
Группа 8(М) является коммутативной только в случае
п< 2.
Заметим, что, перенумеровав элементы множества М некоторым
фиксированным образом: М= { х }9х 29...,хп } и ото-
466
Элементы алгеЬры и теории чисел
ждествив элементы х, с их номерами /, вместо группы 8(М)
можно рассматривать группу 8(0), где О = { 1 , 2 Обычно
группу 8(0 ) обозначают через 8„.
Любая подгруппа О группы 8„ (подмножество группы 8„,
которое само является группой) называется группой подстановок
степени п.
Конечные поля
Число элементов конечного поля равно р для некоторого
простого числа р и натурального числа I. Обычно поле из р 1
элементов обозначается ОР{р1). Пусть ц ~ р 1.
Сформулируем основные свойства конечных полей.
1. Все элементы поля ОР(д) являются корнями многочлена
х ч - X .
2. Любой многочлен / (х) степени т. неприводимый над по-
т
лем СР(д\ является делителем многочлена х ч - х . (В
частности, все корни многочлена Дх) содержатся в поле
СР{дт\ то есть оно является полем разложения этого
многочлена.)
>11 1 3. Любой делитель многочлена х ч - 1 , неприводимый над
полем ОР(д), имеет степень, делящую значение т.
4. В поле ОР(д) существует примитивный элемент а такой,
что все ненулевые элементы поля представляются в виде
его степеней, то есть мультипликативная группа конечного
поля является циклической.
В прикладных целях обычно используются задания конечных
полей в виде кольца вычетов целых чисел по простому
модулю р (поле ОР{р)) либо в виде фактор-кольца кольца
многочленов над полем ОР(р) по модулю неприводимого
многочлена (поля СР(р% 1> 1).
В последнем случае для задания поля ОР{р1) рассматриваются
многочлены над полем СР(р). Для них вводится поня-
467
I фипожение 3
тие деления с остатком: разделить многочлен а{х) на многочлен
Ь(х) степени 5 — это значит представить многочлен а{х)
в виде
а(х) = д(х) • Ь(х) + г(х%
где степень многочлена г(х) строго меньше 8.
По аналогии с целыми числами вводятся понятия вычета
по модулю многочлена Ь(х), сравнимости многочленов и
операции сложения и умножения по модулю многочлена.
Роль полной системы вычетов по модулю многочлена
р(х) выполняет множество всех возможных остатков от деления
многочленов над полем СР(р) на р(х). Другими словами,
полную систему вычетов по модулю многочлена р(х) степени
я образует множество многочленов
{г(х) = г0 +г,х + ... + г5_1л;'~| , г0, . е О Р ( р ) } .
Множество вычетов по модулю фиксированного многочлена
р(х) степени 8 с операциями сложения и умножения образует
коммутативное кольцо. Это кольцо является полем в
том и только в том случае, когда многочлен р(х) неприводим
(т.е. не раскладывается над ОР{р) в произведение многочленов
меньших степеней).
Наличие в конечном поле примитивного элемента а позволяет
ввести понятие логарифма для ненулевых элементов
этого поля. Логарифм элемента (3 по основанию а определяется
как наименьшее целое неотрицательное число к, удовлетворяющее
равенству (3 = о/*. В настоящее время задача вычисления
логарифма в конечном поле в общем случае не имеет
достаточно эффективных алгоритмов решения и по этой
причине, наряду с задачей разложения на множители, используется
при построении стойких криптографических алгоритмов
и протоколов.
468
Литература
[Ано97]
[Арш83]
[Баб97]
[Бер92]
[Бил69]
[Бол86]
[Бра99]
[Вар95]
[ВарОО]
[Вар96]
[Г ай94]
Анохин М. И., Варновский Н. П., Сиделышков
B. М, Ященко В. В. Криптография в банковском
деле. —М.: Изд-во МИФИ, 1997.
Аршинов М. Н., Садовский Л. Е. Коды и математика.
— М.: Наука, 1983.
Бабаш А. В., Глухов М. М, Шанкин Г. П. О преобразованиях
множества слов в конечном алфавите,
не размножающих искажений // Дискретная
математика. — 1997. — Т. 9. — № 3.
Березин Б. Я, Дорошкевич П. В. Цифровая подпись
на основе традиционной криптографии //
Защита информации.— 1992.— Вып. 2 .—
C. 148—167.
Биллингслей П. Эргодическая теория и информация.
— М.: Мир, 1969.
Болл У., Коксетер Г. Математические эссе и
развлечения (криптография и криптографический
анализ). — М.: Мир, 1986.
Брассар Ж. Современная криптология. — М.:
Полимед, 1999.
Варфоломеев А. А., Пеленицын М. Б. Методы
криптографии и их применение в банковских
технологиях. — М.: Изд-во МИФИ, 1995.
Варфоломеев А. А., Жуков А. Е , Пудовкина М. А.
Поточные криптосистемы. Основные свойства и
методы анализа стойкости. — М.: Изд-во
МИФИ, 2000.
Варфоломеев А. А. , Домнина О. С., Пеленицын
М. Б. Управление ключами в системах
криптографической защиты банковской информации.
— М.: Изд-во МИФИ, 1996.
Гайкович В., Першин А. Безопасность электронных
банковских систем.— М.: Единая Европа,
1994.
469
Литература
[Глу99]
[Глу98]
[Гне88]
[Диф79]
[Жел96]
[Каб88]
[Кну99]
[Кон87]
[Кос87]
[Кра75]
[Куз98]
[Лид88]
[Маф93]
[Мэс88]
Глухов М. М Инъективные отображения слов,
не размножающие искажений типа пропуск
букв // Дискретная математика.— 1999.—
Т. 2.— №2.
Глухов М. М Инъективные отображения слов,
не размножающие искажений // Математические
вопросы кибернегики. — 1998. — Т. 7.
Гнеденко Б. В. Курс теории вероятностей. — М.:
Наука, 1988.
Диффи У., Хеллман М. Э. Защищенность и имитостойкость.
Введение в криптографию //
ТИИЭР. — 1979. — Т. 67. — № 3.
Жельников В. Криптография от папируса до
компьютера. — М.: АВР, 1996.
Кабатянский Г. А. Математика разделения секрета
// Математическое просвещение. —
1998. — Сер. 3. — Вып. 2. — С. 115—126.
Кнут Д, Искусство программирования. Т. 2. По-
лучисленные алгоритмы. Третье издание. — М.:
МЦНМО, 1999.
Конхейм А. Г. Основы криптографии. — М.: Радио
и связь, 1987.
Сборник задач по алгебре / Под ред. А. И. Ко-
стрикина — М.: Наука, 1987.
Крешер Г. Математические методы статистики.
— М.: Мир, 1975.
Кузъминов Т. В. Криптографические методы защиты
информации. — Новосибирск: Наука,
1998.
Лидл Р., Нидеррайтер Г. Конечные поля.
Т. 1,2.— М.: Мир, 1988.
Мафтик С. Механизмы защиты в сетях ЭВМ. — М.:
Мир, 1993.
Мэсси Дж. Л. Современная криптология: введение
// ТИИЭР. — 1988. — Т. 76. — № 5.
470
Литература
[Неч99]
[Пербб]
[ПетОО]
[Пит64]
[Ром99]
[РосОО]
[Рос01]
[Сал96]
[Сим88]
[Соб94]
[Сто01]
[Хол70]
[Хоф80]
[ШенбЗ]
Нечаев В. И. Элементы криптографии. Основы
теории защиты информации.— М.: Высшая
школа, 1999.
Перельман Я. И. Занимательная астрономия. —
М.: Наука, 1966.
Петров А. А. Компьютерная безопасность.
Криптографические методы защиты.— М.:
ДМК, 2000.
Питерсон У. Коды, исправляющие ошибки. —
М.: Мир, 1964.
Романец Ю. В., Тимофеев 77. А., Шанъгин В. Ф.
Защита информации в компьютерных системах
и сетях. — М.: Радио и связь, 1999.
Ростовцев А. Алгебраические основы криптографии.
— СПб.: Мир и семья. — Интерлайн,
2000.
Ростовцев А., Маховейко Е. Введение в криптографию
с открытым ключом. — СПб.: Мир и
семья — Интерлайн, 2001.
Саломаа А. Криптография с открытым ключом.
— М.: Мир, 1996.
Симмонс Г. Дж. Обзор методов аутентификации
информации // ТИИЭР.— 1988.— Т. 76.—
№5.
Соболева Т. А. Тайнопись в истории России. История
криптографической службы России
ХУШ — начала XX в. — М.: Международные
отношения, 1994.
Столлингс В. Криптография и защита сетей.
Принципы и практика. — М.: Изд. Дом "‘Вильямс”
2-е изд., 2001.
Холл М. Комбинаторика. — М.: Мир, 1970.
Хоффман Л. Современные методы защиты информации.
— М.: Радио и связь, 1980.
Шеннон К. Теория связи в секретных системах //
В кн.: Работы по теории информации и кибернетике.
— М.: ИЛ, 1963.
471
Литература
[Ягл73]
[Яще98]
[Вес97]
[Век82]
[В!Ь92]
[Ваи39]
[В1о83]
[Вгт90]
[Виг90]
[Са178]
[Сат90]
Р1Р76]
Руе95]
472
Яглом А. М., Яглом И. М. Вероятность и
информация. — М.: Наука, 1973.
Введение в криптографию / Под ред.
В. В. Ященко — М.: МЦНМО — ЧеРо, 1998.
Веске( В. 1п1годис0оп ю сгур!о1о§у апс1 РС зеси-
п1у. — МсОго\у-НП1, Ьопбоп, 1997.
Векег Н., Прег Р. СИрег зузЗетз. ТЬе Рго1ес0оп о Г
Соттишсабопз. — Ы о г1Н \у о о с1 Воокз, Ьопбоп,
1982.
ВИгат Е„ Вкатгг А. ОИТегепПа1 сгур1апа1уз1з оГ 1Ье
Ги11 16-гоипс1 БЕЗ // Ас1у. ш Сгур1о1о§у —
СКУРТО’92 РгосееШп§з, 1992. — 8рг.-Уег1., 1992.
ВаиАоит С. Ё1ётеп!з (1е сгур1о§гарЫе / Ё<1 Ре-
<1опе А. — Рапз, 1939.
В1от К. ЫоприЬНс кеу сНзЗпЪиОоп // Абуапсез т
Сгур1о1о§у. — Ргосее<Ип§з оР Е1ЛЮСКУРТ'82.
Р1епиш. Ие\у Уогк. — 1983.— Р. 231 — 236.
Вигте$1ег М., ОеатесР У, А зесиге апб еГПаегД
соп1ёгепсе кеу «ИзОтЬиЕоп зузЗет // Ас1уапсез 1п
Сгур1о1о§у — Е11ЯОСКУРТ '89. ЬТЧС8 434.—
1990, — Р. 122—133.
Виггош М., АЪасИ М., МееАкат К. А Ёо§ю оГ аи-
ШепОсаНоп. — АСМ Тгапз. оп Сотр. 8узгетз. —
1990. — V. 8, п. 1, р. 18 — 36.
СаЫаз N. Р. Ап аррПсаРоп о Г сотриЮгз т сгур-
1о§гарЬу // Сгур1о1о§1а, ОсЮЬег 1978.
СатрЬеИ К. IV., Шепег М. У. ОЕ8 18 по! а §гоир //
Ас1у. 1п Сгур1о1о§у-СКУРТО’90. ЬЫС8 740,
1990.
IV., НеПтап М. Е. 1Че\у сИгесПопз т сгур-
1о§гарЬу И ШЕЕ Тгапз. оп 1пГ. ТНеогу. — 1976. —
1Т-22.
Оуег М., Регтег Т., Рпеге А., Ткотазоп А. Оп кеу
з1ога§е т зесиге пе1\УОгкз // 3. Сгур*о1о§у.—
1995. — п. 8. — Р. 189 — 200.
Литература
[ЕЮ85]
[Ре188]
[Рп20]
[Рп85]
[Сш40]
[Оо188]
[Сос190]
[Оо197]
[Рак95]
[КаЬ67]
[Киг95]
[Ма186]
Е1 Сата1 Т. А риЬПс-кеу сгур1озуз1ет ап с) а зк;-
паШге зсНете Ьазес! оп Шзсгею [о^агкЬтз // 1ЕЕЕ
Тгапз. 1пР. ТНеогу. — 1985. — 1Т-31. — № 4.
Реще V., Р'иН А., Зкатгг А. 2его-кпо\у1ес1§е
ргооРз оР к)епшу // 3. Сгур1о1о§у.— 1988.—
п. 1, — Р. 77 — 94.
Рпедтап IV. Р. ТНе тс)ех оР сотсШепсе апс) Из
аррПсаОопз т сгур1апа1уз1з. — Аецеап Рагк Ргезз,
Ьа§ипа НШз С А, 1920.
РпеАтап \У. Р., СаШтакоз Б. МПкагу сгургапа-
1уз15. РаП I. Уо1. 2. — Ае§еап Рагк Ргезз, Ьа§ипа
НШз СА, 1985.
Сатез Н. Р. Е1етеп1агу сгур1апа1уз13 (А з1ис)у оР
С1рЬегз апс! Гкек зо1и0оп). — СНартап апс) На11,
Ыткес!, копкоп, 1940.
СоПтапп Б., СкатЬегз IV. С. Ьоск-т еРРес! т
сазсакез оР с1оск сопкоПес) зЫй ге§1зРегз // Еес1.
Ыо1ез 1п СотриРегз 8<пепсе, V. 30, 1998.
Сос11ем>зку Р. Кеу-ттппа! сгур1озуз1етз Рог ип-
сопс)Шопа1 зесгесу // Р. Сгур1:о1о§у. — 1990. —
№3.
Соке А. Сгур1апа1уз15 оР а11е§ес1 А5 зкеат арЬег
// РгосеесНп§з оР Е11КОСРУРТ’97. ЬЫС8 1233,
8рпп§ег-Уег1а§, 1997.
АакоЬзеп Т. А Раз! теШоО Рог сгур1апа1уз1з оР
зиЬзШиОоп аркегз // Р. Сгур(о1о§1а.— 1995.—
№3.
Какп Б. ТЬе сойеЪгеакегз. ТНе з!огу оР зесге! \угк-
т§. — МастШап, МУ., 1967.
КигактУ.Ь., КигттА.8., М1кка1ех А. V., Ме-
скаеуА. А. Ыпеаг Яеситп§ Зециепсез оуег Кт§з
ап<Р Мос1и1е$. I. оР МаШ. 8с1епсе. СоШетрогагу
МаРк. апс! к'з Арр1. ТкетаОс зигуеуз, уо1. 10,
1994,1. оРМаРк. 8с1епсе$, уо1. 76, № 6, 1995.
Ма1зито1о Т., Таказкта V., 1тш Н. Оп зеект§
зтагР риЬИс-кеу-скзРпЪиРюп зузРетз // Тгапз. оР
Рке 1ЕСЕ оРРарап. — 1986. — Е69,—Р. 99— 106.
473
Литература
[Меп97]
[Мег81]
[Ыее78]
[0(\у87]
[Рге91]
[Шу78]
[Рие87]
[8пп43]
[8сН96]
[8На79]
[811951
[Уег26]
474
Мепегез А У, \'ст Оогзско1 Р С , Уапз1опе 8 А
Напс1Ьоок о!' аррМес! сгурЮцгарЬу. — С КС Ргезз,
Воса КаЮп, N644 Уогк, 1.опс1оп. Токуо, 1997.
Мегк1е К С , Не11тап М Е Оп (Не зесиШу о Г
тиН1р1е епсгурНоп // СоттишсаНопз о!- (Не
АСМ — 1981. — Уо1. 24.
МеесИшт К М , 8скгое<Аег М О Е)зт§ епсгурНоп
Гог аи(Неп(юа(юп т 1аг«е пе(л\огкз о Г сотри(егз //
СоттитсаНопз оГ 1Не АСМ.— 1978.— Уо1.
21, — Р. 993 — 999.
0(м>ау О , Кеез О ЕШс1еп1 апс! Ите1у ти(иа1 аи-
(НепНсаНоп // Орега(т§ 8уз1етз Кеу1е\у. —
1987. — Уо1. 21. — Р. 8— 10.
Ргепее1 В , ОоуаеПз Р., УапАеыаИе У Сотри(ег
зесигНу ап<3 тс1из(па1 сгур(о§гарНу 8(а(е оГ АЛ
ап<1 Еуо1и(юп // Е8АТ Соигзе, Ьеиуеп, Ве1§шт,
Мау21—23, 1991. 8рппцег-Уеге1аё, ВегПп, 1991.
Кыез1 В Ь . 8катгг А , АсИетап У А Ме(Нос1 Гог оЪ-
(апт§ сПсП(а1 зщпаШгез апс! риЬНс кеу сгур(озуз-
(етз // Соттип. АСМ. — 1978. — V. 21. — № 2.
КиерреI К А , 81а#1Ъаск О У Ргос1ис1з оГ Нпеаг ге-
сигг!Пё зесиепсез уу!1Н тах1тит сотр1ехНу //
ШЕЕ Тг 413. 1пГ. ТНеогу. — 1987.— V. 33 —
№ 1.- - Р 126 — 131.
8гт(к О С г\ рЮегарЬу, (Не зс1епсе оГ зесге( \уп(-
т§ . — 1943.
8сИпегег В АррНес! сгур(о1о§у. — .(оНп \УПеу &
8опз, 1пс., 1996.
8Нат1г А Но\\ 1о зНаге а зесге( // Соттип.
АСМ. — 1979.—У.22.—Ыо. 11,—Р. 612—613.
8(тзоп Б К Сгур(о§гарНу: ТНеогу апс! ргас-
Нсе. — СКС Ргезз, 14.У., 1995.
Уегпат С 8 С1рНег рпп(т§ (е1е§гарН зузСетз Гог
зесге! уутиГе апс! гасПо (е1е§гарЫс со т ти т с а -
(юпз // Д. оГ (Не Атепсап 1пзШи(е оГ Е1ес(пса1
Еп§теегз. — 1926. — Уо1. ХЬУ.
Литература
[УагЗ 1]
[7|е73]
УагсИеу Н О ТНе атепсап Ыаск сЬатЬег. —
ВоЬЬз МегпП, (псПапароНз, 1Т1, 1931.
7Лег1ег N, МШь \У Н РгоёисЬ о!' Ппеаг гесигппц
зециепсез // 3. А1§еЫа— 1973.— V. 27. —
№. 1. — Р. 147— 157.
475
ОГЛАВЛЕНИЕ
Погорелое Б Л. Вступительное слово............................................. 3
Введение............................................................................................ 5
Обозначения...................................................................................... 7
Глава 1. Исторический очерк развития криптографии....................... 8
Глава 2. Основные понятия................................................................. 54
§ 2.1. Криптография....................................................................... 54
Конфиденциальность........................................................... 56
Целостность.......................................................................... 62
Аутентификация................................................................... 63
Цифровая подпись............................................................... 65
§ 2.2. Управление секретными ключами...................................... 6 8
Предварительное распределение ключей.......................... 6 8
Пересылка ключей............................................................... 69
Открытое распределение ключей....................................... 70
Схема разделения секрета................................................... 71
§ 2.3. Инфраструктура открытых ключей.................................... 72
Сертификаты........................................................................ 72
Центры сертификации......................................................... 73
§ 2.4. Формальные модели шифров.............................................. 74
§ 2.5. Модели открытых текстов....................................................79
Математические модели открытого текста........................ 80
Критерии распознавания открытого текста........................83
Глава 3. Классификация шифров по различным признакам............ 8 6
§ 3.1. Математическая модель шифра замены..............................87
§ 3.2. Классификация шифров замены..........................................89
Глава 4. Шифры перестановки.............................................................95
§ 4.1. Маршрутные перестановки..................................................95
§ 4.2. Элементы криптоанализа шифров перестановки ........98
Глава 5. Шифры замены.....................................................................101
§ 5.1. Поточные шифры простой замены....................................101
§ 5.2. Криптоанализ поточного шифра простой замены 105
§ 5.3. Блочные шифры простой замены......................................ИЗ
§ 5.4. Многоалфавитные шифры замены............... 121
§ 5.5. Дисковые многоалфавитные шифры замены....................122
Глава 6 . Шифры гаммирования.........................................................126
§ 6.1. Табличное гаммирование....................................................126
476
§ 6.2. О возможности восстановления вероятностей знаков
гаммы.................................................................................... 129
§ 6.3. Восстановление текстов, зашифрованных
неравновероятной гаммой................................................... 132
§ 6.4. Повторное использование гаммы...................................... 139
§ 6.5. Криптоанализ шифра Виженера........................................ 143
§ 6 .6 . Ошибки шифровальщика....................................................152
Глава 7. Надежность шифров............................................................. 156
§ 7.1. Энтропия и избыточность языка........................................ 156
§ 7.2. Расстояние единственности................................................ 162
§ 7.3. Стойкость шифров.............................................................. 169
Теоретическая стойкость шифров..................................... 172
Практическая стойкость шифров...................................... 179
§ 7.4. Вопросы имитостойкости шифров.................................... 182
§ 7.5. Шифры, не распространяющие искажений.................. 194
Шифры, не распространяющие искажений типа
“замена знаков” ................................................................... 195
Шифры, не распространяющие искажений типа
“пропуск-вставка знаков” .................................................. 2 0 1
Глава 8 . Блочные системы шифрования........................................... 205
§ 8.1. Принципы построения блочных шифров..........................206
§ 8.2. Примеры блочных шифров ...................................209
Американский стандарт шифрования данных ЭЕ8 209
Стандарт шифрования данных ГОСТ 28147-89...............220
§ 8.3. Режимы использования блочных шифров........................223
§ 8.4. Комбинирование алгоритмов блочного шифрования 230
§ 8.5. Методы анализа алгоритмов блочного шифрования 231
§ 8 .6 . Рекомендации по использованию алгоритмов блочного
шифрования.......................................................................... 237
Глава 9. Поточные системы шифрования......................................... 240
§ 9.1. Синхронизация поточных шифрсистем............................240
§ 9.2. Принципы построения поточных шифрсистем................242
§ 9.3. Примеры поточных шифрсистем....................................... 247
Шифрсистема А5................................................................ 247
Шифрсистема Гиффорда.................................................... 250
§ 9.4. Линейные регистры сдвига................................................ 251
§ 9.5. Алгоритм Берлекемпа—Месси.......................................... 261
§ 9.6. Усложнение линейных рекуррентных
последовательностей........................................................... 265
477
Фильтрующие генераторы 265
Комбинирующие генераторы 272
Композиции линейных регистров сдвига 274
Схемы с динамическим изменением закона рекурси 275
Схемы с элементами памяти 279
§ 9 7 Методы анализа поточных шифров 283
Глава 10 Шифрование в аналоговой телефонии 287
§10 1 Особенности речевых сигналов 287
§10 2 Скоемблирование 290
§10 3 Частотные преобразования сигнала 291
§10 4 Временные преобразования сигнала 298
§ 10 5 Стойкость систем временных перестановок 305
§10 6 Системы цифровой телефонии 307
Глава 11 Системы шифрования с открытыми ключами 310
§ 11 1 Шифрсистема К.8 А 311
§ 11 2 Шифрсистема Эль-Гамаля 318
§ 11 3 Шифрсистема Мак-Элиса 321
§ 11 4 Шифрсистемы на основе “проблемы рюкзака” 323
Глава 12 Идентификация 327
§ 12 1 Фиксированные пароти (слабая идентификация) 328
Правила составления паролей 329
Усложнение процедуры проверки паролей 330
“Подсоленные” пароли 330
Парольные фразы 331
§ 12 2 Атаки на фиксированные пароли 331
Повторное использование паролей 331
Тотальный перебор паролей 332
Атаки с помощью словаря 332
Личные идентификационные номера 333
Одноразовые пароли 334
§12 3 “Запрос-ответ ’ (сильная идентификация) 335
“Запрос-ответ” с использованием симметричных
алгоритмов шифрования 337
“Запрос-ответ” с использованием асимметричных
алгоритмов шифрования 339
§ 12 4 Протоколы с нулевым разглашением 341
§ 12 5 Атаки на протоколы идентификации 344
Глава 13 Криптографические хэш-функции 347
§ 13 1 Функции хэширования и целостность данных 347
478
§ 13 2 Ключевые функции хэширования 3 5 0
§ 13 3 Бесключевые функции хэширования 3 5 4
§ 13 4 Целостность данных и аутентификация сообщений 359
§ 13 5 Возможные атаки на функции хэширования 362
Глава 14 Цифровые подписи 3 6 5
§14 1 Общие положения 365
§ 14 2 Цифровые подписи на основе шифрсистем
с открытыми ключами 369
§ 14 3 Цифровая подпись Фиата-Шамира 371
§ 14 4 Цифровая подпись Эль-Гамаля 372
§ 14 5 Одноразовые цифровые подписи 375
Глава 15 Протоколы распределения ключей 378
§ 15 1 Передача ключей с использованием симметричного
шифрования 378
Двусторонние протоколы 378
Трехсторонние протоколы 381
§ 15 2 Передача ключей с использованием асимметричного
шифрования 385
Протоколы без использования цифровой подписи 385
Протоколы с использованием цифровой подписи 386
Сертификаты открытых ключей 386
§15 3 Открытое распределение ключей 387
§ 15 4 Предварительное распределение ключей 390
Схемы предварительного распределения ключей
в сети связи 391
Схемы разделения секрета 398
§ 15 5 Способы установления ключей для конференц-связи 401
§ 15 6 Возможные атаки на протоколы распределения
ключей 404
Глава 16 Управление ключами 408
§16 1 Жизненный цикл ключей 411
§ 16 2 Услуги, предоставляемые доверенной третьей
стороной 414
Установка временных меток 415
Нотаризация цифровых подписей 416
Глава 17 Некоторые практические аспекты использования
шифрсистем 418
§17 1 Анализ потока сообщений 418
§ 17 2 Ошибки операторов 419
479
§ 17.3. Физические и организационные меры при
использовании шифрсистем................................................420
Глава 18. Квантово-криптографический протокол открытого
распределения ключей.......................................................423
Квантовый канал и его свойства........................................423
Протокол открытого распределения ключей....................425
Приложение 1. Открытые сообщения и их характеристики 429
Приложение 2. Пример.......................................................................450
Приложение 3. Элементы алгебры и теории чисел..........................460
Литература...........................................................................................469
480