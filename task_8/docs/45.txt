Министерство образования Российской Федерации
Санкт-Петербургский государственный институт точной механики и оптики (технический университет)
Ю.А.Гатчин, А. Г. Коробейников
Основы криптографических алгоритмов
Учебное пособие
Санкт-Петербург 2002
2
УДК 511
Ю.А.Гатчин, А. Г. Коробейников. Основы криптографических алгоритмов
Учебное пособие. СПб: ГИТМО (ТУ), 2002. 29 с.
В учебном пособии рассматриваются основы современных математических криптографических алгоритмов, фундаментом которых является прикладная теория чисел.
Рассмотрены криптосистемы с секретным ключом (одноключевые, симметричные или классические), а также криптосистемы с открытым ключом (асимметричные). Кроме того, представлены основные положе-ния криптографического протокола "электронная подпись". В каждом раз-деле рассмотрены примеры на соответствующие темы.
Предназначено для студентов, обучающихся по специальности 0754 "Комплексная защита объектов информатизации".
Илл. – 3, список литературы – 8 наим.
 Cанкт-Петербургский государствен-ный институт точной механики и оптики (технический университет), 2002
 Ю.А.Гатчин, А.Г. Коробейников 2002
3
ВВЕДЕНИЕ
Математическая криптография возникла как наука о шифровании информации, т.е. как наука о криптосистемах. В классической шенноновс-кой модели системы секретной связи имеют два полностью доверяющих друг-другу участника, которым необходимо передавать между собой ин-формацию, не предназначенную для третьих лиц. Такая информация на-зывается конфиденциальной или секретной. Отсюда возникает задача обеспечения конфиденциальности, т.е. защита секретной информации от противника. Эта задача, по крайней мере исторически, – первая задача криптографии. Она традиционно решается с помощью криптосистем.
При обмене информацией между участниками часто возникает ситуация, когда информация не является конфиденциальной, но важен факт поступления сообщений в неискаженном виде, т.е. наличие гарантии, что никто сумеет не подделать сообщение. Такая гарантия называется обеспечением целостности информации и составляет вторую задачу крип-тографии.
Для предотвращения угрозы контроля за источниками информации (откуда пересылаются сообщения) необходима система контроля за досту-пом к ресурсам, которая должна удовлетворять двум, казалось бы, взаим-но исключающим требованиям. Во – первых, всякий желающий должен иметь возможность обратиться к этой системе анонимно, а во – вторых, при этом все же доказать свое право на доступ к ресурсам. Примером мо-гут служить бумажные купюры. Если ресурсом является некоторый товар, то наличие у покупателя достаточного количества купюр является доказа-тельством его права на доступ к ресурсу. С другой стороны, хотя каждая бумажная купюра и имеет уникальный номер, отслеживать купюры по но-мерам практически невозможно, т.е. определить, кто ее использовал и в каких платежах, практически невозможно. Аналог этого свойства в криптографии называется неотслеживаемостью. Обеспечение неотслежи-ваемости –третья задача криптографии.
Если задача обеспечения конфиденциальности решается с по-мощью криптосистем, то для обеспечения целостности и неотслеживае-мости разрабатываются криптографические протоколы.
В первой части кратко рассмотрена история криптографии и её основные понятия. Приведены основные классические шифры, такие как, шифр Цезаря, маршрутная транспозиция, таблица Виженера, одноразовый блокнот и т.д.
Во второй части изучаются основные свойства диофантова уравне-ния и метод его решения при помощи алгоритма Евклида. Рассмотрена криптосистема без передачи ключей.
4
В третьей части представлена криптосистема с открытым ключом, рассмотрена основные положения системы шифрования RSA, дан анализ стойкости системы с открытым ключом.
В четвертой части рассмотрены основные положения криптографи-ческого протокола "электронная подпись".
В пятой части рассмотрено использование криптографических ал-горитмов для защиты программного обеспечения. Дан анализ их при-менения в некоторых программных продуктах.
Каждая часть сопровождается соответствующими примерами.
Криптографические средства и программные продукты, упоминае-мые в пособии, используются только для иллюстрации общих криптогра-фических идей, так как в работе не ставится цель сравнения имеющихся на рынке криптографических средств.
5
1. КЛАССИЧЕСКИЕ ШИФРЫ И ОСНОВНЫЕ ПОНЯТИЯ
1.1. ИЗ ИСТОРИИ КРИПТОГРАФИИ
Термин криптография (тайнопись) ввел Д. Валлис. Потребность шифровать и передавать шифрованные сообщения возникла очень давно. Так, еще в V-IV вв. до н. э. греки применяли специальное шифрующее устройство. По описанию Плутарха, оно состояло из двух палок одинако-вой длины и толщины. Одну оставляли себе, а другую отдавали отъезжа-ющему. Эти палки называли скиталами. Когда правителям нужно было сообщить какую-нибудь важную тайну, они вырезали длинную и узкую, вроде ремня, полосу папируса, наматывали ее на свою скиталу, не остав-ляя на ней никакого промежутка, так чтобы вся поверхность палки была охвачена этой полосой. Затем, оставляя папирус на скитале в том виде, как он есть, писали на нем все, что нужно, а написав, снимали полосу и без палки отправляли адресату. Так как буквы на ней разбросаны в бес-порядке, то прочитать написанное можно только при помощи соответст-вующей скиталы, намотав на нее без пропусков полосу папируса.
Аристотелю принадлежит способ дешифрования этого шифра. На-до изготовить длинный конус и, начиная с основания, обертывать его лен-той с шифрованным сообщением, постепенно сдвигая ее к вершине. В ка-кой-то момент начнут просматриваться куски сообщения. Так можно оп-ределить диаметр скиталы.
В Древней Греции (II в. до н. э.) был известен шифр, называемый квадрат Полибия. Это устройство представляло собой квадрат 5 х 5, столбцы и строки которого нумеровали цифрами от 1 до 5. В каждую клетку этого квадрата записывалась одна буква. (В греческом варианте од-на клетка оставалась пустой, в латинском – в одну клетку помещали две буквы i и j.) В результате каждой букве отвечала пара чисел и шифрован-ное сообщение превращалось в последовательность пар чисел.
Пример 1. 13 34 22 24 44 34 15 42 22 34 43 45 32
Это сообщение записано при использовании латинского варианта квад-рата Полибия, в котором буквы расположены в алфавитном порядке.
("Cogito, ergo sum" – лат, "Я мыслю, следовательно существую"). ♦
В 1 в. н.э. Ю. Цезарь во время войны с галлами, переписываясь со своими друзьями в Риме, заменял в сообщении первую букву латинского алфавита (А) на четвертую (D), вторую (В) – на пятую (Е), наконец, по-следнюю – на третью:
⇓ A B C D E F G H I J K L M N O P Q R S T U V W X Y Z
⇑ D E F G H I J K L M N O P Q R S T U V W X Y Z A B C
Пример 2. Донесение Ю. Цезаря Сенату об одержанной им победе над Понтийским царем выглядело так:
6
YHQL YLGL YLFL("Veni, vidi, vici" – лат. "Пришел, увидел, победил") .♦
Император Август (1 в. н. э.) в своей переписке заменял первую букву на вторую, вторую – на третью и т. д., наконец, последнюю – на первую:
⇓ A B C D E F G H I J K L M N O P Q R S T U V W X Y Z
⇑ B C D E F G H I J K L M N O P Q R S T U V W X Y Z A
Пример 2. Любимое изречение императора Августа выглядело так:
GFTUJOB MFOUF ("Festina lente" – лат. "Торопись медленно") .♦
Квадрат Полибия, шифр Цезаря входят в класс шифров, называе-мых подстановка или простая замена, т.е. Это такой шифр, в котором каждой букве алфавита соответствует буква, цифра, символ или какая-нибудь их комбинация.
В известных рассказах “Пляшущие человечки” Конан Дойля и “Зо-лотой жук” Эдгара По используемые шифры относятся к указанному классу шифров. В другом классе шифров – перестановка – буквы сооб-щения каким-нибудь способом переставляются между собой. К этому классу принадлежит шифр скитала.
1.2. МАРШРУТНАЯ ТРАНСПОЗИЦИЯ
К классу перестановка относится шифр маршрутная транспозиция и его вариант постолбцовая транспозиция. В каждом из них в данный прямоугольник [n×m] сообщение вписывается заранее обусловленным способом, а столбцы нумеруются или обычным порядком следования, или в порядке следования букв ключа – буквенного ключевого слова.
Пример 3. В первом прямоугольнике столбцы нумеруются в обыч-ном порядке следования – слева направо, а во втором – в порядке следова-ния букв слова “Пушкин”. Используя расположение букв этого ключа в алфавите, получим набор чисел [4 5 6 2 1 3]:
1
2
3
4
5
6
д
е
л
а
д
а
в
н
о
м
и
н
у
в
ш
и
х
д
н
е
й
п
р
е
д
а
н
ь
я
с
т
а
р
и
н
ы
г
л
у
б
о
к
о
й
а
б
в
г
4
5
6
2
1
3
д
е
л
а
д
а
в
н
о
м
и
н
у
в
ш
и
х
д
н
е
й
п
р
е
д
а
н
ь
я
с
т
а
р
и
н
ы
г
л
у
б
о
к
о
й
а
б
в
г
В первом случае шифрованный текст найдем, если будем выписы-вать буквы очередного столбца в порядке следования столбцов (прямом или обратном), во втором, – если будем выписывать буквы столбца в по-рядке следования букв ключа. Таким образом, будем иметь:
7
1) двундтго енвеаалй лошйнруа амипьибб дихрянов андесыкг;
2) дихрянов амипьибб андесыкг двундтго енвеаалй лошйнруа. ♦
Термин “шифр” арабского происхождения. В начале XV в. арабы опубликовали энциклопедию “Шауба Аль-Аща”, в которой есть специаль-ный раздел о шифрах. В этой энциклопедии указан способ раскрытия шифра простой замены. Он основан на различной частоте повторяемости букв в тексте. В этом разделе есть перечень букв в порядке их повторяе-мости на основе изучения текста Корана. Заметим, что в русском тексте чаще всего встречается буква “О”, затем буква “Е” и на третьем месте сто-ят буквы “И” и “А”. Более точно: на 1000 букв русского текста в среднем приходится 90 букв “О”, 72 буквы “Е” или “Ё”, 60 букв “И” и “А” и т.д.
Неудобство шифров типа подстановка (простая замена) в случае использования стандартного алфавита очевидно. Таблица частот встречае-мости букв алфавита позволяет определить одни или несколько символов, а этого иногда достаточно для дешифрования всего сообщения (“Пля-шущие человечки” Конан Дойля или “Золотой жук” Эдгара По). Поэтому обычно пользуются разными приемами, чтобы затруднить дешифрование. Для этой цели используют многобуквенную систему шифрования – сис-тему, в которой одному символу отвечает одна или несколько комбинаций двух и более символов. Другой прием – использование нескольких алфа-витов. В этом случае для каждого символа употребляют тот или иной ал-фавит в зависимости от ключа, который связан каким-нибудь способом с самим символом или с его порядком в передаваемом сообщении.
1.3. ТАБЛИЦА ВИЖЕНЕРА
В процессе шифрования (и дешифрования) используется таблица Виженера, которая устроена следующим образом: в первой строке выпи-сывается весь алфавит, в каждой следующей осуществляется циклический сдвиг на одну букву. Так получается квадратная таблица, число строк ко-торой равно числу столбцов в алфавите. Чтобы зашифровать какое-нибудь сообщение, поступают следующим образом. Выбирается слово – лозунг и подписывается с повторением над буквами сообщения.
Чтобы получить шифрованный текст, находят очередной знак ло-зунга, начиная с первого в вертикальном алфавите, а ему соответствую-щий знак сообщения в горизонтальном.
Пример 4. Таблица 1, составлена из 31 буквы русского алфавита (без букв Ё и Ъ).
Выбираем лозунг – математика. Находим столбец, отвечающий букве "м" лозунга, а затем строку, соответствующую букве "к". На пересе-чении выделенных столбца и строки находим букву "ц". Так продолжая дальше, находим весь шифрованный текст.
м а т е м а т и к а м а т е м а т и к а м а т е м а
к р и п т о г р а ф и я с е р ь е з н а я н а у к а
8
таблица 1
А
Б
В
Г
Д
Е
Ж
З
И
Й
К
Л
М
Н
О
П
Р
С
Т
У
Ф
Х
Ц
Ч
Ш
Щ
Ь
Ы
Э
Ю
Я
Б
В
Г
Д
Е
Ж
З
И
Й
К
Л
М
Н
О
П
Р
С
Т
У
Ф
Х
Ц
Ч
Ш
Щ
Ь
Ы
Э
Ю
Я
А
В
Г
Д
Е
Ж
З
И
Й
К
Л
М
Н
О
П
Р
С
Т
У
Ф
Х
Ц
Ч
Ш
Щ
Ь
Ы
Э
Ю
Я
А
Б
Г
Д
Е
Ж
З
И
Й
К
Л
М
Н
О
П
Р
С
Т
У
Ф
Х
Ц
Ч
Ш
Щ
Ь
Ы
Э
Ю
Я
А
Б
В
Д
Е
Ж
З
И
Й
К
Л
М
Н
О
П
Р
С
Т
У
Ф
Х
Ц
Ч
Ш
Щ
Ь
Ы
Э
Ю
Я
А
Б
В
Г
Е
Ж
З
И
Й
К
Л
М
Н
О
П
Р
С
Т
У
Ф
Х
Ц
Ч
Ш
Щ
Ь
Ы
Э
Ю
Я
А
Б
В
Г
Д
Ж
З
И
Й
К
Л
М
Н
О
П
Р
С
Т
У
Ф
Х
Ц
Ч
Ш
Щ
Ь
Ы
Э
Ю
Я
А
Б
В
Г
Д
Е
З
И
Й
К
Л
М
Н
О
П
Р
С
Т
У
Ф
Х
Ц
Ч
Ш
Щ
Ь
Ы
Э
Ю
Я
А
Б
В
Г
Д
Е
Ж
И
Й
К
Л
М
Н
О
П
Р
С
Т
У
Ф
Х
Ц
Ч
Ш
Щ
Ь
Ы
Э
Ю
Я
А
Б
В
Г
Д
Е
Ж
З
Й
К
Л
М
Н
О
П
Р
С
Т
У
Ф
Х
Ц
Ч
Ш
Щ
Ь
Ы
Э
Ю
Я
А
Б
В
Г
Д
Е
Ж
З
И
К
Л
М
Н
О
П
Р
С
Т
У
Ф
Х
Ц
Ч
Ш
Щ
Ь
Ы
Э
Ю
Я
А
Б
В
Г
Д
Е
Ж
З
И
Й
Л
М
Н
О
П
Р
С
Т
У
Ф
Х
Ц
Ч
Ш
Щ
Ь
Ы
Э
Ю
Я
А
Б
В
Г
Д
Е
Ж
З
И
Й
К
М
Н
О
П
Р
С
Т
У
Ф
Х
Ц
Ч
Ш
Щ
Ь
Ы
Э
Ю
Я
А
Б
В
Г
Д
Е
Ж
З
И
Й
К
Л
Н
О
П
Р
С
Т
У
Ф
Х
Ц
Ч
Ш
Щ
Ь
Ы
Э
Ю
Я
А
Б
В
Г
Д
Е
Ж
З
И
Й
К
Л
М
О
П
Р
С
Т
У
Ф
Х
Ц
Ч
Ш
Щ
Ь
Ы
Э
Ю
Я
А
Б
В
Г
Д
Е
Ж
З
И
Й
К
Л
М
Н
П
Р
С
Т
У
Ф
Х
Ц
Ч
Ш
Щ
Ь
Ы
Э
Ю
Я
А
Б
В
Г
Д
Е
Ж
З
И
Й
К
Л
М
Н
О
Р
С
Т
У
Ф
Х
Ц
Ч
Ш
Щ
Ь
Ы
Э
Ю
Я
А
Б
В
Г
Д
Е
Ж
З
И
Й
К
Л
М
Н
О
П
С
Т
У
Ф
Х
Ц
Ч
Ш
Щ
Ь
Ы
Э
Ю
Я
А
Б
В
Г
Д
Е
Ж
З
И
Й
К
Л
М
Н
О
П
Р
Т
У
Ф
Х
Ц
Ч
Ш
Щ
Ь
Ы
Э
Ю
Я
А
Б
В
Г
Д
Е
Ж
З
И
Й
К
Л
М
Н
О
П
Р
С
У
Ф
Х
Ц
Ч
Ш
Щ
Ь
Ы
Э
Ю
Я
А
Б
В
Г
Д
Е
Ж
З
И
Й
К
Л
М
Н
О
П
Р
С
Т
Ф
Х
Ц
Ч
Ш
Щ
Ь
Ы
Э
Ю
Я
А
Б
В
Г
Д
Е
Ж
З
И
Й
К
Л
М
Н
О
П
Р
С
Т
У
Х
Ц
Ч
Ш
Щ
Ь
Ы
Э
Ю
Я
А
Б
В
Г
Д
Е
Ж
З
И
Й
К
Л
М
Н
О
П
Р
С
Т
У
Ф
Ц
Ч
Ш
Щ
Ь
Ы
Э
Ю
Я
А
Б
В
Г
Д
Е
Ж
З
И
Й
К
Л
М
Н
О
П
Р
С
Т
У
Ф
Х
Ч
Ш
Щ
Ь
Ы
Э
Ю
Я
А
Б
В
Г
Д
Е
Ж
З
И
Й
К
Л
М
Н
О
П
Р
С
Т
У
Ф
Х
Ц
Ш
Щ
Ь
Ы
Э
Ю
Я
А
Б
В
Г
Д
Е
Ж
З
И
Й
К
Л
М
Н
О
П
Р
С
Т
У
Ф
Х
Ц
Ч
Щ
Ь
Ы
Э
Ю
Я
А
Б
В
Г
Д
Е
Ж
З
И
Й
К
Л
М
Н
О
П
Р
С
Т
У
Ф
Х
Ц
Ч
Ш
Ь
Ы
Э
Ю
Я
А
Б
В
Г
Д
Е
Ж
З
И
Й
К
Л
М
Н
О
П
Р
С
Т
У
Ф
Х
Ц
Ч
Ш
Щ
Ы
Э
Ю
Я
А
Б
В
Г
Д
Е
Ж
З
И
Й
К
Л
М
Н
О
П
Р
С
Т
У
Ф
Х
Ц
Ч
Ш
Щ
Ь
Э
Ю
Я
А
Б
В
Г
Д
Е
Ж
З
И
Й
К
Л
М
Н
О
П
Р
С
Т
У
Ф
Х
Ц
Ч
Ш
Щ
Ь
Ы
Ю
Я
А
Б
В
Г
Д
Е
Ж
З
И
Й
К
Л
М
Н
О
П
Р
С
Т
У
Ф
Х
Ц
Ч
Ш
Щ
Ь
Ы
Э
Я
А
Б
В
Г
Д
Е
Ж
З
И
Й
К
Л
М
Н
О
П
Р
С
Т
У
Ф
Х
Ц
Ч
Ш
Щ
Ь
Ы
Э
Ю
ц р ь ф я о х ш к ф ф я д к э ь ч п ч а л н т ш ц а ♦
Наконец, к сообщению можно применять несколько систем шиф-рования.
1.4. МОДИФИЦИРОВАННЫЙ ШИФР ЦЕЗАРЯ
Аббат Тритемеус – автор первой печатной книги о тайнописи (1518 г.) – предложил несколько шифров и среди них шифр, который можно считать усовершенствованием шифра Цезаря. Этот шифр устроен так. Все буквы алфавита нумеруются по порядку (от 1 до 31 в русском варианте). Затем выбирают какое-нибудь слово, называемое "ключом", и подписыва-ют под сообщением с повторением.
Чтобы получить шифрованный текст, складывают номер очеред-ной буквы с номером соответствующей буквы ключа. Если полученная сумма больше 31, то из нее вычитают 31. В результате получают последо-вательность чисел от 1 до 31. Вновь заменяя числа этой последовательнос-ти соответствующими буквами, получают шифрованный текст. Разбиваем этот текст на группы одной длины, получают шифрованное сообщение.
Пример 5. Выбираем ключевое слово "Пособие". Составляем сооб-щение "сессия начинается в конце семестра"
с е с с и я н а ч и н а е т с я в к о н ц е с е м е с т р а
по с о б и е п о с о б и е п о с о б и е п о с о б и е п о
9
Шифруем, разбиваем текст на группы длины 6, и получаем шифро-ванное сообщение:
в фд а и и у р з ь э в о ш в о ф щ р ц э х б ч ы з ь ш б п ♦
Чтобы получить шифрованный текст, складывают номер очеред-ной буквы с номером соответствующей буквы ключа. Если полученная сумма больше 33, то из нее вычитают 33. В результате получают последо-вательность чисел от 1 до 33. Вновь заменяя числа этой последовательнос-ти соответствующими буквами, получают шифрованный текст. Разбивал этот текст на группы одной длины (например, по 5), получают шифрован-ное сообщение.
Если под ключом шифра понимать однобуквенное слово “В” (в русском варианте), то мы получим шифр Цезаря.
Пример 6. Для сообщения из примера 5, получим:
ф и ф ф л в р г ь л р г и х ф в в н т р щ и ф и п и ф х у г ♦
1.5. ОДНОРАЗОВЫЙ БЛОКНОТ
Почти все используемые на практике шифры характеризуются как условно надежные, поскольку они могут быть раскрыты в принципе при наличии неограниченных вычислительных возможностей. Абсолютно на-дежные шифры нельзя разрушить даже при наличии неограниченных вы-числительных возможностей. Доказательство существования и единствен-ности абсолютно надежного шифра получил К.Шеннон с помощью разра-ботанного им теоретико-информационного метода исследования шифров. Таким образом, единственный абсолютно надежный шифр, который ис-пользуется на практике, это так называемый одноразовый блокнот, в ос-нове которого лежит та же идея, что и шифре Цезаря. Рассмотрим его основную идею.
В русском варианте число символов расширенного алфавита, т.е. совокупности букв, а также знаков препинания и пробела между словами, равно 44. Занумеровав все символы расширенного алфавита числами от 0 до 43, можно рассматривать любой передавамый текст, как последова-тельность {an} чисел множества А={0,1,2,…,43}. Имея случайную после-довательность {cn} из чисел множества А той же длины что и передавае-мый текст (ключ), складываем по модулю 44 число an передаваемого текс-та с соответствующим числом cn ключа
an+cn≡bn(mod 44), 0≤ bn ≤ 43,
получим последовательность {bn} знаков шифрованного текста.
Чтобы получить передаваемый текст, можно воспользоваться тем же ключом:
an≡bn-c(mod 44), 0≤ an ≤ 43.
У двух абонентов, находящихся в секретной переписке, имеются два одинаковых блокнота, составленных из отрывных страниц, на каждой из которых напечатана таблица со случайными числами или буквами, т.е.
10
случайная последовательность чисел из множества А. Таблица имеет только две копии: одна используется отправителем, другая – получателем. Отправитель свой текст шифрует указанным выше способом при помощи первой страницы блокнота. Зашифровав сообщение, он уничтожает ис-пользованную страницу и отправляет его второму абоненту. Получатель шифрованного текста расшифровывает его и также уничтожает использо-ванный лист блокнота. Нетрудно видеть, что одноразовый шифр нераск-рываем в принципе, так как символ в тексте может быть заменен любым другим символом и этот выбор совершенно случаен.
11
2. ДИОФАНТОВЫ УРАВНЕНИЯ
2.1. ДИОФАНТОВО УРАВНЕНИЕ ПЕРВОЙ СТЕПЕНИ
Рассмотрим задачу отыскания целочисленного решения уравнения:
ax-my=1, (2.1)
где наибольший общий делитель (НОД) a и m равен 1, т.е. НОД(a,m)=1,
a>0, m>0.
Для решения этой задачи число a/m обращают в конечную цепную дробь при помощи алгоритма Евклида:
a=mq0+a1,
m=a1q1+a2,
a1=a2q2+a3,
a2=a3q3+a4,
………………………….
ak-2=ak-1qk-1+ak,
ak-1=ak+1qk+0;
Цепная дробь имеет вид: a/m = [q0,q1,q2,…qk], а последовательности {Pn} и {Qn} числителей и знаменателей подходящих дробей к цепной дро-би определяются рекуррентно:
P-2=0, P-1=1;
Q-2=1, Q-1=0;
n≥0 ⇒ Pn = qnPn-1 + Pn-2,
n≥0 ⇒ Qn = qnQn-1 + Qn-2.
Их вычисление удобно оформлять в виде таблицы:
n
-2
-1
0
1
2
…
k-1
k
qn
q0
q1
q2
…
qk-1
qk
Pn
0
1
P0
P1
P2
…
Pk-1
Pk
Qn
1
0
Q0
Q1
Q2
…
Qk-1
Qk
Но известно, что PkQk-1-Pk-1Qk=(-1)k-1 и a/m = Pk/Qk. Следовательно
(-1)k-1PkQk-1-Pk-1(-1)k-1Qk=1.
А так как НОД(a,m)=1, то Pk = a, Qk = m. Поэтому
(-1)k-1Qk-1a – m(-1)k-1Pk-1=1.
Другими словами, пара (x,y), где x=(-1)k-1Qk-1; y=(-1)k-1Pk-1, являются целочисленным решением уравнения (2.1).
2.2. РЕШЕНИЕ СРАВНЕНИЯ ПЕРВОЙ СТЕПЕНИ
Чтобы найти решение сравнения ax≡1(mod m), где НОД(a,m)=1, обычно пользуются алгоритмом Евклида, и тогда x≡(-1)k-1Qk-1(mod m),, где Qk-1 – знаменатель предпоследней подходящей дроби разложения a/m в цепную дробь, или теоремой Ферма-Эйлера, которая утверждает, что если НОД(a,m)=1, то
12
aϕ(m)≡1(mod m),
где ϕ(m) – функция Эйлера.
Следовательно
x≡aϕ(m)-1(mod m).
Пример 7. Решить сравнение
7283*x≡1(mod 190116)
Имеем
7283=190116*0+7283
190116=7283*26+758
7283=758*9+461
758=461*1+297
461=297*1+164
297=164*1+133
164=133*1+31
133=31*4+9
31=9*3+4
9=4*2+1
4=1*4+0
n
0
1
2
3
4
5
6
7
8
9
10
qn
0
26
9
1
1
1
1
4
3
2
4
Pn
0
1
0
1
9
10
19
29
48
221
711
1643
7283
Qn
1
0
1
26
235
261
496
757
1253
5769
18560
42889
190116
Действительно, k=10; x≡(-1)9×42889 (mod 190116)= -42889 (mod 190116) = = 147227(mod 190116); (7283*147227-1)/ 190116=5640 ♦
2.3. КРИПТОСИСТЕМА БЕЗ ПЕРЕДАЧИ КЛЮЧЕЙ
Пусть абоненты А, В, С, ... условились организовать секретную пе-реписку между собой. Для этой цели они выбирают достаточно большое простое число р и такое, что р-1 хорошо разлагается на не очень большие простые множители. Если среди множителей такого числа кратных нет, то число р-1 называют евклидовым. Каждый из абонентов независимо один от другого выбирает случайное число, натуральное, взаимно простое с числом р-1: А, В, С, ... – абоненты; а, b, c, ... – выбранные ими случайные числа. Далее, абонент А находит число α из условия
а⋅α≡1(mod ϕ(p)), 0 < α <р-1; (2.2)
абонент В находит число β из условия
b⋅β≡1(mod ϕ(p)), 0 < β <р-1, (2.3)
где ϕ(p) – функция Эйлера, а, α – секретные ключи абонента А; b, β – секретные ключи абонента В и т.д.
Пусть абонент А решает послать сообщение m абоненту В. Можно предполагать, что 0 < m < р-1. Тогда он сначала зашифровывает это сооб-щение своим первым секретным ключом, находит:
m1≡mа(mod p), 0 < m1 < р (2.4)
13
и отправляет абоненту В. Абонент В, в свою очередь, зашифровывает вновь это сообщение также своим первым ключом:
m2≡m1b(mod p), 0 < m2 < р (2.5)
и пересылает его обратно абоненту А. Абонент А, получив обратно свое дважды зашифрованное сообщение, шифрует его же в третий раз своим вторым ключом:
m3≡m2α(mod p), 0 < m3 < р (2.6)
и вновь отправляет его абоненту В. Последний расшифровывает эту шиф-ротелеграмму при помощи своего второго ключа:
m4≡m3β(mod p), 0 < m4 < р.
В самом деле, из сравнений (2.4) – (2.6) имеем:
m4≡mk(mod p),
где k≡a⋅α⋅b⋅β(mod р-1).
В силу (2.2) и (2.3) k≡1(mod ϕ(p)). Поэтому m4≡m(mod p), а так как каждое из них положительно и меньше p, то m4=m.
Пример 8. Пусть абоненты A и B решили установить между собой скрытую связь без передачи ключей. Они выбрали для этого простое число p = 9551. Тогда p-1=9550.
Абонент A выбирает случайное число a=8159, а абонент B – b=7159. Абонент A решает сравнение: 8159⋅α≡1(mod ϕ(9551)), 0<α< 9550
и находит α= 6639, а абонент B решает сравнение: 7159⋅β≡1(mod ϕ(9551)), 0<β<9550 и находит β= 6139.
Абонент A решает послать секретное сообщение абоненту B m=7032. Тогда он сначала шифрует сообщение своим первым ключом: m1≡mа(mod p)= 703281593(mod 9551)= 153.
Абонент B, получив это сообщение, шифрует его своим первым ключом: m2≡m1b(mod p)= 1537159(mod 9551)= 4896, и пересылает его або-ненту А, который, получив зашифрованное сообщение, шифрует его же в третий раз своим вторым ключом: m3≡m2α(mod p) =48966639(mod 9551)= 7577 и отправляет его абоненту В, который расшифровывает эту шифро-телеграмму при помощи своего второго ключа: m4≡m3β(mod p)= 75776139(mod 9551)= 7032.♦
Пример 9. А теперь рассмотрим похожий пример, но с большими числами, а именно пусть абоненты A и B выбирают случайное число p =3 618502788666131106986593281521497120414687020801267626233049500247285301313. Далее абонент A выбирает случайное число a=32910091146 42412084309938365114701009965471731267159726697218119, а абонент B – b=72133456729194312009114642445656781208430934647938365165454 65843. Абонент A решает сравнение: 3291009114642412084309938365114 701009965471731267159726697218119⋅α≡1(mod ϕ(3618502788666131106 986593281521497120414687020801267626233049500247285301313)), 0 < α < 36185027886661311069865932815214971204146870208012676262330495 00247285301312 и находит α=7182890946724276712267540712060414209
14
95758405828622569613369504272231654775, а абонент B решает сравне-ние: 721334567291943120091146424456567812084309346479383651654546 5843⋅β ≡1(mod ϕ(119726214130147567059245861496117904970213993920 59391)), 0 < β < 1197262141301475670592458614961179049702139939205 9390 и находит β= 20507850089479826167721544736489099017840580106 89679595249365486507640220987.
Абонент A решает послать секретное сообщение абоненту B m=16439530856237023359734047455621923453212389086. Тогда он снача-ла шифрует сообщение своим первым ключом: m1≡mа(mod p)= 164395308 562370233597340474556219234532123890863291009114642412084309938365114701009965 471731267159726697218119(mod 3618502788666131106986593281521497120414687 020801267626233049500247285301313)=2340488471726089607124556756 26416933820229094970133 5616973062664572414115995.
Абонент B, получив это сообщение, шифрует его своим первым ключом: m2≡m1b(mod p)= 23404884717260896071245567562641693382022 9094970133561697306266457241411599572133456729194312009114642445656781208430934 64793836516545465843(mod 361850278866613110698659328152149712041468702 0801267626233049500247285301313) =200847152309106133691890020899 3851807662985672512619192514870979350742436070, и пересылает его абоненту А. Абонент А, получив зашифрованное сообщение, шифрует его же в третий раз своим вторым ключом: m3≡m2α(mod p) =200847152309106 1336918900208993851807662985672512619192514870979350742436070718289094672427671226754071206041420995758405828622569613369504272231654775(mod 3618502788666 131106986593281521497120414687020801267626233049500247285301313) = 33742679560664044914439639213562036497523303647522251966113925 36160948437196 и отправляет его абоненту В, который расшифровывает эту шифротелеграмму при помощи своего второго ключа: m4≡m3β(mod p)= 3374267956066404491443963921356203649752330364752225196611392536 1609484371962050785008947982616772154473648909901784058010689679595249365486507640220987 ( mod 36185027886661311069865932815214971204146870208012676262330 49500247285301313)=16439530856237023359734047455621923453212389086♦
15
3. КРИПТОСИСТЕМА С ОТКРЫТЫМ КЛЮЧОМ
3.1. КРАТКАЯ ИСТОРИЯ ВОПРОСА
В 1976 году американцы Уитфилд Диффи и Мартин Хеллман (Diffi W., Hellman M.) в статье "Новые направления в криптографии" предложи-ли новый принцип построения криптосистем, не требующий не только пе-редачи ключа принимающему сообщение, но даже сохранения в тайне ме-тода шифрования. Эти шифры позволяют легко зашифровывать и дешиф-ровать текст и их можно использовать многократно.
В 1978 г. Р. Ривест, А. Шамир и Л. Адлема (R.L.Rivest, A.Shamir, L.Adleman) предложили пример функции, обладающей рядом замечатель-ных свойств. На ее основе была построена реально используемая система шифрования, получившая название по первым буквам фамилий авторов – система RSA. Рассмотрим ее основные положения на примере криптосис-темы с открытым ключом.
3.2. ОСНОВНЫЕ ПОЛОЖЕНИЯ КРИПТОСИСТЕМЫ С ОТКРЫТЫМ КЛЮЧОМ
Пусть абоненты А и В условились организовать секретную пере-писку между собой с открытым ключом. Тогда каждый из них, независи-мо от другого, выбирает два достаточно больших простых числа, находит их произведение, функцию Эйлера от этого произведения и выбирает случайное число, меньшее этого вычисленного значения функции Эйлера и взаимно простое с ним. Итак,
А:р1,р2, rА=р1р2, ϕ(rА), (a,ϕ(rА))=1, 0 < a < ϕ(rА),
B:q1,q2, rB=q1q2, ϕ(rB), (b,ϕ(rB))=1, 0 < b < ϕ(rB).
Затем печатается телефонная книга, доступная всем желающим, которая имеет вид:
rА – произведение двух простых чисел, известных только А, a – открытый ключ, доступный каждому, кто хочет передать секрет-ное сообщение А, rB – произведение двух простых чисел, извест-ных только B. b – открытый ключ, доступный каждому, кто хо-чет передать секретное сообщение B.
А: rА,a
B: rB,b
Каждый из абонентов находит свой секретный ключ из сравнений а⋅α≡1(mod ϕ(rА)), 0 < α < ϕ(rА), b⋅β≡1(mod ϕ(rB)), 0 < β < ϕ(rB),
Итак,
Абонент
Открытые ключи
Секретные ключи
A
rА, a
α
B
rB, b
β
Пусть абонент А решает послать сообщение m абоненту В:
16
А: m → В и пусть 0 < m < rB, иначе текст делят на куски длины rB.
Сначала А зашифровывает сообщение открытым ключом абонента В, который есть в телефонной книге, и находит:
m1≡mb(mod rB), 0 < m1 < rB,
и отправляет абоненту В. Абонент В, расшифровывает это сообщение своим секретным ключом:
m2≡m1β(mod rB), 0 < m2 < rB,
и получает m4=m.
В самом деле:
m2≡m1β≡(mβ)b≡mbβ(mod rB).
Но b⋅β≡1(mod ϕ(rB)), следовательно m2≡ m(mod rB). Но так как 0<m<rB, 0<m2<rB то m2=m.
Пример 9. Пусть абоненты A и B решили установить между собой скрытую связь с открытым ключом.
Абонент A выбрал простые числа р1=7643 и р2=8753, их произведе-ние rА=66899179, функцию Эйлера ϕ(rA) =р1р2(1-1/р1)(1-1/р2)=66882784. Затем он выбирает случайное число a=9467 (открытый ключ) и находит секретный ключ из решения сравнения: а⋅α≡1(mod ϕ(rА))=9467⋅α≡1(mod 66882784), 0<α<ϕ(rА), т.е. α=30993427.
Абонент B выбрал простые числа q1=7481 и q2=9539, их произведе-ние rB=71361259, функцию Эйлера ϕ(rB) =rB(1-1/q1)(1-1/q2)=71344240. Затем он выбирает случайное число b=74671 (открытый ключ) и находит секретный ключ из решения сравнения: b⋅β≡1(mod ϕ(rB))=74671⋅β≡1(mod 71344240), 0<β<ϕ(rB), т.е. β=33289711.
Следовательно имеется таблица:
Абонент
Открытые ключи
Секретные ключи
A
66899179, 9467
30993427
B
71361259, 74671
33289711
Абонент A решает послать cверхсекретное сообщение абоненту B m=95637. Тогда он шифрует сообщение открытым ключом абонента B:
m1≡mb(mod rB)= 9563774671(mod 71361259)= 25963634.
Абонент B, получив это сообщение, расшифровывает его своим секретным ключом:
m2≡m1β(mod p)= 2596363433289711(mod 71361259)= 95637.♦
Пример 10. А теперь рассмотрим похожий пример, но с большими числами, а именно: р1=7643 и р2=8753, их произведение rА=66899179, ϕ(rA) =р1р2(1-1/р1)(1-1/р2)=66882784, a=9467 и α=30993427. Далее, q1=170141183460469231731687303715884105727, q2=103507944310551623 86718619237468234569, b=18268770466636286477546060408953537745699 1567871. Тогда имеем: rB=1761096414255759626214007376557990993955 085697884921213758143162998032276663, ϕ(rB) =rB(1-1/q1)(1-1/q2)= 176109 6414255759626214007376557990993774593719993396819639737240044679 936368. Находим секретный ключ из решения сравнения: b⋅β≡1(mod
17
ϕ(rB))=182687704666362864775460604089535377456991567871⋅β≡1(mod 1761096414255759626214007376557990993774593719993396819639737240 044679936368), 0<β<ϕ(rB), т.е. β=165135868322368842056118800995582 3597594847807953854259478179905981879730111.
Таким образом имеется таблица:
Абонент
Открытые ключи
Секретные ключи
A
66899179, 9467
30993427
B
176109641425575962621400737655799099395508 569788492 1213758143162998032276663, 18268770466636286477546060 408953537745699 1567871
165135868322368842056118800995582359759484780795 385425947817990598187973 0111
Абонент A решает послать cверхсекретное сообщение абоненту B m=9563712352348897672389641396218609567172. Тогда он шифрует со-общение открытым ключом абонента B: m1≡mb(mod rB)=956371235234889 7672389641396218609567172182687704666362864775460604089535377456991567871(mod 176 1096414255759626214007376557990993955085697884921213758143162998 032276663)=83255471600987219023332593780878672784122613750592044594478223942973656948.
Абонент B, получив это сообщение, расшифровывает его своим се-кретным ключом: m2≡m1β(mod p)=8325547160098721902333259378087867 27841226137505920445944782239429736569481651358683223688420561188009955823597 594847807953854259478179905981879730111(mod 1761096414255759626214007376557990 993955085697884921213758143162998032276663)=95637123523488976723 89641396218609567172.♦
3.3. НАДЕЖНОСТЬ СИСТЕМЫ С ОТКРЫТЫМ КЛЮЧОМ
В рассмотренной криптосистеме с открытым ключом для перехва-та сообщения m необходимо найти секретный ключ β. Это возможно в двух случаях:
1) если известно разложение rB на простые множители;
2) если известен модуль ϕ(rB) сравнения b⋅β≡1(mod ϕ(rB)).
Но так как rB=q1q2, то ϕ(rB)=ϕ(q1)ϕ(q2)=(q1-1)(q2-1)=q1q2-(q1+q2)+1 и (q1-q2)2=q12+q22-2q1q2=(q1+q2)2-4q1q2.
Следовательно мы имеем равенства:
ϕ(rB)=rB-(q1+q2)+1,
(q1-q2)2=(q1+q2)2-4q1q2,
а значит, зная ϕ(rB), можно решить эту систему и найти q1 и q2, а зная q1 и q2, легко вычислить ϕ(rB). Таким образом, оба подхода определения ключа β эквивалентны, т.е. задачи одной сложности.
В теории чисел, несмотря на многолетнюю ее историю и на очень интенсивные поиски в течение последних 30 лет, эффективный алгоритм
18
разложения натуральных чисел на множители так и не найден. Конечно, можно, перебирая все простые числа до (rB)1/2 , и деля на них rB, найти требуемое разложение. Но учитывая, что количество простых чисел в этом промежутке асимптотически равно 2⋅(rB)1/2⋅(ln rB)-1, находим, что при rB, записываемом 100 десятичными цифрами, найдется не менее 4⋅1042 простых чисел, на которые придется делить rB при разложении его на мно-жители, что при современных возможностях вычислительной техники за-тянется на долгие годы.
Известны и более эффективные алгоритмы разложения целых чи-сел на множители, чем простой перебор простых делителей, но и они работают очень медленно.
19
4. ЭЛЕКТРОННАЯ ПОДПИСЬ
Криптосистема "открытый ключ" неудобна в том смысле, что по-лучатель сообщения не знает, кто является отправителем сообщения. Это-го недостатка лишены протоколы "электронной подписи". Рассмотрим их основную идею.
Пусть имеется банкир A и несколько вкладчиков – B1, B2, B3, …. Банкир и каждый из вкладчиков независимо друг от друга выбирают два больших простых числа и держат их в секрете. Пусть P и Q – простые числа банкира, pi и qi – простые числа вкладчика Bi, i = 1, 2, 3, … . Пусть далее R = PQ, ri = qipi, i = 1, 2, 3, … . И пусть банкир выбирает случайно целое число S с условиями 0 < S < ϕ(R), (S, ϕ(R))=1, а каждый из вклад-чиков также случайно и независимо друг от друга выбирает число si с условиями 0 < si < ϕ(ri), (si, ϕ(ri))=1, i = 1, 2, 3, … . После этого публикует-ся всем доступная телефонная книга:
A: R, S
B1: r1, s1
B2: r2, s2
…………….
Далее каждый из них, и банкир и вкладчики, находят свои секрет-ные T, ti ключи из условий:
S⋅T≡1(mod ϕ(R)), 0 < T < ϕ(R),
si⋅ti≡1(mod ϕ(ri)), 0 < ti < ϕ(ri), i = 1, 2, 3, … .
Пусть вкладчик Bk собирается дать распоряжение m банкиру A, и пусть
0 < rk < R.
Последнее неравенство существенно для дальнейшего. Положим для удобства записи B=Bk, r=rk, t=tk, s=sk. Будем считать m < r и (m, r)=1. Вкладчик B шифрует распоряжение m сначала своим секретным ключом:
m1≡mt(mod r), 0 < m1 < r,
а потом открытым ключом банкира:
m2≡m1S(mod R), 0 < m2 < R.
Банкир A, получив шифрованную телеграмму m2, расшифровывает ее пользуясь сначала своим секретным ключом T:
m3≡m2T(mod R), 0 < m3 < R.
а потом открытым ключом s вкладчика:
m4≡m3s(mod r), 0 < m4 < r,
и получает m4 =m.
Действительно, так как m3≡m2T(mod R), а m2≡m1S(mod R), то m3≡m1TS(mod R), где S⋅T≡1(mod ϕ(R)). Если (m1, R)=1, то по теореме Ферма-Эйлера m1TS≡m1(mod R), т.е. m3≡m1(mod R). Но 0 <m3 < R,
20
0 < m1 < r < R, следовательно m3≡m1. Имеем m4≡m3s≡m1s≡mst(mod r), s⋅t≡1(mod ϕ(r)) и (m,r)=1, а значит m4≡m(mod r), но каждое из них меньше r и больше 0. Следовательно, эти числа равны, т.е. m4≡m1. Таким образом, банкир A получит распоряжение m от вкладчика B.
Пример 11. Пусть банкир A выбирает простые числа 10243 и 57037. Вкладчик B выбирает простые числа 175261 и 817549. Таким образом, R=10243⋅57037=584229991 и r=175261⋅817549=143284455289.
Пусть 381259693 и 3387425143 – открытые ключи банкира и вкладчика соответственно.
Находим секретный ключ банкира из условия:
S⋅T≡1(mod ϕ(R))=381259693⋅T≡1(mod ϕ(584229991)), 0 < T < 584162712.
Откуда T=182938789.
Далее находим секретный ключи вкладчика из условия:
s⋅t≡1(mod ϕ(r))=3387425143⋅t≡1(mod ϕ(143284455289)), 0<t<143283462480
Откуда t=111788667367.
Тогда открытая телефонная книга имеет вид:
A: 584229991, 381259693;
B: 143284455289, 3387425143.
Вкладчик B дает поручение m=134645771 своему банкиру A и замечая, что R<r, шифрует его сначала открытым ключом банкира, а по-том своим секретным ключом:
m1=134645771381259693≡116030491(mod 584229991),
m2=116030491111788667367≡38467700641(mod 143284455289).
Банкир A, получив шифрованную телеграмму m2 = 38467700641, и замечая, что R<r, расшифровывает ее пользуясь сначала открытым клю-чом s вкладчика, а потом своим секретным ключом T:
m3=384677006413387425143≡116030491(mod 143284455289),
m4=116030491182938789≡134645771(mod 584229991).
А так как 134645771<584229991, то банкир делает вывод, что 134645771 и есть распоряжение вкладчика. ♦
Пример 12. А теперь рассмотрим похожий пример, но с большими числами, а именно пусть банкир A выбирает простые числа P=194266889 2225729070919461906823518906642406839052139521251812409738904285205208498221 и Q=1989292945639146568621528992587283360401824603 189390869761855907572637988050133502132777. Вкладчик B выбирает простые числа p=4171849679533027504677776769862406473833407270227 837441302815640277772901915313574263597826351 и q=26699837949011 3760299377713271194014325338065294581596243380200977777465722580 068752870260867081. Таким образом, R=P⋅Q=38645375230172583446953 5189093198734429892732970643499865723525145151914228956042462678 6245033085001726650883132403334350820436786561409950278676776821 404280671468710289717 и r=p⋅q=1113877103911668754551067286547922 6867415108660274804518015606733152527263693060025649201200314681
21
82531702861728994369209436657549958984742232427841226232435332781707353985214366888130251431.
Пусть S=123876132205208335762278423601 и s=178639387836316 4227858270210279 – открытые ключи банкира и вкладчика соответствен но.
Находим секретный ключ банкира из условия:
S⋅T≡1(mod ϕ(R))=123876132205208335762278423601⋅T≡1(mod ϕ(386537 523017258344695351890931987344298927329706434998657235251451519 142289560424626786245033085001726650883132403334350820436786561 409950278676776821404280671468710289717)), 0 < T < 386 45375230172 5834469535189093198734429892732970643499865723525145151914228956 0424624795009418553629428958434677909227471511969776532966940995569056839027388336129999658720. Откуда T=23072659504241153398046 00398128368899935333772682076091680201008526293671242848480878979917823868683915465119790318161456991662717340564119766903857227137940434810257460401.
Далее находим секретный ключ вкладчика из условия:
s⋅t≡1(mod ϕ(r))=1786393878363164227858270210279⋅t≡1(mod ϕ(11138771 0391166875455106728654792268674151086602748045180156067331525272 6369306002564920120031468182531702861728994369209436657549958984 742232427841226232435332781707353985214366888130251431)), 0<t< 111 3877103911668754551067286547922686741510866027480451801560673315252726369306002564920120031197012302533214941190313719395601129159813269667618407541549418714726468729489832039754271558000.
Откуда t=1090565502522891618292699020417534322247203415566437878 802477735053283172357254489347820225363132143002236688057919682349884543238900725792941984463616233718226914091858983777397034416153319.
Вкладчик B дает поручение m=812341242521515435903200431245 123343674951737516 своему банкиру A и замечая, что R<r, шифрует его сначала открытым ключом банкира, а потом своим секретным ключом:
m1=8123412425215154359032004312451233436749517375161238761322052083357 62278423601≡248511822777937811551654127521464327437717812899563233066063749613826855197883217523405222393087208805419033892041887892 6479375920337706284851138975131623170385268669095130 (mod 38653 7523017258344695351890931987344298927329706434998657235251451519 1422895604246267862450330850017266508831324033343508204367865614 09950278676776821404280671468710289717), m2=24851182277793781155 1654127521464327437717812899563233066063749613826855197883217523 4052223930872088054190338920418878926479375920337706284851138975 13162317038526866909513010905655025228916182926990204175343222472034155664378788024777 35053283172357254489347820225363132143002236688057919682349884543238900725792941984463616233718226914091858983777397034416153319≡73489742554402060454691702809631186932817767 8130575024408820168981154372959237321022592300520039883948751936
22
807163535166855427900196918680433211395236453568380666048559059355500695895883062 (mod 11138771039116687545510672865479226867415 1086602748045180156067331525272636930600256492012003146818253170 2861728994369209436657549958984742232427841226232435332781707353 985214366888130251431).
Банкир A, получив шифрованную телеграмму m2 = 7348974255440 2060454691702809631186932817767813057502440882016898115437295923 7321022592300520039883948751936807163535166855427900196918680433211395236453568380666048559059355500695895883062, и замечая, что R<r, расшифровывает ее пользуясь сначала открытым ключом s вклад-чика, а потом своим секретным ключом T:
m3=734897425544020604546917028096311869328177678130575024408820168981154372959237321022592300520039883948751936807163535166855 427900196918680433211395236453568380666048559059355500695895883062178639387836316 4227858270210279≡2485118227779378115516541275214643274377 1781289956323306606374961382685519788321752340522239308720880541 9033892041887892647937592033770628485113897513162317038526866909 5130 (mod 111387710391166875455106728654792268674151086602748045 1801560673315252726369306002564920120031468182531702861728994369 2094366575499589847422324278412262324353327817073539852143668881 30251431), m4=24851182277793781155165412752146432743771781289956 3233066063749613826855197883217523405222393087208805419033892041 8878926479375920337706284851138975131623170385268669095130230726595042411533980460039812836889993533377268207609168020100852629367124284848087897991782386868391546511 9790318161456991662717340564119766903857227137940434810257460401≡812341242521515435903200431245123343674951737516 (mod 386537523017258344 695351890931 9873442989273297064349986572352514515191422895604246267862450330 850017266508831324033343508204367865614099502786767768214042806 71468710289717).
А так как 812341242521515435903200431245123343674951737516 < 38645375230172583446953518909319873442989273297064349986572352 5145151914228956042462678624503308500172665088313240333435082043 6786561409950278676776821404280671468710289717, то банкир делает вывод, что 812341242521515435903200431245123343674951737516 и есть распоряжение вкладчика. ♦
23
5. КРИПТОГРАФИЧЕСКИЕ АЛГОРИТМЫ И ЗАЩИТА ПРОГРАММНОГО ОБЕСПЕЧЕНИЯ
В последнее время защита информации перестала быть задачей только для государственных структур. С нею приходится сталкиваться и многим обычным пользователям персональных компьютеров (ПК). Идя навстречу их пожеланиям, многие производители программного обеспече-ния ст али включать свои продукты функции защиты данных. Однако в большинстве случаев разработчики не ставят своей целью использовать в них сколько-нибудь стойкие алгоритмы. Они считают своей основной за-дачей предоставить пользователю возможность защитить информацию либо от случайного несанкционированного доступа, либо от неквалифи-цированного взломщика. Они, скорее, маскируют информацию, чем реа-лизуют алгоритмы надежного криптографического закрытия. Проде-монстрируем данное утверждение на двух программных продуктах.
Многие пользователи используют в работе Microsoft Word. Эта система предоставляет пользователю большой спектр возможностей для работы с документами, в том числе и шифрования информации. Но вы-бранная в начальных версиях Microsoft Word схема шифрования инфор-мации останавливала лишь начинающего взломщика. Рассмотрим ее по-дробнее.
Из пароля пользователя Word вырабатывает массив длиной 16 байт, называемый гаммой (gamma[0…15]). далее, каждый байт открытого текста (open_text[i]) последовательно складывается побитно (XOR) с бай-том гаммы. В результате получается шифрованный текст (cripto_text[i]), который мы можем видеть в файле с паролем, т.е. шифрование произво-дится согласно формуле:
cripto_text[i]=open_text[i] XOR gamma[i mod 16],
где mod 16 – операция получения остатка от целочисленного деления на 16.
Таким образом, перед нами типичный пример криптографической схемы гаммирования короткой гаммой. Так как каждый шестнадцатый символ шифрованного текста получается прибавлением к символу откры-того текста одного и того же значения гаммы, можно считать, что мы имеем дело с 16-ю простыми заменами. Для каждой из шестнадцати пози-ций символа в тексте подсчитаем таблицу частот его значений, после чего выберем в каждой из них значения символа, встретившегося чаще других.
Самый частый символ в документе Word – это пробел (его значе-ние в кодировке ASCII есть 0х20). Следовательно, самым частым симво-лам в таблице частот соответствуют зашифрованные пробелы. Складывая побитно значения этих символов с 0х20, мы получим все 16 знаков гаммы. Далее, зная гамму, расшифровываем весь текст.
24
На эту очевидную слабость многие обратили внимание. Поэтому фирма Microsoft для версий текстового процессора Microsoft Word, начи-ная с Word 97, полностью изменила алгоритм шифрования файлов, встро-ив в него алгоритмы шифрования RC4 и хеширования VD5.
Теперь посмотрим, как защищаются пароли пользователя в опера-ционных системах (ОС) Microsoft Windows 95 первых версий (до OSR 2).
ОС Microsoft Windows 95 не является многопользовательской и не предоставляет возможность пользователям разделять свои ресурсы. Тем не менее, она запрашивает у пользователя при входе в систему его имя и пароль. Но если он ничего не ответит (нажмет кнопку Esc), ОС все равно разрешит ему работать дальше. Но для того, что бы работать в локальной вычислительной сети (ЛВС), где ПК доступны ресурсы или серверы, не-обходимы соответствующие пароли, причем, возможно, различные. Что-бы пользователю не нужно было их все запоминать, ОС Microsoft Windows 95 записывает пароли для доступа к ресурсам ЛВС в специаль-ный файл с именем "имя_пользователя.pwl". В этом файле данные шифру-ются на том самом пароле, который система запрашивает у пользователя при его входе в систему. Если пароль введен правильно, то в дальнейшем ОС сама подставляет соответствующий пароль при запросе пользователя на доступ к ресурсам или серверам ЛВС.
Данные в *.pwl файлах шифруются следующим образом. Из пароля пользователя по алгоритму шифрования RC4 вырабатывается гамма. Каж-дый пароль на доступ к соответствующему ресурсу вместе с некоторой служебной информацией суммируется побитно с полученной гаммой. То есть каждый раз при шифровании используется одна и та же гамма. Если учесть, что *.pwl файл содержит зашифрованную запись, начинающегося с имени пользователя, дополненного до 20 символов пробелами, то задача вскрытия пароля становится элементарной. Получив первые 20 знаков гаммы, мы можем прочитать любой сохраненный в файле пароль ( учиты-вая то обстоятельство, что редко когда используют пароли длиной более 10 символов).
Следует отметить, что сам по себе алгоритм RC4 довольно слож-ный, и в данном случае использовались слабости не самого алгоритма, а схемы его применения, а именно многократное использование одной и той же гаммы.
25
ЗАКЛЮЧЕНИЕ
За рамками данной работы остались многие вопросы, такие как генерация случайной последовательности, построение больших простых чисел, распознавание простоты наугад взятого числа, содержащего 125 и более цифр в десятичной записи, генерация ключей и т.д и т.п. Всем интересующихся данными вопросами можно порекомендовать обратиться к соответствующей литературе, часть из которой приведена в списке.
26
ЛИТЕРАТУРА
1. Иванов М.А. Криптографические методы защиты информации в компьютерных системах и сетях. – М.: КУДИЦ-ОБРАЗ, 2001, - 368 с.
2. Кон П. Универсальная алгебра. - М.:Мир. - 1968. 351 с
3. Коробейников А. Г. Математические основы криптографии. Учебное пособие. СПб: СПб ГИТМО (ТУ), 2002. 41 с
4. Левин М. Криптография. Руководство пользователя. - М.: Познаватель-ная книга плюс, 2001, - 320 с.
5. Левин Максим. Криптография. Руководство пользователя. - М.: Познавательная книга плюс, 2001, - 320 с.
6. Молдовян А.А., Молдовян Н.А., Советов Б.Я. Криптография. – СПб.: Издательство "Лань", 2001, - 224 с.
7. Смирнов В.И. Курс высшей математики, том III, часть I – М:. Наука, Главная редакция физико-математической литературы, 1974. 324 с.
8. Чмора А.Л. Современная прикладная криптография. 2-е изд. – М.: Гелиос, АРВ, 2002. – 256 с. ил.
27
ОГЛАВЛЕНИЕ
ВВЕДЕНИЕ.......................................................................................................3
1. КЛАССИЧЕСКИЕ ШИФРЫ И ОСНОВНЫЕ ПОНЯТИЯ............5
1.1. ИЗ ИСТОРИИ КРИПТОГРАФИИ……………………………….5
1.2. МАРШРУТНАЯ ТРАНСПОЗИЦИЯ……………………………..6
2. ДИОФАНТОВЫ УРАВНЕНИЯ.........................................................11
2.1. ДИОФАНТОВО УРАВНЕНИЕ ПЕРВОЙ СТЕПЕНИ……….11
2.2. РЕШЕНИЕ СРАВНЕНИЯ ПЕРВОЙ СТЕПЕНИ……………..11
2.3. КРИПТОСИСТЕМА БЕЗ ПЕРЕДАЧИ КЛЮЧЕЙ…………...12
3. КРИПТОСИСТЕМА С ОТКРЫТЫМ КЛЮЧОМ.........................15
3.1. КРАТКАЯ ИСТОРИЯ ВОПРОСА………………………………15
3.2. ОСНОВНЫЕ ПОЛОЖЕНИЯ КРИПТОСИСТЕМЫ С ОТКРЫТЫМ КЛЮЧОМ………………………………………………..15
3.3. НАДЕЖНОСТЬ СИСТЕМЫ С ОТКРЫТЫМ КЛЮЧОМ….17
4. ЭЛЕКТРОННАЯ ПОДПИСЬ..............................................................19
5. КРИПТОГРАФИЧЕСКИЕ АЛГОРИТМЫ И ЗАЩИТА ПРОГРАММНОГО ОБЕСПЕЧЕНИЯ.......................................................23
ЗАКЛЮЧЕНИЕ..............................................................................................25
ЛИТЕРАТУРА................................................................................................26
28
ИСТОРИЯ КАФЕДРЫ
1945-1966 гг. РЛПУ (кафедра радиолокацион-ных приборов и устройств). Решением Советс-кого правительства в августе 1945 г. в ЛИТМО был открыт факультет электроприборостроения.
Приказом по институту от 17 сентября 1945 г. на этом факультете была организована кафедра радиолокационных приборов и устройств, ко-торая стала готовить инженеров, специализирующихся в новых направле-ниях радиоэлектронной техники, таких как радиолокация, радиоуправле-ние, теленаведение и др. Организатором и первым заведующим кафедрой был д.т.н., профессор С. И. Зилитинкевич (до 1951 г.). Выпускникам кафедры присваивалась квалификация инженер-радиомеханик, а с 1956 г. – радиоинженер (специальность 0705).
В разные годы кафедрой заведовали доцент Б.С. Мишин, доцент И.П. Захаров, доцент А.Н. Иванов.
1966–1970 гг. КиПРЭА (кафедра конструирования и производства радиоэлектронной аппаратуры). Каждый учебный план специальности 0705 коренным образом отличался от предыдущих планов радиотехничес-кой специальности своей четко выраженной конструкторско–технологи-ческой направленностью. Оканчивающим институт по этой специальнос-ти присваивалась квалификация инженер–конструктор–технолог РЭА.
Заведовал кафедрой доцент А.Н. Иванов.
1970–1988 гг. КиПЭВА (кафедра конструирования и производства электронной вычислительной аппаратуры). Бурное развитие электронной вычислительной техники и внедрение ее во все отрасли народного хозяй-ства потребовали от отечественной радиоэлектронной промышленности решения новых ответственных задач. Кафедра стала готовить инженеров по специальности 0648. Подготовка проводилась по двум направлениям–автоматизация конструирования ЭВА и технология микроэлектронных устройств ЭВА.
Заведовали кафедрой д.т.н., проф. В.В. Новиков (до 1976 г.), затем проф. Г.А. Петухов.
1988–1997 гг. МАП (кафедра микроэлектроники и автоматизации проектирования). Кафедра выпускала инженеров–конструкторов–техно-логов по микроэлектронике и автоматизации проектирования вычисли-тельных средств (специальность 2205). Выпускники этой кафедры имеют хорошую технологическую подготовку и успешно работают как в произ-водстве полупроводниковых интегральных микросхем, так и при их про-ектировании, используя современные методы автоматизации проектиро-вания. Инженеры специальности 2205 требуются микроэлектронной про-мышленности и предприятиям–разработчикам вычислительных систем.
Кафедрой с 1988 г. по 1992 г. руководил проф. С.А. Арустамов, за-
29
тем снова проф. Г.А. Петухов.
С 1997 г. ПКС (кафедра проектирования компьютерных систем). Кафедра выпускает инженеров по специальности 220500 "Проектирование и технология электронно-вычислительных средств". Область профессио-нальной деятельности выпускников включает в себя проектирование, конструирование и технологию электронных вычислительных средств, от-вечающих целям их функционирования, требованиям надежности, дизай-на и условиям эксплуатации. Кафедра готовит также специалистов по спе-циальности 075400 – "Комплексная защита объектов информатизации". Область профессиональной деятельности включает в себя методы, средства и системы обеспечения защиты всех видов конфиденциальной информации.
С 1996 г. кафедрой заведует доктор технических наук, доцент Ю.А. Гатчин.
За время своего существования кафедра выпустила 4037 инженера, из них по специальности 0705 – 2472 чел. и по специальности 0648 (2205) – 1565 чел. На кафедре защищено 50 кандидатских и 9 докторских диссер-таций.