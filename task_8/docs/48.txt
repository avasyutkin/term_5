МИНИСТЕРСТВО ОБРАЗОВАНИЯ И НАУКИ РОССИЙСКОЙ ФЕДЕРАЦИИ
ФЕДЕРАЛЬНОЕ АГЕНТСТВО ПО ОБРАЗОВАНИЮ
САНКТ-ПЕТЕРБУРГСКИЙ ГОСУДАРСТВЕННЫЙ УНИВЕРСИТЕТ
ИНФОРМАЦИОННЫХ ТЕХНОЛОГИЙ, МЕХАНИКИ И ОПТИКИ
А.А.Ожиганов
ОСНОВЫ КРИПТОАНАЛИЗА СИММЕТРИЧНЫХ
ШИФРОВ
Учебное пособие
Санкт-Петербург
2008
2
Ожиганов А.А. Основы криптоанализа симметричных шифров: учебное посо-
бие. – СПб: СПбГУ ИТМО, 2008. – 44 с.
Целью данного учебного пособия является ознакомление студентов с ос-
новами криптологии. В пособии рассматриваются традиционные (симметрич-
ные) методы шифрования, базирующиеся на шифрах перестановки, шифрах
простой и сложной замены, некоторых их модификаций и комбинаций, а также
вопросы криптоанализа симметричных шифров. Следует отметить, что комби-
нации шифров перестановок и шифров замены образуют все многообразие
применяемых на практике симметричных шифров. Материал пособия разбит на
5 разделов по числу лабораторных работ. В каждом разделе приведены краткие
теоретические сведения и даны методические указания к выполнению соответ-
ствующей лабораторной работы. Все лабораторные работы снабжены примера-
ми выполнения.
Пособие предназначено для студентов, специализирующихся в области
информационных технологий и может быть использовано при подготовке бака-
лавров и магистров по направлению 230100 «Информатика и вычислительная
техника" и инженеров по специальности 230101 «Вычислительные машины,
комплексы, системы и сети».
Рекомендовано Советом факультета Компьютерных технологий и управления
26 февраля 2008 г., протокол № 6
В 2007 году СПбГУ ИТМО стал победителем
конкурса инновационных образовательных программ вузов России на 2007–
2008 годы. Реализация инновационной образовательной программы «Иннова-
ционная система подготовки специалистов нового поколения в области инфор-
мационных и оптических технологий» позволит выйти на качественно новый
уровень подготовки выпускников и удовлетворить возрастающий спрос на спе-
циалистов в информационной, оптической и других высокотехнологичных от-
раслях экономики.
©Санкт-Петербургский государственный университет информационных техно-
логий, механики и оптики, 2008
3
Содержание
Стр.
Указания к выполнению лабораторных работ…………………………… 4
Лабораторная работа № 1.
Моноалфавитные подстановки……………………………………………
5
Лабораторная работа № 2.
Полиалфавитные подстановки…………………………………………….
10
Лабораторная работа № 3.
Многопетлевые полиалфавитные подстановки…………………………..
18
Лабораторная работа № 4.
Метод вероятных слов……………………………………………………..
25
Лабораторная работа № 5.
Перестановки……………………………………………………………….. 30
Литература………………………………………………………………….. 41
Приложение ………………………………………………………………… 42
4
Указания к выполнению лабораторных работ
Лабораторный практикум включает в себя следующие работы:
Название
работы
Исполняемый
файл
Имя файла
с криптограммой
Lab_r_1
Моноалфавитные подста-
новки
Mono.exe
mono_varNN.kr
Lab_r_2
Полиалфавитные подста-
новки
Poly.exe
poly_varNN.kr
Lab_r_3
Многопетлевые полиалфа-
витные подстановки
PolyM.exe
mpoly_varNN.kr
Lab_r_4
Метод вероятных слов
(шифр Виженера)
Word.exe
word_vNN.kr
Lab_r_4
Метод вероятных слов
(«бегущий ключ»)
Word.exe
word_rkNN.kr
Lab_r_5
Простая перестановка
Trans.exe
trans_simpleNN.kr
Lab_r_5
Перестановки по путям Га-
мильтона
Trans.exe
trans_gamNN.kr
Lab_r_5
Табличные перестановки
Trans.exe
trans_tabNN.kr
По каждой выполненной работе необходимо составить и сдать отчет, ко-
торый должен включать себя:
1. Номер варианта.
2. Расшифрованный текст.
3. Протокол анализа.
При запуске каждой лабораторной работы Вам будет предложено вы-
брать файл с криптограммой. Имена файлов имеют вид: "*NN.*", где NN -номер
варианта. Номер Вашего варианта должен совпадать с Вашим номером в списке
группы, который можно узнать на сайте кафедры ВТ: cis.ifmo.ru.
Обратить особое внимание – во всех лабораторных работах использо-
вана мощность алфавита L=33, А-0, Б-1,…, Я-31, пробел – 32, буква Ё – отсут-
ствует.
В приложении находятся графы, необходимые для выполнения лабора-
торной работы 5 (перестановки по путям Гамильтона ).
Лабораторные работы по желанию студента могут быть выполне-
ны дома.
5
Лабораторная работа № 1
“Моноалфавитные подстановки”
Задание
Используя частотный анализ, дешифровать криптограмму, зашифрован-
ную методом моноалфавитных подстановок.
Теория
Шифр моноалфавитной подстановки - это один из самых древних шифров
на Земле. Частным случаем этого шифра для шифровки секретных сообщений
пользовался еще Гай Юлий Цезарь.
Первая лабораторная работа посвящена изучению моноалфавитных под-
становок и их криптоанализа. Рассмотрим, как используют этот шифр.
Прежде всего, выбирается нормативный алфавит, т.е. набор символов,
которые будут использоваться при составлении сообщений, требующих за-
шифровки. Допустим, это будут прописные буквы русского алфавита (исклю-
чая буквы “Ё” и “Ъ”) и пробел. Таким образом, наш нормативный алфавит со-
стоит из 32 символов. Затем выбирается алфавит шифрования и устанавлива-
ется взаимно однозначное соответствие между символами нормативного алфа-
вита и символами алфавита шифрования. Алфавит шифрования может состоять
из произвольных символов, в том числе и из символов нормативного алфавита.
Чтобы зашифровать исходное сообщение, каждый символ открытого тек-
ста заменяется соответствующим ему символом алфавита шифрования (табл.
1.1).
Таблица 1.1
Нормативный
алфавит А Б В Г Д Е Ж З И Й К Л ...
Алфавит
шифрования Н К А Л З Т П И О Р Б Г ...
Зашифруем, например, слово “звезда”. Если использовать алфавиты, при-
веденные в табл. 1.1, то получится следующее:
Исходное сообщение: З В Е З Д А
Шифрованный текст: И А Т И З Н
Метод моноалфавитной подстановки можно представить как числовые
преобразования символов исходного текста. Для этого каждой букве норма-
тивного алфавита ставится в соответствие некоторое число, называемое число-
вым эквивалентом этой буквы. Например, для букв русского алфавита и про-
бела это выглядит так, как показано в табл. 1.2.
Моноалфавитные подстановки можно описать выражением:
6
Ei=( Mi + Si ) mod L , (1.1)
где Ei, Mi - числовые эквиваленты символов алфавита шифрования и норма-
тивного алфавита соответственно, Si - коэффициент сдвига, L - мощность алфа-
вита.
Таблица 1.2
Нормативный
алфавит А Б В Г Д Е Ж З И Й К Л М Н О П
Числовые
эквиваленты 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15
Нормативный
алфавит Р С Т У Ф Х Ц Ч Ш Щ Ы Ь Э Ю Я “_“
Числовые
эквиваленты 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31
Шифр Цезаря
Простейшим примером моноалфавитных подстановок является шифр Це-
заря. В этом шифре каждый символ открытого текста заменяется третьим после
него символом в алфавите, замкнутом в кольцо, т.е. после пробела следует бук-
ва “А”. Таким образом, шифр Цезаря описывается так:
Ei=( Mi + S ) mod L , (1.2)
где S - коэффициент сдвига, одинаковый для всех символов.
Цезарь использовал величину сдвига S=3, но, конечно, можно использо-
вать любое целое S: 1 ≤ S ≤ (L-1).
Зашифруем, например, текст “ШИФР_ЦЕЗАРЯ”, используя коэффици-
ент сдвига S = 2.
Открытый текст: Ш И Ф Р _ Ц Е З А Р Я
Шифрованный текст: Ы К Ц Т Б Ш З Й В Т А
Частотный анализ
Все естественные языки имеют характерное частотное распределение
символов. Например, буква “О” - встречается в русском языке чаще других, а
буква “Ф” - самая редкая (см. табл. 1.3).
Моноалфавитные подстановки обладают важным свойством: они не на-
рушают частот появления символов, характерных для данного языка. Это по-
зволяет криптоаналитику легко получить открытый текст при помощи частот-
ного анализа. Для этого нужно сопоставить частоты появления символов шифра
с вероятностями появления букв используемого алфавита (в данном случае рус-
ского). После этого наиболее частые символы криптограммы заменяются наи-
более вероятными символами алфавита, остальные замены производятся на ос-
нове вероятных слов и знания синтаксических правил используемого языка.
7
Вероятности встречаемости букв русского языка
Таблица 1.3
Символ Вероятность Символ Вероятность Символ Вероятность
пробел 0.175 К 0.028 Ч 0.012
О 0.089 М 0.026 Й 0.010
Е 0.072 Д 0.025 Х 0.009
А 0.062 П 0.023 Ж 0.007
И 0.062 У 0.021 Ю 0.006
Н 0.053 Я 0.018 Ш 0.006
Т 0.053 Ы 0.016 Ц 0.004
С 0.045 З 0.016 Щ 0.003
Р 0.040 Ь 0.014 Э 0.003
В 0.038 Б 0.014 Ф 0.002
Л 0.035 Г 0.013
Выполнение работы
1. Запустить на выполнение файл mono.exe.
2. Выбрать в меню пункт Файл →Открыть.
3. Выбрать в появившемся списке свой вариант.
4. Теперь экран выглядит следующим образом
8
Далее Вы можете:
o просматривать на экране таблицу частот встречаемости сим-
волов криптограммы и вероятностей русского языка. Про-
крутка статистики по клавише Shift+вверх, Shift+вниз;
o заменить символ криптограммы на символ нормативного ал-
фавита (прописные буквы русского языка и пробел). Про-
крутка текста по клавише вверх, вниз;
o получить помощь (по клавише F1);
o выйти в главное меню (по клавише Alt).
5. Пользуясь описанными возможностями, расшифруйте криптограм-
му. Результат Вашей работы покажите преподавателю.
Примечание:
Если Вы ошибочно заменили какой-либо символ криптограммы и хотите
это исправить, замените этот символ на служебный символ “-”.
Чтобы сохранить результаты своей работы выберите пункт меню
Файл→Сохранить и введите имя файла.
Содержание отчета
1. Титульный лист (с номером Вашего варианта).
2. Цель работы.
3. Расшифрованный исходный текст.
4. Ключ (в данном случае ключом является таблица замен).
5. Краткий протокол криптоанализа.
Пример дешифрации криптограммы, зашифрованной
моноалфавитной подстановкой
Текст криптограммы:
КЩРНСЙШЩХДТАРБУТЦПФЮСНЫАШЙАЬЙЛБАНСЙСТНСТОБНДЩМЩАЙШЙЖТЛЙАСБДНСЙАШЩА
СЩЖ
------------------------------------------------------------------
---
ЕДЩАБНЖТАЩШАРЩНСЙСЩОШЩАРЖТШШИГ
------------------------------
В таблице 1.4 находятся результаты статистического анализа данной
криптограммы. Сюда включены значения частот букв русского языка, а также
частоты встречаемости символов для данной криптограммы.
Исходя из полученной статистики, сделаем первые замены: “А”-“ ”, “Щ”-
“О”.
Реакция программы:
КЩРНСЙШЩХДТАРБУТЦПФЮСНЫАШЙАЬЙЛБАНСЙСТНСТОБНДЩМЩАЙШЙЖТЛЙАСБДНСЙА
-О-----О--- ----------- -- ---- ------------О-О ------- ------
ШЩАСЩЖЕДЩАБНЖТАЩШАРЩНСЙСЩОШЩАРЖТШШИГ
-О -О---О ---- О- -О----О--О -------
Обратим внимание на 8-ое и 12-ое слова: “ШЩ” и “ЩШ”. Т.к. мы пред-
положили, что “Щ” заменяет “О” в открытом тексте, то буква “Ш” может быть
только буквой “Н” или буквой “Т”. Попробуем сделать замену “Ш” - “Н”.
9
Таблица 1.4
Криптограмма Русский язык
Символ Частота Буква Вероятность
А 0.121 Пробел 0.175
Щ 0.111 о 0.090
С 0.101 е 0.072
Й 0.091 а 0.062
Н 0.081 и 0.062
Ш 0.081 н 0.053
Т 0.071 т 0.053
Б 0.051 с 0.045
Р 0.040 р 0.040
Д 0.040 в 0.038
Ж 0.040 л 0.035
и т.д. и т.д.
Можно предположить, что 5-ое слово - оканчивается на “ОГО” и являет-
ся, стало быть, прилагательным или причастием.
Замена “М” - “Г”.
Слово, следующее за прилагательным или причастием, скорее всего явля-
ется существительным и оканчивается на “А”. Отсюда следует замена “Й” -
“А”.
Теперь имеем следующую картину:
КЩРНСЙШЩХДТАРБУТЦПФЮСНЫАШЙАЬЙЛБАНСЙСТНСТОБНДЩМЩАЙШЙЖТЛЙАСБДНСЙА
-О---АНО--- ----------- НА -А-- --А---------ОГО АНА---А -----А
ШЩАСЩЖЕДЩАБНЖТАЩШАРЩНСЙСЩОШЩАРЖТШШИГ
НО -О---О ---- ОН -О--А-О-НО ---НН--
Четвертым словом является предлог “НА”, поэтому следующее слово
оканчивается, скорее всего, на букву “Е”.
Заменяем “Б” - “Е”.
Шестое слово имеет вид “АНА---А”. Это очень похоже на слово
“АНАЛИЗА”. Заменим “Ж” - “Л”, “Т” - “И”, “Л” - “З”.
Реакция программы:
КЩРНСЙШЩХДТАРБУТЦПФЮСНЫАШЙАЬЙЛБАНСЙСТНСТОБНДЩМЩАЙШЙЖТЛЙАСБДНСЙА
-О---АНО--И -Е-И------- НА -АЗЕ --А-И--И-Е--ОГО АНАЛИЗА -Е---А
ШЩАСЩЖЕДЩАБНЖТАЩШАРЩНСЙСЩОШЩАРЖТШШИГ
НО -ОЛ--О Е-ЛИ ОН -О--А-О-НО -ЛИНН—
Словосочетание “НА -АЗЕ” означает, видимо, слова “НА БАЗЕ”, слово
“Е-ЛИ” является словом “ЕСЛИ”, а последнее слово криптограммы “-
ЛИНН--” похоже на слово “ДЛИННЫЙ”. Сделаем соответствующие замены
: “Ь” - “Б”, “Н” - “С”, “Р” - “Д”, “И” - “Ы”, “Г” - “Й”.
Реакция программы:
КЩРНСЙШЩХДТАРБУТЦПФЮСНЫАШЙАЬЙЛБАНСЙСТНСТОБНДЩМЩАЙШЙЖТЛЙАСБДНСЙА
-ОДС-АНО--И ДЕ-И-----С- НА БАЗЕ С-А-ИС-И-ЕС-ОГО АНАЛИЗА -Е-С-А
ШЩАСЩЖЕДЩАБНЖТАЩШАРЩНСЙСЩОШЩАРЖТШШИГ
НО -ОЛ--О ЕСЛИ ОН ДОС-А-О-НО ДЛИННЫЙ
Слово “С-А-ИС-И-ЕС-ОГО” (АНАЛИЗА) похоже на слово
1 0
“СТАТИСТИЧЕСКОГО”. Замены: “С” - “Т”, “О” - “Ч”, “Д” - “К”.
Реакция программы:
КЩРНСЙШЩХДТАРБУТЦПФЮСНЫАШЙАЬЙЛБАНСЙСТНСТОБНДЩМЩАЙШЙЖТЛЙАСБДНСЙА
-ОДСТАНО-КИ ДЕ-И----ТС- НА БАЗЕ СТАТИСТИЧЕСКОГО АНАЛИЗА ТЕКСТА
ШЩАСЩЖЕДЩАБНЖТАЩШАРЩНСЙСЩОШЩАРЖТШШИГ
НО ТОЛ-КО ЕСЛИ ОН ДОСТАТОЧНО ДЛИННЫЙ
Последующие замены не вызывают затруднений.
Исходный текст:
ПОДСТАНОВКИ ДЕШИФРУЮТСЯ НА БАЗЕ СТАТИСТИЧЕСКОГО
АНАЛИЗА ТЕКСТА НО ТОЛЬКО ЕСЛИ ОН ДОСТАТОЧНО ДЛИННЫЙ
В табл. 1.5 приведены замены (ключ) между символами нормативного
алфавита и символами алфавита шифрования. Прочерки в таблице соответст-
вуют буквам, ни разу не встретившимся в исходном тексте криптограммы.
Таблица 1.5
Нормативный
алфавит ( M ) А Б В Г Д Е Ж З И Й К Л М Н О П
Алфавит
шифрования(E) Й Ь Х М Р Б - Л Т Г Д Ж - Ш Щ К
Нормативный
алфавит (M) Р С Т У Ф Х Ц Ч Ш Щ Ы Ь Э Ю Я “_“
Алфавит
шифрования (E) П Н С Ф Ц - - О У - И Е - Ю Ы А
Лабораторная работа № 2
“Полиалфавитные подстановки”
Задание
Используя индекс соответствия и частотный анализ, дешифровать крип-
тограмму, зашифрованную шифром Вижинера.
Теория
В случае моноалфавитных подстановок используется только один алфа-
вит шифрования. Существуют шифры, где используется целый набор алфави-
тов шифрования. Такие шифры называются полиалфавитными и позволяют, в
отличие от моноалфавитных подстановок, скрыть естественную частоту появ-
ления символов в тексте.
Простая полиалфавитная подстановка (или шифр Вижинера) последова-
тельно и циклически меняет используемые алфавиты шифрования. Число ис-
пользуемых алфавитов называется периодом шифра. Для шифрования исполь-
зуется ключ - слово или бессмысленный набор символов нормативного алфави-
та. Каждая буква ключа определяет свой алфавит шифрования, который полу-
1 1
чается из нормативного циклическим сдвигом на количество символов, равное
числовому эквиваленту буквы ключа. Очевидно, что длина ключа равна перио-
ду шифра.
Чтобы зашифровать сообщение шифром Вижинера, поступают следую-
щим образом. Под каждой буквой открытого текста помещается буква ключа.
Ключ циклически повторяется необходимое число раз. Чтобы вычислить чи-
словой эквивалент буквы шифртекста, числовой эквивалент буквы ключа скла-
дывается по модулю L с числовым эквивалентом буквы открытого текста, где L
- мощность нормативного алфавита. Т.е. шифр Вижинера описывается сле-
дующим выражением:
Ei = ( Mi + Ki( mod U) ) mod L, ( 2.1 )
где Ei, Mi - числовые эквиваленты символов криптограммы и открытого тек-
ста соответственно, Ki(mod U) - числовой эквивалент буквы ключа, L - мощность
нормативного алфавита, U - длина ключа или период шифра.
Буквы ключа определяют величину смещения символов криптограммы
относительно символов открытого текста.
Зашифруем, например, текст “полиалфавитная_подстановка” ключом
“краб”. Будем использовать алфавит, приведенный в табл. 1.2. Процесс шифро-
вания приведен в табл. 2.1.
Таблица 2.1
П 15 К 10 (15+10)mod 32 25 Щ
О 14 Р 16 (14+16)mod 32 30 Я
Л 11 А 0 (11+0) mod 32 11 Л
И 8 Б 1 (8 + 1)mod 32 9 Й
А 0 К 10 (0+10) mod 32 10 К
Л 11 Р 16 (11+16)mod 32 27 Ь
Ф 20 А 0 (20+0) mod 32 20 Ф
А 0 Б 1 (0+1) mod 32 1 Б
В 2 К 10 (2+10) mod 32 12 М
И 8 Р 16 (8+16) mod 32 24 Ш
Т 18 А 0 (18+0) mod 32 18 Т
Н 13 Б 1 (13+1) mod 32 14 О
А 0 К 10 (0+10) mod 32 10 К
Я 30 Р 16 (30+16) mod 32 14 О
_ 31 А 0 (31+0) mod 32 31 _
П 15 Б 1 (15+1) mod 32 16 Р
О 14 К 10 (14+10) mod 32 24 Ш
Д 4 Р 16 (4+16) mod 32 20 Ф
С 17 А 0 (17+0) mod 32 17 С
Т 18 Б 1 (18+1) mod 32 19 У
А 0 К 10 (0+10) mod 32 10 К
Н 13 Р 16 (13+16) mod 32 29 Ю
О 14 А 0 (14+0) mod 32 14 О
В 2 Б 1 (2+1) mod 32 3 Г
К 10 К 10 (10+10) mod 32 20 Ф
А 0 Р 16 (0+16) mod 32 16 Р
1 2
В результате получилась криптограмма:
“ЩЯЛЙКЬФБМШТОКО_Р ШФСУКЮОГФР”.
Описанный в работе 1 шифр Цезаря является частным случаем шифра
Вижинера с периодом, равным единице.
Криптоанализ полиалфавитных подстановок
Полиалфавитные подстановки маскируют естественную частоту появле-
ния символов в шифруемом тексте. Поэтому полиалфавитные подстановки зна-
чительно надежнее моноалфавитных. Однако метод частотного анализа приме-
ним и здесь. Разобъем криптограмму на блоки так, тобы число символов в каж-
дом блоке равнялось длине ключа. Символы криптограммы, занимающие оди-
наковое положение в блоках, имеют одинаковое смещение относительно сим-
волов открытого текста, т.е. при их шифровании используется один и тот же
алфавит шифрования. Например, в приведенном выше примере 1-ая, 5-ая, 9-ая,
... , ( 4i + 1)- ая , ... буквы имеют смещение, равное десяти - числовому эквива-
ленту 1-ой буквы ключа “К”.
Описанное свойство дает возможность применить частотный анализ от-
дельно для каждой группы символов криптограммы, соответствующих опреде-
ленной букве ключа. Такие группы символов криптограмм называют группой
периода. Понятно, что число групп периода равно длине ключа.
Частотный анализ по группам ключа позволяет криптоаналитику узнать
величину смещения для каждой группы, т.е. ключ шифрования.
Подобный метод криптоанализа применим, если число символов в крип-
тограмме превышает число 20U, где U - длина ключа.
Индекс соответствия
Чтобы иметь возможность применить частотный анализ к группам перио-
да, криптоаналитик должен прежде высказать предположение о том, чему мо-
жет быть равен период. Для этой цели используется индекс соответствия
(ИС).
ИС представляет собой оценку суммы квадратов вероятностей каждого
символа. Теоретически ожидаемые значения ИС вычисляются по формуле
, (2.2)
где , N - число символов в криптограмме, m - длина ключа, pi -
вероятность встречаемости i-ой буквы алфавита, L - мощность алфавита.
Чтобы вычислить значение ИС для конкретной криптограммы, использу-
ют следующую формулу:
(2.3)
где N - число символов в криптограмме, fi -сколько раз i-ая буква встретилась
в криптограмме.
Существуют таблицы, содержащие теоретически ожидаемые значения
1 3
ИС для разных длин ключа. Ниже представлена табл. 2.2 для алфавита, состоя-
щего из русских букв и пробела. Криптоаналитик, рассчитав ИС анализируемой
им криптограммы, может определить ее период по такой таблице.
Однако из-за погрешностей в оценке ИС, его использование становится
неэффективным при длине ключа большей, чем десять символов.
Таблица 2.2
Период Min
значение ИС
Max
значение ИС
Среднее
знач. ИС
1 0.0550 0.0580
2 0.0395 0.0550 0.0460
3 0.0355 0.0440 0.0400
4 0.0350 0.0405 0.0375
5 0.0335 0.0390 0.0360
6 0.0325 0.0385 0.0352
7 0.0315 0.0365 0.0345
более 0.0350
Выполнение работы
1. Запустить на выполнение файл poly.exe.
2. Выбрать в меню пункт Файл → Открыть.
3. Выбрать в появившемся списке свой вариант.
4. Теперь экран выглядит следующим образом
5. Задайте длину ключа. Для этого вызовите таблицу индекса соответст-
вия. В этой таблице содержатся теоретически ожидаемые значения ИС
для различных длин ключа и значение ИС, подсчитанное для конкрет-
1 4
ной криптограммы. На основании значения ИС выберете длину ключа.
Можно использовать два метода:
o первый метод Фридмана (клавиша F5);
o второй метод Фридмана (клавиша F6).
6. На основе частотного анализа для каждой группы периода осущест-
вить подстановку (одну). Номер анализируемой буквы ключа (т.е.
номер текущей группы периода) указан в заголовке окна статисти-
ки. Номер текущей группы периода легко изменить, воспользовав-
шись клавишами Left и Right. Существует возможность изменить
букву прямо в ключе. Для этого воспользуйтесь клавишей F8.
7. Проанализируйте полученные текст и ключ. При неудовлетвори-
тельном результате измените подстановки в некоторых группах пе-
риода. При неудаче изменить длину ключа.
8. Расшифруйте криптограмму, продемонстрируйте преподавателю
результат.
Примечание:
Чтобы сохранить результаты своей работы выберите пункт меню
Файл→Сохранить и введите имя файла.
Содержание отчета
1. Титульный лист (с номером Вашего варианта).
2. Цель работы.
3. Расшифрованный исходный текст.
4. Ключ.
5. Краткий протокол криптоанализа.
Пример дешифрации криптограммы, зашифрованной
полиалфавитной подстановкой
Текст криптограммы:
ОНГПРЛЩГЮЧМУРМ-ЬТЯК-ОЗЫЬЫДЫРЫЛЗАСХСКЗВМИЮЬРТ-ОЗАПЧФЗХШМЬК-У-
------------------------------------------------------------
ТИЭШБЩЦРТ--ЛБЗМЬЗЯКПСКСХ-ЮК-З-ЫНВПНЦЫРЛЫЧЗАПРОГЬЙЧМЩРЧОГРРМ-
------------------------------------------------------------
РЦЮП-ОЩЦЙУТНРХЕПУЩ
------------------
Для данной криптограммы теоретически ожидаемые значения ИС при
разных длинах ключа приведены в табл. 2.3.
Таблица 2.3
Период Min значение ИС Max значение ИС Среднее знач. ИС
1 0.0550 0.0580
2 0.0395 0.0550 0.0460
3 0.0355 0.0440 0.0400
4 0.0350 0.0405 0.0375
5 0.0335 0.0390 0.0360
6 0.0325 0.0385 0.0352
7 0.0315 0.0365 0.0345
более 0.0350
1 5
Прежде всего необходимо определить период шифра. Это можно сделать
с помощью ИС. Для данной криптограммы ИС = 0.0384 .
Исходя из таблицы, возможные значения длины ключа равны 4 или 5.
Предположим, длина ключа равна 4.
Теперь проведем анализ по группам периода.
Статистика относительно 1-ой буквы ключа приведена в табл. 2.4.
Таблица 2.4
Криптограмма Русский язык
Символ Частота Буква Вероятность
Р 0.200 Пробел 0.175
Т 0.086 о 0.090
Ы 0.086 е 0.072
З 0.086 а 0.062
- 0.086 и 0.062
О 0.057 н 0.053
и т.д. и т.д.
Сделаем в первой группе периода замену “Р”-“ ”.
Поскольку для шифра Вижинера все символы, принадлежащие одной
группе периода, имеют одинаковый сдвиг относительно исходного алафавита,
программа вычисляет этот сдвиг, исходя из сделанной нами замены, как (“Р” -
“ ”) mod32=17(“С”) и производит замены для остальных букв данной группы
периода.
ОНГПРЛЩГЮЧМУРМ-ЬТЯК-ОЗЫЬЫДЫРЫЛЗАСХСКЗВМИЮЬРТ-ОЗАПЧФЗХШМЬК-У-
Ю--- ---М--- ---Б---Ю---К---К---А---Ц---М---О---Я---Д---Щ---
ТИЭШБЩЦРТ--ЛБЗМЬЗЯКПСКСХ-ЮК-З-ЫНВПНЦЫРЛЫЧЗАПРОГЬЙЧМЩРЧОГРРМ-
Б---Р---Б---Р---Ц---А---О---Ц---С---К---Ж--- ---Ш--- --- ---
РЦЮП-ОЩЦЙУТНРХЕПУЩ
---О---Ш--- ---В-
Проанализируем вторую группу периода. Статистика относительно 2-ой
буквы ключа приведена в табл. 2.5.
Таблица 2.5
Криптограмма Русский язык
Символ Частота Буква Вероятность
Ч 0.114 Пробел 0.175
З 0.086 о 0.090
О 0.086 е 0.072
- 0.086 а 0.062
Л 0.057 и 0.062
Я 0.057 н 0.053
и т.д. и т.д.
Заменим “Ч”-“ ”.Но при таких заменах текст должен начинаться с “ЮХ”,
что маловероятно. Попробуем другие варианты замен.
Как видно из статистики, для первой группы периода самые частые сим-
1 6
волы это “Р”, “Т”, “Ы”, “З” и “ ”. А для второй группы периода самые частые
символы “Ч”, “З”, “О”, “ ” и “Л”.
Попытаемся подобрать такие замены для первой и второй групп периода,
чтобы в тексте и в ключе не встречалось недопустимых диграмм для русского
языка.
Замена в первой группе “Т” на “ ” не годится,т.к. тогда текст должен на-
чинаться с “Ы”.
Замена в первой группе “З” на “ ”,а во второй группе “Ч” на “ ” не го-
дится,т.к. тогда текст начинается с “ЖХ”.
Замена в первой группе “З” на “ ”,а во второй группе “З” на “ ” не го-
дится, т.к. тогда ключ начинается с “ИИ”.
И т.д., проверив всевозможные замены в первой и во второй группах пе-
риода, и, делая замены в других группах для сомнительных случаев, приходим
к выводу, что наша гипотеза о длине ключа в 4 символа неверна.
Предположим, длина ключа равна 5.
Результаты статистического анализа относительно первой буквы ключа
приведены в табл. 2.6.
Таблица 2.6
Криптограмма Русский язык
Символ Частота Буква Вероятность
О 0.179 Пробел 0.175
Ь 0.107 о 0.090
М 0.071 е 0.072
Ю 0.071 а 0.062
Т 0.071 и 0.062
Л 0.036 н 0.053
и т.д. и т.д.
Сделаем в первой группе периода замену “О”-“ ”. Но тогда текст начина-
ется с пробела.
Сделаем замену “Ь”-“ ”. Но тогда ключ начинается с “Ы”.
Сделаем замену “М”-“ ”.
Результаты статистического анализа относительно второй буквы ключа
приведены в табл. 2.7.
Таблица 2.7
Криптограмма Русский язык
Символ Частота Буква Вероятность
З 0.214 Пробел 0.175
Н 0.107 о 0.090
Щ 0.107 е 0.072
К 0.107 а 0.062
У 0.071 и 0.062
Ы 0.071 н 0.053
и т.д. и т.д.
1 7
Сделаем во второй группе периода замену “З”-“ ”.
ОНГПРЛЩГЮЧМУРМ-ЬТЯК-ОЗЫЬЫДЫРЫЛЗАСХСКЗВМИЮЬРТ-ОЗАПЧФЗХШМЬК-У-
БЕ---ЯС--- Л---НК---Б ---ЧУ---ЬШ---Ю ---РТ---Б ---З ---НВ---
ТИЭШБЩЦРТ--ЛБЗМЬЗЯКПСКСХ-ЮК-З-ЫНВПНЦЫРЛЫЧЗАПРОГЬЙЧМЩРЧОГРРМ-
ЕА---МО---ТГ---Н ---ДВ---РВ---ОЕ---ЙУ---К ---БЫ--- С---ЦИ---
РЦЮП-ОЩЦЙУТНРХЕПУЩ
ГО---БС---ЕЕ---ВЛ-
Результаты статистического анализа относительно третьей буквы ключа
приведены в табл. 2.8.
Таблица 2.8
Криптограмма Русский язык
Символ Частота Буква Вероятность
Р 0.286 Пробел 0.175
Г 0.071 о 0.090
Я 0.071 е 0.072
С 0.071 а 0.062
В 0.071 и 0.062
А 0.071 н 0.053
и т.д. и т.д.
Сделаем в третьей группе периода замену “р”-“ ”.
Результаты статистического анализа относительно четвертой буквы клю-
ча приведены в табл. 2.9.
Таблица 2.9
Криптограмма Русский язык
Символ Частота Буква Вероятность
П 0.185 Пробел 0.175
М 0.111 о 0.090
Х 0.111 е 0.072
К 0.074 а 0.062
Т 0.074 и 0.062
Ш 0.074 н 0.053
и т.д. и т.д.
Сделаем в четвертой группе периода замену “П”-“ ”.
Результаты статистического анализа относительно пятой буквы ключа
приведены в табл. 2.10.
Сделаем в пятой группе периода замену “-”-“ ”.
Получили:
ОНГПРЛЩГЮЧМУРМ-ЬТЯК-ОЗЫЬЫДЫРЫЛЗАСХСКЗВМИЮЬРТ-ОЗАПЧФЗХШМЬК-У-
БЕТ РЯСТНЧ Л Э НКНЬ Б ККЫЧУ ЛЛЬШАЕСЮ СЭИРТ В Б П ЧЗ ДИМНВОГ
ТИЭШБЩЦРТ--ЛБЗМЬЗЯКПСКСХ-ЮК-З-ЫНВПНЦЫРЛЫЧЗАПРОГЬЙЧМЩРЧОГРРМ-
ЕАЛИБМО В ТГРЧМН НЬПДВАЕ РВОЧ ОЕС НЙУ ЫЫК П РБЫЙЩЧ С ЗОЦИ Э
РЦЮП-ОЩЦЙУТНРХЕПУЩ
ГОМ БСЕЩУЕЕ ЕЕВЛИ
1 8
Таблица 2.10
Криптограмма Русский язык
Символ Частота Буква Вероятность
- 0.333 Пробел 0.175
Ч 0.111 о 0.090
Р 0.074 е 0.072
Ы 0.074 а 0.062
М 0.074 и 0.062
Л 0.037 н 0.053
и т.д. и т.д.
Т.к. отрыв по частоте самых частых символов в первой и четвертой груп-
пах периода менее значителен, чем в остальных группах, попробуем изменить
подстановки именно в них.
Заменим в первой группе “Ю” на “ ”. Безуспешно.
Заменим в первой группе “Т” на “ ”. Безуспешно.
Заменим в первой группе “Л” на “ ”. Обратим внимание на ключ
“МИСРА”. Возможно, это искаженное “МИСКА”. Изменим соответствующим
образом ключ:
ОНГПРЛЩГЮЧМУРМ-ЬТЯК-ОЗЫЬЫДЫРЫЛЗАСХСКЗВМИЮЬРТ-ОЗАПЧФЗХШМЬК-У-
ВЕТЕР СТУЧАЛ В ОКНА В КРЫШУ СЛЬШАЛСЯ СВИСТ И В ПЕЧИ ДОМОВОЙ
ТИЭШБЩЦРТ--ЛБЗМЬЗЯКПСКСХ-ЮК-З-ЫНВПНЦЫРЛЫЧЗАПРОГЬЙЧМЩРЧОГРРМ-
ЖАЛОБНО И УГРЮМО НАПЕВАЛ СВОЮ ПЕСЕНКУ БЫЛ ПЕРВЫЙ ЧАС НОЧИ В
РЦЮП-ОЩЦЙУТНРХЕПУЩ
ДОМЕ ВСЕ УЖЕ ЛЕГЛИ
Криптограмма расшифрована.
Исходный текст:
ВЕТЕР СТУЧАЛ В ОКНА В КРЫШУ СЛЫШАЛСЯ СВИСТ И В ПЕЧИ
ДОМОВОЙ ЖАЛОБНО И УГРЮМО НАПЕВАЛ СВОЮ ПЕСЕНКУ БЫЛ ПЕРВЫЙ
ЧАС НОЧИ В ДОМЕ ВСЕ УЖЕ ЛЕГЛИ
Ключ: МИСКА .
Лабораторная работа № 3
“Многопетлевые полиалфавитные подстановки”
Задание
Дешифровать криптограмму, зашифрованную многопетлевым шифром.
Определить период шифра предлагаемой криптограммы. Получить составной
ключ, вычислить первичные ключи.
Теория
Многопетлевая полиалфавитная подстановка является наиболее интерес-
ным подстановочным шифром. В шифре Виженера при шифровании использу-
ется только один ключ. В многопетлевом шифре используется не один, а не-
1 9
сколько ключей шифрования. Их называют петлевыми или первичными клю-
чами.
Многопетлевой шифр описывается формулой
Ei=(Mi+K1,i mod U1+...+Kj,i mod Uj+...+KG,i mod UG)mod L (3.1)
где Ei - i-ый символ криптограммы, Mi - i-ый символ открытого текста, L -
мощность исходного алфавита, G - число петель шифра, Uj - длина j-ого пер-
вичного ключа, N - число символов в криптограмме, 1≤ i≤ N; 1≤j≤ G.
В качестве первичных ключей используются осмысленные слова русско-
го языка. Последовательное и циклическое применение первичных ключей дает
в итоге составной ключ.
Период составного ключа равен наименьшему общему кратному длин
всех первичных ключей. Если длины первичных ключей являются взаимно
простыми числами, то длина составного ключа равна их произведению и бу-
дет наибольшей.
Составной ключ равен сумме первичных ключей. В отличие от шифра
Виженера составной ключ многопетлевых подстановок не является осмыслен-
ным словом и имеет гораздо больший период. Благодаря этому многопетлевые
подстановки надежнее всех уже рассмотренных нами шифров.
Пусть, например, исходный текст будет “ЭТО СТРОКА ОТКРЫТОГО
ИСХОДНОГО ТЕКСТА”, а в качестве первичных ключей будем использовать
слова “ПЕРВЫЙ” и “БУКВА”. Процесс шифрования отражен в таблице 3.1.
В результате шифрования получаем зашифрованный текст:
“МКИГЛЭТЮЭВЫКЛСАЮ БФУРЮХАЮКРЫ ЧПК ОЛЭВ”.
Для нашего примера L=32, N = 37, G=2, U1 = 6, U2 = 5. Длина составного
ключа 30 символов.
Шифр Виженера является частным случаем многопетлевой постановки.
Таким образом, выражение 3.1 наиболее полно описывает шифры замены и, как
частный случай, включает в себя выражения 1.2 и 2.1 для шифров Виженера и
Цезаря.
Определение периода шифра
Метод Казиски
Криптоанализ многопетлевых шифров проводится, как и в случае шифра
Виженера, в два этапа. Во-первых, необходимо определить период шифра (т.е.
длину составного ключа) и, во-вторых, провести частотный анализ по группам
периода.
Т.к. период обычно довольно большой (больше 10 символов), применение
ИС не приведет к успеху. Однако существует и другой метод определения дли-
ны ключа. Это метод Казиски.
Суть его заключается в следующем. В открытом тексте сообщения встре-
чаются одинаковые сочетания символов. В процессе криптографического пре-
образования может так случиться, что эти одинаковые сочетания зашифрованы
одинаковой частью ключа. В результате и в криптограмме появиться одинако-
2 0
вые сочетания символов. Криптоаналитик может определить между ними рас-
стояние и разложить это число на множители. Один из множителей будет рав-
ным периоду шифра. Если в криптограмме встретилось несколько пар одина-
ковых сочетаний, нужно определить расстояние для каждой пары и разложить
его на множители. Множитель, который встретился чаще других, скорее всего и
является искомой длиной ключа.
Таблица 3.1
Э 28 П 15 Б 1 ( 28+15+ 1 ) mod 32 = 12 М
Т 18 Е 5 У 19 ( 18+ 5+19 ) mod 32 = 10 К
О 14 Р 16 К 10 ( 14+16+10 ) mod 32 = 8 И
31 В 2 В 2 ( 31+ 2+ 2 ) mod 32 = 3 Г
С 17 Ы 26 А 0 ( 17+26+ 0 ) mod 32 = 11 Л
Т 18 Й 9 Б 1 ( 18+ 9+ 1 ) mod 32 = 28 Э
Р 16 П 15 У 19 ( 16+15+19) mod 32 = 18 Т
О 14 Е 5 К 10 ( 14+ 5+10 ) mod 32 = 29 Ю
К 10 Р 16 В 2 ( 10+16+ 2 ) mod 32 = 28 Э
А 0 В 2 А 0 ( 0 +2 + 0 ) mod 32 = 2 В
31 Ы 26 Б 1 ( 31+26 +1 ) mod 32 = 26 Ы
О 14 Й 9 У 19 ( 14+ 9+19 ) mod 32 = 10 К
Т 18 П 15 К 10 ( 18+15+10 ) mod 32 = 11 Л
К 10 Е 5 В 2 ( 10+ 5+ 2 ) mod 32 = 17 С
Р 16 Р 16 А 0 ( 16+16+ 0 ) mod 32 = 0 А
Ы 26 В 2 Б 1 ( 26+ 2+ 1 ) mod 32 = 29 Ю
Т 18 Ы 26 У 19 ( 18+26+19 ) mod 32 = 31
О 14 Й 9 К 10 ( 14+ 9+10 ) mod 32 = 33 Б
Г 3 П 15 В 2 ( 3+15+ 2 ) mod 32 = 20 Ф
О 14 Е 5 А 0 ( 14+ 5+ 0 ) mod 32 = 19 У
31 Р 16 Б 1 ( 31+16+ 1 ) mod 32 = 16 Р
И 8 В 2 У 19 ( 8+ 2+ 19 ) mod 32 = 29 Ю
С 17 Ы 26 К 10 ( 17+26+10 ) mod 32 = 21 Х
Х 21 Й 9 В 2 ( 21+ 9+ 2 ) mod 32 = 0 А
О 14 П 15 А 0 ( 14+15+ 0 ) mod 32 = 29 Ю
Д 4 Е 5 Б 1 ( 4+ 5+ 1 ) mod 32 = 10 К
Н 13 Р 16 У 19 ( 13+16+19 ) mod 32 = 16 Р
О 14 В 2 К 10 ( 14+ 2+10 ) mod 32 = 26 Ы
Г 3 Ы 26 В 2 ( 3+26+ 2 ) mod 32 = 31
О 14 Й 9 А 0 ( 14+ 9+ 0 ) mod 32 = 23 Ч
31 П 15 Б 1 ( 31+15+ 1 ) mod 32 = 15 П
Т 18 Е 5 У 19 ( 18+ 5+19 ) mod 32 = 10 К
Е 5 Р 16 К 10 ( 5+16+10 ) mod 32 = 31
К 10 В 2 В 2 ( 10 + 2+ 2) mod 32 = 14 О
С 17 Ы 26 А 0 ( 17+26+ 0 ) mod 32 = 11 Л
Т 18 Й 9 Б 1 ( 18+ 9+ 1 ) mod 32 = 28 Э
А 0 П 15 У 19 ( 0+15+19 ) mod 32 = 2 В
2 1
Однако возможны и “ложные тревоги”, когда одинаковые сочетания
символов в криптограмме образованы случайным стечением обстоятельств.
Обычно, при использовании метода Казиски, криптоаналитики анализи-
руют криптограммы на наличие в них одинаковых триграмм, т.к. вероятность
присутствия в тексте одинаковых сочетаний из четырех и более символов
слишком мала, а при использовании диаграмм велик процент ложных тревог.
Очевидным недостатком метода является его полная непригодность в
случае отсутствия в тексте одинаковых сочетаний.
Рекомендуется использовать методы Казиски и ИС совместно. ИС пока-
зывает порядок длины ключа (больше или меньше 10 символов), а метод Кази-
ски позволит определить точное значение.
Выполнение работы
1. Запустить на выполнение файл polym.exe.
2. Выбрать в меню пункт Файл → Открыть.
3. Выбрать в появившемся списке свой вариант.
4. Теперь экран выглядит следующим образом
5. Определите период ключа. Для этого вызовите таблицу индекса соответ-
ствия (меню Нахождение периода → Использование индекса соответ-
ствия). В этой таблице содержатся теоретически ожидаемые значения
ИС для различных длин ключа и значение ИС, подсчитанное для кон-
кретной криптограммы. А так же воспользуйтесь методом Ф. Казиски
(меню Нахождение периода → Подход Ф. Казиски). Который больше
подходит для ключей с периодом более 10 символов.
2 2
6. Задайте длину ключа. Пункт меню Нахождение периода → Принятие
решения.
7. На основе частотного анализа для каждой группы периода осуществить
подстановку (одну). Номер анализируемой буквы ключа (т.е. номер те-
кущей группы периода) указан в заголовке окна статистики. Номер теку-
щей группы периода легко изменить, воспользовавшись клавишами Left
и Right. Существует возможность изменить букву прямо в ключе. Для
этого воспользуйтесь клавишей F8.
8. Проанализируйте полученные текст и ключ. При неудовлетворительном
результате измените подстановки в некоторых группах периода
9. Расшифруйте криптограмму, продемонстрируйте преподавателю резуль-
тат.
Примечание:
Чтобы сохранить результаты своей работы выберите пункт меню Файл
→ Сохранить и введите имя файла.
Содержание отчета
1. Титульный лист (с номером Вашего варианта).
2. Цель работы.
3. Расшифрованный исходный текст.
4. Составной ключ.
5. Краткий протокол криптоанализа.
6. Первичные ключи (процесс вычисления отразить в отчете).
Пример дешифрации криптограммы, зашифрованной многопетлевой
подстановкой
Текст криптограммы:
ИЙАЦЩМЙШЛ БО ТТВЯЛОАЧДККЙЙРРЧМЖЗБЙССЭАУЭЕАРРЫЧКФЬШММЭЖЮЬ
---------------------------------------------------------
КЛБАИКЫКДЙДРХЩЬИХ МЭЕРДДВАУНОСШЯИЮЙЗЩГ ГЙЩЧИЭНВПЭЭОЮДПЖЙЙМЖЙРАЛ
---------------------------------------------------------------
ШЖВЫВГЖ ЙЭВАЫБЧЧЛФЫСЦФОРЮОРЙ АЭШ
----------------------------------
ОЬЗЗНЭФОЯЦЙПЭЕПЫЗСЦПЯНВМЭЯОКИУОЗИХМВНОЯЭМГМОРЫЬЦЧБ ЦФСЯМЖЬКЯОК
---------------------------------------------------------------
ФЗЦЩДЭЫ ЫХМБСЬТТУЙЬРЕЛВСИКЕРОЮЩХФДЛКЗНОБ ЧАЧЫПЩАЙИЮЬДСАЙ
--------------------------------------------------------
ДЫЙМЯЗУЭИЩТЫПЮКПЮЖЫМАЛШГЦ...
-------------------------...
Прежде всего, необходимо определить период шифра. В нашем распоря-
жении метод Казиски и ИС.
Методом Казиски получили возможные значения периода, представлен-
ные в табл. 3.2.
Наибольший вес имеет период 30.
Для большей уверенности уточним порядок периода (единицы или десят-
ки) с помощью ИС.
2 3
Таблица 3.2
Номер Период Вес
1 30 5
2 6 4
3 5 3
4 10 3
Значение ИС для данной криптограммы равно 0.0321 , что указывает на
длину ключа более 10 символов. Итак, окончательное решение - период равен
30.
Теперь, когда длина ключа определена, переходим к частотному анализу.
В каждой группе периода заменяем самый частый символ данной группы
самым частым символом русского языка - в нашем случае это “пробел”.
Например, статистика первой группы периода приведена в табл. 3.3.
Таблица 3.2
Криптограмма Русский язык
Символ Частота Буква Вероятность
Ч 0.116 Пробел 0.175
Ж 0.110 о 0.090
А 0.090 е 0.072
Ы 0.084 а 0.062
Ю 0.058 и 0.062
И 0.058 н 0.053
и т.д. и т.д.
Сделаем замену “Ч”-“ ”.
Действуя подобным образом для каждой группы периода, получаем сле-
дующий текст:
РУСЬ ИЗДАВЯА ВЕЕА ТОРГОЭЛЮ С ВОСТОЧНЫМИ ВТРАНЫМИ
ЖЕЛАШ ПОЛУЧИТЬ РАЗРЕШЦНИЕ ЗДИТЬ Ч РЕЗ РУССКИЕ ЗЕМЛЩ В П
РСИЮ ИНЯИЮ БУХАРУ И ДЛЯ ТЫСКЫНИЯ ПУТВ В КИТАЙ АНГЛИЙСЬИЙ
ПИСОЛ ПОВ ДАЛ ЦАРЮ МОСКОВСЬОМУ СТО ДРАГИЦЕННОСТИ
ПЕРЕВОЗЩМ ЫЕ ДУПЦАМИ ВЗ СТРАНЫ В СТРАНД ОСТЫВЛЯЮТ НЫ ПУТИ
ЗОЛОТЫЕ СЛЦДЫ РНССКИЕ ПКЕК...
Очевидно, замены в некоторых группах были сделаны неверно.
Рассмотрим слова “РУСЬ ИЗДАВЯА ВЕЕА ТОРГОЭЛЮ”. Логично
предположить, что это искаженное “РУСЬ ИЗДАВНА ВЕЛА ТОРГОВЛЮ”.
Тогда сделаем следующие замены:
в 11 группе “Б”-“Н”
в 16 группе “В”-“Л”
в 24 группе “К”-“В”
2 4
Теперь текст выглядит так:
РУСЬ ИЗДАВНА ВЕЛА ТОРГОВЛЮ С ВОСТОЧНЫМИ СТРАНАМИ
ЖЕЛАЯ ПОЛУЧИТЬ РАЗРЕШЕНИЕ ЕЗДИТЬ ЧЕРЕЗ РУССКИЕ ЗЕМЛИ В
ПЕРСИЮ ИНДИЮ БУХАРУ И ДЛЯ ОТЫСКАНИЯ ПУТИ В КИТАЙ
АНГЛИЙСКИЙ ПОСОЛ ПОВЕДАЛ ЦАРЮ МОСКОВСКОМУ ЧТО
ДРАГОЦЕННОСТИ ПЕРЕВОЗИМ ЫЕ КУПЦАМИ ИЗ СТРАНЫ В СТРАНУ
ОСТАВЛЯЮТ НА ПУТИ ЗОЛОТЫЕ СЛЕДЫ РУССКИЕ ПРЕК...
Криптограмма расшифрована.
Получен составной ключ “ШЦПЬЫДВФЛЮФОАРНЧЯМЭТЗБЭИЯМС ШК”.
Необходимо разложить его на первичные ключи.
Для этого воспользуемся формулой, описывающей многопетлевые под-
становки (3.1).
Составной ключ равен сумме циклически повторяющихся первичных
ключей. Его длина является наименьшим общим кратным длин первичных
ключей. И, если длины первичных ключей взаимно просты, то длина составно-
го ключа будет равна их произведению.
Исходя из вышесказанного, попытаемся определить длины первичных
ключей. Длина составного ключа равна 30 символов. Будем считать, что в
шифре использовались два ключа. Тогда их длины могут равняться 5 и 6.
Пусть составной ключ K=K1K2...K30 , первый первичный ключ
K1=K1,1K1,2...K1,5, второй первичный ключ K2 = K2,1K2,2...K2,6.
Составим уравнения, из которых сможем найти значения первичных
ключей.
K1 = K1,1 + K2,1
K2 = K1,2 + K2,2
K3 = K1,3 + K2,3
.
.
.
K30 = K1,5 + K2,6
Подставим сюда конкретные значения символов составного ключа:
ШЦПЬЫДВФЛЮФОАРНЧЯМЭТЗБЭИЯМС ШК
K1,1 + K2,1 = 24 (“Ш”)
K1,2 + K2,2 = 22 (“Ц”)
K1,3 + K2,3 = 15 (“П”)
K1,4 + K2,4 = 27 (“Ь”)
K1,5 + K2,5 = 26 (“Ы”)
K1,1 + K2,6 = 4 (“Д”)
.
.
.
K1,5 + K2,6 = 10 (“К”)
Имеем 11 неизвестных и 10 линейно независимых уравнений. Выразим
все переменные через одну, например, через K1,1.
Эта переменная является числовым эквивалентом символа русского ал-
2 5
фавита, и, следовательно, может принимать целочисленные значения от 0 до 31.
Первичные ключи являются словами русского языка, поэтому, перебрав все
возможные значения K1,1, получим истинные значения первичных ключей.
Первичные ключи: “ДОМИК” и “ФИГУРА”.
Лабораторная работа № 4
“Метод вероятных слов”
Задание
Расшифровать криптограмму, зашифрованную шифром Виженера, мето-
дом вероятных слов, получить ключ шифрования.
Расшифровать криптограмму, зашифрованную “бегущим” ключом, мето-
дом вероятных слов, получить “бегущий” ключ.
Теория
Метод вероятных слов основан на том, что чаще всего заранее известна
область применения криптограммы, а, значит, и слова, которые могут встре-
титься в тексте. Например, если известно, что в криптограмме зашифрован фи-
нансовый отчет, вероятно, в тексте встречаются слова “дебет”, “кредит”, “ба-
ланс” и т.п.
Т.к. в полиалфавитных подстановках криптограмма является суммой от-
крытого текста и ключа по модулю L, то, чтобы проверить наличие вероятного
слова в тексте, необходимо вычесть его из криптограммы по модулю L во всех
возможных позициях, где L - мощность исходного алфавита.
Если данное вероятное слово присутствует в тексте и вычитается в пра-
вильной позиции, то результатом такого вычитания будет ключ шифрования
или его часть. Если слово испытывается в неправильной позиции, то результа-
том вычитания будет бессмысленный набор букв. Понятно, что, если этого сло-
ва нет в тексте, все позиции будут неправильными.
Полученная в результате вычитания хотя бы часть осмысленного слова -
показатель успеха. Далее надо попытаться расширить открытый текст или ключ
в этом направлении.
Конечно, будут возникать и “ложные тревоги”, особенно в случае корот-
ких вероятных слов, но эти варианты будут легко отбрасываться в процессе
продвижения анализа, т.к. они не дадут разумных расширений.
Выполнение работы
1. Дешифровать криптограмму, зашифрованую шифром Виженера, методом
вероятных слов, получить ключ шифрования.
1.1. Запустить на выполнение файл word.exe.
1.2. Выбрать метод простой перестановки, Выбор шифра→Шифр Ви-
женера.
1.3. Выбрать в меню пункт Файл → Открыть.
2 6
1.4. Выбрать в появившемся списке свой вариант.
1.5. Теперь экран выглядит следующим образом
1.6. Теперь перед Вами текст криптограммы, меню и строка подсказки.
Под строкой криптограммы на экране изображены еще две строки:
верхняя строка для ввода и редактирования вероятного слова и
нижняя строка для ключа.
1.7. Начните расшифровку с ввода вероятного слова в верхней строке.
1.8. Используются только большие буквы русского алфавита. Буквы
“Ъ”, “Ё” и пробел в криптограммах не используются. При вводе
можно пользоваться клавишами управления курсором Up, Down,
Left и Right, а также клавиши Home, End, Del и BackSpace. Ввод
можно осуществлять в двух режимах: вставки и замены. По умол-
чанию установлен режим вставки. Переключение между режимами
происходит по клавише Ins. Возможен ввод как в строке для веро-
ятного слова, так и в строке ключа. Переключение ввода с одной
строки на другую происходит по клавише Tab.
1.9. Подберите перспективную позицию для введенного вероятного
слова, пользуясь для сдвига слова влево-вправо клавишами Ctr← и
Ctrl→. Если в строке ключа появились осмысленные сочетания
букв, возможно Вы выбрали правильное вероятное слово. Если во
всех позициях получались бессмысленные буквосочетания, попро-
2 7
буйте ввести другое вероятное слово.
1.10. Для ввода короткого ключа воспользуйтесь клавишей F5.
1.11. Постарайтесь “расширить” ключ или вероятное слово. Например,
если предполагаемый ключ “..крипто...”, мы можем попробовать
расширить его: “криптография”, ”криптоанализ” и т.п. Если в тек-
сте открылось слово “подстановки”, можно попробовать варианты
“полиалфавитные подстановки”, “моноалфавитные подстановки”.
1.12. Поочередно расширяя то ключ, то вероятное слово, расшифруйте
полностью криптограмму.
Примечание
Чтобы сохранить результаты свое работы выберите пункт меню
Файл→Сохранить и введите имя файла.
2. Дешифровать криптограмму, зашифрованую “бегущим” ключом, мето-
дом вероятных слов, получить “бегущий” ключ.
2.1. Запустить на выполнение файл word.exe.
2.2. Выбрать метод простой перестановки, Выбор шифра → “бегущий”
ключ.
2.3. Выбрать в меню пункт Файл → Открыть.
2.4. Выбрать в появившемся списке свой вариант.
2.5. Теперь экран выглядит следующим образом
2.6. Расшифровать криптограмму, действуя согласно пунктам 1.6 – 1.12.
2 8
Примечание
Чтобы сохранить результаты своей работы выберите пункт меню
Файл→Сохранить и введите имя файла.
При выборе вероятных слов учесть, что все тексты на тему криптоанали-
за. Т.е. могут встретиться слова: “частота”, “алфавит”, “подстановки”, “крип-
то”, “буква”, “метод”, “шифр”, “сообщение”, “информация”, “защита” и т.п.
В криптограммах, зашифрованных “бегущим ключом”, в качестве ключа
выбраны строки из известных песен, стихов, а также пословицы.
Если в процессе работы Вы убедились, что ключ периодически повторя-
ется (например, омгромгромгро), можно значительно ускорить расшифровку
криптограммы, воспользовавшись функцией ввода “короткого ключа” (клави-
ша F5).
Содержание отчета
1. Титульный лист (с номером Вашего варианта).
2. Цель работы.
3. Исходный текст криптограммы, зашифрованной шифром Вижене-
ра.
4. Ключ.
5. Краткий протокол криптоанализа.
6. Исходный текст криптограммы, зашифрованной “бегущим клю-
чом”.
7. “Бегущий ключ”.
8. Краткий протокол криптоанализа.
Пример дешифрации криптограммы, зашифрованной
шифром Виженера, методом вероятных слов
Текст криптограммы:
УВВПННЮЖТХМЧЫНЗВВИЦАТЯБХОЕГЭСШЧДДОЖЬФУОРЛКСДВТЧПЧДДЖЖШЛЕТЖЮЖКНЫ
---------------------------------------------------------------
---------------------------------------------------------------
ГИВИТЬХАТЯШЕПЫД
---------------
---------------
Т.к. известно, что исходный текст на тему криптографии, будем пробо-
вать вероятные слова, связанные с данной темой.
Проверка вероятных слов “КРИПТО”, “МЕТОД” во всех позициях
криптограммы не дала положительного результата.
При проверке вероятного слова “АЛФАВИТ” получилось следующее:
УВВПННЮЖТХМЧЫНЗВВИЦАТЯБХОЕГЭСШЧДДОЖЬФУОРЛКСДВТЧПЧДДЖЖШЛЕТЖЮЖКНЫ
-----АЛФАВИТ---------------------------------------------------
-----НТСТУДЕ---------------------------------------------------
ГИВИТЬХАТЯШЕПЫД
---------------
---------------
Похоже, что ключом является слово “СТУДЕНТ”. Так как ключ цикли-
2 9
чески повторяется, для проверки нашей гипотезы воспользуемся опцией меню
“Короткий ключ”. Введем предполагаемый ключ “СТУДЕНТ” и получим ре-
зультат:
УВВПННЮЖТХМЧЫНЗВВИЦАТЯБХОЕГЭСШЧДДОЖЬФУОРЛКСДВТЧПЧДДЖЖШЛЕТЖЮЖКНЫ
ВПОЛИАЛФАВИТНЫХПОДСТАНОВКАХКАЖДАЯБУКВАКЛЮЧАСООТВЕТСТВУЕТБУКВЕИС
СТУДЕНТСТУДЕНТСТУДЕНТСТУДЕНТСТУДЕНТСТУДЕНТСТУДЕНТСТУДЕНТСТУДЕНТ
ГИВИТЬХАТЯШЕПЫД
ХОДНОГОАЛФАВИТА
СТУДЕНТСТУДЕНТС
Криптограмма расшифрована.
Исходный текст:
В ПОЛИАЛФАВИТНЫХ ПОДСТАНОВКАХ КАЖДАЯ БУКВА КЛЮЧА
СООТВЕТСТВУЕТ БУКВЕ ИСХОДНОГО АЛФАВИТА
Ключ: СТУДЕНТ.
Пример дешифрации криптограммы, зашифрованной “бегущим
ключом”, методом вероятных слов
Текст криптограммы:
ЩЕДТИЬРАЦЫБЬОЯЖЭЙУЗЯЕОЬААГУВЫЕВЙЦЦАФНФШХОЫАРХСЧШЖЗКАНХСЦРЯЗЩЮШК
---------------------------------------------------------------
---------------------------------------------------------------
ЙВАЗФФЭФЖДЗЯБЦОЯВБЯЦЖБЫЛБ
-------------------------
-------------------------
Т.к. известно, что исходный текст на тему криптографии, будем пробо-
вать вероятные слова, связанные с данной темой.
Проверка вероятных слов “подстановка”, “метод”, “алфавит” во всех по-
зициях криптограммы не дала положительного результата.
При проверке вероятного слова “крипто” получилось следующее:
ЩЕДТИЬРАЦЫБЬОЯЖЭЙУЗЯЕОЬА
------КРИПТО------------
------ЖПОЛОН------------
Попробуем расширить “КРИПТОАНАЛИЗ”:
ЩЕДТИЬРАЦЫБЬОЯЖЭЙУЗЯЕОЬА
------КРИПТОАНАЛИЗ------
------ЖПОЛОНОСЖСБМ------
Попробуем расширить “КРИПТОГРАФИЯ”:
ЩЕДТИЬРАЦЫБЬОЯЖЭЙУЗЯЕОЬА
------КРИПТОГРАФИЯ------
------ЖПОЛОНЛОЖИБФ------
Учитывая,что бегущим ключом являются строки из известных стихотво-
рений и песен, предположим, что здесь ключ - это строки из “Евгения Онеги-
на”:
ЩЕДТИЬРАЦЫБЬОЯЖЭЙУЗЯЕОЬААГ
ЗАДАЧИКРИПТОГРАФИИВЕСЬ----
ТЕАТРУЖПОЛОНЛОЖИБЛЕЩУТ----
Гипотеза подтвердилась. Продолжим ввод ключа:
3 0
ЩЕДТИЬРАЦЫБЬОЯЖЭЙУЗЯЕОЬААГУВЫЕВЙЦЦАФНФШХОЫАРХСЧШЖЗКАНХСЦРЯЗЩЮШК
ЗАДАЧИКРИПТОГРАФИИВЕСЬМАПРОСТЫСДЕЛАТЬПОНЯТНОЕСООБЩЕНИЕВСЕЦЕЛОНЕ
ТЕАТРУЖПОЛОНЛОЖИБЛЕЩУТПАРТЕРИКРЕСЛАВСЕКИПИТВРАЙКЕНЕТЕРПЕЛИВОПЛЕ
ЙВАЗФФЭФЖДЗЯБЦОЯВБЯЦЖБЫЛБ
ПОНЯТНЫМДЛЯНЕПОСВЯЩЕННОГО
ЩУТИВЗВИВШИСЬЗАНАВЕСШУМИТ
Криптограмма расшифрована.
Исходный текст:
ЗАДАЧИ КРИПТОГРАФИИ ВЕСЬМА ПРОСТЫ СДЕЛАТЬ ПОНЯТНОЕ СООБЩЕНИЕ
ВСЕЦЕЛО НЕПОНЯТНЫМ ДЛЯ НЕПОСВЯЩЕННОГО
Бегущий ключ:
ТЕАТР УЖ ПОЛОН ЛОЖИ БЛЕЩУТ ПАРТЕР И КРЕСЛА ВСЕ КИПИТ В РАЙКЕ
НЕТЕРПЕЛИВО ПЛЕЩУТ И ВЗВИВШИСЬ ЗАНАВЕС ШУМИТ
Лабораторная работа № 5
“Перестановки”
Задание
Расшифровать криптограмму, зашифрованную методом перестановок,
получить ключ шифрования.
Расшифровать криптограмму, зашифрованную методом перестановок по
путям Гамильтона, получить ключ шифрования.
Расшифровать криптограмму, зашифрованную методом табличной пере-
становки, пользуясь для этой цели таблицей частот диграмм русского языка,
получить ключ шифрования.
Теория
Блочные и поточные шифры
Перестановки
Все шифры замены, которые были рассмотрены выше, относятся к т.н.
поточным шифрам. В поточных шифрах шифрование происходит посимволь-
но. Если уподобить поточные шифры - а, вернее, шифраторы - черному ящику
и подавать на вход поток символов открытого текста, то на выходе практически
без задержек будут появляться соответствующие им символы криптограммы.
Кроме поточных шифров, существуют еще блочные. При использовании
блочных шифров текст предварительно разбивается на блоки и шифрование
происходит поблочно.
Перестановки относятся к блочным шифрам. Текст делится на блоки по N
символов, и в каждом блоке символы переставляются в соответствии с некото-
рым правилом (ключом). Таким образом, ключ задает порядок символов в бло-
ке.
Кроме того, известны т.н. табличные перестановки. Например, исходный
текст вписывают в таблицу по столбцам, а затем строки таблицы переставляют-
ся в соответствии с ключом. Размер таблицы оговаривается заранее.
Существует два способа использования ключа.
3 1
Пусть
Ключ K = k1k2…ki…kN
Текст M = m1m2…mi…mN
ki- целое число: ki∈[1,Ν].
Способ 1.
Чтобы зашифровать M, нужно i-ый символ текста поставить на ki-ое ме-
сто. При расшифровке на i-ое место ставим ki-ый символ криптограммы.
N = 5; Ключ 3-1-5-4-2
Исходный Текст :ИНФОР⏐МАЦИЯ
Криптограмма :НРИОФ⏐АЯМИЦ
Способ 2.
При шифровке на i-ое место ставим ki-ый символ текста. При расшифров-
ке i-ый символ криптограммы ставится на ki-ое место.
N = 5; Ключ 3-1-5-4-2
Исходный Текст :ИНФОР⏐МАЦИЯ
Криптограмма :ФИРОН⏐ЦМЯИА
В нашем лабораторном практикуме для простой перестановки ис-
пользуется способ 2, а для случая табличной перестановки - способ 1.
Пути Гамильтона
Любую перестановку можно представить в виде графа G = < V,E >,
где V - вершины, а E - ребра графа. В этом случае перестановки получают, за-
писывая открытый текст и читая зашифрованный текст по всевозможным пу-
тям этого графа.
Для этих целей удобно пользоваться путями Гамильтона. Гамильтонов
путь в графе - это путь, проходящий в точности один раз через каждую верши-
ну данного графа.
Таким образом, заранее выбирается некоторый граф, и затем один из пу-
тей Гамильтона используется в качестве ключа перестановки.
Криптоанализ перестановок
Метод диграмм
В общем случае, при использовании перестановок с длиной блока N, су-
ществует N! вариантов ключа. Поэтому при малой длине ключа N, для вскры-
тия шифра достаточен простой перебор всех вариантов перестановок. При
больших значениях N перебор становится невозможен. Использование маршру-
тов Гамильтона упрощает дешифрацию перестановок, т.к. из всего множества
возможных ключей используются только пути Гамильтона. Однако, при боль-
ших значениях N, это преимущество становится незаметным.
3 2
Знание частот встречаемости в тексте пар букв - диграмм - позволяет лег-
ко вскрывать шифры табличной перестановки. Оказывается, рассматривая ма-
ловероятные сочетания букв, можно восстановить истинный порядок строк в
таблице. Кроме того, с помощью вероятностей появления диграмм можно рас-
считать вероятность следования одной строки за другой.
Рассмотрим, например, шифр табличной перестановки, для которого
текст M = m1m2…mnxm выписывается по столбцам в таблицу размером n x m, а
затем строки переставляются в соответствии с ключом и, в результате, получа-
ется криптограмма E:
e1,1 e1,2 … e1,m
… … … …
ei,1 ei,2 … ei,m
… … … …
ej,1 ej,2 … ej,m
… … … …
en,1 en,2 … en,m
Обозначим вероятность того, что в исходном тексте встретится диграмма
“ab”, как p(a,b). Тогда вероятность следования в исходном тексте j-ой строки за
i-ой строкой можно записать так:
, ,
1
( , ) ( , )
m
i k j k
k
p i j p e e
=
= Π (5.1)
Пользуясь формулой 5.1, можно вычислить вероятности следования друг
за другом всех возможных пар строк, т.е. вычислить p(i,j) для всех i ≠ j: i,j
[1,m]. Если в исходном тексте за i-ой строкой стоит строка j, то вероятность
p(i,j) должна быть, в принципе, больше вероятностей p(i,k), где k ≠ j, и p(k,j), где
k ≠ i. Руководствуясь этим соображением, для таблиц небольшого размера лег-
ко восстановить истинный порядок следования строк. В общем случае для рас-
шифровки криптограммы необходимо решить оптимизационную задачу нахож-
дения наиболее вероятного порядка строк в таблице (задача коммивояжера).
В табл. 5.1 диграмм русского языка приведены не вероятности диграмм, а
их логарифмы. Поэтому, для оценки вероятности следования строк друг за дру-
гом, необходимо складывать значения логарифмов вероятностей необходимых
диграмм.
Выполнение работы
1. Дешифровать криптограмму, зашифрованную методом простой перестанов-
ки.
1.1.Запустить на выполнение файл trans.exe.
1.2.Выбрать метод простой перестановки: Выбор метода → Простая
перестановка.
3 3
1.3.Выбрать в меню пункт Файл → Открыть.
1.4.Выбрать в появившемся списке свой вариант.
1.5.Теперь экран выглядит следующим образом
1.6.Перед Вами на экране текст криптограммы. Задайте длину ключа. Это
можно сделать, нажав клавишу F5 или через меню Действия → Длина
ключа. Вам будет предложено несколько возможных длин ключа. Выбе-
рите наиболее вероятную.
1.7.Укажите способ порождения ключа: автоматическая генерация или Вы
будете вводить ключ вручную. Переключение режимов осуществляется
по клавише F7 или через меню Действия → Автоматическая генерация.
1.8.Если возникло предположение, что какое-либо слово или его часть при-
сутствует в тексте, можно его проверить, воспользовавшись клавишей F6
или через меню Действия → Вероятное слово. В появившееся окно ввода
введите Ваше вероятное слово, и программа попытается найти такое зна-
чение ключа, при котором это слово присутствовало бы в тексте. Для
продолжения поиска нажимайте клавишу Enter.
1.9.Проверяя различные значения ключей, расшифруйте криптограмму.
Примечание:
Чтобы сохранить результаты своей работы выберите пункт меню Файл
→ Сохранить и введите имя файла.
3 4
2. Дешифровать криптограмму, зашифрованную c использованием путей Га-
мильтона.
2.1.Запустить на выполнение файл trans.exe.
2.2.Выбрать метод простой перестановки: Выбор метода → Перестановка с
использованием путей Гамильтона.
2.3.Выбрать в меню пункт Файл → Открыть.
2.4.Выбрать в появившемся списке свой вариант.
2.5.Теперь экран выглядит следующим образом
2.6.Нажмите клавишу F9 или выберите пункт меню Действия → Задание
графа. Введите число вершин и заполните матрицу смежности для графа,
выбранного Вами из приложения. (Вершина не считается смежной сама
себе). Программа вычислит все пути Гамильтона для этого графа.
2.7.Перед Вами на экране текст криптограммы. Процесс дешифрации анало-
гичен описанному выше случаю простой перестановки. Исключение со-
ставляет добавившаяся возможность просмотра путей Гамильтона, один
из которых и является ключом (столбец слева МАРШРУТЫ).
2.8.Расшифровать криптограмму.
Примечание:
Чтобы сохранить результаты своей работы выберите пункт меню Файл
→ Сохранить и введите имя файла.
3 5
3. Дешифровать криптограмму, зашифрованную методом табличной переста-
новки:
3.1.Запустить на выполнение файл trans.exe.
3.2.Выбрать метод табличной перестановки: Выбор метода → Табличная
перестановка.
3.3.Выбрать в меню пункт Файл → Открыть.
3.4.Выбрать в появившемся списке свой вариант.
3.5.Теперь экран выглядит следующим образом
3.6.Перед Вами на экране три таблицы: Первая - таблица с криптограммой,
вторая - рабочая таблица - в ней отражаются изменения, вносимые поль-
зователем в процессе криптоанализа. В результате расшифровки в рабо-
чей таблице должен появиться исходный текст криптограммы. Строки
этих двух таблиц пронумерованы: слева - красными цифрами, справа -
зелеными. Красные цифры означают номер строки в таблице (“позицию”
строки), а зеленые - номер самой строки (“идентификатор” строки). Что-
бы поменять местами две строки рабочей таблицы, необходимо в окне
ввода, расположенном в нижней части экрана, ввести номера их позиций
(красные цифры). В третьей таблице содержится оценки вероятностей
следования строк друг за другом. Кроме того, по клавише F4 можно про-
смотреть таблицу диграмм русского языка.
3.7.Пользуясь таблицей вероятностей следования строк друг за другом и таб-
лицей диграмм русского языка, переставьте строки рабочей таблицы та-
3 6
ким образом, чтобы в ней получился осмысленный текст. Не забудьте,
что текст нужно читать по столбцам.
3.8.Если использование таблицы вероятностей p(i,j) не дает результата, мож-
но сделать следующее:
• осуществлять проверку не только максимальной вероятности
следования строк друг за другом, но и семантического смысла
получающихся сочетаний;
• пользоваться не вероятностями следования строк друг за другом,
а вероятностями диграмм в отдельных столбцах;
• использовать не вероятности p(i,j), а суммы p(i,j)+p(j,k), т.е. ве-
роятности следования строк i,j и k друг за другом.
3.9.Расшифруйте криптограмму и получите ключ шифрования.
Примечание:
Чтобы сохранить результаты своей работы выберите пункт меню Файл
→ Сохранить и введите имя файла.
Таблица 5.1
i\j А Б В Г Д Е Ж З И Й К Л М Н О П Р С Т У Ф Х Ц Ч Ш Щ Ъ Ы Ь Э Ю Я -
А 2 7 8 6 7 7 7 7 4 7 7 7 8 8 3 7 6 7 8 2 6 6 7 7 5 5 0 0 0 0 6 7 9
Б 7 1 1 0 1 6 2 2 6 0 5 6 3 5 7 2 7 5 0 7 0 5 4 1 0 5 5 7 2 2 0 3 5
В 8 0 5 0 4 8 0 3 7 1 6 7 5 6 8 4 6 6 6 6 0 3 0 1 3 0 0 8 2 0 0 4 8
Г 6 0 1 1 6 5 0 0 6 0 4 5 4 4 8 0 7 0 0 6 0 0 1 2 0 0 0 0 0 0 0 0 4
Д 8 1 6 3 4 8 1 0 7 0 4 7 1 7 8 4 6 5 2 7 1 3 3 3 4 0 0 6 4 0 4 5 7
Е 5 5 6 7 8 6 6 6 4 7 7 8 8 9 6 5 8 8 9 3 3 6 5 6 5 6 0 0 1 1 5 5 9
Ж 6 0 0 0 6 7 2 1 7 0 5 0 2 7 1 0 1 2 1 3 0 0 0 0 0 0 0 0 2 0 0 0 2
З 8 4 6 2 6 4 1 1 6 1 5 5 6 6 7 1 5 0 0 6 0 0 2 1 0 0 2 6 2 0 0 4 6
И 6 6 7 6 6 8 5 7 7 7 7 6 8 8 5 5 7 8 8 1 5 7 7 7 6 3 0 1 0 0 6 7 9
Й 0 0 3 0 3 0 0 0 0 0 3 6 5 4 0 0 0 6 6 0 0 0 1 2 3 0 0 0 0 0 0 0 8
К 8 1 5 1 1 6 5 2 7 1 2 7 0 5 8 0 7 6 6 7 0 0 6 0 1 0 0 0 0 0 0 0 7
Л 8 4 1 2 1 8 6 1 8 0 4 4 1 6 7 0 0 3 3 6 3 0 0 3 1 1 0 6 8 0 7 8 6
М 7 5 7 2 2 8 0 1 7 0 4 4 7 6 8 5 1 3 1 6 1 0 0 0 0 0 0 7 3 0 0 6 8
Н 9 0 3 3 6 8 1 1 9 0 6 0 1 7 8 0 0 5 7 6 5 2 5 3 0 0 0 8 5 0 4 6 7
О 2 8 8 8 8 6 7 7 6 8 7 8 8 7 6 7 8 8 8 3 2 5 6 7 6 5 0 0 1 5 2 5 9
П 7 0 0 0 0 8 0 4 7 0 3 6 1 4 8 4 9 4 5 6 2 0 1 0 0 0 0 4 5 3 0 4 4
Р 9 1 6 4 4 8 6 0 8 0 5 2 6 6 8 4 2 6 6 7 3 5 4 2 4 2 0 7 4 0 1 6 7
С 6 4 6 2 5 7 2 0 7 0 7 8 6 6 8 7 5 6 9 6 3 5 1 5 5 0 0 5 6 1 3 8 7
Т 8 2 7 1 4 8 0 0 8 0 6 4 5 6 9 3 8 8 4 6 0 0 0 4 0 2 1 7 8 0 1 5 8
У 3 4 4 6 6 7 6 5 3 3 6 5 5 6 0 6 7 7 7 1 5 5 0 6 3 6 0 0 0 0 7 4 8
Ф 6 0 0 0 0 5 0 0 6 0 0 2 2 0 6 0 4 0 3 5 4 0 0 0 0 0 0 1 0 0 0 0 2
Х 4 3 3 0 0 4 0 0 3 0 1 1 0 5 6 0 5 3 1 3 0 0 2 0 0 0 1 0 0 0 0 0 8
Ц 5 0 6 0 0 6 0 0 7 0 0 0 0 0 3 0 0 0 0 4 0 0 0 0 0 0 0 5 0 0 0 0 5
Ч 7 0 1 0 0 8 0 0 7 0 6 1 0 6 2 0 1 0 7 3 0 0 0 1 3 0 0 1 3 0 0 0 4
Ш 5 0 0 0 0 6 0 0 7 0 3 3 0 3 4 0 3 0 3 4 0 0 0 0 0 0 0 0 4 0 0 0 5
Щ 6 0 0 0 0 7 0 0 6 0 0 0 0 2 0 0 2 0 0 4 0 0 0 0 0 0 0 0 4 0 1 0 1
Ъ 0 0 0 0 0 4 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 3 2
Ы 1 4 7 3 5 7 1 5 1 7 5 5 6 2 1 5 5 5 6 0 0 7 0 5 4 1 0 1 0 0 0 1 8
Ь 0 1 0 0 0 3 0 7 1 0 6 0 4 7 1 0 0 6 4 0 0 0 0 1 6 1 0 0 0 0 6 2 8
Э 0 0 4 0 0 1 0 0 0 2 6 5 2 1 0 2 0 1 7 0 4 3 0 0 0 0 0 0 0 0 0 0 1
Ю 0 5 0 0 2 0 1 2 0 4 1 0 0 0 0 0 0 3 7 0 0 0 0 6 1 7 0 0 1 0 3 0 7
Я 0 1 5 2 5 6 2 5 0 2 2 3 6 5 0 1 4 4 7 0 0 4 4 3 0 4 0 0 0 0 6 4 9
- 7 8 9 7 8 7 5 8 8 3 8 6 8 9 9 9 8 9 8 7 7 6 7 8 5 1 1 2 1 8 2 6 0
3 7
Содержание отчета
1. Титульный лист (с номером Вашего варианта).
2. Цель работы.
3. Исходный текст криптограммы, зашифрованной простой перестановкой.
4. Ключ.
5. Краткий протокол криптоанализа.
6. Исходный текст криптограммы, зашифрованной с использованием путей
Гамильтона.
7. Граф, матрица смежности графа.
8. Краткий протокол криптоанализа.
9. Исходный текст криптограммы, зашифрованной табличной перестанов-
кой.
10.Ключ.
11.Таблица вероятностей следования строк друг за другом.
12.Краткий протокол криптоанализа.
Пример дешифрации криптограммы, зашифрованной
простой перестановкой
Текст криптограммы:
ЮЛЧЕКЕО-ЗВЧАЕНН-ЕДЛИС-БАЯНАСИЛВОАНРСОТИНЫРНК-Ц-ЕНАХЫ-БНАМГ-
-----------------------------------------------------------
УЕМЕТИБОЕС-ЧЕ ЕНП-ЕЛИИИВДНКТСИ-ОКИВИЛЫНЙ-ДНЫОКРАХРА-ТРИКЕУТСЗУ-
---------------------------------------------------------------
ЗКЯ-МРАИЫРВОЗМ-ЕЖМ-УЦЕ ДЙО-ПНДОАВР-АИ-ЦНЕОЙЦОПКУ-ТАЕЛПН-
--------------------------------------------------------
ЕБЯЬЛШИО-ИКОМБЕАНЛМЯИ-ИНЕ-ОЦС-ДЕТИК-КЛД СЕЛ--ЕЛИКИВДНКТСЬ-ОМЕ-
--------------------------------------------------------------
ВТЕШ-ЧЫ-МБОЕШЬЕ-ЛАЧСТУКИОВНРПОД-ИЖЕМА
-------------------------------------
Определим длину ключа. Программа предлагает следующие варианты: 5,
11. Предположим, длина ключа равна 5.
Установим автоматический режим генерации ключей. При значении клю-
ча, равном 3-1-5-4-2, возникло предположение, что в тексте присутствует слово
“ЗНАЧЕНИЕ”:
ЮЛЧЕКЕО-ЗВЧАЕНН-ЕДЛИС-БАЯНАСИЛВОАНРС...
ЛКЮЕЧОВЕЗ-АНЧНЕЕИ-ЛД-ЯСАБАЛНИСОРВНАО...
Введем его как вероятное слово. В результате перебора ключей програм-
ма выдала следующее:
ЮЛЧЕКЕО-ЗВЧАЕНН-ЕДЛИС-БАЯНАСИЛВОАНРСОТИНЫРНК-Ц-ЕНАХЫ-БНАМГ-У
КЛЮЧЕВОЕ-ЗНАЧЕНИЕ-ДЛЯ-СБАЛАНСИРОВАННОСТИ-РЫНКА-ЦЕННЫХ-БУМАГ-
ЕМЕТИБОЕС-ЧЕ ЕНП-ЕЛИИИВДНКТСИ-ОКИВИЛЫНЙ-ДНЫОКРАХРА-ТРИКЕУТСЗУ-
ИМЕЕТ-ОБЕСПЕЧЕНИЕ-ЛИКВИДНОСТИ-ЛИКВИДНЫЙ-РЫНОК-ХАРАКТЕРИЗУЕТСЯ-
ЗКЯ-МРАИЫРВОЗМ-ЕЖМ-ДЙО-ПНДОАВР-АИ-ЦНЕОЙЦОПКУ-ТАЕЛПН-ЕБЯЬЛШИО-
УЗКИМ-РАЗРЫВОМ-МЕЖДУ-ЦЕНОЙ-ПРОДАВЦА-И-ЦЕНОЙ-ПОКУПАТЕЛЯ-НЕБОЛЬ
3 8
ИКОМБЕАНЛМЯИ-ИНЕ-ОЦС-ДЕТИК-КЛД СЕЛ--ЕЛИКИВДНКТСЬ-ОМЕ-ВТЕШ-ЧЫ-
ШИМИ-КОЛЕБАНИЯМИ-ЦЕН-ОТ-СДЕЛКИ-К-СДЕЛКЕ-ЛИКВИДНОСТЬ-ТЕМ-ВЫШЕ-
МБОЕШЬЕ-ЛАЧСТУКИОВНРПОД-ИЖЕМА
ЧЕМ-БОЛЬШЕ-УЧАСТНИКОВ-ПРОДАЖИЕМ
Криптограмма расшифрована.
Исходный текст:
КЛЮЧЕВОЕ-ЗНАЧЕНИЕ-ДЛЯ-СБАЛАНСИРОВАННОСТИ-РЫНКА-ЦЕННЫХ-БУМАГ-ИМЕЕТ-
ОБЕСПЕЧЕНИЕ-ЛИКВИДНОСТИ-ЛИКВИДНЫЙ-РЫНОК-ХАРАКТЕРИЗУЕТСЯ-УЗКИМ-
РАЗРЫВОМ-МЕЖДУ-ЦЕНОЙ-ПРОДАВЦА-И-ЦЕНОЙ-ПОКУПАТЕЛЯ-НЕБОЛЬШИМИ-
КОЛЕБАНИЯМИ-ЦЕН-ОТ-СДЕЛКИ-К-СДЕЛКЕ-ЛИКВИДНОСТЬ-ТЕМ- ВЫШЕ-ЧЕМ-
БОЛЬШЕ-УЧАСТНИКОВ-ПРОДАЖИЕМ
Ключ: 3-2-4-5-1 .
Пример дешифрации криптограммы, зашифрованной перестановкой
по путям Гамильтона
Криптограмма:
Л-ЯПДОЕВРРИН-АКИИЧЯЛВРЕО-ТОНГЯ-ЛСООАК-РВПОТАИАИЛТНКВ-ЫИИАТЕЧ-
-------------------------------------------------------------
ГЕОТИ-ЗШ-ФОРВИНОНГА-ЕТКОТ-АПС-ОМДОЛ-ЮКУВ-ОВ-Е-ХВСЗОМЖОЫ-
--------------------------------------------------------
ХПНЗЦИИОХЫЮХЯ
-------------
Граф:
Заполним матрицу смежности для данного графа:
1 1 1
1 1 1
1 1 1 1
1 1 1
1 1 1
Программа вычислит по матрице смежности пути Гамильтона для нашего
графа:
1 2 3 4 5 цикл
1 2 3 5 4
1 2 4 3 5
1 2 4 5 3 цикл
1 3 2 4 5 цикл
1 3 5 4 2 цикл
1 5 3 2 4
1 5 3 4 2 цикл
3 9
1 5 4 2 3 цикл
1 5 4 3 2 цикл
Будем проверять пути Гамильтона в качестве ключей перестановки.
Применение перестановок 1 2 3 4 5 (цикл), 1 2 3 5 4, 1 2 4 3 5 не дало ре-
зультата. Для пути Гамильтона 2 4 3 5 1 программа выдала следующее:
Л-ЯПДОЕВРРИН-АКИИЧЯЛВРЕО-ТОНГЯ-ЛСООАК-РВПОТАИАИЛТНКВ-ЫИИАТЕЧ-Г
ДЛЯ-ПРОВЕРКИ-НАЛИЧИЯ-ВЕРОЯТНОГО-СЛОВА-КРИПТОАНАЛИТИК-ВЫЧИТАЕТ-
ЕОТИ-ЗШ-ФО РВИНОНГА-ЕТКОТ-АПС-ОМДОЛ-ЮКУВ-ОВ-Е-ХВСЗОМЖОЫ-ХП
ЕГО-ИЗ-ШИФ РОВАННОГО-ТЕКСТА-ПО-МОДУЛЮ-К-ВО-ВСЕХ-ВОЗМОЖНЫХ-
НЗЦИИОХЫЮХЯ
ПОЗИЦИЯХЮЫХ
Криптограмма расшифрована.
Исходный текст:
ДЛЯ-ПРОВЕРКИ-НАЛИЧИЯ-ВЕРОЯТНОГО-СЛОВА-КРИПТОАНАЛИТИК-ВЫЧИТАЕТ-ЕГО-
ИЗ-ШИФРОВАННОГО-ТЕКСТА-ПО-МОДУЛЮ-К-ВО-ВСЕХ-ВОЗМОЖНЫХ-
ПОЗИЦИЯХЮЫХ
Ключ: 2-4-3-5-1.
Пример дешифрации криптограммы, зашифрованной табличной
перестановкой, методом диграмм
Криптограмма:
0 В Ь В Г Л О Р Ш 0
1 Р С А Н С Е М Л 1
4 А А Л Е П _ У Л 2
3 З Л С _ _ Е _ С 3
2 И У _ И Й О И _ 4
6 Е _ К Е _ Ф Ю А 5
7 Л Н О М И В _ О 6
5 _ С И В И К Г У 7
Программа вычислила оценки вероятностей следования строк друг за
другом и поместила их в таблицу:
i\j 0 1 2 3 4 5 6 7
0 43 40 33 41 42 54 46
1 40 57 47 52 49 41 43
2 40 51 49 35 53 62 58
3 53 55 65 52 36 50 54
4 47 56 40 63 56 56 52
5 37 56 44 47 41 52 42
6 45 46 62 43 63 44 48
7 47 50 51 59 60 42 39
4 0
Из таблицы видно, что максимальные вероятности у пар строк 0-6, 0-7, 1-
2, 2-6, 2-7, 3-2, 4-3, 5-1, 6-2, 7-4.
Попробуем поставить строку 3 после 4-ой, 2-ую после 3-ей, 7-ую после 2-
ой:
0 В Ь В Г Л О Р Ш 0
1 Р С А Н С Е М Л 1
2 И У _ И Й О И _ 4
3 З Л С _ _ Е _ С 3
4 А А Л Е П _ У Л 2
5 _ С И В И К Г У 7
6 Е _ К Е _ Ф Ю А 5
7 Л Н О М И В _ О 6
Во втором столбце “..УЛАС..”. Похоже, что здесь глагол, оканчивающий-
ся на “..УЛАСЬ ..”. Т.е. строку 0 после 7-ой и 5-ую после 0-ой.
0 Л Н О М И В _ О 6
1 Р С А Н С Е М Л 1
2 И У _ И Й О И _ 4
3 З Л С _ _ Е _ С 3
4 А А Л Е П _ У Л 2
5 _ С И В И К Г У 7
6 В Ь В Г Л О Р Ш 0
7 Е _ К Е _ Ф Ю А 5
Теперь текст очевиден. Поставим 1-ую строку после 5-ой:
0 Л Н О М И В _ О 6
1 И У _ И Й О И _ 4
2 З Л С _ _ Е _ С 3
3 А А Л Е П _ У Л 2
4 _ С И В И К Г У 7
5 В Ь В Г Л О Р Ш 0
6 Е _ К Е _ Ф Ю А 5
7 Р С А Н С Е М Л 1
Криптограмма расшифрована.
Исходный текст:
ЛИЗА-ВЕРНУЛАСЬ-СО-СЛИВКАМИ-ЕВГЕНИЙ-ПИЛ-СВОЕ-КОФЕ-И-УГРЮМО-СЛУШАЛ
Ключ: 6-4-3-2-7-0-5-1.
4 1
Литература
1. Романец Ю.В., Тимофеев П.А., Шаньгин В.Ф. Защита информации в
компьютерных системах и сетях/ Под ред. В.Ф. Шаньгина.- М-: Радио и
связь, 1999.-328 с.
2. Начала криптологии. Методические указания к выполнению лаборатор-
ного практикума по курсу “ИНФОРМАЦИОННЫЙ ОБМЕН В СЕТЯХ”.
МГИФИ. Москва. 1999 г.
3. Молдовян Н.А., Молдовян А.А., Еремеев М.А. Криптография: От прими-
тивов к синтезу алгоритмов. Издательство: "БХВ-Петербург" . 2004. – 446
с.
4. Нильс Фергюсон, Брюс Шнайер. Практическая криптография. Издатель-
ство: Вильямс. 2005.- 416 с.
5. Харин Ю.С., Берник В.И., Матвеев Г.В. Математические основы крипто-
логии. Издательство: БГУ Минск. 1999.- 319 с.
6. Баричев С. Криптография без секретов. Издательство: Горячая Линия –
Телеком. 2004.- 43 с.
7. С.Г. Баричев, В.В.Гончаров, Р.Е.Серов.Основы современной криптогра-
фии издание 1.3 исправленное. Издательство: Горячая Линия Телеком.
2004.-152 с.
8. Н. Смарт . Криптография. Издательство: М.: Техносфера. 2005. – 528 с.
9. Ященко В.В., Варновский Н.П., Нестеренко Ю.В. и др. Введение в крип-
тографию. Издательство: ЧеРо. 1999. – 272 с.
10.Ж. Брассар. Современная криптология. Издательство: Полимед. 1999. -
176 с.
11.Секреты и ложь. Безопасность данных в цифровом мире / Б.Шнайер. –
СПб.: Питер, 2003. – 368 с. : ил.
4 2
Приложение.
Графы для работы №5 (перестановки по путям Гамильтона)
Граф №1 использовать для вариантов 1, 6, 11, 16, 21, 26:
Граф №2 использовать для вариантов 2, 7, 12, 17, 22, 27:
Граф №3 использовать для вариантов 3, 8, 13, 18, 23, 28:
Граф №4 использовать для вариантов 4, 9, 14, 19, 24, 29:
Граф №5 использовать для вариантов 5, 10, 15, 20, 25, 30:
4 3
В 2007 году СПбГУ ИТМО стал победителем конкурса инновационных
образовательных программ вузов России на 2007–2008 годы. Реализация инно-
вационной образовательной программы «Инновационная система подготовки
специалистов нового поколения в области информационных и оптических тех-
нологий» позволит выйти на качественно новый уровень подготовки выпуск-
ников и удовлетворить возрастающий спрос на специалистов в информацион-
ной, оптической и других высокотехнологичных отраслях экономики.
КАФЕДРА ВЫЧИСЛИТЕЛЬНОЙ ТЕХНИКИ
О кафедре
Кафедра ВТ СПбГУ ИТМО создана в 1937 году и является одной из ста-
рейших и авторитетнейших научно-педагогических школ России.
Первоначально кафедра называлась кафедрой математических и счетно-
решающих приборов и устройств и занималась разработкой электромеханиче-
ских вычислительных устройств и приборов управления. Свое нынешнее на-
звание кафедра получила в 1963 году.
Кафедра вычислительной техники является одной из крупнейших в уни-
верситете, на которой работают высококвалифицированные специалисты, в том
числе 8 профессоров и 15 доцентов, обучающие около 500 студентов и 30 аспи-
рантов.
Кафедра имеет 4 компьютерных класса, объединяющих более 70 компью-
теров в локальную вычислительную сеть кафедры и обеспечивающих доступ
студентов ко всем информационным ресурсам кафедры и выход в Интернет.
Кроме того, на кафедре имеются учебные и научно-исследовательские лабора-
тории по вычислительной технике, в которых работают студенты кафедры.
Чему мы учим
Традиционно на кафедре ВТ основной упор в подготовке специалистов де-
лается на фундаментальную базовую подготовку в рамках общепрофессио-
нальных и специальных дисциплин, охватывающих наиболее важные разделы
вычислительной техники: функциональная схемотехника и микропроцессорная
техника, алгоритмизация и программирование, информационные системы и ба-
зы данных, мультимедиатехнологии, вычислительные сети и средства телеком-
муникации, защита информации и информационная безопасность. В то же вре-
мя, кафедра предоставляет студентам старших курсов возможность специали-
зироваться в более узких профессиональных областях в соответствии с их ин-
тересами.
4 4
Специализации на выбор
Кафедра ВТ ИТМО предлагает в рамках инженерной и магистерской под-
готовки студентам на выбор по 3 специализации.
1. Специализация в области информационно-управляющих систем направ-
лена на подготовку специалистов, умеющих проектировать и разрабатывать
управляющие системы реального времени на основе средств микропроцессор-
ной техники. При этом студентам, обучающимся по этой специализации, пре-
доставляется уникальная возможность участвовать в конкретных разработках
реального оборудования, изучая все этапы проектирования и производства,
вплоть до получения конечного продукта. Для этого на кафедре организована
специальная учебно-производственная лаборатория, оснащенная самым совре-
менным оборудованием. Следует отметить, что в последнее время, в связи с
подъемом отечественной промышленности, специалисты в области разработки
и проектирования информационно-управляющих систем становятся все более
востребованными, причем не только в России, но и за рубежом.
2. Кафедра вычислительной техники - одна из первых, начавшая в свое
время подготовку специалистов в области открытых информационно-
вычислительных систем. Сегодня студентам, специализирующимся в этой об-
ласти, предоставляется уникальная возможность изучать и осваивать одно из
самых мощных средств создания больших информационных систем - систему
управления базами данных Oracle. При этом повышенные требования, предъяв-
ляемые к вычислительным ресурсам, с помощью которых реализуются базы
данных в среде Oracle, удовлетворяются за счет организации на кафедре спе-
циализированного компьютерного класса, оснащенного мощными компьюте-
рами фирмы SUN, связанными в локальную сеть кафедры. В то же время, сту-
денты, специализирующиеся в данной области, получают хорошую базовую
подготовку в области информационных систем, что позволяет им по заверше-
нию обучения успешно разрабатывать базы данных и знаний не только в среде
Oracle, но и на основе любых других систем управления базами данных.
3. И, конечно же, кафедра не могла остаться в стороне от бурного натиска
вычислительных сетей и средств телекоммуникаций в сфере компьютерных
технологий. Наличие высокопрофессиональных кадров в данной области и со-
ответствующей технической базы на кафедре (две локальные вычислительные
сети, объединяющие около 80 компьютеров и предоставляющие возможность
работы в разных операционных средах - Windows, Unix, Solaris), позволило ор-
ганизовать подготовку специалистов по данному направлению, включая изуче-
ние вопросов компьютерной безопасности, администрирования, оптимизации и
проектирования вычислительных сетей.