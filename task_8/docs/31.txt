
Отсенхонвоыло гии
Москва
Прочая линия - Телеком
2004
УДК 681.3.067
ББК 32.973
Г67
Р е ц е н з е н т : Ученый Совет факультета информационной безопасности
МИФИ (Председатель Совета - канд. техн. наук, доцент А.А. Малюк)
Горбатов В. С , Полянская О. Ю.
Г67 Основы технологии PKI. - М.: Горячая линия-Телеком, 2004. -
248 с : ил.
ISBN 5-93517-154-6.
Рассматриваются основы технологии инфраструктур открытых ключей.
Даются базовые определения. Анализируются основные подходы к реализации
инфраструктур открытых ключей, описываются архитектура, структуры
данных, компоненты и сервисы PKI. Предлагается классификация стандартов
и спецификаций в области инфраструктур открытых ключей. Рассматриваются
проблемные ситуации и риски, политика PKI, правовые аспекты
использования технологии PKI. Описываются программные продукты
ведущих мировых и российских компаний-производителей программного
обеспечения для поддержки PKI.
Для студентов и аспирантов высших учебных заведений, слушателей
курсов повышения квалификации, а также для широкого круга читателей,
интересующихся современными проблемами информационной безопасности.
ББК 32.973
Адрес издательства в Интернет www.techbook.ru
e-mail: radios_hl@mtu-net.ru
Горбатов Виктор Сергеевич
Полянская Ольга Юрьевна
ОСНОВЫ ТЕХНОЛОГИИ PKI
-X#il-
Издание осуществлено при финансовой поддержке Российского фонда
фундаментальных исследований по проекту № 04-07-95002
Компьютерная верстка О. Ю. Полянской
Обложка художника В. Г Ситникова
ЛР № 071825 от 16 марта 1999 г.
Подписано в печать 23.10.04. Формат 60x88/16.
Бумага офсетная. Усл. печ. л. 15,5. Тираж 2000 экз. Изд. № 154.
ISBN 5-93517-154-6 ©В. С. Горбатов, О. Ю. Полянская, 2004
© Оформление издательства
«Горячая линия - Телеком», 2004
Сокращения, принятые в книге
АС атрибутный сертификат
ИОК инфраструктура открытых ключей
ИТ информационная технология
ППС политика применения сертификатов
РЦ регистрационный центр
САС список аннулированных сертификатов
СКЗИ система криптографической защиты информации
УЦ удостоверяющий центр
ЭЦП электронная цифровая подпись
СА Certificate Authority, удостоверяющий центр
DNS Domain Name System, защищенная система доменных имен
НМАС Hash Message Authentication Checksum, код аутентификации сообщения
на основе вычисления хэща
IETF Internet Engineering Task Force, группа инженерной поддержки Интернет
LDAP Lightweight Directory Access Protocol, упрощенный протокол доступа к
каталогу
MAC Message Authentication Code, код аутентификации сообщения
OCSP ОпИпе Certificate Status Protocol, онлайновый протокол статуса сертификата
CPS Certification Practice Statement, регламент удостоверяющего центра
CRL Certificate Revocation List, список аннулированных сертификатов
PDS PKI Disclosure Statement, краткая характеристика политики PKI
PKCS Public Key Cryptographic Standards, стандарты щифрования с открытыми
ключами
PIN Personal Identification Number, персональный идентификационный номер
PKI Public Key Infrastructure, инфраструктура открытых ключей
PKIX Internet Х.509 PKI, стандарты для описания инфраструктур открытых
ключей (сертификаты формата Х.509)
RA Registration Authority, регистрационный центр
SET Secure Electronic Transactions, аандарт защищенных электронных транзакций
SHTTP Secure HyperText Transfer Protocol, защищенный протокол передачи гипертекста
SSL Secure Socket Layer, протокол передачи пшфрованных данных в Интернет
SPKI Simple Public Key Infrastructure, простая инфраструкт>ра открьггых ключей
VPN Virtual Private Network, виртуальная частная сеть
URL Uniform Resource Locator, унифицированный указатель ресурсов
Х.509 Международный стандарт хранения в каталоге и получения данных
аутентификации
Основы технологии PKl
Введение
Уже сейчас Интернет-технологии прочно вошли в жизнь общества
и продолжают интегрироваться во все более важные сферы
деятельности. Интернет, активно использующийся значительной
частью мирового сообщества, в том числе и в коммерческих целях,
широко применяется банками, финансово-инвестиционными структурами,
участниками рынка ценных бумаг, финансовыми, торговыми
и промышленными компаниями для организации электронного
документооборота.
Бурное развитие сферы электронных услуг и электронной
коммерции резко актуализировали проблему обеспечения информационной
безопасности как в корпоративных сетях, так и в сетях общего
пользования - Интернет. Как известно, решение этой проблемы
достигается одновременным выполнением трех условий: доступности,
целостности и конфиденциальности информационных ресурсов
или, иными словами, обеспечением безопасности электронного
документооборота. Устанавливая деловые контакты, стороны,
субъекты информационных правоотношений, должны быть полностью
уверены в "личности" партнеров, конфиденциальности обмена
электронными документами и подлинности самих документов. Эти
требования предъявляются как программно-аппаратным платформам
(Windows, Macintosh, Unix), так и к различным типам клиентских
и серверных приложений (web-сервер, web-клиент, почтовый
сервер, сервер конференций, сервер каталогов, промежуточный
агент). Сегодня уже существуют индустриальные решения этих задач
на основе практического использования криптографических
средств. При работе в Интернет и корпоративных сетях, они позволяют
обеспечить процесс взаимной аутентификации, целостность
и конфиденциальность данных, регламентировать доступ к информации
ограниченного распространения.
После того как шифрование с открытыми ключами приобрело
популярность, появилась потребность в цифровых сертификатах.
Цифровой сертификат иногда называют цифровым паспортом или
цифровым идентификатором "digital ID". Сертификат - цифровой
эквивалент пропуска, паспорта или водительских прав. Сертификат
Введение
и соответствующий ему секретный ключ позволяют идентифицировать
их владельца всем, кому это необходимо. Универсальное применение
сертификатов обеспечивает стандарт Международного Союза
по телекоммуникациям Х.509, который является базовым и поддерживается
целым рядом протоколов безопасности. В их числе -
стандарты шифрования с открытыми ключами (PKCS), протокол
связи SSL (Secure Sockets Layer Handshake Protocol) и безопасный
протокол передачи гипертекстовых сообщений (Secure HTTP).
Стандарт Х.509 задает формат цифрового сертификата. Основными
атрибутами сертификата являются имя и идентификатор
субъекта, информация об открытом ключе субъекта, имя, идентификатор
и цифровая подпись удостоверяющего центра, серийный номер,
версия и срок действия сертификата, информация об алгоритме
подписи и др. Важно, что цифровой сертификат содержит цифровую
подпись на основе секретного ключа удостоверяющего центра. До
недавнего времени не существовало общепризнанного русского аналога
термина, который берет начало в области шифрования с открытыми
ключами, - Certificate Authority (СА). Часто при переводе на
русский язык термин интерпретировался совершенно по-разному:
служба сертификации, уполномоченный по выпуску сертификатов,
распорядитель сертификатов, орган выдачи сертификатов, доверенный
центр, центр сертификации, сертификатор и т.д. Принятый в декабре
2001 года Закон РФ «Об электронной цифровой подписи» изменил
это положение дел и закрепил за организацией, выдающей
сертификаты открытых ключей, новое название - удостоверяющий
центр. Подлинность сертификата можно проверить с помощью открытого
ключа удостоверяющего центра.
Цифровые сертификаты позволяют идентифицировать и регистрировать
пользователей без передачи их имен и паролей в открытом
виде. Идентификация необходима для контроля доступа. Цифровые
сертификаты защищают конфиденциальные документы от
несанкционированного доступа. Кроме того, в связи с широким распространением
электронной почты, систем межбанковских расчетов,
электронной коммерции появляются возможности подделки или
изменения сообщений и документов, которыми обмениваются сотрудники
компаний или партнеры по бизнесу. Только надежная сие-
Основы технологии PKI
тема идентификации может практически исключить подобные злоупотребления.
Цифровые сертификаты являются необходимым элементом
для создания защищенной системы обмена сообщениями.
Сертификаты лишают злоумышленника возможности использовать
фальшивый ключ и выдавать себя за другое лицо; серверы сертификатов
защищенным образом выпускают, хранят и обрабатывают сертификаты.
Однако одного наличия сертификата недостаточно. Действительно
защищенный обмен сообщениями, надежная идентификация
и электронная коммерция невозможны без инфраструктуры открытых
ключей - Public Key Infrastucture (PKI). PKI служит не только
для создания цифровых сертификатов, но и обеспечивает хранение
огромного количества сертификатов и ключей, резервное копирование,
восстановление и депонирование ключей, взаимную сертификацию,
ведение списков аннулированных сертификатов и автоматическое
обновление ключей и сертификатов после истечения срока их
действия. Использование технологии PKI позволяет компаниям предоставлять
дифференцированные и безопасные электронные услуги,
выполнять важные транзакции в интерактивном режиме, обеспечивать
конфиденциальность связи через Интернет, защищать порталы
экстранет и интранет.
PKI является комплексом аппаратных и программных средств,
политик и процедур. Продукты и услуги, входящие в инфраструктуру
открытых ключей, предлагаются на рынке целым рядом компаний.
Большинство компаний, начинающих использовать технологию
PKI, из двух путей выбирают один: они либо создают собственный
орган выдачи сертификатов, либо предоставляют это сделать другим
компаниям, специализирующимся на услугах PKI, например
Verisign, Digital Signature Trust и др.
В последнее время в развитых странах банки, университеты,
правительственные учреждения начали выдавать сотрудникам цифровые
сертификаты, которые позволяют отдельным лицам шифровать
сообщения электронной почты и электронные документы,
а также снабжать их цифровой подписью. По прогнозам специалистов,
в течение ближайших нескольких лет на рынке систем безопасности
ожидаются высокие темпы роста сферы услуг по развер-
Введение
тыванию PKI, основная причина — большой потенциал технологии
PKI. Инфраструктура открытых ключей необходима организациям
и компаниям для безопасного обмена электронными документами
и ведения бизнеса, требующего гарантированной защиты электронных
транзакций и доступа к данным через Интернет. Поставщики
электронных услуг (банковских, нотариальных, страховых, торговых
и т.п.) должны удостовериться в подлинности стороны, участвующей
в сделке, обеспечить целостность и конфиденциальность
отправляемой через Интернет информации, а также подтвердить успешное
выполнение транзакции. Пользователям необходимо иметь
возможность при коммуникации однозначно и надежно связывать
цифровой сертификат с уникальным физическим лицом. PKI предоставляет
инфраструктуру безопасности, позволяющую реализовать
эти критически важные функции и обеспечить участникам
электронного документооборота такой уровень защищенности, который
необходим незнакомым друг с другом сторонам для обмена
информацией и безопасного выполнения транзакций через Интернет.
В первой главе описываются сервисы безопасности распределенных
систем и анализируются возможности разных механизмов
безопасности.
Вторая глава посвящена анализу основных подходов к реализации
PKI и особенностей архитекторы инфраструктур открытых
ключей, в ней описываются компоненты и сервисы эффективной
PKL
В третьей главе предлагается классификация стандартов и спецификаций
в области инфраструктур открытых ключей, описываются
особенности терминологии, концепции инфраструктуры открытых
ключей PKIX.
Четвертая глава подробно знакомит со структурами данных
PKI, таблично представлены форматы сертификатов и списков аннулированных
сертификатов.
Пятая глава обобщает сведения о структуре и содержании основных
документов, описывающих политику PKI, в этой главе обсуждаются
проблемы и трудности формирования политики применения
сертификатов, регламента и проектирования инфраструктуры
открытых ключей.
Основы технологии PKI
В шестой главе анализируются риски создания, распространения
и принятия сертификатов и риски управления сертификатами,
рассматриваются основные факторы, влияющие на операционный,
стратегический риски и риск утраты репутации удостоверяющих
центров. Отдельные разделы этой главы посвящены проблемам аутентификации
и секретности в системах PKI, а также правовым аспектам
использования цифровых сертификатов.
В седьмой главе предлагается план работ по развертыванию
PKI, описываются особенности проектирования в зависимости от
потребностей ведения бизнеса и требований безопасности конкретной
организации.
В восьмой главе приводятся результаты анализа программных
прод>тстов ведущих мировых и российских компаний-производителей
программного обеспечения и особенностей их применения для практической
реализации PKJ.
7. Сервисы и механизмы безопасности
1. СЕРВИСЫ И МЕХАНИЗМЫ БЕЗОПАСНОСТИ
1.1. Сервисы безопасности
Унифицированный подход к обеспечению безопасности распределенных
систем изложен в известном международном документе
Рекомендации Х.800 (Recommendation Х.800: Security Architecture
for Open Systems Interconnection for CCITT Applications) [57]. В нем
описаны основные сервисы, или функции, безопасности: аутентификация,
управление доступом, конфиденциальность, целостность
и предотвращение отказа от участия в обмене информацией. Сервис
безопасности представляет собой совокупность механизмов, процедур
и других средств управления для снижения рисков, связанных
с угрозой утраты или раскрытия данных [2].
Сервис идентификации и аутентификации обеспечивает аутентификацию
партнеров по коммуникации и аутентификацию источника
данных. Идентификацией субъекта называется процесс сопоставления
введенной им своей характеристики с некоторым хранимым
системой идентификатором. В дальнейшем идентификатор
субъекта используется для предоставления субъекту определенного
уровня прав и полномочий. Аутентификацией субъекта называется
процедура проверки принадлежности идентификатора субъекту.
Аутентификация осуществляется на основании того или иного секретного
элемента (аутентификатора), которым располагают как
субъект, так и информационная система [41].
Обычный способ идентификации - ввод имени пользователя
при входе в систему. Для аутентификации пользователей, то есть
проверки подлинности их личности, чаще всего используются пароли.
При аутентификации источника данных подтверждается подлинность
источника отдельной порции данных. Функция не обеспечивает
защиты против повторной передачи данных [7].
Сервис управления доступом обеспечивает защиту от несанкционированного
использования доступных сетевых ресурсов.
Сервис конфиденциальности обеспечивает защиту от несанкционированного
получения информации: разрешает доступ к конфиденциальным
данным только пользователям, имеющим соответ-
10 Основы технологии PKl
ствующие права, и предотвращает несанкционированное раскрытие
информации не имеющим полномочий пользователям или процессам.
Различают следующие виды конфиденциальности:
• конфиденциальность данных при общении с установлением
соединения;
• конфиденциальность данных при общении без установления
соединения;
• конфиденциальность отдельных полей данных (избирательная
конфиденциальность);
• конфиденциальность трафика (защита информации, которую
можно получить, анализируя трафик).
Сервис целостности предотвращает преднамеренное или случайное
несанкционированное изменение данных, в том числе их
ввод, уничтожение или модификацию (изменение, сокращение или
дополнение), в процессе передачи по сети. Для гарантирования целостности
система должна обнаруживать несанкционированную модификацию
информации. Цель получателя информации - убедиться
в том, что данные при передаче не были изменены.
Сервис предотвращения отказа от участия в обмене информацией
гарантирует, что стороны, отправляющие и принимающие
электронные сообщения или документы, не смогут отрицать свое
участие в информационном обмене в целом или на отдельных его
этапах [2]. Сторона, отправляющая информацию, не сможет отрицать
того, что сообщение отправлено ею (доказательство происхождения
данных), а сторона, принимающая информацию, не сможет
отрицать того, что получила сообщение (доказательство доставки
данных). Для краткости этот сервис часто называют сервисом «неотказуемости
» или «неотрекаемости». Подвергая сомнению, с точки
зрения русского языка, правильность образования слова «неотка-
зуемость», авторы, тем не менее, признают, что термин «неотказуе-
мость» интуитивно понятен многим, привычен и широко распространен
в среде специалистов, поэтому в дальнейшем изложении
сервис предотвращения отказа от участия в обмене информацией
называют сервисом неотказуемости. Побочным продуктом сервиса
неотказуемости является аутентификация источника данных.
/. Сервисы и механизмы безопасности 11
1.2. Некриптографические механизмы безопасности
Некоторые из описанных выше сервисов безопасности могут
быть реализованы без использования криптографии. К некриптографическим
механизмам безопасности можно отнести контроль циклическим
избыточным кодом и битами четности, использование
оцифрованных подписей, РГМ-кодов и паролей, а также биометрических
средств аутентификации.
Биты контроля четности и циклический избыточный код
Простейшие механизмы безопасности разрабатывались для
гарантирования целостности данных, передаваемых между устройствами
(компьютерами и терминалами). При связи устройств через
канал с помехами (например, телефонная линия), имеется возможность
изменения данных. Во избежание этого системы могут передавать
дополнительный бит (бит четности) для каждого байта данных.
При проверке на четность бит контроля четности выбирается
так, чтобы число единичек в байте, включая бит контроля четности,
было четно. Если такой байт изменен, когда один из битов принимает
другое значение, то проверка на четность показывает, что байт
испорчен. Проверка на нечетность работает аналогичным способом,
создавая нечетное число единичек в байте. Биты контроля четности -
достаточно дорогостоящий способ защиты целостности, они увеличивают
размер сообщения, по крайней мере, на 12,5%. Более того,
они не позволяют обнаружить множественные ошибки в самом байте.
При использовании дополнительных битов четности для выявления
таких ошибок возрастает стоимость реализации сервиса целостности.
Контроль циклическим избыточным кодом выполняет ту же
самую функцию для больших потоков данных с меньшими затратами.
Вычисленное отправителем с помощью разновидности полиномиального
кода число присоединяется к передаваемому по каналам
связи сообщению. Получатель сообщения заново вычисляет циклический
избыточный код и сравнивает результат с принятым значением,
Если они совпадают, то данные не были случайно изменены.
Биты контроля четности и циклические избыточные коды защищают
данные от случайной модификации при передаче по каналу
12 Основы технологии PKl
с помехами, но не позволяют обнаружить подмену или модификацию
сообщения опытным злоумышленником.
Оцифрованные подписи
В бумажном документообороте традиционный механизм
обеспечения целостности и неотказуемости - собственноручная
подпись лица, ознакомившегося или согласного с содержанием документа.
В компьютерных приложениях в качестве заменителя собственноручной
подписи иногда используется оцифрованная подпись,
получаемая в результате сканирования рукописной подписи.
При подписании электронного документа изображение подписи
просто вставляется в соответствующее место. Оцифрованная подпись
легко узнается получателем электронного документа или сообщения
при просмотре, если ему заранее была известна собственноручная
подпись отправителя. Преимущество оцифрованных подписей
- простота использования, а существенный недостаток - ненадежность,
так как оцифрованная подпись может быть извлечена из
одного документа и вставлена в совершенно другой, к которому автор
подписи не имеет никакого отношения. Оцифрованные подписи
в основном используются вместе с дополнительными, более надежными
механизмами безопасности.
PIN'Kodbi и пароли
Традиционным и наиболее простым методом аутентификации
пользователей при получении доступа к определенной системе является
использование ими персональных идентификационных номеров
(Personal Identification Number - PIN) или секретных паролей. Системы
парольной идентификации пользователей могут быть эффективны
только при четком управлении.
Использование пароля обеспечивает так называемую однофак-
торную идентификацию, когда идентификация пользователя осуществляется
только по одному признаку [45]. Аутентификация, опирающаяся
исключительно на пароли, по ряду причин часто не обеспечивает
адекватной защиты компьютерных систем. Проблема состоит
в том, что пользователи часто выбирают в качестве паролей
легко запоминающиеся комбинации букв и цифр, которые можно
угадать или подобрать. Если пароли генерируются автоматически
как случайные, трудные для запоминания комбинации символов, то
1. Сервисы и механизмы безопасности 13
их приходится записывать, тогда недолгий поиск на рабочем месте
пользователя может дать злоумышленнику ценную информацию.
Для взлома паролей часто используются программы, которые способны
автоматически осуществлять подбор паролей.
Кроме того, PIN-коды и пароли не позволяют обеспечить не-
отказуемость, конфиденциальность или целостность данных. Если
один пользователь желает аутентифицировать другого по паролю, то
его партнер по общению должен знать этот пароль. И в том случае,
когда пароль известен обоим, трудно доказать, кто из них выполнил
определенную операцию. Поскольку аутентификация только по паролям
не обеспечивает комплексной защиты, то она часто используется
в комбинации с другими механизмами безопасности.
Биометрия
Биометрическая аутентификация опирается на уникальные
биологические показатели человека. К основным биометрическим
идентификаторам относятся отпечатки пальцев, рукописные подписи,
образцы голоса, результаты сканирования сетчатки и радужной
оболочки глаза, формы ладони или черт лица.
Новое поколение сенсорных дактилоскопических устройств
измеряет емкостное сопротивление кожи для формирования изображения
по различным характеристикам отпечатка пальца. Устройства
сканирования ладони, или сканирования формы ладони, создают
объемное изображение ладони, измеряя длину пальцев, толщи11у
и площадь поверхности ладони. В технологии сканирования черт
лица для верификации и идентификации личности используются
особенности глаз, носа и губ. Системы аутентификации по голосу
при записи образца и в процессе последующей идентификации опираются
на такие уникальные для каждого человека особенности голоса,
как высота, модуляция и частота звука.
Полученный при помощи биометрических устройств уникальный
образец вносится в список образцов биометрических идентификаторов
пользователей и применяется в качестве шаблона при верификации.
При аутентификации пользователя осуществляется измерение
заданной физической характеристики и сравнение полученного
результата с хранимым в списке шаблоном.
14 Основы технологии PKl
В настоящее время наиболее распространенной технологией
является сканирование отпечатков пальцев [26]. По уровню спроса
на первом месте стоят дактилоскопические сканеры, далее в порядке
убывания следуют системы распознавания черт лица, устройства
распознавания по форме ладони, по голосу и радужной оболочке
глаза. Завершают этот список устройства верификации подписи.
Т а б л и ц а 1.1. Сравнение некриптографических механизмов
безопасности
Механизм безопасности
Биты контроля четности и ЦИК
Оцифрованные подписи
' PIN-коды и пароли
Биометрия
я
ж
cd
О
X
о
1=:
+
-
-
-
1 ^ &о X
5
S
X
X
-§е- Xо
-
--
-
S
-
-
+
+
о
О
X 1
-
--
-
Широкое распространение средств биометрической аутентификации
тормозится рядом факторов: высокой ценой сложного и
громоздкого аппаратного обеспечения, громоздкостью для инсталляции
специального программного обеспечения, низкой скоростью
работы. Устройства биометрической аутентификации более дороги,
чем системы, использующие пароли или аппаратные ключи. Однако
биометрические характеристики обеспечивают более высокий уровень
безопасности, так как аутентификация базируется на уникальных
физических показателях пользователя. Применение устройств
биометрической аутентификации избавляет пользователей от необходимости
запоминать сложные пароли для входа в сети и опасений,
что кто-то может обойти систему защиты от несанкционированного
доступа к критически важным ресурсам [38].
В таблице 1.1 сопоставлены возможности некриптографических
механизмов для поддержки сервисов безопасности [72].
у. Сервисы и механизмы безопасности 15
1.3. Криптографические механизмы безопасности
Криптография - область прикладной математики, занимающаяся
проблемами преобразования данных для обеспечения информационной
безопасности. В криптографии отправитель преобразует
незащищенную информацию {открытый текст) в непонятный для
стороннего наблюдателя, закодированный вид {шифротекст). Получатель
использует криптографические средства, чтобы преобразовать
шифротекст в открытый текст, то есть расшифровать его, проверить
подлинность отправителя, целостность данных или реализовать
некоторые комбинации перечисленного.
Современная криптография предлагает большой набор механизмов
обеспечения информационной безопасности от "классического"
шифрования до алгоритмов хэширования, схем аутентификации,
цифровой подписи и других криптографических протоколов [146].
Кратко остановимся на трех классах криптографических механизмов
- симметричных алгоритмах, алгоритмах хэширования и асимметричных
алгоритмах.
Симметричные алгоритмы
Использование симметричных криптографических алгоритмов
предполагает наличие взаимного доверия сторон, участвующих
в обмене электронными документами или сообщениями, так как для
шифрования и расшифрования применяется известный им один
и тот же общий ключ. В этом случае нет никаких гарантий, что секретный
ключ не будет скомпрометирован, поэтому при использовании
симметричных алгоритмов требуются очень надежные механизмы
распределения ключей. Кроме того, необходимость обмена
единым ключом между отправителем сообщения и каждым из получателей
многократно увеличивает количество ключей в системе и затрудняет
ее масштабируемость. Для 10 пользователей нужно 45 ключей,
а для 1000 уже 499 500 ключей [147].
Симметричные алгоритмы могут ограниченно использоваться
для поддержания сервисов аутентификации и целостности, но,
в первую очередь, применяются для обеспечения конфиденциальности.
Для проверки целостности сообщения и аутентификации источника
данных отправитель может сгенерировать шифротекст на базе
всего открытого текста, как излагалось выше. После этого он от-
16 Основы технологии PKI
правляет открытый текст и часть шифротекста получателю сообщения.
Эта часть шифротекста известна как код аутентификации сообщения
или MAC (Message Authentication Checksum). Функция MAC
на основе входа переменной длины и ключа формирует выход фиксированной
длины [166]. Получатель использует свою копию секретного
ключа отправителя сообщения для генерации шифротекста,
выбирает ту же часть шифротекста и сравнивает ее с полученным
значением MAC. Их совпадение подтверждает подлинность отправителя,
но не гарантирует невозможности отказа от участия в обмене
сообщениями. Отправитель может отрицать факт передачи сообщения,
мотивируя это тем, что получатель мог сгенерировать сообщение
сам.
Управление ключами - сложная проблема, она может решаться
при помощи криптографии с симметричными ключами, но является
классической проблемой типа «курицы или яйца». Прежде чем
отправитель зашифрует сообщение или сгенерирует MAC, он должен
разделить с получателем некоторый секрет. Разделение секрета,
например, секретного ключа из нескольких частей, осуществляется
таким образом, чтобы из любого заранее указанного количества
к-частей можно было восстановить секрет, а количества частей (к-1)
для восстановления секрета было недостаточно [166]. В системах
с одним ключом утрата ключа фактически равноценна взлому криптографической
защиты. Для обеспечения требуемого уровня защиты
ключ обычно передают по каналам, отличным от канала распространения
зашифрованных данных. При этом должна обеспечиваться
надежная идентификация пользователя (он должен иметь санкционированный
доступ к зашифрованной информации) и секретность
(предотвращение доступа к ключу в процессе передачи).
Преимуществами симметричных криптографических алгоритмов
признаны их высокая производительность и стойкость, которая
делает практически невозможным процесс расшифрования. Одним
из первых стандартных симметричных алгоритмов стал DES (Digital
Encryption Standard), затем появился Triple DES, который выполняет
алгоритм DES троекратно и соответственно требует для работы в
три раза больше времени. Для решения проблемы производительности
и повышения защитных свойств были предложены новые алго-
/. Сервисы и механизмы безопасности 17
ритмы RC2 и RC5 корпорации RSA Security, IDEA компании Ascom,
Cast компании Entrust Technologies, Safer компании Cylink и Blowfish
компании Соитефапе Systems [2]. В России разработан и используется
симметричный алгоритм ГОСТ 28147-89. В качестве нового
международного стандарта AES (Advanced Encryption Standard)
предлагается симметричный алгоритм Rijndael, разработанный бельгийскими
криптографами В. Риджменом и Д. Дименом.
Алгоритмы хэширования
Криптографическими методами можно обеспечить не только
конфиденциальность, но и проконтролировать целостность передаваемых
или хранимых данных. Контроль целостности в основном
осуществляется путем расчета некоторой "контрольной суммы"
данных. На сегодняшний день известно множество алгоритмов, рассчитывающих
контрольные суммы передаваемых данных. Проблема
простых алгоритмов вычисления контрольной суммы состоит в том,
что достаточно легко подобрать несколько массивов данных, имеющих
одинаковую контрольную сумму. Криптографически стойкие
контрольные суммы вычисляются как результат применения к исходному
тексту так называемой хэш-функции. Хэш-функции являются
необходимым элементом ряда криптографических схем. Под
этим термином понимаются функции, отображающие сообщения
произвольной длины (иногда длина сообщения ограничена, но достаточно
велика) в значения фиксированной длины [146]. Последние
часто называют дайдэюестами, или хэш-кодами, сообщений.
Главными свойствами "хорошей" в криптографическом смысле
хэш-функции являются свойство необратимости, свойство стойкости
к коллизиям и свойство рассеивания. Необратимость означает, что
вычисление обратной функции (то есть восстановление значения аргумента
по известному значению функции) оказывается невозможно теоретически
или (в крайнем случае) невозможно вычислительно. Свойство
стойкости к коллизиям хэш-функции Н выражается в невозможности
найти два разных сообщения Tj и Т2 с одинаковым результатом
преобразования ЩТ^) = Н(Т2). Дайджест может быть повторно
получен для того же сообщения любым пользователем, но
практически невозможно создать разные сообщения для получения
одного и того же дайджеста сообщения. Значение хэш-функции все-
18 Основы технологии PKI
гда имеет фиксированную длину, а на длину исходного текста не
накладывается никаких ограничений. Свойство рассеивания требует,
чтобы минимальные изменения текста, подлежащего хэшированию,
вызывали максимальные изменения в значении хэш-функции [41].
Дайджест сообщения может использоваться для обеспечения
целостности. Отправитель посылает сообщение вместе с контрольным
значением - дайджестом, если сообщение было изменено, контрольное
значение также будет другим. Получатель может вновь
вычислить дайджест сообщения, чтобы убедиться, что данные не
были случайно изменены. Однако это не защищает получателя от
действий злоумышленника, который может перехватить и заменить
сообщение отправителя и дайджест.
Хэш-функция может использоваться для создания так называемого
кода аутентификации сообщения на основе вычисления хэша
НМАС {Hash Message Authentication Checksum). Если отправитель
посылает сообщение и его НМАС получателю, то последний
может вновь вычислить НМАС для защиты от случайных изменений
данных. В этом случае злоумышленник может перехватить сообщение
отправителя и заменить его на новое, но, не зная секретного
ключа, не имеет возможности рассчитать соответствующий НМАС.
Если получатель доверяет отправителю, то принимает НМАС как
подтверждение подлинности отправителя.
Обычно коды НМАС используются только для быстрой проверки
того, что содержимое не было изменено при передаче. Для
создания уникальной, подлежащей проверке подписи необходим
другой способ, он заключается в шифровании дайджеста с помощью
секретного ключа лица, поставившего подпись. В этом случае хэш-
функция используется в схемах электронной цифровой подписи
(ЭЦП). Поскольку применяемые на практике схемы электронной
подписи не приспособлены для подписания сообщений произвольной
длины, а процедура разбиения сообщения на блоки и генерации
подписи для каждого блока по отдельности крайне неэффективна,
схему подписи применяют к дайджесту сообщения. Очевидно, что
наличие эффективных методов поиска коллизий для хэш-функции
подрывает стойкость протокола электронной подписи [146]. Хэш-
функции используются также в некоторых протоколах аутентифи-
L Сервисы и механизмы безопасности 19
кации для снижения их коммуникационной сложности, то есть для
уменьшения длин пересылаемых сообщений, и в некоторых других
криптографических протоколах.
Существует множество алгоритмов, реализующих хэш-
функции, к ним относятся алгоритмы вычисления дайджестов, созданные
Роном Ривестом (MD2, MD5), SHA и его вариант SHA1,
российский алгоритм, описываемый стандартом ГОСТ Р 34.11-94.
Асимметричные алгоритмы
Асимметричная криптография, также известная как криптография
с открытыми ключами, использует класс алгоритмов, в которых
применяется пара ключей: открытый ключ и секретный (личный)
ключ, известный только его владельцу. В отличие от секретного
ключа, который должен сохраняться в тайне, открытый ключ может
быть общедоступным, не подвергая опасности систему защиты.
Открытый и секретный ключи генерируются одновременно, и данные,
зашифрованные одним ключом, могут быть расшифрованы при
помощи другого ключа. То есть отправитель может зашифровать
сообщение, используя открытый ключ получателя, и только получатель
- владелец соответствующего секретного ключа, может расшифровать
это сообщение.
Асимметричные системы имеют ряд преимуществ перед симметричными
системами. В асимметричных системах решена сложная
проблема распределения ключей между пользователями, так как
каждый пользователь может сгенерировать свою пару ключей, а открытые
ключи свободно публикуются и распространяются. Благодаря
тому, что в асимметричных системах секретный ключ известен
только его владельцу, возможно взаимодействие сторон, не знающих
друг друга. Среди асимметричных алгоритмов наиболее известными
являются RSA и алгоритм Эль-Гамаля [150].
Криптография с открытыми ключами в чистом виде обычно не
применяется, так как реализация асимметричных алгоритмов требует
больших затрат процессорного времени. Тем не менее, преимуществами
криптографии с открытыми ключами пользуются при
формировании и проверке ЭЦП, а также для решения проблемы
распределения ключей. Секретный ключ применяется для подписания
данных, а открытый ключ - для их проверки. Единственно из-
20 Основы технологии PKI
вестный способ получить корректную подпись - использовать секретный
ключ. Кроме того, для каждого сообщения формируется
уникальная подпись. В целях повышения производительности подписывается
не все сообщение, а его дайджест [2]. Вообще, собственно
ЭЦП сообщения - это дайджест сообщения, зашифрованный секретным
ключом, он пересылается вместе с цифровым объектом
и удостоверяет целостность самого объекта и подлинность его отправителя
Для выработки ЭЦП пользователь генерирует открытый
и секретный ключи. Затем секретный ключ и цифровой объект (документ)
используются как входная информация для функции генерации
цифровой подписи. После того как другой пользователь получает
цифровой объект, он использует сам объект, связанную с ним
цифровую подпись и открытый ключ для верификации (проверки)
подписи. Верификация ЭЦП сообщения заключается в вычислении
значения дайджеста полученного сообщения и его сравнении со значением
дайджеста в подписи, расшифрованной открытым ключом
отправителя. Если значения вычисленного получателем и сохраненного
в подписи дайджеста совпадают, то считается, что подпись под
документом верна, а сам документ - подлинный [41]. Цифровая подпись
обеспечивает надежную защиту документа от подлога и случайных
модификаций и позволяет придавать юридическую силу электронным
документам и сообщениям.
В схемах цифровой подписи применяются три основных алгоритма:
RSA, алгоритм цифровой подписи DSA (Digital Signature Algorithm)
и его вариант с использованием эллиптических кривых -
ECDSA (Elliptic Curve Digital Signature Algorithm).
Сравнение криптографических механизмов безопасности
Криптографические механизмы необходимы для поддержания
основных сервисов безопасности. Каждый класс алгоритмов имеет
свои сильные и слабые стороны (см. табл. 1.2) [72].
Алгоритмы хэширования и коды аутентификации сообщения -
основа обеспечения целостности данных в электронных коммуникациях.
Но они не позволяют обеспечить конфиденциальность, аутентификацию,
неотказуемость и распределение ключей. Алгоритмы
цифровой подписи такие, как RSA и DSA, по эффективности пре-
7. Сервисы и механизмы безопасности 21
восходят алгоритмы хэширования. Если управление ключами возлагается
на третью доверенную сторону, цифровые подписи могут использоваться
для обеспечения неотказуемости.
Т а б л и ц а 1.2. Сравнение криптографических механизмов безопасности
Механизм безопасности
Симметричная
криптография
Хэш-функции
Асимметричная
криптография
Шифрование
Коды аутентификации
сообщения
Транспортировка ключей
Дайджест сообщения
НМАС
Цифровые подписи
Транспортировка ключей
Согласование ключей
2к ад
О
о
-
+
-
+
+
+
-
-
1 ^
о
о
S
=J
•X
s
о
1^
+
-
-----
-
ь S
" 1
S «
•е- S
-
-
-
--
+
-
-
он
О
Н
О
-
-
--
-
+
-
-
1)
S
X
с?
(2н «!
-
-
+
1
1
1 +
+ 1
Для обеспечения конфиденциальности должны использоваться
симметричные криптографические алгоритмы. В некоторой мере
они также могут обеспечить целостность и аутентификацию, но не
позволяют предотвратить отказ от участия в информационном обмене.
Самое слабое звено этих алгоритмов - распространение (распределение)
ключей. Для решения проблемы распространения ключей
широко используются алгоритм RSA, алгоритм Диффи-
Хэллмана - Diffie-Hellman (DH) и алгоритм эллиптических кривых
Диффи-Хэллмана - Elliptic Curve Diffie-Hellman (ECDH). Распространение
ключей может выполняться тремя способами: прямым
обменом между сторонами при помощи симметричного шифрования;
посредством симметричного шифрования и доверенной третьей
22 Основы технологии PKI
стороны или при помощи управления открытыми ключами доверенной
третьей стороной.
Первый способ подходит для небольших закрытых сообществ
с числом пользователей не более 4-5 человек. Это решение плохо
масштабируется при росте сообщества. Если число участников обмена
ключами достигает 10-12 человек, то возникает необходимость
в доверенной третьей стороне. Второй способ позволяет существенно
расширить сообщество пользователей, но не обеспечивает в должной
мере аутентификацию партнеров и неотказуемость. Только третий
способ решает проблему комплексно. Если доверенная третья сторона
связывает открытый ключ с пользователем или системой, то
есть подтверждает подлинность стороны, владеющей соответствующим
секретным ключом, поддерживаются все сервисы безопасности.
Систематическим, расширяемым, унифицированным и легко
управляемым подходом к распространению открытых ключей стали
сертификаты открытых ключей [2]. Инфраструктура безопасности
для распространения открытых ключей, управления электронными
сертификатами и ключами пользователей получила название инфраструктуры
открытых ключей Public Key Infrastructure (PKI). Термин
PKI является производным от названия базовой технологии -
криптографии с открытыми Ю1ючами, обладающей уникальными
свойствами и являющейся основой для реализации функций безопасности
в распределенных системах.
2. Структура, сервисы и архитектура PKI 23
2. СТРУКТУРА, СЕРВИСЫ И АРХИТЕКТУРА PKI
2.1. Основные подходы к реализации PKI
Общими целями современных архитектур безопасности являются
защита и распространение информации в распределенной среде,
где пользователи, ресурсы и посредники разделены во времени
и пространстве. Инфраструктура открытых ключей обеспечивает
сервисы, необходимые для непрерывного управления ключами
в распределенной системе, связывает открытые ключи с владельцами
соответствующих секретных ключей и позволяет пользователям
проверять подлинность этих связей. PKI поддерживает электронный
документооборот и обеспечивает ведение электронного бизнеса, гарантируя,
что:
1) лицо или процесс, идентифицируемый как отправитель
электронного сообщения или документа, действительно является
инициатором отправления;
2) лицо или процесс, выступающий получателем электронного
сообщения или документа, действительно является тем получателем,
которого имел в виду отправитель;
3) целостность передаваемой информации не нарушена.
С ростом числа приложений, использующих криптографию,
с увеличением количества ее пользователей возрастает количество
разнородных сертификатов, как во всей информационной системе,
так и у каждого конкретного ютиента [16]. Задачу единообразной
организации сервиса управления сертификатами успешно решает
инфраструктура открытых ключей (PKI). В настоящее время известно
пять основных подходов к реализации PKI в следующих системах:
1) инфраструктура открытых ключей, основанная на сертификатах
Х.509 - PKIX;
2) простая инфраструктура открытых ключей SPKI/SDS1;
3) защищенная система доменных имен DNS;
4) система защищенной почты PGP;
5) система защищенных электронных транзакций SET.
24 Основы технологии PKl
Большая часть данной работы посвящена технологии PKI, базирующейся
на первом подходе, поэтому кратко охарактеризуем
остальные подходы.
Простая инфраструктура открытых ключей SPKI/SDSI
Задачей простой инфраструктуры открытых ключей SPKI
(Simple Public Key Infrastructure) является распространение сертификатов
для авторизации, а не для аутентификации владельцев открытых
ключей. Теоретические основы и требования к SPKI разработаны
группой инженерной поддержки Интернет (Internet Engineering
Task Force - IETF). IETF является открытым интернациональным
сообществом исследователей, разработчиков сетевых протоколов,
операторов и производителей, занимающихся проблемами развития
сетей Интернет и обеспечением непрерывного функционирования
существующей инфраструктуры. Базой для SPKI стали основные
идеи простой распределенной структуры безопасности - Simple Distributed
Security Infrastructure (SDSI), поэтому можно говорить
о единой концепции, кратко обозначаемой SPKI/SDSI. Центральными
объектами SDSI являются сами ключи, а не имена. Именно ключи
могут идентифицировать объекты. Сертификаты SDSI имеют
удобную для восприятия человеком форму, как правило, содержат
некоторый текст свободного формата, возможно фотографию или
другую информацию.
Основная цель сертификата SPKI - это авторизация некоторых
действий, выдача разрешений, предоставление возможностей и т.п.
владельцу ключа (RFC 2692 SPKI Requirements). Сертификаты для
авторизации, по замыслу авторов идеи SPKI, должны генерироваться
любым владельцем ключа, которому разрешено предоставлять
или делегировать полномочия. Владелец ключа непосредственно
идентифицируется своим открытым ключом, хотя для ряда целей
допускается применение некоторых других идентификаторов. Это
может быть значение дайджеста открытого ключа или некоторое
имя, которое, тем не менее, всегда связано с ключом. В связи с тем,
что сертификаты SPKI могут содержать информацию, которую владелец
ключа не желает публиковать, допускается, чтобы сертификаты
распространялись самим владельцем. Владелец ключа может ис-
2. Структура, сервисы и архитектура PKI 25
пользовать глобальное хранилище, например LDAP, сервер ключей
PGP или систему доменных имен DNS.
Поскольку сертификаты SPKI содержат информацию, извлечение
которой из всех сертификатов представляет угрозу безопасности
и приватности, то каждый сертификат должен содержать минимум
информации, необходимой в зависимости от назначения сертификата.
Сертификат должен быть подобен одному ключу, а не связке
ключей. Владелец ключа должен выпускать минимум информации,
подтверждающей его полномочия. Иногда необходима анонимность
некоторых сертификатов. Так как одним из вариантов
применения сертификатов SPKI является их использование в секретном
голосовании и аналогичных приложениях, сертификаты
SPKI должны уметь присваивать атрибут ключу обезличенной подписи.
Одним из атрибутов владельца ключа является его имя. У одного
владельца ключа может быть несколько имен: те, которыми
владелец предпочитает называться, и те, под которыми он известен
другим владельцам ключей. Сертификат SPKI должен обеспечивать
связывание ключей с такими именами.
Сертификат SPKI, как и всякий другой, имеет период действия.
Проверка действительности сертификатов в простой инфраструктуре
открытых ключей осуществляется при помощи списка
аннулированных сертификатов (САС). Минимальный САС содержит
перечень уникально идентифицированных аннулированных
сертификатов, номер данного списка в последовательности публикуемых
САС и подпись. Так как в SPKI явным образом не задается
способ передачи САС, то основным требованием является точное
указание в сертификате открытого ключа подписи для лица, желающего
проверить законность сертификата, информации о местонахождении
САС. SPKI должна поддерживать проверку действительности
сертификатов в онлайновом режиме.
Защищенная система доменных имен DNS
Одной из альтернатив системы распространения открытых
ключей посредством сертификатов Х.509 могут служить расширения
системы доменных имен Domain Name System (DNS). DNS
представляет собой распределенную базу данных с децентрализованным
управлением, хранящую обобщенные записи о ресурсах сети.
26 Основы технологии PKI
и задает схему именования, основанную на иерархически структурированных
доменных именах. Структура базы данных DNS - инвертированное
дерево с корнем на верху. Каждый узел дерева представляет
раздел общей базы данных или домен. Каждый домен имеет
доменное имя, которое идентифицирует его местоположение
в базе данных DNS. Информация о пространстве доменных имен
хранится серверами имен [155]. Система доменных имен DNS позволяет
использовать для доступа к серверам сети Интернет словесные
обозначения вместо их цифровых IP адресов.
Безопасность передачи данных DNS, а особенно передачи информации
о зоне пространства доменных имен и динамическом обновлении,
имеет исключительно большое значение. Для защиты передаваемых
данных используется механизм TSIG, который заключается
в том, что в каждое DNS-сообщение добавляется виртуальная
запись, содержащая дайджест сообщения и секретного ключа, известного
только отправителю и получателю [169]. Запись TSIG называется
виртуальной, потому что она не находится в базе данных,
а формируется динамически для каждого DNS-сообщения. Для вычисления
дайджеста используется алгоритм MD5. После того, как
дайджест вычислен, в конец сообщения добавляется запись TSIG,
содержащая имя ключа, время создания сообщения, допустимое
расхождение часов отправителя и получателя и собственно дайджест.
Получатель сообщения, используя свою копию секретного
ключа, тоже вычисляет дайджест, и, если его значение совпадает
с полученным в сообщении, это свидетельствует о целостности и
подлинности сообщения. Механизм TSIG позволяет аутентифици-
ровать любые DNS-сообщения: передачу зоны, динамическое обновление
и обычные запросы и ответы, — но только между хостами,
знающими секретный ключ (каждая пара хостов может иметь свой
секретный ключ).
Для обеспечения достоверной передачи DNS-данных в масштабе
сетей Интернет используются расширения системы DNS, называемые
DNSSEC. Основная идея DNSSEC состоит в использовании
криптографии с открытыми ключами для присоединения цифровой
подписи к передаваемым данным. Секретный ключ известен
только администратору первичного сервера зоны. Записи из базы
2. Структура, сервисы и архитектура PKI 27
данных зоны обрабатываются алгоритмом хэширования (как правило,
MD5), и получившийся дайджест шифруется с помощью секретного
ключа - так формируется цифровая подпись. Она заносится
в базу данных зоны в виде записи специального типа SIG и присоединяется
к передаваемым данным при ответе на запрос. Сами данные
передаются в открытом виде. Открытый ключ доступен по запросу
всем потенциальным получателям; он хранится в базе данных
зоны в записи специального типа. Приняв данные и подпись, получатель
расшифровывает подпись с помощью открытого ключа. Потом
он вычисляет дайджест полученных данных и сравнивает с результатом
расшифровки ЭЦП. Совпадение дайджестов подтверждает,
что данные при передаче не изменялись и действительно были
отправлены владельцем секретного ключа.
В отличие от TSIG механизм DNSSEC не требует от получателя
знания секретного ключа, что позволяет обойти неразрешимую
задачу распространения секретного ключа по всем возможным DNS-
серверам глобальной сети. Платой за это является существенное
(в несколько раз) увеличение базы данных каждой зоны и повышенные
требования к процессорной мощности DNS-серверов, которая
требуется для выполнения операций криптографии с открытыми
ключами. Для реализации механизма DNNSEC вводятся три новых
типа записей: KEY, SIG и NXT. Запись типа KEY содержит открытый
ключ зоны, закодированный для текстового представления с помощью
алгоритма Base64. Запись типа SIG содержит цифровую подпись
для набора записей одного типа для одного доменного имени.
Получив запрос определенного набора записей, сервер возвращает
требуемые данные, а вместе с ними - запись SIG, которая их удостоверяет.
Цифровая подпись также кодируется с помощью Base64.
Кроме собственно цифровой подписи запись SIG содержит время
создания подписи и момент истечения ее срока действия.
Открытый ключ зоны тоже подписывается с помощью секретного
ключа вышестоящей зоны. Что касается открытых ключей самой
верхней, корневой зоны, то считается, что они широко известны
и, следовательно, их фальсификация будет немедленно обнаружена
любым сервером DNS. Очевидно, описанная схема работает только
в том случае, если все зоны от заданной и до корневой включи-
28 Основы технологии PKI
тельно используют DNSSEC. В системе DNS обеспечивается хранение
сертификатов открытых ключей CERT RR и списков аннулированных
сертификатов.
Система защищенной почты PGP
Система PGP (Pretty Good Privacy) [162] разработана американским
программистом Филом Циммерманном для защиты секретности
файлов и сообщений электронной почты в глобальных вычислительных
и коммуникационных средах. PGP представляет собой
гибридную систему, комплексно использующую преимущества
асимметричных и симметричных криптографических алгоритмов.
С точки зрения пользователя, PGP ведет себя как система с открытым
ключом. Она обеспечивает безопасный обмен сообщениями
и файлами по каналам открытой связи без наличия защищенного
канала для обмена ключами [165]. PGP позволяет шифровать, заверять
электронной цифровой подписью, расшифровывать и проверять
сообщения во время отправки и чтения электронной почты. В PGP
применяются стойкие криптографические алгоритмы CAST, тройной
DBS и IDEA. Для выработки сеансового ключа используются
алгоритмы RSA и Диффи-Хеллмана, для подписи - RSA и DSA.
Перед использованием PGP пользователю необходимо сгенерировать
открытый и секретный ключи. Открытый ключ может быть
передан абоненту как сообщение электронной почты, как файл, или
помещен на сервер открытых ключей. Получив копию чьего-либо
открытого ключа, пользователь может добавить его на свою связку
открытых ключей. Убедиться в том, что ключ не был подделан,
можно, сравнивая уникальный отпечаток своей копии ключа с отпечатком
оригинальной копии. Отпечаток - это строка из цифр и букв,
уникальным образом идентифицирующая владельца ключа. После
проверки действительности ключа пользователь подписывает его,
подтверждая PGP безопасность его использования. При этом пользователь
может указать степень доверия, которую он испытывает
к владельцу ключа, в смысле его способности ручаться за подлинность
ключей третьих лиц. Степень доверия к способности владельца
ключа выступать в качестве посредника отражает оценку не только
его персональной порядочности, но и компетентности в понимании
механизма управления ключами и склонности руководствовать-
2. Структура, сервисы и архитектура PKI 29
ся здравым рассудком при принятии решения о сертификации ключа
третьего лица. Пользователь может обозначить лицо как пользующееся
полным доверием, ограниченным доверием или не пользующееся
доверием. Эта информация о степени доверия к конкретному
владельцу ключа хранится на связке вместе с соответствующими
ключами, но при экспорте ключа из связки она не передается, так
как считается конфиденциальной.
При оценке действительности открытого ключа в системе PGP
проверяется уровень доверия, приданный пользователем всем подписям,
которыми он сертифицирован. Система вычисляет взвешенное
значение действительности, при этом две подписи лиц, пользующихся
ограниченным доверием, рассматриваются так же, как
подпись одного лица, пользующегося полным доверием. Ключи,
сертифицированные посредниками, которым доверяет пользователь,
PGP считает действительными. Ключи, принадлежащие этим посредникам,
сами должны быть сертифицированы пользователем или
другими посредниками, которым пользователь доверяет. Таким образом,
формируется сеть поручительства участников системы PGP
за достоверность распространяемых ключей, так называемая сеть
доверия. Предоставление всем пользователям возможности действовать
в качестве посредников считается целесообразным для децентрализованных
сред.
POP поддерживает в качестве частного случая своей обобщенной
модели распределенного доверия централизованный сценарий,
когда сертификаты открытых ключей пользователей заверяет
своей подписью лицо, пользующееся общим доверием - удостоверяющий
центр [162]. Любому открытому ключу, заверенному подписью
удостоверяющего центра, можно доверять в том смысле, что
он принадлежит тому, чье имя он несет. Все пользователи должны
обладать копией открытого ключа удостоверяющего центра для
проверки его цифровой подписи. POP обеспечивает интегрированную
поддержку распространения и поиска открытых ключей на серверах
ключей. Единый удостоверяющий центр особенно подходит
для больших централизованно управляемых организаций, правительственных
или корпоративных. Некоторые организационные
среды используют иерархию удостоверяющих центров, лежащую
30 Основы технологии PKI
в основе стандартной схемы, основанной на централизованном контроле
и принудительно централизованном доверии. Иерархия удостоверяющих
центров обычно диктует пользователю, кому он должен
доверять. Децентрализованный вероятностный метод определения
действительности ключей, реализованный PGP, позволяет пользователю
самостоятельно принимать решение о доверии, строя свою
собственную пирамиду сертификации.
Система защищенных электронных транзакций SET
Протокол SET, базирующийся на техническом стандарте, разработанном
компаниями VISA и Master Card [170], обеспечивает
безопасность электронных расчетов по пластиковым картам через
Интернет: гарантирует конфиденциальность и целостность информации
о платежах, аутентификацию счета владельца карты и дает
возможность подтвердить право коммерсанта (продавца) проводить
финансовые операции с финансовым учреждением [1]. В среде SET
инфраструктура открытых ключей является фундаментом, на котором
базируется вся система аутентификации участников расчетов.
Цифровые сертификаты, также известные как электронные
мандаты или цифровые удостоверения личности, используются для
связывания открытых ключей и субъектов и выпускаются доверенной
третьей стороной или компанией - удостоверяющим центром
(УЦ). Сертификаты владельцев карт выдаются только с разрешения
финансового учреждения - эмитента этих карт, снабжаются его
цифровой подписью и не могут быть изменены третьей стороной.
Сертификаты содержат данные о номере счета и периоде действия,
которые шифруются с использованием известного алгоритма шифрования
с секретным ключом - Data Encryption Standard (DES). Запрашивая
сертификат, владелец карты сообщает о своем намерении
стать участником электронной торговли. Эти сертификаты передаются
продавцам вместе с запросами о покупке и платежными инструкциями.
Сертификаты продавцов снабжаются цифровыми подписями
их финансовых учреждений, открывающих счета продавцов и обрабатывающих
авторизации и платежи по картам. Эти финансовые
учреждения являются получателями платежей, переводимых посредством
системы межбанковских расчетов. Чтобы участвовать в систе-
2. Структура, сервисы и архитектура PKI 31
ме SET и получатели платежей, и эмитенты карт также должны
иметь сертификаты от каждой ассоциации платежных карт. Сертификаты
SET проверяются в иерархии доверия. Каждый сертификат
связан с сертификатом подписи того субъекта, который снабдил его
цифровой подписью. Следуя по цепочке доверия до известной доверенной
стороны, так называемого корневого удостоверяющего центра,
находящегося на верхнем уровне иерархии, можно убедиться
в подлинности сертификата.
Конфиденциальность и целостность сообщений, которыми
обмениваются участники системы защищенных электронных транзакций,
обеспечивается механизмом двойных подписей. Содержание
каждого сообщения шифруется при помощи случайно сгенерированного
симметричного ключа шифрования. Этот ключ, в свою очередь,
шифруется с использованием открытого ключа получателя сообщения.
Полученный в результате последней операции так называемый
цифровой конверт отправляется получателю вместе с зашифрованным
сообщением. После получения цифрового конверта,
получатель расшифровывает его, используя свой секретный ключ,
чтобы получить случайно сгенерированный симметричный ключ
для расшифровки исходного сообщения отправителя.
Протокол SET предоставляет сервис аутентификации для участников
посредством использования сертификатов формата Х.509
и имеет средства аннулирования, реализованные с помощью списка
аннулированных сертификатов. В SET определены свои собственные
специфические дополнения сертификатов, которые поддерживаются
только в SET - совместимых системах [2].
Для безопасного ведения элекфонной торговли разработано
множество транзакций, в том числе регистрация владельца карты,
регистрация продавца, запрос о покупке, авторизация платежа, получение
платежа и др. Открытая спецификация SET предоставляет
инфраструктуру для использования платежных карт в открытых
компьютерных сетях, гаратирующую безопасность платежных
средств.
32 Основы технологии PKI
2.2. Компоненты и сервисы
инфраструктуры открытых ключей
2.2.1. Основные компоненты PKI
Инфраструктура открытых ключей представляет собой комплексную
систему, обеспечивающую все необходимые сервисы
для использования технологии открытых ключей. Цель PKI состоит
в управлении ключами и сертификатами, посредством которого
корпорация может поддерживать надежную сетевую среду. PKI
позволяет использовать сервисы шифрования и выработки
цифровой подписи согласованно с широким кругом приложений,
функционирующих в среде открытых ключей.
Основными компонентами эффективной PKI являются:
• удостоверяющий центр;
• регистрационный центр;
• реестр сертификатов;
• архив сертификатов;
• конечные субъекты (пользователи).
В составе PKI должны функционировать подсистемы аннулирования
сертификатов, создания резервных копий и восстановления
ключей, поддержки невозможности отказа от цифровых подписей,
автоматической корректировки пар ключей и сертификатов, управления
«историей» ключей и поддержки взаимной сертификации,
прикладное программное обеспечение пользователей должно взаимодействовать
со всеми этими подсистемами безопасным, согласованным
и надежным способом [9].
Удостоверяющий центр
Непосредственное использование открытых ключей требует
дополнительной их защиты и идентификации для определения связи
с секретным ключом. Без такой дополнительной защиты злоумышленник
может выдавать себя как за отправителя подписанных данных,
так и за получателя зашифрованных данных, заменив значение
открытого ключа или нарушив его идентификацию. Все это приводит
к необходимости верификации открытого ключа [147]. Все
пользователи PKI должны иметь зарегистрированное удостоверение,
признаваемое сообществом пользователей законным и надежным.
2. Структура, сервисы и архитектура РК1 33
Эти удостоверения хранятся в цифровом формате, известном как
сертификат с открытым ключом. Электронный сертификат представляет
собой цифровой документ, который связывает открытый
ключ с его владельцем. Для заверения электронного сертификата
используется электронная цифровая подпись удостоверяющего
центра (УЦ), в этом смысле удостоверяющий центр уподобляется
нотариальной конторе, так как подтверждает подлинность сторон,
участвующих в обмене электронными сообщениями или документами.
Удостоверяющий центр объединяет людей, процессы, программные
и аппаратные средства, вовлеченные в безопасное привязывание
имен пользователей к их открытым ключам. Удостоверяющий
центр известен пользователям по двум атрибутам: названию
и открытому ключу. УЦ включает свое имя в каждый выпущенный
им сертификат и список аннулированных сертификатов (САС)
и подписывает их при помощи собственного секретного ключа.
Пользователи могут легко идентифицировать сертификаты по имени
удостоверяющего центра и убедиться в их подлинности, используя
его открытый ключ.
Удостоверяющий центр, главный управляющий компонент
PKI, выполняет следующие основные функции:
• формирует собственный секретный ключ и самоподписанный
сертификат;
• выпускает (то есть создает и подписывает) сертификаты
подчиненных удостоверяющих центров и сертификаты открытых
ключей пользователей;
• ведет базу всех изданных сертификатов и формирует список
аннулированных сертификатов с регулярностью, определенной
регламентом;
• публикует информацию о статусе сертификатов и САС.
При необходимости удостоверяющий центр может делегировать
некоторые функции другим компонентам PKI. Выпуская сертификат
открытого ключа, удостоверяющий центр тем самым подтверждает,
что лицо, поименованное в сертификате, владеет секретным
ключом, который соответствует этому открытому ключу.
Включая в сертификат дополнительную информацию, удосто-
34 Основы технологии PKI
веряющий центр подтверждает ее принадлежность этому субъекту.
Дополнительная информация может быть контактной (например,
адрес электронной почты) или содержащей сведения о типах приложений,
которые могут работать с данным сертификатом. Когда
субъектом сертификата является другой удостоверяющий центр, издатель
подтверждает надежность выпущенных этим центром сертификатов.
Действия удостоверяющего центра ограничены политикой
применения сертификатов (ППС), которая диктует ему, какую информацию
должен содержать сертификат. Удостоверяющий центр
выполняет адекватную защиту своего секретного ключа и открыто
публикует свою политику, чтобы пользователи могли убедиться в соответствии
ей сертификатов. Ознакомившись с политикой применения
сертификатов и решив, что доверяют удостоверяющему центру
и его деловым операциям, пользователи могут полагаться на сертификаты,
выпущенные этим центром. Таким образом, в PKI удостоверяющие
центры выступают как доверенная третья сторона.
Регистрационный центр
Регистрационный центр (РЦ) является необязательным компонентом
PKI. Обычно РЦ получает уполномочия от удостоверяющего
центра регистрировать пользователей, обеспечивать их взаимодействие
с удостоверяющим центром и проверять информацию,
которая заносится в сертификат. Сертификат может содержать информацию,
предоставленную субъектом, подающим заявку на сертификат
и предъявляющим документ (например, паспорт, водительские
права, чековую книжку и т.п.) или третьей стороной (кредитным
агентством о кредитном лимите пластиковой карты). Иногда
в сертификат включается информация из отдела кадров или данные,
характеризующие полномочия субъекта в компании (например, право
подписи документов определенной категории). РЦ агрегирует эту
информацию и предоставляет ее удостоверяющему центру.
Удостоверяющий центр может работать с несколькими регистрационными
центрами, в этом случае он поддерживает список аккредитованных
регистрационных центров, то есть тех, которые признаны
надежными. Удостоверяющий центр выдает сертификат регистрационному
центру. РЦ выступает как объект, подчиненный удо-
2. Структура, сервисы и архитектура РК1 35
стоверяющему центру, и должен адекватно защищать свой секретный
ключ. РЦ известен удостоверяющему центру по имени и открытому
ключу. Проверяя подпись РЦ на сообщении или документе,
удостоверяющий центр полагается на надежность предоставленной
РЦ информации.
РЦ объединяет комплекс программного и аппаратного обеспечения
и людей, работающих на нем. В функции РЦ может входить
генерация и архивирование ключей, уведомление об аннулировании
сертификатов, публикация сертификатов и САС в сетевом справочнике
LDAP и др. Но РЦ не может выпускать сертификаты и списки
аннулированных сертификатов. Иногда удостоверяющий центр сам
выполняет функции регистрационного центра.
Реестр сертификатов
Реестр сертификатов - специальный объект PKI, база данных,
где хранятся действующие сертификаты и списки аннулированных
сертификатов. Термин «реестр» введен в практику Законом
РФ «Об электронной цифровой подписи» [19] и является синонимом
ранее использованных в литературе названий хранилища сертификатов:
каталог, репозиторий, справочник и др. Этот компонент PKI
значительно упрощает управление системой и доступ к ресурсам.
Реестр предоставляет информацию о статусе сертификатов, обеспечивает
хранение и распространение сертификатов и списков аннулированных
сертификатов, управляет внесениями изменений в сертификаты.
К реестру предъявляются следующие требования:
• простота и стандартность доступа;
• регулярность обновления информации;
• встроенная защищенность;
• простота управления;
• совместимость с другими хранилищами (необязательное
требование).
Реестр обычно размещается на сервере каталогов, соответствующем
международному стандарту Х.500 и его подмножеству.
Большинство серверов каталогов и прикладное программное обеспечение
пользователей поддерживают протокол облегченного доступа
к каталогам LDAP. Такой унифицированный подход позволяет
обеспечивать функциональную совместимость приложений PKI
36 Основы технологии PKI
и дает возможность доверяющим сторонам получать информащсю
о статусе сертификатов для верификации ЭЦП.
Архив сертификатов
На архив сертификатов возложена функция долговременного
хранения (от имени удостоверяющего центра) и защиты информации
обо всех изданных сертификатах. Архив поддерживает базу
данных, используемую при регулировании споров по поводу надежности
электронных цифровых подписей, которыми в прошлом заверялись
документы. Архив подтверждает качество информации в момент
ее получения и обеспечивает целостность данных во время
хранения. Информация, предоставляемая удостоверяющим центром
архиву, должна быть достаточной для определения статуса сертификатов
и их издателя. Архив защищает информацию соответствующими
техническими средствами и процедурами.
Пользователи
Конечные субъекты, или пользователи, PKI делятся на две категории:
владельцы сертификатов и доверяющие стороны. Они используют
некоторые сервисы и функции PKI, чтобы получить сертификаты
или проверить сертификаты других субъектов. Владельцем
сертификата может быть физическое или юридическое лицо,
приложение, сервер и т.д. Доверяющие стороны запрашивают и полагаются
на информацию о статусе сертификатов и открытых ключах
ЭЦП своих партнеров по деловому общению.
2.2.2. Сервисы PKI
Криптографические сервисы
Генерация пар ключей. При помощи этого сервиса генерируется
пара ключей (открытый ключ/секретный ключ), секретный ключ
хранится в файле, защищенном паролем или иными средствами (например,
на смарт-карте или при помощи другого аппаратного или
программного средства, гарантирующего конфиденциальность секретного
ключа). В PKI должны поддерживаться две пары ключей
для каждого пользователя. В любой момент времени пользователь
должен иметь одну пару ключей для шифрования и расшифрования
сообщения, а другую пару ключей для выработки или проверки
цифровой подписи.
2. Структура, сервисы и архитектура PKI 37
Выработка цифровой подписи. Этот сервис заключается в генерации
дайджеста сообщения и подписи его цифровым образом.
Верификация (проверка) цифровой подписи. Посредством этого
сервиса устанавливается подлинность сообщения и соответствующей
ему цифровой подписи.
Сервисы управления сертификатами
Сервисы управления сертификатами образуют ядро инфраструктуры
открытых ключей [9].
Выпуск сертификата. Сертификаты выпускаются для пользователей
(физических и юридических лиц), для сертификационных
центров, находящихся на более низких уровнях иерархии доверия,
а также для других сертификационных центров в случае взаимной
сертификации.
Управление эюизненным циклом сертификатов и ключей. Если
секретный ключ пользователя потерян, похищен или скомпрометирован
или есть вероятность наступления таких событий, действие
сертификата должно быть прекращено. После получения подтверждения
запроса пользователя об аннулировании сертификата удостоверяющий
центр уведомляет об аннулировании все заинтересованные
стороны, используя список аннулированных сертификатов.
Аналогично аннотированию осуществляется приостановление действия
сертификата. Оно заключается в однократной отмене сертификата
на некоторое время в течение периода его действия. После
этого действие сертификата возобновляется автоматически или же
сертификат аннулируется. Приостановление действия сертификата
осуществляется в тех ситуациях, когда невозможно установить подлинность
лица, обращающегося с запросом об аннулировании.
Поддерэюка реестра. Выпущенный сертификат или САС
включается в реестр (в соответствии со спецификациями стандарта
Х.500 или иными требованиями), чтобы третьи стороны могли иметь
к нему доступ. Обычно реестр контролируется удостоверяющим
центром, в некоторых случаях - третьей стороной. Доступ к реестру
может быть ограничен. Если необходимо соблюдение прав приватности
пользователей, применяются меры защиты данных от лиц, не
имеющих полномочий доступа.
38 Основы технологии PKI
Хранение сертификатов и САС в архиве. Выпускаемые сертификаты
и списки аннулированных сертификатов хранятся в архиве
длительное время, определяемое правилами хранения заверенных
ЭЦП документов.
Вспомогательные сервисы
В PKI могут поддерживаться также различные дополнительные
сервисы.
Регистрация. Регистрационные сервисы обеспечивают регистрацию
и контроль информации о субъектах, а также аутентификацию,
необходимую для выпуска или аннулирования сертификатов
(от имени удостоверяющего центра). Фактический выпуск сертификатов
осуществляется удостоверяющим центром.
Хранение информации в архиве. Сервисы хранения информации
в архиве предназначены для долговременного хранения
и управления электронными документами и другой информацией.
Сервисы обеспечивают создание резервных копий и восстановление
информации в случае уничтожения или старения среды хранения.
Нотариальная аутентификация. Нотариальная аутентификация
включает аутентификацию отправителя сообщения, подтверждение
целостности и юридической силы электронных документов.
Создание резервных копий и восстановление ключей. Удостоверяющий
центр должен иметь возможность восстановить зашифрованную
информацию в случае потери пользователями их ключей
шифрования. Это означает, что удостоверяющему центру необходима
система создания резервных копий и восстановления этих ключей.
Этот процесс известен как коммерческое создание резервных
копий и восстановление ключей, и он отличается от принудительного
депонирования ключей третьей стороной (обычно правоохранительными
органами), которая получает доступ к ключам для расшифровки
необходимой информации. Коммерческие сервисы восстановления
ключей обеспечивают заблаговременное засекречивание
копии ключа на случай утери ключа пользователем, его ухода
с работы, забывания пароля, необходимого для доступа к ключу,
и восстановление ключа в ответ на запрос пользователя или его работодателя.
2. Структура, сервисы и архитектура РК1 39
Неотказуемостъ. Собственноручные подписи традиционно
свидетельствуют о согласии или ознакомлении подписавшего с текстом
документа и не позволяют отказаться от факта подписания документа.
Современные электронные технологии позволили заменить
собственноручную подпись цифровой. Самое главное требование
для предотвращения отказа от цифровой подписи состоит в том, что
ключ подписи должен генерироваться и безопасно храниться под
контролем его владельца. Когда пользователи забывают свои пароли
или теряют свои ключи подписи, на резервирование или восстановление
предыдущей пары ключей подписи не накладывается никаких
технических ограничений (в отличие от аналогичной ситуации с парами
ключей шифрования сообщений). В таких случаях допускается
генерация и дальнейшее использование новых пар ключей подписи.
Параллельное функционирование систем резервного копирования
и восстановления ключей и сервиса неотказуемости вызывает
определенные проблемы. При резервном копировании и восстановлении
ключей должны создаваться копии секретных ключей пользователя.
Чтобы обеспечить невозможность отказа от цифровой подписи,
не должны создаваться резервные копии секретных ключей
пользователя, используемых для выработки цифровой подписи. Для
соблюдения этих требований в PKI должны поддерживаться две пары
ключей для каждого пользователя. В любой момент времени
пользователь должен иметь одну пару ключей для шифрования
и расшифрования, а другую пару ключей для выработки или проверки
цифровой подписи.
Авторизация, Сертификаты могут использоваться для подтверждения
личности пользователя и задания полномочий, которыми
он наделен. В числе полномочий субъекта сертификата может
быть, например, право просматривать информацию или разрешение
вносить изменения в материал, представленный на web-сервере.
Корректировка ключей и управление историями ключей. В ближайшем
будущем пользователи будут иметь огромное количество
пар ключей, которые должны будут поддерживаться как криптографические
ключи, даже если никогда не будут использоваться. Ключи
шифрования должны со временем обновляться и должна поддерживаться
история всех ключей, использованных ранее (например.
40 Основы технологии PKI
для расшифрования информации многолетней давности и проверки
цифровой подписи на старом контракте).
Процесс корректировки пар ключей должен быть «прозрачен»
для пользователя. Это означает, что пользователи не должны заботиться
об обновлении ключей или получать отказ в обслуживании
из-за недействительности своих ключей. Для удовлетворения этого
требования пары ключей пользователя должны автоматически обновляться
до истечения срока их действия. При обновлении пары
ключей подписи предыдущий ключ подписи безопасно уничтожается.
Тем самым предотвращается несанкционированный доступ к ключу
и устраняется необходимость хранения предыдущих ключей.
Другие сервисы. В ряде случаев необходимы и другие сервисы,
например, сервисы генерации пар ключей и записи их на смарт-
карты, если ключи хранятся на смарт-картах.
2.3. Архитектура и топология PKI
2.3.1. Типы архитектуры
PKI обычно состоит из многих удостоверяющих центров
и пользователей, связанных между собой разными способами, позволяющими
выстроить пути доверия. Путь доверия связывает доверяющую
сторону с одной или многими третьими доверенными сторонами
и позволяет конфиденциально проверить законность используемого
доверяющей стороной сертификата. Получатель заверенного
цифровой подписью сообщения, не имеющий связи с удостоверяющим
центром - издателем сертификата открытого ключа подписи,
может проверить сертификат отправителя сообщения, прослеживая
цепочку сертификатов между двумя удостоверяющими центрами:
своим и отправителя. Для развертывания PKI традиционно используют
иерархическую или сетевую архитектуру, в последнее
время с ростом масштабов PKI и необходимости объединения разнородных
инфраструктур получает распространение гибридная архитектура.
Иерархическая архитектура
Удостоверяющие центры организуются иерархически под
управлением, так называемого корневого удостоверяющего центра,
который выпускает самоподписанный сертификат и сертификаты
2. Структура, сервисы и архитектура PKI 41
для подчиненных удостоверяющих центров. Подчиненные удостоверяющие
центры могут выпускать сертификаты для удостоверяющих
центров, находящихся ниже них по уровню иерархии, или для
пользователей. В иерархической PKI каждая доверяющая сторона
знает открытый ключ подписи корневого удостоверяющего центра.
Любой сертификат может быть проверен путем выстраивания цепочки
сертификатов от корневого удостоверяющего центра и ее верификации,
то есть проверки связанности субъекта сертификата и его
открытого ключа. Процедура верификации цепочки сертификатов
подразумевает, что все «правильные» цепочки начинаются с сертификатов,
изданных одним корневым удостоверяющим центром.
Чтобы полагаться на сертификат, доверяющая сторона должна удостовериться,
что:
• каждый сертификат в цепочке подписан при помощи открытого
ключа следующего сертификата в цепочке;
• срок действия сертификата не истек и сертификат не аннулирован
и
• каждый сертификат удовлетворяет ряду критериев, задаваемых
сертификатами, расположенными выше в цепочке [2].
Выстраивание цепочки иллюстрирует рис. 2.1 а). Отправитель
сообщения А проверяет сертификат получателя сообщения В, выпущенный
УЦ 4, затем - сертификат УЦ 4, выпущенный УЦ 2, а затем
сертификат УЦ 2, выпущенный УЦ 1 - корневым удостоверяющим
центром, открытый ключ подписи известен отправителю.
Существуют два способа получения доверяющей стороной сертификатов
для проверки цепочки: модель с проталкиванием и модель
с извлечением [2]. Модель с проталкиванием предполагает, что отправитель
передает получателю вместе со своим сертификатом все
сертификаты цепочки и получатель может немедленно их проверить.
При использовании модели с извлечением посылается только
сертификат отправителя, а получатель сам должен извлечь сертификат
удостоверяющего центра. Поскольку каждый сертификат содержит
имя издателя, получателю известно, где проверить сертификат.
Преимуществом иерархической архитектуры является то, что
не все стороны должны автоматически доверять всем удостоверяющим
центрам. Фактически единственным удостоверяющим центром.
42 Основы технологии PKl
которому необходимо доверять, является корневой удостоверяющий
центр.
Сетевая архитектура
Независимые удостоверяющие центры взаимно сертифицируют
друг друга, то есть выпускают сертификаты друг для друга,
и объединяются в пары взаимной сертификации. Взаимная сертификация
позволяет взаимодействовать удостоверяющим центрам и конечным
субъектам из различных доменов PKI. В результате между
ними формируется сеть доверия, которую иллюстрирует рис. 2.1 б).
а) б)
Рис. 2.1. Традиционные архитектуры PKJ:
а) иерархическая; б) сетевая
Доверяющая сторона знает открытый ключ ближайшего к ней
удостоверяющего центра, обычно того, который выпустил для нее
сертификат. Доверяющая сторона проверяет сертификат, выстраивая
цепочку доверия от известного ей удостоверяющего центра, которому
она доверяет. Например, отправитель сообщения А знает открытый
ключ подписи УЦ 3, в то время как получателю сообщения В
известен открытый ключ УЦ 4. Существует несколько цепочек сертификатов
от получателя к отправителю сообщения. Самая короткая
цепочка: отправитель сообщения проверяет сертификат получателя,
выпущенный УЦ 4, затем - сертификат УЦ 4, выпущенный УЦ 5, и.
2. Структура, сервисы и архитектура PKI 43
наконец, сертификат УЦ 5, выпущенный УЦ 3. УЦ 3 — это удостоверяющий
центр, которому доверяет отправитель и знает его открытый
ключ.
Преимущество сетевой архитектуры заключается в том, что
компрометация одного центра в сети удостоверяющих центров не
обязательно ведет к утрате доверия ко всей PKL
Гибридная архитектура
Для связывания разнородных инфраструктур открытых ключей
недавно была предложена гибридная (смешанная) или «мостовая
» архитектура [72]. Соединение корпоративных PKI независимо
от их архитектуры достигается введением нового удостоверяющего
центра, названного мостовым, единственным назначением которого
является установление связей между ними.
В отличие от сетевого удостоверяющего центра мостовой
центр не выпускает сертификаты непосредственно для пользователей,
а в отличие от корневого удостоверяющего центра в иерархической
PKI - не выступает в качестве узла доверия.
Все пользователи PKI рассматривают мостовой удостоверяющий
центр как посредника. Мостовой удостоверяющий центр устанавливает
отношения «равный с равным» между различными корпоративными
PKI. Эти отношения служат своеобразным мостом доверия
между пользователями разнородных PKI. Если область доверия
реализована как иерархическая PKI, то мостовой удостоверяющий
центр устанавливает связь с корневым удостоверяющим центром.
Если же область доверия - это сеть PKI, то мостовой удостоверяющий
центр взаимодействует только с одним из удостоверяющих
центров сети. В любом случае удостоверяющий центр, который
вступает в отношения доверия с мостовым УЦ, называется главным.
На рис.2.2 мостовой удостоверяющий центр устанавливает
связи с тремя корпоративными PKI: первая - это PKI пользователей
А и В, вторая - иерархическая PKI пользователя С и третья - сетевая
PKI пользователя D. Ни один из пользователей не доверяет непосредственно
мостовому удостоверяющему центру. Пользователи А
и В доверяют удостоверяющему центру, выпустившему их сертификаты,
и косвенно доверяют мостовому удостоверяющему центру,
для которого их УЦ выпустил взаимный сертификат.
44 Основы технологии PKl
Корпорация 1
Пользователь А Пользователь В
Корпорация 2
т
Пользователь С
Корпорация 3
Пользователь D
Рис. 2.2. Мостовой УЦ и разнородные PKI
Пользователь С доверяет мостовому удостоверяющему центру
только потому, что для него выпустил сертификат корневой
удостоверяющий центр в иерархической PKI, субъектом которой
является сам пользователь С. Аналогично пользователь D доверяет
мостовому удостоверяющему центру только потому, что существует
законная цепочка сертификатов от удостоверяющего центра, выпустившего
сертификат для пользователя D, до мостового удостоверяющего
центра. Пользователи А и В могут использовать мост до-
2. Структура, сервисы и архитектура РК1 45
верия через мостовой удостоверяющий центр, чтобы установить
контакты с пользователями С и D.
Использование взаимной сертификации вместо или вместе
с иерархиями сертификатов представляется более защищенным решением,
чем чисто иерархическая модель [2]. Если в иерархии доверия
скомпрометирован секретный ключ корневого удостоверяющего
центра, то не следует полагаться на сертификаты всех подчиненных
ему удостоверяющих центров. В противоположность этому, в сетевой
или гибридной архитектуре компрометация одного удостоверяющего
центра не обязательно подрывает доверие ко всей инфраструктуре
открытых ключей.
2.3.2. Физическая топология
Система РЮ помимо выполнения целого ряда функций - выпуска
сертификатов, генерации ключей, управления безопасностью,
аутентификации, восстановления данных должна обеспечивать интеграцию
с внешними системами. PKI необходимо взаимодействовать
с множеством самых разных систем и приложений - это и программное
обеспечение групповой работы, и электронная почта,
и системы управления доступом, и каталоги пользователей, и виртуальные
частные сети, и разнообразные операционные системы,
и службы безопасности, и Web-приложения, и широкий спектр корпоративных
систем [39]. Рис. 2.3 иллюстрирует взаимодействие
компонентов PKI.
Функциональные компоненты PKI (УЦ, РЦ и др.) могут быть
реализованы программно и аппаратно различными способами, например,
располагаться на одном или нескольких серверах. Системы,
выполняющие функции удостоверяющего и регистрационного центров,
часто называют серверами сертификатов и регистрации соответственно.
Основными серверными компонентами PKI являются сервер
сертификатов, сервер каталогов и сервер восстановления ключей. На
сервер сертификатов возлагаются функции выпуска и управления
сертификатами, защищенного хранения секретного ключа удостоверяющего
центра, поддержки жизненного цикла сертификатов и ключей,
восстановления данных, ведения контрольного журнала и регистрации
всех операций удостоверяющего центра.
46 Основы технологии PKI
Серверы PKI
Сервер
восстановления
ключей
Сервер
сертификатов
Сервер
каталогов
~V~
Удаленный
доступ
И
Защищенная
электронная
почта
Виртуальная
частная сеть Web
сервер
Л^
PKI - совместимые приложения t
ПОЛЬЗОВАТЕЛИ |»-^*?^ t*"^?^ i^-'f^
Рис. 2.3. Взаимодействие компонентов PKI
Сервер каталогов содержит информацию о сертификатах и атрибутах
субъектов сертификатов открытых ключей. Через протокол
LDAP приложения стандартным образом обращаются к записям каталогов,
например, к адресам электронной почты, номерам телефонов,
полномочиям и сертификатам пользователей.
Сервер каталогов должен обеспечивать:
• сетевую аутентификацию через IP-адреса или DNS-имена
и аутентификацию конечных субъектов по именам и паролям или по
сертификатам открытых ключей;
• управление доступом субъектов к информации в зависимости
от их прав на выполнение операций чтения, записи, уничтожения,
поиска или сравнения;
• конфиденциальность (посредством протокола SSL) и целостность
сообщений для всех видов связи [70].
2. Структура, сервисы и архитектура PKI 47
Сервер восстановления ключей поддерживает создание резервных
копий и восстановление ключей шифрования конечных
субъектов. Среди всех компонентов PKI сервер восстановления
ключей должен быть наиболее защищен и обеспечивать строгую
аутентификацию администратора и пользователей, поддержку конфиденциальности
и целостности сообщений, безопасное хранение
всех компонентов ключей.
PKI управляет ключами и сертификатами, используемыми для
реализации криптографических операций в web-браузерах, web-
серверах, приложениях электронной почты, электронного обмена
сообщениями и данными, в приложениях, поддерживающих защищенные
сетевые транзакции и сеансы связи через Worid Wide Web
или в виртуальных частных сетях на базе протоколов S/MIME, SSL
и IPSec, а также для заверения цифровой подписью электронных
документов или программного кода [87]. Наряду с перечисленными
выше приложениями, PKI-совместимыми могут быть и корпоративные
приложения, разработанные внутри организации.
Приложения электронной почты и обмена сообщениями используют
пары ключей для шифрования сообщений и файлов и заверения
их цифровыми подписями. Системы электронного обмена
данными поддерживают транзакции, требующие аутентификации
сторон, обеспечения конфиденциальности и целостности данных.
Браузеры и web-серверы используют шифрование для аутентификации,
обеспечения конфиденциальности и для таких приложений, как
онлайновое предоставление банковских услуг и электронная коммерция.
Шифрование и аутентификация применяются также для создания
виртуальных частных сетей (Virtual Private Networks - VPN) на
основе сетей общего пользования, для защиты коммуникаций «сайт-
сайт» или удаленного доступа (клиент - сервер). Заверение цифровой
подписью программных кодов и файлов дает возможность пользователям
подтвердить источник выгружаемых программ и файлов
и целостность их содержания, это важно и для контроля вирусного
заражения.
Существует множество вариантов физической конфигурации
корпоративной PKI. В целях безопасности обычно рекомендуется,
чтобы основные компоненты PKI были реализованы в виде отдель-
48 Основы технологии РК1
ных систем. Так как системы содержат конфиденциальные данные,
они должны размещаться за корпоративным межсетевым экраном.
Особенно важна система удостоверяющего центра, так как ее компрометация
потенциально способна разрушить функционирование
PKI и вызвать необходимость полного обновления системы. Желательно,
чтобы система удостоверяющего центра размещалась за дополнительным
межсетевым экраном, только тогда она будет защищена
от внутренних атак и вторжений через Интернет. Очевидно,
что межсетевой экран не должен мешать взаимодействию системы
удостоверяющего центра с другими компонентами PKI.
Пограничный
сервер
каталогов
Интернет Корпоративный
межсетевой
экран
Рис 2.4. Физическая топология PKI
в связи с необходимостью оперативного получения пользователями
информации о статусе сертификатов и данных из реестров
сертификатов удостоверяющих центров разных PKI серверы каталогов
должны быть доступны через Интернет. Однако некоторые организации
используют сервер каталогов шире, чем просто хранилище
сертификатов, в частности для хранения корпоративных данных,
в том числе и конфиденциальных. В этом случае проблема защищенности
данных решается следующим образом: корпоративные
пользователи получают доступ к основному серверу каталогов, а все
2. Структура, сервисы и архитектура PKI 49
остальные внешние пользователи, системы и организации - к пограничному
серверу (см. рис. 2.4).
К основным общим требованиям безопасности корпоративной
PKJ относятся:
• продуманная политика безопасности;
• надежное программное обеспечение компонентов PKI;
• безопасная / надежная связь между компонентами (например,
по протоколам IPSec, SSL и т.п.).
Каждый компонент, чтобы быть частью PKI, должен удовлетворять
критерию безопасности. Этот критерий характеризует необходимый
для целей бизнеса уровень защищенности в пределах допустимого
уровня риска. Механизмы безопасности, обеспечивающие
заданный уровень защищенности, обычно подразделяют на механизмы
защиты аппаратных средств, компьютерной платформы,
сети и приложений. РК1-совместимые приложения не позволяют
обеспечить полную безопасность корпоративной сети и должны
быть дополнены другими средствами защиты, например, межсетевыми
экранами, сервисами аутентифицируемых имен (службами
имен) и строгим контролем администратора сети.
50 Основы технологии PKI
3. СТАНДАРТЫ И СПЕЦИФИКАЦИИ PKI
3.1. Стандарты в области PKI
Стандарты играют существенную роль в развертывании и использовании
PKI. Стандартный подход особенно важен при регулировании
процедур регистрации и выработки ключа, задании формата
сертификата и списка аннулированных сертификатов, формата
криптографически защищенных данных и описании онлайновых
протоколов. Стандартизация в области PKI позволяет различным
приложениям взаимодействовать между собой с использованием
единой PKI [164]. Стандарты в области PKI можно разбить на четыре
группы (см. табл. 3.1), каждая из которых относится к определенному
технологическому сегменту, необходимому для создания PKI
[41].
К первой группе (см. табл. 3.1) можно отнести стандарты серии
X, подготовленные Международным союзом по телекоммуникациям
ГГи (International Telecommunications Union) и стандарты Международной
организации стандартизации ISO (International Organization
for Standardization), относящиеся к PKI [137]. Они признаны в международном
масштабе и содержат описания концепций, моделей
и сервиса каталога (Х.500) и формализуют процедуру аутентификации
(Х.509). Стандарт Х.509 первоначально предназначался для
спецификации аутентификации при использовании в составе сервисов
каталога Х.500. С течением времени Х.509 претерпел ряд изменений,
и его последняя (третья) версия была стандартизована группой
инженерной поддержки Интернет - Internet Engineering Task
Force (IETF). Организация IETF является открытым интернациональным
сообществом исследователей, разработчиков сетевых протоколов,
операторов и производителей, занимающихся проблемами развития
Интернет и обеспечением непрерывного функционирования
существующей инфраструктуры.
Документ Х.509 регулирует хранение в каталоге и получение
данных аутентификации. Он характеризует криптосистему с открытым
ключом как метод строгой аутентификации, который базируется
на создании, управлении и свободном доступе к сертификату.
J. Стандарты и спецификации PKI 51
связывающему субъекта (пользователя) с его открытым ключом.
Синтаксис сертификатов формата Х.509 выражается с помощью
особой нотации, так называемой абстрактной синтаксической
нотации версии 1 (Abstract Syntax Notation One - ASN.l), которая
была предложена комитетом разработчиков стандартов взаимодействия
открытых систем OSI (Open System Interconnection) для использования
с протоколами Х.500. ASN.1 описывает синтаксис различных
структур данных, предоставляя четко определенные примитивные
объекты и средства описания комбинаций примитивных
объектов [2]. Форматы электронного сертификата и списка аннулированных
сертификатов, предложенные Х.509, фактически признаны
стандартом и получили всеобщее распространение независимо от
Х.500. Как показало время, наиболее ценной в стандарте Х.509 оказалась
не сама процедура, а ее служебный элемент - структура сертификатов,
хранящих имя пользователя, криптографические ключи
и сопутствующую информацию [8].
ТаблицаЗ.1.1 группа стандартов
1 Номер и название стандарта
1 Х.500
\ Х.509
{ Х.509а
) Х.208 (180ЛЕС 8825)
\ Abstract Syntax Notation
1 (ASN.l)
1 X.209
1 ISOAEC 8824
[Object Identifiers (OIDs)
1 ISOAEC 9594/8
Directory Services (X.509)
Содержание стандарта
Каталог: обзор концепций, моделей и услуг
Каталог: структура аутентификации
Проект изменений и дополнений для!
продления срока действия сертификатов!
(расширение Версии 3)
Абстрактная синтаксическая нотация
Основные правила кодирования для
ASN.l 1
Идентификаторы объектов
Сервисы каталога (Х.509) |
Стандарты второй группы (см. табл. 3.2) разработаны основным
центром по выпуску согласованных стандартов в области PKI,
52 Основы технологии PKI
рабочей группой организации IETF, известной как группа PKIX (от
сокращения PKI for Х.509 certificates) [134].
Т а б л и ц а 3.2. II группа стандартов
j Номер и название стандарта
1
J]RK:2510
Certificate Management Protocols
j (CMP)
1 Certificate Request Protocol
щрстп
j Certificate Policy and Certification Prac-
[1R tFicCes 2 F5r5a9m ework
f1RLDTAdSP SVO2 Operational Protocols ^ "^
Online Certificate Status Protocol
1 (OCSP)
RFC 2585
1 HTTP/FTP Operations
f RFC 2587
1R LFDCA 2P7 9V72 Schema
Certificate Management Messages over
1 CMS (CMC)
Т1ЖГЖ15
Diffie-Hellman Proof-of-Possession
1 (POP) Algorithms
Г1РС1Ш9
Data Validation and Certification Server
) Protocols
Rrc3039
Qualified Certificates Profile
RFC 3161
J1. ,TJ^ipm.ge2-S7t9a•m•(5pы Piшroйtoиc"o'"lR (FTГS2P3)2 8} ^
I Algorithms and Identifiers for tne Inter-
1 net X.509 Public Key Infrastructure Cer-
1 tificate and Certificate Revocation List
i (CRL) Profile
1 RFC 3280 (бывший RFC 2459)
1 Certificate & CRL Profile
i RFC 3281
An Internet Attribute Certificate Profile
1 for Authorization
Содержание стандарта
Инфраструктура открытых ключей
Интернет Л.509: протоколы управ- \
\ ления сертификатами
Протокол запроса на сертификат
1 Политика применения сертификатов
и структура регламента 1
1 Эксплуатационные протоколы инфраструктуры
открытых ключей
1 Онлайновый протокол статуса сертификата
[Применение протоколов
HTTP/FTP для получения из реестра
PKI сертификатов и С АС
Схема поддержки pKJX в среде
LDAP v2
Протокол управления сертификатами
на базе сообщений управления
сертификатами
Алгоритмы Диффи-Хэлмана доказывания
владения
Протоколы сервера сертификации
и проверки достоверности данных
Фо13мат сертификата ограниченно-1
го пользования |
Протокол пометки времени
Алгоритмы и идентификаторы для i
профилей сертификатов и САС
Форматы сертификата и списка
аннулированных сертификатов
Формат атрибутного сертификата
для авторизации
3. Стандарты и спецификации PKI 53
Документы PKIX определяют политику применения сертификатов
и структуру регламента УЦ, форматы, алгоритмы и идентификаторы
сертификата и САС Х.509, схему поддержки PKIX в среде
LDAP v2, форматы атрибутных сертификатов и сертификатов ограниченного
пользования, описывают протоколы статуса сертификатов,
запроса на сертификацию, проставления метки времени, эксплуатационные
протоколы PKL
Т а б л и ц а 3.3. III группа стандартов
j Номер и название стандарта
! PKCS#1
j RSA Cryptography
|PKCS#3
1 Diffie-Hellman Key Agreement
j PKCS #5
\ Password-Based Cryptography
j PKCS #6
i Extended-Certificate Syntax
1 PKCS#7
I Cryptographic Message Syntax
1 PKCS #8
1 Private-Key Information Syntax
i PKCS #9
1 Selected Attribute Types
iPKCS#10 (Б1РС2314)
i Certification Request Syntax
iPKCS#ll
i Cryptographic Token Interface
\ (Cryptoki)
1 PKCS #12
j Personal Information Exchange
i Syntax
i PKCS #13
i Elliptic Curve Cryptography
1 PKCS #15
; Cryptographic Token Information
; Format
Содержание стандарта
Механизмы шифрования и подписания
1 данных методом RSA.
Примечание: Стандарты PKCS #2 and
PKCS #4 были объединены в PKCS #1 1
Согласование ключей методом Диффи- \
Хеллмана i
Шифрование секретным ключом, соз- |
данным на основе пароля. |
Синтаксис расширенного сертификата
Синтаксис криптографических сообщений
Синтаксис данных секретного ключа
Особые типы атрибутов для использования
в других PKCS стандартах.
Стандарт синтаксиса запроса на сертификацию
Прикладной программный интерфейс
Cryptoki для криптографических устройств
типа смарт-карт и карт PCMCIA j
Синтаксис обмена персональными данными
пользователя (секретными ключами,
различными тайнами и т.п.) |
Механизмы шифрования и подписания
данных методом эллиптических кривых
Формат данных, хранящихся на криптографических
токенах (является дополнением
к PKCS #11)
54 Основы технологии PKl
Третью группу образуют стандарты криптографии с открытыми
ключами PKCS (Public Key Cryptography Standards), разработанные
компанией RSA Security Inc. [168] совместно с неофициальным
консорциумом, в состав которого входили компании Apple, Microsoft,
DEC, Lotus, Sun и MIT. Документы PKCS признаны симпозиумом
разработчиков стандартов взаимодействия открытых систем
методом реализации стандартов OSI. Стандарты PKCS (см. табл. 3.3)
обеспечивают поддержку криптографических процессов при выполнении
защищенного шифрованием информационного обмена между
субъектами. Стандарты PKCS ориентированы на двоичные и ASCII
данные и совместимы со стандартом ITU-T Х.509. В PKCS входят
алгоритмически зависимые и независимые реализации стандартов
[157]. Многие из них опираются на систему шифрования с открытыми
ключами RSA, названную по инициалам авторов Ривеста,
Шамира и Адлемана, метод эллиптических кривых и метод согласования
ключей Диффи-Хэллмана, подробно описанные в трех соответствующих
криптографических стандартах.
Кроме того, стандарты PKCS определяют алгоритмически независимый
синтаксис криптографических сообщений, данных секретного
ключа, запросов на сертификацию, расширенных сертификатов,
обмена персональными данными пользователя, что позволяет
реализовать любой криптографический алгоритм в соответствии со
стандартным синтаксисом и обеспечить взаимодействие самых разных
приложений. Большинство стандартов, использующих криптографию,
разработано с учетом применения PKI.
В четвертую группу объединены дополнительные, связанные
с PKI стандарты S/MIME, S/HTTP, TLS, IPSec, DNS и SET (см.
табл. 3.4). Стандарты S/MIME (Secure/Multipuфose Internet Mail
Extensions) предназначены для обеспечения защищенного обмена
сообщениями в Интернет. Защищенный протокол электронной почты
S/MIME базируется на технологии шифрования и электронной
подписи, разработанной компанией RSA Security Inc., и используется
для предупреждения возможного перехвата или подделки почтовых
сообщений [142]. Семейство стандартов S/MIME описывает
синтаксис криптографических сообщений, управление сертификатами
в среде S/MIME, процедуры и атрибуты дополнительных сер-
3. Стандарты и спецификации PKI SS
висов безопасности для почтовых приложений, к которым относятся
заверенные цифровой подписью уведомления о приеме сообщений,
метки безопасности и защищенные списки рассылки электронной
почты.
Т а б л и ц а 3.4. IV группа стандартов
Номер и название стандарта Содержание стандарта
1 W ] |
с/3
RFC 2311
S/MIME Version 2 Message Specification
Спецификация сообщений
S/MIME версии 2
RFC 2312
S/MIMEv2 Certificate Handling
Управление сертификатами
S/MIME версии 2
БУРС 2630
Cryptographic Message Syntax
(CMS)
Синтаксис криптографических
сообщений
RFC 2632
S/MIME V3 Certificate Handling
RFC 2633
S/MIME V3 Message Specification
RFC 2634
Enhanced Security Services for
S/MIME
Управление сертификатами
S/MIME версии 3
Спецификат^я сообщений
S/MIME версии 3
Сервисы безопасности для
S/MIME
RFC 2785
Methods for Avoiding the "Small-
Subgroup" Attacks on the Diffie-
Hellman Key Agreement Method for
S/MIME
Методы отражения атак на
основе метода согласования
ключей Диффи-Хэллмана для
S/MIME
со
Н
г:
со
RFC 2246
TLS Protocol Version 1.0
Протокол безопасности
транспортного уровня TLS
версии!
RFC 2659
Security Extensions For HTML
Расширения безопасности для
протокола передачи гипертекста
HTTP
RFC 2660
The Secure HyperText Transfer Protocol
Защищенный протокол HTTP
RFC 2817
Upgrading to TLS Within HTTP
Модификация протокола TLS
в среде HTTP
RFC 2818
HTTP Over TLS
Использование протокола
TLS для защищенных HTTP
соединении через Интернет
!
56 Основы технологии PKI
Окончание таблицы 3.4.
\ Номер и название стандарта
1 Он
:5
i :z;
1 ^ !
i ^ i
1 RFC 2401
Security Architecture for the Internet
1 Protocol
ЖС'24Ш
1 IP Authentication Header
nRFC^2TOer~
1 IP Encapsulating Security Payload (ESP)
[RFC 2408
1 Internet Security Association and Key
Management Protocol (ISAKMP)
1 RFC 2137
i Secure Domain Name System Dynamic
Update
1 RFC 2535
Domain Name System Security Extensions
RFC 2536
DSA KEYS and SIGs in the Domain
Name System
RSA/MD5 KEYS and SIGs in the Domain
Name System
'"RFCI538 "'""
Storing Certificates in the Domain Name
System
RFC 2539
Storage of Diffie-Hellman Keys in the
Domain Name System
RFC 2540
Detached Domain Name System Information
RFC 2541
DNS Security Operational Considerations
Secure Electronic Transaction
Specification The Business Description
Secure Electronic Transaction
The Specification Programmer's Guide
Secure Electronic Transaction
Specification Formal Protocol Definition
Содержание стандарта
Архитектура безопасности
1 Интернет-протокола
[ Протокол аутентифйцирую-
1 щего заголовка
1 Протокол инкапсулирующей |
1 защиты содержимого iPI
пакетов
[ Интернет-протокол управле- ]
\ ния ключами и контекстами
1 безопасности
1 Динамическое обновление
защищенной системы доменных
имен
! Расширения системы домен- 1
ных имен 1
DSA-ключи и подписи в системе
доменных имен
RSA/MD5-ключи и подписи
в системе доменных имен
Хранение сертификатов в системе
доменных имен |
Хранение юхючёй Дйффй-
Хэллмана в системе доменных
имен
Отделенная информация системы
доменных имен
Операционные требования 1
безопасности службы доменных
имен
Защищенные электронные |
транзакции. Спецификация: |
Описание бизнеса
Защищенные электронные 1
транзакции. Спецификация:
Руководство программиста |
Защищенные электронные 1
транзакции. Спецификация: |
Описание формального протокола
1
3. Стандарты и спецификации PKI 57
К стандартам S/HTTP и TLS относятся документы, определяющие
защищенный протокол передачи гипертекста HTTP и его
расширения, протокол безопасности транспортного уровня TLS, его
модификацию и использование в среде HTTP. TLS - открытый стандарт,
разработанный на базе протокола защищенного обмена информацией
между клиентом и сервером SSL (Secure Sockets Layer)
в качестве его замены для защиты коммуникаций в Интернет. Протокол
TLS обеспечивает конфиденциальность и целостность данных
при коммуникации двух приложений и позволяет приложениям
"клиент-сервер" взаимодействовать защищенным способом, предотвращающим
перехват информации и подделку сообщений. Для взаимной
аутентификации перед началом информационного взаимодействия
приложениями используется технология PKI.
Программный
код и файлы,
заверенные
ЭЦП
Электронная
почта
Групповая
работа
(Электронный II
обмен
данными
S/MIME
Онлайновые
банковские
операции
Электронная
торговля
SSL
TLS
VPN
IPSec
РРТР
Приложения
Стандарты,
опирающиеся
наРК!
Стандарты,
определяющие
PKI
Рис. 3.1. Взаимосвязь стандартов в области PKI
Стандарты семейства IPSec описывают архитектуру безопасности
Интернет-протоколов (IP), регламентируют контроль целостности
на уровне ЕР-пакетов, аутентификацию источника данных и защиту
от воспроизведения ранее посланных IP-пакетов, обеспечение
конфиденциальности: шифрование содержимого IP-пакетов, а также
58 Основы технологии PKI
частичную защиту от анализа трафика путем применения туннельного
режима [153]. Документы RFC, относящиеся к IPsec, содержат
описания протокола аутентифицирующего заголовка, протокола инкапсулирующей
защиты содержимого IP-пакетов и протокола
управления ключами и контекстами безопасности. Стандарты IPSec
обеспечивают конфиденциальность, целостность и достоверность
данных, передаваемых через открытые IP-сети.
Стандарты DNS определяют механизмы, обеспечивающие
безопасность данных инфраструктуры системы доменных имен
DNS. Документы описывают операционные требования безопасности
системы, методы хранения сертификатов и ключей Диффи-
Хэллмана, динамическое обновление защищенной системы DNS,
механизм защиты передаваемых данных с помощью алгоритма
MD5, DSA и RSA-ключей и цифровых подписей. Для обеспечения
достоверной передачи DNS-данных в масштабе Интернет в систему
DNS вводятся расширения DNSSEC, задаваемые соответствующим
стандартом.
Спецификация SET предлагает инфраструктуру для защиты от
подделок платежных карт, используемых для транзакций электронной
коммерции в Интернет, описывает систему аутентификации
участников расчетов, которая базируется на PKI [2]. Принципы SET
излагаются в трех книгах, содержащих сведения о правилах ведения
бизнеса на базе защищенных электронных транзакций, руководство
программиста и формальное описание протокола SET. Рис. 3.1 иллюстрирует
взаимосвязь стандартов в области PKI.
Итак, базой для разработки стандартов в области PKI стали
стандарты серии Х.500 (хотя не все их наименования начинаются
с Х.5хх) Международного союза по телекоммуникациям (ITU),
предложившие стандартную структуру баз данных, записи в которых
содержали информацию о пользователях [3]. Стандарт Х.509
ITU-T является фундаментальным стандартом, лежащим в основе
всех остальных, используемых в РК1. Однако Х,509 ITU-T не описывает
полностью технологию РК1. В целях применения стандартов
Х.509 в повседневной практике комитеты по стандартизации, пользователи,
поставщики программных продуктов и сервисов PKI обращаются
к семейству стандартов PKIX,
3. Стандарты и спецификации PKI 59
3-2. Стандарты Internet Х.509 PKI (PKIX)
3.2.1. Терминология и концепции PKIX
Стандарты PKIX для описания инфраструктур используют
сходные понятия инфраструктура открытых ключей PKI и инфраструктура
управления привилегиями PMI. Главное отличие между
ними заключается в том, что PKI управляет сертификатами открытых
ключей, а PMI - атрибутными сертификатами. Сертификат открытого
ключа можно сравнить с паспортом субъекта, а атрибутный
сертификат - с визой, первый обеспечивает идентификацию личности,
а второй дает определенное разрешение.
Основные термины и аббревиатуры, используемые в стандартах
PKIX, а также их аналоги на русском языке приведены в табл. 3.5.
Таблица 3.5. Термины PKIX
Термин на английском языке
Attribute Authority
Attribute Certificate
Certificate
Certification Authority
Certificate Policy
Certification Practice Statement
1 End-Entity
1 Public Key Certificate
Public Key Infrastructure
Privilege Management Infrastructure
Registration Authority
Relying Party
Root CA
Subordinate CA
Subject
TopCA
Аббревиатура
AA
AC
CA
CP
CPS
ЕЕ
PKC
PKI
PMI
RA
Термин на русском языке
Атрибутный центр
Атрибутный сертификат j
Сертификат
Удостоверяющий центр
(УЦ)
Политика применения
сертификатов (ППС)
Регламент УЦ
Конечный субъект
Сертифика! открытого
ключа
Инфраструктура открытых
ключей
Инфраструктура управления
привилегиями
Регистрационный центр
(РЦ)
Доверяющая сторона 1
Корневой УЦ
Подчиненный УЦ
Субъект
УЦ верхнего уровня |
60 Основы технологии PKl
Системы, использующие сертификаты, и PKI
Результатом усилий технических специалистов по повышению
безопасности Интернет стала разработка группы протоколов безопасности,
таких, как S/MIME, TLS и IPSec. Все эти протоколы используют
криптографию с открытыми ключами для обеспечения
сервисов конфиденциальности, целостности данных, аутентификации
источника данных и неотказуемости. Цель PKI состоит в обеспечении
надежного и эффективного управления ключами и сертификатами
открытых ключей. Пользователи систем, основанных на
PKI, должны быть уверены, что в любой момент времени при коммуникации
с определенным субъектом они полагаются на открытый
ключ, связанный с секретным ключом, владельцем которого является
именно этот субъект. Эта уверенность возникает в результате использования
сертификатов открытых ключей, связывающих значения
открытых ключей с их владельцами. Связывание происходит
в результате проверки доверенным удостоверяющим центром личности
субъекта и заверения цифровой подписью каждого сертификата
открытого ключа.
ТаблицаЗ.6. Функциональность PKI
Функции PKI
Регистрация
Инициализация
Сертификация
Генерация ключей
Восстановление
пары ключей
Обновление ключей
Контроль периода
действия ключей
Компрометация
ключей
Взаимная
сертификация |
Аннулирование
Публикация и распространение
сертификатов
и уведомлений об аннулировании
Согласно стандартам PKIX, PKI представляет собой комплекс
программного и аппаратного обеспечения, кадров, а также политик
и процедур, необходимых для создания, управления, хранения, распространения
и аннулирования сертификатов открытых ключей.
Функциональность и компоненты PKI представлены табл. 3.6 и 3.7.
Сертификат открытого ключа имеет ограниченный период действия,
3. Стандарты и спецификации PKI 61
который зафиксирован в содержании сертификата. Поскольку клиент
должен иметь возможность самостоятельно проверить подпись
сертификата открытого ключа и его срок действия, сертификаты
должны открыто храниться в системах, использующих сертификаты,
и могут распространяться посредством ненадежных коммуникаций
и систем серверов.
ТаблицаЗ.7. Компоненты PKI
Компонент
1 Удостоверяющие
центры (УЦ)
Регистрационные
центры (РЦ)
Владельцы
сертификатов
Клиенты
Реестры
Описание
Выпускают и аннулируют сертификаты
Подтверждают связывание открытых ключей и
личностей владельцев сертификатов и других атрибутов
Подписывают и шифруют электронные документы
Проверяют подлинность цифровых подписей и соответствующих
цепочек сертификатов при помощи
открытого ключа доверенного УЦ
Хранят и делают доступными сертификаты и САС |
Сертификаты открытых ключей используются в процессе ва-
лидации (подтверждения) заверенных цифровой подписью данных,
когда получатель проверяет, чтобы:
1) информация, идентифицирующая отправителя, соответствовала
данным, содержащимся в сертификате;
2) ни один сертификат из цепочки сертификатов не был аннулирован,
и в момент подписания сообщения все сертификаты были
действительными;
3) сертификат использовался отправителем по назначению;
4) данные не были изменены с момента создания ЭЦП.
В результате проверок получатель может принять данные,
подписанные отправителем.
Общая схема функционирования PKI представлена на рис.3.1.
Конечный субъект отправляет запрос на сертификат в регистрационный
центр (транзакция управления). Если запрос фактически
одобрен, то направляется непосредственно в удостоверяющий центр
62 Основы технологии PKI
для заверения цифровой подписью. Удостоверяющий центр проверяет
запрос на сертификат, и если тот проходит верификацию, то
подписывается и выпускается сертификат. Для публикации сертификат
направляется в реестр сертификатов, в зависимости от конкретной
конфигурации PKI эта функция может быть возложена на
регистрационный или удостоверяющий центр.
р
Е
Е
С
Т
Р
Р
т
и
ф
и
к
а
т
о
Операционные транзакции
и транзакции управления
Конечный
субъект
Публикует сертификат Ш
Транзакции
управления
рц
Публикует сертификат и САС
Субъекты
управления
PKI
УЦ1 УЦ2
Транзакции
управления
Рис. 3.1. Схема функционирования PKI
На рис. 3.1 показаны все возможные коммуникации между конечным
субъектом и удостоверяющим центром. Процесс аннулирования
сертификата аналогичен процессу его генерации. Конечный
субъект запрашивает удостоверяющий центр об аннулировании своего
сертификата, регистрационный центр принимает решение и направляет
запрос об аннулировании в УЦ. Удостоверяющий центр
вносит изменения в список аннулированных сертификатов и публикует
его в реестре. Конечные субъекты могут проверить действительность
конкретного сертификата через операционный протокол.
3. Стандарты и спецификации РК1 63
Операционные протоколы - это протоколы для доставки сертификатов
(или информации об их статусе) и списков аннулированных
сертификатов к клиентским системам, использующим сертификаты.
Существуют разнообразные механизмы распространения сертификатов
и САС с использованием протоколов LDAP, HTTP и FTP.
Например, поиск САС для проверки статуса сертификата осуществляет
операционный протокол.
Протоколы управления требуются для поддержки взаимодействий
в онлайновом режиме между пользователем PKI и субъектами
управления.
Протоколы управления используются при:
1) регистрации субъекта для получения сертификата;
2) инициализации (например, генерации пары ключей);
3) выпуске сертификата;
4) восстановлении пары ключей;
5) обновлении пары ключей по истечении срока действия сертификата;
6) обращении с запросом об аннулировании сертификата;
7) взаимной сертификации, когда два удостоверяющих центра
обмениваются информацией для генерации взаимного сертификата.
Политика применения сертификатов и регламент удостоверяющего
центра содержатся в документах, описывающих обязательства сторон
и правила использования сертификатов.
Системы, использующие сертификаты, и PMI
Многие системы используют сертификаты открытых ключей
для принятия решений по управлению доступом, основанному на
идентификации. Такие решения принимаются только после того, как
пользователь докажет, что имеет доступ к секретному ключу, который
соответствует открытому ключу, содержащемуся в сертификате.
Для некоторых систем этого бывает достаточно, но в настоящее
время появляется потребность в управлении доступом, основанном
на определенных принципах, ролях или должностях. Тогда
для принятия решений по управлению доступом требуется дополнительная
информация, которая обычно не включается в сертификат,
так как период жизни подобной информации бывает намного меньше
64 Основы технологии PKl
срока действия пары ключей. Атрибутный сертификат (АС) используется
для связывания такой информации с сертификатом.
Формат атрибутного сертификата позволяет связать любую
дополнительную информацию о владельце с сертификатом открытого
ключа, включая в структуру данных, заверенных цифровой подписью,
ссылку на один или несколько сертификатов открытых ключей
одного и того же субъекта. Атрибутный сертификат может иметь несколько
назначений (например, предназначаться для доступа к web-
серверу и хосту электронной почты).
Согласно стандартам PKIX, PMI представляет собой комплекс
программного и аппаратного обеспечения, кадров, а также политик
и процедур, необходимых для создания, управления, хранения и аннулирования
атрибутных сертификатов. Компоненты PMI представлены
в табл. 3.8.
ТаблицаЗ.8. Компоненты PMI
Компонент
Атрибутные центры
(АЦ)
Пользователи атрибутных
сертификатов
Верификаторы атрибутных
сертификатов
Клиенты
Реестры
Описание
Издатели атрибутных сертификатов. Выпускают
и аннулируют атрибутные сертификаты
Анализируют или обрабатывают атрибутные
сертификаты (АС)
Подписывают и шифруют электронные документы
Запрашивают действие, для которого должна
быть сделана проверка авторизации
Хранят и делают доступными сертификаты и
САС
По способу доставки атрибутные сертификаты делятся на передаваемые,
или «проталкиваемые» (push), серверу и, считываемые,
или «извлекаемые» (pull), сервером (см. рис. 3.2). В некоторых средах
удобно, чтобы клиент передавал атрибутный сертификат серверу,
при этом не требуется никаких новых соединений между клиентом
и сервером, и на сервер не возлагаются функции поиска, что повышает
производительность. В других случаях более походящим для
клиента является простая аутентификация сервера, а для сервера -
извлечение атрибутного сертификата клиента из базы издателя атрибутных
сертификатов или из реестра.
3. Стандарты и спецификации PKI 65
Издатель м
атрибутных
серти фи катов
'^'^—
h получение АС
получение АС
Клиент передача АС
Рис.3.2. Схемы доставки атрибутных сертификатов
Основное достоинство pull-модели состоит в том, что она может
быть реализована без внесения изменений в протокол связи клиент
- сервер. Она также подходит для случаев, когда полномочия
клиента должны быть определены внутри домена сервера, а не внутри
домена клиента.
3.2.2. Направления стандартизации
Группа PKIX IETF разрабатывает документы для следующих
направлений стандартизации:
1) профили сертификатов и списков аннулированных сертификатов;
2) протоколы управления;
3) операционные протоколы;
4) политики применения сертификатов и регламенты;
5) сервисы проставление меток времени и сертифика-
ции/валидации данных.
66 Основы технологии PKl
К первому направлению относятся стандарты RFC 3280 [104],
RFC 3281 [105], RFC 3039 [101] и RFC 3279 [103]. Стандарт RFC
3280 (бывший RFC 2459) Certificate & CRL Profile предлагает форматы
сертификатов версии Х.509 v3 и списка аннулированных сертификатов
версии Х.509 v2 для использования в Интернет, детализирует
информацию, относящуюся к формам имен и стандартным
расширениям. Документ описывает алгоритм проверки цепочек сертификатов
и форматы открытых ключей и электронной цифровой
подписи для алгоритмов шифрования ключей RSA, DSA и Диффи-
Хэллмана.
Стандарт RFC 3281 An Internet Attribute Certificate Profile for
Authorization определяет профиль атрибутного сертификата для использования
в Интернет-протоколах. Атрибутный сертификат подобен
сертификату открытого ключа, но в отличие от него содержит не
открытый ключ, а атрибуты, характеризующие его владельца: принадлежность
к какой-либо группе, роль, полномочия, уровень прозрачности
информации о владельце и т.п. Стандарт обеспечивает
поддержку атрибутных сертификатов для электронной почты в Интернет,
протокола IPSec, приложений безопасности World Wide
Web.
Стандарт RFC 3039 Qualified Certificates Profile описывает
формат сертификата ограниченного пользования. Владельцем этого
сертификата может быть только физическое лицо. Термин «ограниченное
пользование» трактуется в общепринятом для государственного
права смысле. Пока стандарт определяет основной синтаксис
сертификата ограниченного пользования без учета особенностей
законодательства разных стран.
Стандарт RFC 3279 Algorithms and Identifiers for the Internet
X.509 Public Key Infrastructure Certificate and Certificate Revocation
List (CRL) Profile определяет идентификаторы алгоритмов и форматы
шифрования используемых в PKIX открытых ключей и цифровых
подписей, односторонние хэш-функции для генерации ЭЦП
сертификатов и САС. Стандарт описывает шифрование цифровых
подписей, сгенерированных при помощи криптографических алгоритмов
RSA, DSA и алгоритма эллиптических кривых (ECDSA), задает
форматы шифрования открытых ключей, используемых в крип-
3. Стандарты и спецификации PKI 67
тографических алгоритмах RSA, DSA, Диффи-Хеллмана и алгоритма
шифрования ключей (КЕА).
Второе направление представлено документами RFC 2510
[91], RFC 2511 [92], RFC 2560 [95] и RFC 2797 [98]. Стандарты RFC
2510 Certificate Management Protocols (CMP) и RFC2511 Certificate
Request Protocol определяют соответственно сообщения протоколов
для процессов создания и управления сертификатами и синтаксис
запроса на выпуск сертификата формата Х.509.
Стандарт RFC 2560 Online Certificate Status Protocol (OCSP)
предлагает протокол для определения статуса сертификата без использования
С АС. По замыслу разработчиков, этот протокол должен
удовлетворять операционным требованиям более своевременного
поступления информации об аннулировании, чем это возможно при
помощи САС. Протокол управляет обменом данными между OCSP-
клиентами, проверяющими статус сертификата, и OCSP-исполни-
телем, информирующем об этом статусе.
Стандарт RFC 2797 Certificate Management Messages over CMS
определяет протокол управления сертификатами на основе сообщений
управления сертификатами. Документ разрабатывался для решения
двух важных проблем сообщества PKI в Интернет:
1) реализации интерфейса с продуктами и сервисами PKI, базирующимися
на сообщениях управления сертификатами и стандарте
синтаксиса запроса на сертификат — PKCS#10;
2) использования стандарта SMIME v3 в протоколе регистрации
сертификатов открытых ключей (Диффи-Хеллмана), подписанных
при помощи алгоритма DSA.
К третьему направлению можно отнести документы RFC
2559 [94], RFC 2587 [97] и RFC 2585 [96].
Стандарт RFC 2559 LDAP V2 Operational Protocols закрепляет
использование протокола LDAP v2 для обеспечения доступа к реестру
сертификатов, который является онлайновой системой открытого
доступа, с целью поиска сертификатов и другой релевантной
PKI информации и управления ими.
Стандарт RFC 2587 LDAP V2 Schema описывает минимально
необходимую схему поддержки PKIX в среде LDAP v2 (как это требует
документ RFC 2559) и определяет только специфические PKD(
68 Основы технологии PKl
компоненты. В соответствии с этим документом серверы LDAP,
действующие как хранилища (реестры) PKIX, должны поддерживать
вспомогательные классы объектов, определенные данным стандартом,
и интегрировать спецификацию этой схемы с общими и
специфическими для приложений схемами в зависимости от сервисов,
предоставляемых этим сервером.
Документ RFC 2585 HTTP/FTP Operations описывает применение
протоколов HTTP/FTP для получения сертификатов и списков
аннулированных сертификатов из реестра удостоверяющего центра.
Четвертое направление представлено одним базовым стандартом
RFC 2527 Certificate Policy and Certification Practices Framework
[93], определяющим политику применения сертификатов
и структуру регламента удостоверяющего центра и подробно описанным
далее в главе 5.
К пятому направлению стандартизации относятся документы
RFC 3029 [100], RFC 2875 [99], RFC 3161 [102]. Стандарт RFC 3029
Data Validation and Certification Server Protocols вводит понятие сервера
сертификации и проверки достоверности данных для обеспечения
надежности сервисов неотказуемости и предлагает протоколы
для взаимодействия с этим сервером. На сервер возлагаются функции
доверенной третьей стороны, проверяющей подлинность сертификатов
открытых ключей и документов с цифровой подписью.
Стандарт RFC 2875 Diffie-Hellman Proof-of-Possession (POP)
Algorithms описывает два метода получения значения проверки целостности
на основе пары ключей Диффи-Хэллмана. В документе
предлагаются два алгоритма доказывания владения, использующие
процесс согласования ключей Диффи-Хеллмана для получения разделенного
секрета на основе значения проверки целостности. В первом
алгоритме значение формируется для конкретного получателя/
верификатора при помощи открытого ключа этого верификатора.
Во втором алгоритме значение формируется для произвольного верификатора.
Документ RFC 3161 Time-Stamp Protocol (TSP) описывает
протокол проставления метки времени.
Следование стандартам технологии цифровых сертификатов
является необходимым условием успешного проектирования и развертывания
эффективных инфраструктур открытых ключей.
4. Структуры данных PKl 69
4. СТРУКТУРЫ ДАННЫХ PKI
В PKI используются две основные структуры данных: сертификат
открытого ключа и список аннулированных сертификатов,
а также третья дополнительная структура - атрибутный сертификат.
4.1. Сертификаты открытых ключей Х.509
4.1.1. Формат сертификата
Формат сертификата открытого ключа подписи определен в
рекомендациях Международного Союза по телекоммуникациям ITU
(Х.509) и документе PKIX - RFC 3280 Certificate & CRL Profile [87].
В настоящее время основным принятым форматом является формат
версии 3, позволяющий задать дополнения, с помощью которых
реализуется определенная политика безопасности в системе. Несмотря
на то, что документ RFC 3820 адресован сообществу Интернет,
формат сертификата открытого ключа предоставляет гибкий
и мощный механизм передачи разнообразной информации и может
применяться в корпоративной практике. Большая часть информации,
указываемой в сертификате, не является обязательной, а содержание
обязательных полей сертификата может варьироваться. Для
разработчиков PKI и пользователей важно понимать назначение полей
сертификата и знать варианты выбора.
Сертификат открытого ключа подписи или шифрования представляет
собой структурированную двоичную запись в формате
ASN.1. Сертификат содержит элементы данных, сопровождаемые
цифровой подписью издателя сертификата (см. рис. 4.1 и табл. 4.1).
В сертификате имеется десять основных полей: шесть обязательных
и четыре опциональных. К обязательным полям относятся:
• серийный номер сертификата Certificate Serial Number;
• идентификатор алгоритма подписи Signature Algorithm
Identifier;
имя издателя Issuer Name;
период действия Validity (Not Before/After);
открытый ключ субъекта Subject Public Key Information и
имя субъекта сертификата Subject Name.
70 Основы технологии PKl
Под субъектом понимается сторона, контролирующая секретный
ключ, соответствующий данному открытому ключу. Наличие
необязательных полей характерно для сертификатов версий 2 и 3,
к необязательным полям сертификата относятся номер версии, два
уникальных идентификатора и дополнения.
Структура сертификата представлена на рис. 4.1.
Версия
Серийный номер
Идентификатор алгоритма подписи
Имя издателя
Период действия (не ранее/не позднее)
Имя субъекта
Открытый ключ субъекта
Уникальный идентификатор издателя
Уникальный идентификатор субъекта
Расширения
Подпись
>
оS
<D
PQ
(N
>
оS о-
(D
0Q
с>о
S
О.
Все версии |
Рис.4.1. Структура сертификата
Поле Version (см. табл. 4.1) задает синтаксис сертификата, по
умолчанию предполагается первая версия сертификата. Если в поле
версии указывается 2, то сертификат содержит только уникальные
идентификаторы, а если - 3, то в сертификат включаются и уникальные
идентификаторы и дополнения, что характерно для всех
современных сертификатов. Сертификаты первой версии не содержат
уникальных идентификаторов или дополнений.
Издатель сертификатов присваивает каждому выпускаемому
сертификату серийный номер Certificate Serial Number, который
должен быть уникален. Комбинация имени издателя и серийного
номера однозначно идентифицирует каждый сертификат.
В поле Signature Algorithm Identifier указывается идентификатор
алгоритма ЭЦП, который использовался для защиты сертификата,
например DSA с SHA-1 или RSA с MD5.
Поле Issuer Name содержит отличительное имя (формата
Х.500) третьей доверенной стороны, то есть издателя, который вы-
4. Структуры данных PKI 71
пустил этот сертификат. В поле Validity (Not Before/After) указываются
даты начала и окончания периода действия сертификата.
Имя пользователя: С = RU, org = ACME, en = UserName
Имя издателя: С = RU, org = ACME
Номер сертификата: #12345678
Открытый ключ пользователя:
Алгоритм: GOST open key
Значение ключа: 010011101001001010000001
Сертификат действует с: 01.01.2000 00:00:00
Сертификат действует до: 31.12.2003 23:59:59
Дополнительная информация (Х.509 v3 Extensions)
Регламент использования сертификата: Только для платежей
Секретный ключ действует с: 31.12.2001 23:59:59
Секретный ключ действует до: 31.12.2002 23:59:59
Область применения ключа: Идентификатор 1
Область применения ключа: Идентификатор i
Область применения ключа: Идентификатор N
Права и полномочия: Администратор
Атрибуты пользователя: IP, DNS, URI, RFC822, Номер счета, Адрес
Подпись Удостоверяющего Щнтра:
Алгоритм: GOSTP 34.10-94 sign algorithm
Значение: 010011101001001010000001
Рис. 4.2. Пример сертификата формата Х.509
Поле Subject Name содержит отличительное имя владельца
секретного ключа, соответствующего открытому ключу данного
сертификата. Субъектом может выступать удостоверяющий центр,
регистрационный центр или конечный субъект.
Поле Subject Public Key Information содержит информацию об
открытом ключе субъекта: сам открытый ключ, необязательные параметры
и идентификатор алгоритма. Это поле всегда должно содержать
значение. Открытый ключ и опциональные параметры алгоритма
используются для верификации цифровой подписи (если
субъектом сертификата является удостоверяющий центр) или
управления ключами.
72 Основы технологии PKI
Т а б л и ц а 4.1. Формат сертификата Х.509
>
S
0Q
(>N
ОС
Он
CQ
>
Он
CQ J
Элемент
version
serialNumber
signature.algorithm
Identifier
algorithm
1 parameters
issuer
Validity
NotBefore
notAfter
subject
SubjectPubiicKeylnfo
Algorithm
subjectPublicKey
issuerUniquelD
subjectUniquelD
AuthorityKeyldentifier
keyldentifier
authorityCertlssuer
authorityCertSerialNumber
subjectKeyldentifier
keyUsage
digitalSignature
nonRepudiation
keyEncipherment
dataEncipherment
Описание
Версия (0 означает vl, 2 означает v3)
1 Серийный номер сертификата |
Тип алгоритма подписи
Алгоритм
Параметры
Уникальное название УЦ, выпустившего
сертификат j
Период действия
Дата и время начала действия
Дата и время окончания действия
Уникальное имя субъекта
Информация об открытом ключе субъекта
Криптографический алгоритм
Ключ (строка битов)
Уникальный идентификатор центра,
выпускающего сертификат
Уникальный идентификатор субъекта
Идентификатор ключа УЦ
Идентификатор ключа
Общее название УЦ
Серийный номер сертификата УЦ
Идентификатор, используемый тогда,
когда субъект имеет более одного ключа
(например, во время возобновления
сертификата)
Применение ключа (строки битов)
1. Формирование и проверка цифровой
подписи
2. Неотказуемость
3. Шифрование других ключей
4. Шифрование и расшифрование данных
и контроль целостности с использованием
имитозащиты. |
4. Структуры данных PKI 73
Продолжение таблицы 4.1
>
s
(L)
Элемент
keyUsage
keyAgreement
KeyCertSign
CRLSign
EncipherOnly
DecipherOnly
privateKeyUsagePeriod
PoIicyMappings
IssuerDomainPolicy
SubjectDomainPolicy
SupportedAlgorithms
Algorithmldentifier
IntendedUsage
intendedCertificatePolicies
SubjectAltName
OtherName
rfc822Name
dNSName
x400Address
directoryName
ediPartyName
uniformResourceldentifier
iP Address
registeredID
issuerAltName
subjectDirectory
Attributes
Описание
Применение ключа (строки битов)
5. Формирование других ключей (например,
по алгоритму Диффи-Хелмана)
6. Формирование ЭЦП сертификатов.
Может использоваться УЦ
7. Формирование ЭЦП САС. Может использоваться
УЦ
8. Только для шифрования
9. Только для расшифрования
Период действия секретного ключа подписи
УЦ
Используется только для сертификата
УЦ, Оговаривает, что политики применения
сертификатов издателя и субъекта
одинаковы
Определяют атрибуты каталога. Исполь- 1
зуются, чтобы сделать атрибуты известными
заранее в случаях, когда партнер по
связи использует данные каталога
Альтернативное имя субъекта. Свобод- 1
ный выбор имени.
Произвольное имя
Адрес электронной почты
Имя домена
Адрес отправителя/получателя
Имя каталога
EDI-имя
Унифицированный указатель ресурсов
WWW URL
IP-адрес
Зарегистриров. ID объекта
Альтернативное имя издателя 1
Необязательные атрибуты субъекта, на- 1
пример, почтовый адрес, номер телефона
и т.п.
74 Основы технологии PKI
Окончание таблицы 4.1
>
О.
CQ
Элемент
BasicConstraints
сА
pathLenConstraint
NameConstraints
PermittedSubtrees
Base
minimum
maximum
excludedSubtree
PolicyConstraints
PolicySet
InhibitPolicyMapping
cRLDistributionPoints
distributionPoint
reasons
keyCompromise
cACompromise
affiliationChanged
superseded
cessalionOfOperation
certificateHold
cRLIssuer
Описание
Отличает ключ УЦ от ключей конечных
пользователей (используется только для
сертификата УЦ)
Для ключа УЦ сА истинно.
Ограничение длины цепочки
Используется только при сертификации
УЦ
Определяет сертификацию домена по
имени по отношению к подчиненному
УЦ в пределах пути, устанавливаемого
параметром BasicConstraints
Подчиненный УЦ и домен его поддерева
Имя подчиненного УЦ
Верхний предел домена
Нижний предел домена
Подчиненный УЦ, исключенный из
домена
Ограничения политики (используется
только для requireExplicitPoIicy УЦ)
Пункты распространения САС
Имя пункта распространения
Вид списка, распространяемого данным
пунктом
1. Скомпрометированный ключ конечного
пользователя
2. Скомпрометированный ключ УЦ
3. Измененная информация в сертификате
(не повреждение)
4. Приостановленный ключ
5. Завершение использования
6. Приостановление использования
Имя издателя САС
4. Структуры данных PKl 75
Необязательные поля Issuer Unique Identifier и Subject Unique
Identifier информируют об идентификаторах субъекта и издателя
сертификата и предназначены для управления многократным использованием
имен субъектов и издателей. Вследствие неэффективности
подобного механизма управления Интернет-стандарты профилей
сертификата и списка аннулированных сертификатов не рекомендуют
использовать в сертификатах эти поля.
4.1.2. Дополнения сертификата
Важная информация находится также в дополнениях сертификата.
Они позволяют В1слючать в сертификат информацию, которая
отсутствует в основном содержании, определять действительность
сертификата и наличие у владельца сертификата прав доступа к той
или иной системе. Кроме того, в дополнениях содержится технологическая
информация, позволяющая легко проверить подлинность
сертификата. Каждая организация может использовать свои частные
дополнения, удовлетворяющие конкретным требованиям ведения
бизнеса. Однако большинство требований охватывают стандартные
дополнения, поддержку которых обеспечивают коммерческие программные
продукты.
Опциональное поле Extensions появляется в сертификатах
третьей версии. Каждое дополнение состоит из идентификатора типа
дополнения Extension identifier, признака критичности Criticality flag
и собственно значения дополнения Extension value. Идентификатор
типа дополнения задает формат и семантику значения дополнения.
Признак критичности сообщает приложению, использующему данный
сертификат, существенна ли информация о назначении сертификата
и может ли приложение игнорировать данный тип дополнения.
Если дополнение задано как критичное, а приложение не распознает
данный тип дополнения, то сертификат не должен использоваться
приложением. Нераспознанное некритичное дополнение приложение
может игнорировать и использовать сертификат.
Дополнения сертификатов Х.509 определены рекомендациями
Х.509 версии 3 Международного Союза по телекоммуникациям
и документом RFC 3280 [104] группы инженерной поддержки Интернет
IETF. Все дополнения, утвержденные указанными рекомендациями,
можно разделить на две категории: ограничивающие и ий-
76 Основы технологии PKI
формационные дополнения [147]. Первые ограничивают область
применения ключа, определенного сертификатом, или самого сертификата.
Вторые содержат дополнительную информацию, которая
может быть использована в прикладном программном обеспечении
пользователем сертификата.
К ограничивающим дополнениям относятся:
• основные ограничения (Basic Constraints);
• область применения ключа (Key Usage);
• расширенная область применения ключа (Extended Key
Usage);
• политики применения сертификатов (Certificates Policies,
Policy Mappings, Policy Constraints);
• ограничения на имена (Name Constraints).
К информационным дополнениям относятся:
• идентификаторы ключей (Subject Key Identifier, Authority
Key Identifier);
• альтернативные имена (Subject Alternative Name, Issuer Alternative
Name);
• пункт распространения списка аннулированных сертификатов
(CRL Distribution Point, Issuing Distribution Point);
• способ доступа к информации удостоверяющего центра
(Authority Access Info).
Документом RFC 3280 Certificate & CRL Profile пока не рекомендуется
использовать дополнение Subject Directory Attributes, которое
может применяться для доставки любых значений атрибутов
каталога Х.500 о субъекте данного сертификата. Вместе с этим стандарт
Х.509 позволяет вводить любые другие дополнения, необходимость
которых определяется их использованием в конкретной системе
(например, в системе SET).
Субъектом сертификата может быть конечный пользователь
или удостоверяющий центр. Основные поля сертификата не дифференцируются
в зависимости от типа пользователя, различать субъекты
сертификатов и оценивать возможность построения цепочки сертификатов
позволяет дополнение Basic Constraints, используемое
только для удостоверяющих центров.
4. Структуры данных PKI 77
Дополнение Key Usage отражает области применения секретного
ключа, соответствующего указанному в сертификате открытому
ключу. В одноименной графе таблицы 4.1 перечислены возможные
области применения ключа.
Дополнение Subject Alternative Name позволяет расширить
границы идентификации владельца сертификата путем использования
альтернативных имен, таких, как DNS-имена, IP-адреса, URI-
адреса или адреса электронной почты Интернет. Для указания дополнительной
справочной информации о владельце применяется
множественное применение имен и представление имени в различных
видах. Альтернативное имя должно проверяться в соответствии
с регламентом удостоверяюш^его центра. Помимо зарегистрированных
типов имен удостоверяющий центр может использовать свои
собственные имена, задавая их в поле Other Name. Аналогичная информация
содержится и в дополнении Issuer Alternative Name, характеризующем
издателя сертификата.
Удостоверяющие центры могут иметь много пар ключей, дополнение
Authority Key Identifier помогает пользователям выбрать
правильный ключ для верификации подписи на сертификате. Пользователи
также могут владеть многими парами ключей или несколькими
сертификатами для одного и того же ключа. Дополнение
Subject Key Identifier используется для того, чтобы различать многочисленные
ключи подписи сертификатов одного и того же владельца.
Дополнение CRL Distribution Point задает унифицированный
идентификатор ресурса (Uniform Resource Identifier - URI) для указания
местоположения списка аннулированных сертификатов, то
есть определяет пункт распространения С АС.
Организации могут поддерживать широкий круг приложений,
использующих PKL Некоторые сертификаты бывают надежнее других
в зависимости от процедур их выпуска или типов криптографических
модулей пользователей. Различные организации (компании
или правительственные агентства) используют разные политики
применения сертификатов, пользователи при этом не всегда способны
их различить, но при принятии решения могут ориентироваться
на дополнение Certificate Policies. Это дополнение содержит абсо-
78 Основы технологии PKI
лютно уникальный идентификатор, характеризующий политику
применения сертификатов, в соответствии с которой был выпущен
данный сертификат, и назначение сертификата. Признак критичности
в поле Certificate Policies ограничивает использование сертификата
одной из идентифицируемых политик, тем самым удостоверяющий
центр декларирует, что выпущенный им сертификат должен
применяться в соответствии с положениями одной из указанных
в списке политик. Это может защитить удостоверяющий центр от
претензий по возмещению ущерба доверяющей стороны, которая
использовала сертификат не по тому назначению или не тем способом,
которые соответствуют политикой применения сертификатов,
указанной в сертификате.
Пусть, например, служба департамента налогов и сборов
должна выпустить сертификаты для налогоплательщиков с целью
защиты информации о налоговых отчислениях. Очевидно, что эта
служба осознает и стремится минимизировать риск случайного выпуска
сертификата для плохо аутентифицированного лица, так как в
случае ошибки при выпуске сертификата и использования его злоумышленником
может быть причинен значительный материальный
ущерб. Считается, что дополнение Certificate Policies с признаком
критичности позволяет издателю сертификата уменьшить риск при
таких обстоятельствах и защитить себя от претензий по возмещению
ущерба. Кроме того, в поле дополнения Certificate Policies можно
указывать значения уточнителя для каждой идентифицируемой политики
применения сертификатов.
Дополнение Policy Mappings используется, если субъектом
сертификата является удостоверяющий центр. С его помощью удостоверяющий
центр может фиксировать соответствие некоторых
своих политик применения сертификатов политикам применения
сертификатов другого удостоверяющего центра. Пусть, например,
корпорация АСЕ заключает соглашение с корпорацией ABC о взаимной
сертификации PKI друг друга с целью взаимной защиты
электронного обмена данными [104]. Каждая компания имеет свою
политику защиты финансовых транзакций. Очевидно, что просто
генерация взаимных сертификатов не обеспечит необходимой функциональной
совместимости, так как в каждой компании конфигури-
4. Структуры данных PKl 79
рование финансовых приложений и выпуск сертификатов для служащих
осуществляются согласно собственной политике. Одно из
возможных решений ~ переконфигурирование всех финансовых
приложений и повторный выпуск всех сертификатов в соответствии
с требованиями обеих политик. Другим более простым решением
может быть использование дополнения Policy Mappings. Если поле
этого дополнения включает взаимный сертификат, выпущенный УЦ
компании АСЕ для УЦ компании ABC, то политика защиты финансовых
транзакций компании ABC считается эквивалентной одноименной
политике компании АСЕ.
Выпуск сертификата одним удостоверяющим центром для
другого является подтверждением надежности сертификатов последнего.
Существует три основных способа подтвердить надежность
некоторого множества сертификатов. Во-первых, это можно
сделать при помощи дополнения Basic Constraints (описанного выше).
Второй способ состоит в описании множества сертификатов на
основании имен в поле имени субъекта или альтернативного имени
субъекта в дополнении Name Constraints. Это дополнение может использоваться
для задания множества допустимых имен или множества
недопустимых имен.
В-третьих, для описания множества сертификатов на основании
ограничения политик можно использовать дополнение Policy
Constraints. Это дополнение используется только в сертификатах
удостоверяющих центров и задает проверку пути к политике, запрашивая
идентификаторы политик и (или) запрещая задание соответствий
политик [2]. Если удостоверяющий центр выдает универсально
надежные сертификаты, то нет необходимости явно указывать
в них политики применения сертификатов. Если же сертификаты
удостоверяющего центра, признанного надежным в определенном
домене, используются вне этого домена, то требуется явное указание
политики применения во всех сертификатах цепочки сертификатов.
При помощи дополнения Policy Constraints можно объявить
неправомерным дополнение Policy Mappings в том случае, когда сертификация
выходит за пределы определенного домена. Это актуально
для контроля рисков, возникающих из-за «транзитивного» доверия,
когда домен А доверяет домену В, домен В доверяет домену С,
80 Основы технологии РК1
но домен А не желает доверять домену С. Если ограничения на политику
применения сертификатов установлены, то пользователи не
станут иметь дело с сертификатами, в которых не указаны определенные
политики или дополнение Policy Constraints вообще отсутствует.
Дополнение Certificate Policies может сопровождаться спецификатором
для указания в каждом сертификате дополнительной информации,
независимой от политики применения сертификатов.
Стандарт Х.509 жестко не регламентирует назначение и синтаксис
этого поля. Типы спецификаторов политики могут быть зарегистрированы
любой организацией, стандартно используются следующие
спецификаторы политики:
а) CPS содержит ссылку в виде уникального идентификатора
ресурса на опубликованный регламент удостоверяющего центра
(Certification Practice Statement - CPS), в соответствии с которым
выпускался данный сертификат;
б) User Notice содержит извещение пользователя в виде указателя
на уведомление и/или текста уведомления, которое должно появляться
на экране дисплея пользователя сертификата (включая
подписчиков и доверяющие стороны) до использования сертификата
и информировать о политике, требуемой для данного сертификата.
Спецификаторы политики могут использоваться для указания
дополнительных специфических деталей политики, существенных
для общего описания политики применения сертификатов.
4.2. Списки аннулированных сертификатов
4.2.1. Проверка статуса сертификата
Каждый раз при использовании сертификата и верификации
цифровой подписи на нем необходимо проверять, является ли сертификат
действующим. Сертификаты, срок действия которых истек,
должны аннулироваться удостоверяющим центром. Существует
множество причин, по которым сертификат аннулируется до истечения
срока его действия: компрометация секретного ключа, политика
безопасности конкретной организации в отношении сертификатов
уволившихся служащих и др. В таких ситуациях пользователи
4. Структуры данных PKI 81
системы должны быть проинформированы о том, что дальнейшее
использование сертификата больше не считается безопасным.
Статус сертификата на предмет аннулирования должен проверяться
перед каждым его использованием. Поэтому PKI должна
поддерживать масштабируемую систему аннулирования сертификатов.
Удостоверяюш.ий центр должен иметь возможность безопасно
публиковать информацию о статусе каждого сертификата в системе.
Клиентское программное обеспечение от имени пользователя должно
затем проверять эту информацию, прежде чем использовать любой
сертификат. Существуют три способа проверки статуса сертификата
[64]:
1. Способ извлечения («pull») или проверки с опросом наличия
изменений. Этот способ заключается в том, что клиентское приложение
периодически проверяет в реестре последнюю версию САС и
использует ее для проверки действительности сертификата. Приложение
выполняет «вытягивание» списка аннулированных сертификатов
при каждом запланированном обновлении списка.
2. Способ проталкивания («push») или принудительной рассылки
изменений, при котором удостоверяющий центр рассылает
приложениям, использующим сертификаты, новый САС всякий раз,
когда какой-либо сертификат аннулируется.
3. Способ онлайновой верификации или использования онлайнового
протокола статуса сертификата (Online Certificate Status Protocol
- OCSP). Сервер удостоверяющего центра, известный как
OCSP-респондер (ответчик), в режиме реального времени обрабатывает
запросы приложений о статусе сертификатов и предоставляет
заверенные цифровой подписью ответы для каждого сертификата.
Ответ содержит информацию об идентификаторе сертификата, его
статусе (нормальный, аннулированный, неизвестный), периоде действия,
а также может включать время и причину аннулирования [2].
В полной системе аннулирования сочетаются публикация
и последующее использование информации об аннулировании сертификатов.
Традиционным инструментом распространения информации
об аннулировании сертификатов являются публикуемые
в реестре списки аннулированных сертификатов, которые содержат
уникальные серийные номера всех аннулированных сертификатов.
82 Основы технологии PKl
4.2.2. Формат списка аннулированных сертификатов
Список аннулированных сертификатов (Certificate Revocation
List - CRL) представляет собой структурированную двоичную запись
в формате ASN.1, состоящую из:
• имени издателя (УЦ), выпустившего САС;
• даты выпуска САС и опциональной даты обновления
САС;
• дополнительных атрибутов, которые могут быть включены
в САС;
• списка элементов, каждый из которых включает ссылку на
аннулируемый сертификат и дополнительной информации о нем
и причинах его аннулирования;
• подписи издателя, заверяющей совокупность этих данных.
Формат списка аннулированных сертификатов (см. табл. 4.2)
определен в рекомендациях Меж;хународного Союза по телекоммуникациям
ITU (Х.509) и документах PKIX [104], В настоящее время
основным принятым форматом является формат САС Х.509 версии 2.
Список аннулированных сертификатов содержит набор обязательных
полей и несколько опциональных дополнений. Поле Version
(обязательное для версии 2) номером версии задает синтаксис САС.
Поле Issuer содержит отличительное имя (формата Х.500) издателя
САС, а поле Signature ~ его подпись. Поле This Update указывает
дату выпуска данного САС, а поле Next Update - дату выпуска следующего
САС.
Аннулированный сертификат характеризуется серийным номером
Certificate Serial Number и датой аннулирования Revocation
Date, а также опциональными дополнениями CRL Extensions и CRL
Entry Extensions.
Каждое дополнение САС может быть обозначено как критичное
или нeкpитич^юe. Рхли дополнение задано как критичное, а при-
ложение не распознает даниглй тип дополнения, то САС не должен
использоваться приложением. Нераспознанное некритичное дополнение
приложение может игнорировать и использовать САС.
Формат САС Х.509 (версия 2) позволяет сообществам задавать
частные дополнения, характеризующие уникальность их информации,
но поощряется использование сообществами некритичных ча-
4. Структуры данных PKI 83
стных дополнений, которые дают возможность проверить САС всем
желающим.
В зависимости от типа САС определены дополнения списка
CRL Extensions, к ним относятся CRL Number, Authority Key Identifier,
Issuer Alternative Name, Issuing Distribution Point и Delta CRL Indicator.
Таблица 4.2. Формат списка аннулированных сертификатов
Версия
vl
v2
Элемент
signature.algorithmldentifier
issuer
thisUpdate
nextUpdate
version
AuthorityKeyldentifier
Keyldentifier
AuthorityCertlssuer
authorityCertSerialNumber
cRLNumber
issuingDistributionPoint
distributionPoint
onlyContainsUserCerts
onlyContainsCACerts
onlySomeResons
indirectCRL
deltaCRLIndicator
Описание
Тип подписи
Уникальное имя УЦ-издателя
САС
Дата выпуска данного САС
Планируемая дата следующего
САС
Версия (без номера означает vl, 1
означает v2)
Идентификатор ключа, используемого
для подтверждения САС
Серийный номер списка аннулированных
сертификатов
Атрибуты выпускающего пункта
распространения САС
Индикатор разностного списка 1
аннулированных сертификатов
(дельта-списка) |
84 Основы технологии PKI
Окончание таблицы 4.2
Версия Элемент Описание
1 [Следующие элементы повторяются для каждого
аннулированного сертификата]
vl
v2
certificateSerialNumber
revocationDate
reasonCode
unspecified
keyCompromise
cACompromise
affiliationChanged
superseded
cessationOfOperation
certificateHold
removeFromCRL
holdlnstructionCode
invalidityDate
certificatelssuer
Серийный номер сертификата
Дата получения запроса об аннулировании
Код причины аннулирования (задается
перечисленными ниже значениями)
1. Причина не определена
2. Повреждение ключа конечного
пользователя
3. Повреждение ключа УЦ
4. Изменение информации в сертификате
(не повреждение)
5. Приостановление действия ключа
6. Завершение использования
7. Приостановление использования
8. Отмена временного приостановления
Код временного приостановления 1
сертификата (OID)
Дата признания сертификата 1
недействительным
Имя издателя сертификата, ассо- 1
циированного с косвенным САС |
Дополнение CRL Number выполняет функцию счетчика и информирует
пользователей о выпуске очередного САС. Дополнение
Authority Key Identifier помогает пользователям выбрать правильный
открытый ключ для верификации подписи на данном САС в том
случае, когда удостоверяющий центр владеет многими парами ключей
подписи САС. Дополнение Issuer Alternative Name служит для
4. Структуры данных FKI 85
указания альтернативных имен владельца секретного ключа, например,
DNS-имен или адресов электронной почты.
Критичное дополнение Issuing Distribution Point используется
вместе с дополнением сертификата CRL Distribution Point для идентификации
пункта распространения списков аннулированных сертификатов
для данного САС. В качестве указателя пункта распространения
САС могут использоваться доменные имена, ВР-адреса
или имена файлов на web-сервере. Это дополнение указывает, учитывает
ли список аннулированных сертификатов только аннулирование
сертификатов конечных пользователей или только сертификатов
удостоверяющих центров. Пункты распространения САС используются
в том случае, когда объем САС для данного домена PKI
становится слишком большим и принимается решение распространять
вместо него несколько меньших списков аннулированных сертификатов,
которые легче обрабатывать. Кроме того, дополнение
Issuing Distribution Point может использоваться для указания, что
САС является косвенным списком. Косвенные списки аннулированных
сертификатов являются другой возможностью распространения
САС [2]. Иногда удостоверяющий центр не желает поддерживать
собственные списки аннулированных сертификатов и делегирует
эти полномочия третьей стороне, например, другому удостоверяющему
центру. Третья сторона объединяет в один САС информацию
об аннулировании сертификатов, полученную от нескольких удостоверяющих
центров, и распространяет косвенные списки аннулированных
сертификатов.
Критичное дополнение Delta CRL Indicator идентифицирует
разностный список аннулированных сертификатов. Вообще говоря,
САС должен содержать все аннулированные сертификаты, такой
список известен как основной, или базовый, САС. Однако удостоверяющий
центр может формировать и разностные списки (дельта-
списки) аннулированных сертификатов, фиксирующие изменения с
момента выпуска предыдущего САС. Разностные списки аннулированных
сертификатов значительно быстрее обрабатываются приложениями,
которые хранят информацию об аннулировании сертификатов
в формате, отличном от структуры САС. Это позволяет при-
86 Основы технологии PKI
ложениям вносить новые изменения в свои локальные базы данных,
не затрагивая данные первоначально загруженного основного САС.
Перечисленные дополнения относятся к САС в целом, но существуют
также дополнения для ввода САС CRL Entry Extensions,
характеризующие аннулирование определенного сертификата. Так,
для указания причины аннулирования сертификата используется
дополнение Reason Code (коды причины аннулирования указаны
в табл. 4.2.), а для пометки сертификата, действие которого приостановлено,
- дополнение Hold Instruction Code. Дополнение Certificate
Issuer задает имя издателя данного сертификата, указанного в косвенном
САС.
Удостоверяющие центры так же, как и пользователи, идентифицируются
по сертификатам, их сертификаты тоже могут быть аннулированы.
Для распространения информации об аннулировании
используется список аннулированных удостоверяющих центров (Authority
Revocation List - ARL). Тип списка распознается при помощи
дополнения Issuing Distribution Point.
4.3. Атрибутные сертификаты
Обычно предполагается, что связывание открытого ключа
и субъекта при помощи сертификата должно быть долговременным.
Большинство сертификатов открытых ключей подписи конечных
субъектов имеют срок действия один или два года. Сертификаты
могут использоваться для аутентификации пользователей, и информация,
идентифицирующая субъекта, может учитываться при принятии
решения об управлении доступом. Однако во многих случаях
сведения о субъекте, содержащиеся в сертификате открытого ключа,
не являются критерием принятия решения о его правах доступа, которые
зависят от роли субъекта, категории допуска, принадлежности
к некоторой группе или платежеспособности.
Информация для авторизации часто имеет меньший срок действия,
чем сертификат открытого ключа. Она могла бы указываться
в дополнениях сертификата открытого ключа, но это не является
выходом по двум причинам. Во-первых, подобный сертификат должен
аннулироваться при любых изменениях информации для авторизации.
Во-вторых, удостоверяющий центр, выпускающий данный
4. Структуры данных PKI 87
сертификат, не имеет полномочия подписывать эту информацию,
а должен связываться с источником информации о правах доступа
конкретного пользователя.
Атрибутный сертификат Х.509 связывает атрибуты с владельцем
сертификата и предназначен для использования в Интернет-
приложениях [72]. Поскольку атрибутный сертификат не содержит
открытого ключа, то его используют вместе с сертификатом открытого
ключа. Аутентификация субъекта осуществляется при помощи
сертификата открытого ключа, а связывание атрибутов с данным-
субъектом - посредством атрибутного сертификага.
Атрибутные сертификаты могут применяться в сервисах аутентификации
источника данных и неотказуемости. В этом случае
в атрибутные сертификаты включают дополнительную информацию
о субъекте, проставляющем цифровую подпись. Эта информация
позволяет удостовериться, что субъект имеет право подписывать
данные. Род проверки зависит от содержания данных, которыми обмениваются
стороны или которые должны быть заверены цифровой
подписью.
Версия (v.l или V.2)
Владелец сертификата
Имя издателя
Тип подписи
Серийный номер
Период действия
(дата и время начала/окончания)
Атрибуты
Уникальный идентификатор издателя
Дополнения
Рис.4.3. Структура атрибутного сертификата
Атрибутный сертификат Х.509 напоминает сертификат открытого
ключа этого же формата, но отличается другими функциональными
возможностями. Он представляет собой структурированную
двоичную запись формата ASN.1 и подписывается издателем сертификата.
Атрибутный сертификат содержит девять полей: версия.
88 Основы технологии PKI
владелец, издатель, идентификатор алгоритма подписи, серийный
номер, период действия, атрибуты, уникальный идентификатор издателя
и дополнения (см. рис. 4.3). Владелец атрибутного сертификата
указывается подобно субъекту сертификата открытого ключа
подписи, но может быть задан по имени, издателю и серийному номеру
сертификата открытого ключа или дайджестом сертификата
или открытого ключа.
Атрибуты описывают информацию о полномочиях владельца
атрибутного сертификата. Как и сертификат открытого ключа подписи,
атрибутный сертификат может содержать дополнения. Наряду
с имеющимися в системе сервисами аутентификации атрибутные
сертификаты обеспечивают защищенную передачу информации о
полномочиях их владельцев [2]. Эту технологию могут применять,
например, приложения удаленного доступа к сетевым ресурсам (таким,
как web-серверы и базы данных), а также приложения, которые
управляют физическим доступом в помещения и к аппаратному
обеспечению.
5. Политика PKI 89_
5. ПОЛИТИКА PKI
5.1. Основные требования к политике PKI
Безопасность практики сертификации зависит от качества разработки
политики PKI и регламента удостоверяющего центра. Точно
спроектированная политика повышает безопасность модели доверия
PKI. Доверие - это фундамент инфраструктур открытых ключей, но
пока разработчики не могут прийти к консенсусу относительно того,
что составляет общепринятую «практику доверия». В результате
компании, предоставляющие услуги PKI, и их клиенты должны создавать
свои собственные уникальные соглашения о доверии, регулирующие
обязательства и ответственность каждой стороны.
Многие организации, реализующие функции PKI, работают,
скрывая отсутствие всякой формальной политики, потому что никогда
ранее не нуждались в ней. В последнее время развертывание PKI
получает все большее распространение, становится все более привычным,
возрастает число взаимодействий, поэтому работа без определенного
набора политик становится практически невозможной.
Первым вопросом для любой системы PKI является вопрос
о реальной необходимости политики, на который не всякая организация
может четко ответить. В закрытой системе PKI не всегда нужен
регламент, но требуется сформировать политику применения
сертификатов; в открытой системе PKI, взаимодействующей с внешними
субъектами, необходимы и политика, и регламент, и требования
внутренней безопасности [49].
К числу документов, регулирующих политику PKI, относятся
документы, описывающие политику применения сертификатов, регламент
и операционные процедуры, юридические контракты, заявления
о приватности, соглашения об обслуживании и др. Многочисленность
документов соответствует сложности и объему информации,
связанной с действующей инфраструктурой.
Политика большинства систем PKI направлена на решение
технических, административных, юридических и кадровых проблем.
90 Основы mexHOJiifc'uu FKI
Основные требования к 1юлигике PKI можно сформулировать
следующим образом:
• соответствие общей корпоративной политике безопасности;
• четкость и однозначность формулировок;
• доступность изложения;
• разграничение ответственности между субъектами РК1;
• адекватность ограничений и пределов ответственности
требованиям сферы приложения сер1ификагов.
Несмотря на свою сложность, PKI - пока голько час1ь любой
инфраструктуры безопасности организации, поэтому политика PKI
должна формироваться в русле общей корпоративной гюлигики
безопасности и не противоречить ей. Очевидно, что могут возникнуть
серьезные проблемы, если, например, 1юлигика PKI разрешает
выпуск сертификатов для аутентификации элекгронных транзакций
на сумму до 10 млн долларов, в то время как корпоративная политика
безопасности устанавливает соответствующий предел в 1 млн
долларов.
Политика должна давать ясное и четкое представление о функционировании
PKI, не допуская неправильных интерпретаций и толкований.
Продуманная политика (юзволяег избежагь многих ошибок
пользователей и способствует принятию ими осознанных решений
при работе в системе РК1. Политика должна устанавливать ответственность
субъектов PKI в случае любой проблемной ситуации, например,
преду сматривагь ответственность доверяющей стороны за
причиненный ущерб в результате недобросовес гной проверки сертификата
и взаимодействия вследствие этого не с тем получателем.
Необходимо, чтобы политика PKI защищала не только систему, но
и пользователей, не имеющих достаточных юридических или технических
знаний для полного понимания работы PKI. Доступность изложения
политики способствует правильному пониманию пользователями
ответственности сторон и позволяет избежать многих ошибок
в применении сертификатов.
Политика PKI должна распределять ответственность между
субъектами системы и разумно ограничивать ее в зависимости от
роли и функций каждого. Так, например, ответственность за начальную
идентификацию и аутентификацию субъектов чаще всего воз-
5. Политика PKI 91
лагается на регистрационный центр. Ответственность обычно ограничивается
верхним предельным значением суммы (в стоимостном
выражении) каждой допустимой РК1-транзакции. Ограничения могут
распространяться также на частоту и источник транзакций. Устанавливаемые
ограничения и пределы ответственности должны
быть разумными и не сдерживать коммерческую деятельность предприятий,
использующих в своей деятельности сертификаты открытых
ключей.
5,2. Политика применения сертификатов и регламент
Как определено стандартом организации ШТР RFC 2527 Certificate
Policy and Certification Practices Framework [93], основными документами,
описывающими политику PKI, являются документ
о политике применения сертификатов (ППС) и регламент. Они позволяют
согласовывать политики безопасности разных организаций,
хотя объем и сложность большинства документов, содержащих ППС
и регламент, делают этот процесс достаточно трудоемким. Документ
о политике применения сертификатов можно сравнить с ответом на
вопрос «что?», а регламент - с ответом на вопрос «как?».
В соответствии с международным стандартом ISO/IEC 9594-
8ЛТи-Т Recommendation Х.509 [69] под политикой применения сертификатов
понимается установленный набор правил, характеризующих
возможность применения сертификата определенным сообществом
и/или для класса приложений с определенными требованиями
безопасности. Политика применения сертификатов позволяет
доверяющей стороне оценить надежность использования сертификата
для определенного приложения. Более детальное описание
практики удостоверяющего центра при выпуске и управлении сертификатами
содержится в опубликованном им регламенте.
Политика применения сертификатов
Фактом выпуска сертификата удостоверяющий центр подтверждает
пользователю сертификата (доверяющей стороне), что данный
открытый ключ принадлежит данному лицу (субъекту сертификата).
Степень доверия, с которой пользователю сертификата следует полагаться
на его надежность, зависит от назначения сертификата и возможности
его использования в конкретном приложении, так как сер-
92 Основы технологии PKI
тификаты выпускаются в соответствии с разными практиками и процедурами
удостоверяющих центров для разных приложений и целей.
При принятии решения об использовании данного сертификата
для конкретной цели и доверии к нему пользователь может ориентироваться
на указатель ППС в сертификате формата Х.509 версии
3. Таким указателем, характеризующим политику применения
сертификатов, является уникальный зарегистрированный идентификатор
объекта - Object Identifier, Регистрация выполняется в соответствии
с процедурами, определенными стандартами Международной
организации стандартизации ISO и Международной электротехнической
комиссии IEC и ITU. Сторона, регистрирующая Object
Identifier, публикует текстовую спецификацию ППС для ознакомления
и проверки пользователями сертификатов. В одном сертификате
чаще указывается одна, а не несколько политик применения сертификатов.
Каждый удостоверяющий центр аккредитуется с учетом
заявленных им политик, которые считаются базовыми. При выпуске
сертификата для другого удостоверяющего центра данный УЦ должен
оценить и отразить в сертификате заявленный перечень политик
применения сертификатов субъекта. Модель доверия стандарта
Х.509 предполагает анализ указателей ППС при обработке цепочки
сертификатов.
Приведем примеры политик применения сертификатов. Пусть,
например, авиакомпания LATA, сотрудничающая с другими авиакомпаниями-
партнерами, желает выработать политики применения сертификатов
для PKI в авиационной индустрии: политики общего
и коммерческого назначения [93]. Политика общего назначения
формируется для персонала компании LATA с целью защиты обычной
информации (например, электронной почты) и аутентификации
соединений web-браузеров с серверами для поиска информации общего
характера. В этом случае сертификаты могут выпускаться автоматически
для любого лица, указанного в списке корпоративного
каталога авиакомпании LATA, или служащего авиакомпании-
партнера, обратившегося к сетевому администратору своей организации
с подписанным запросом на сертификат. Генерация,хранение
и управление парами ключей могут осуществляться посредством
браузеров.
5. Политика PKI 93
Политика коммерческого назначения разрабатывается для защиты
финансовых транзакций или коммуникаций с авиакомпаниями-
партнерами и предусматривает использование аппаратных криптографических
ключей. Сертификаты и аппаратные ключи выдаются
только уполномоченным служащим авиакомпаний после прохождения
ими проверки корпоративной службой безопасности и подписания
обязательств защищенного хранения и правильного использования
аппаратных ключей.
Регламент удостоверяющего центра
Термин регламент удостоверяющего центра {Certification
Practice Statement - CPS) был введен в 1995 году в проекте директив
Американской ассоциации юристов (American Bar Association) как
«заявление о практике выпуска сертификатов удостоверяющим центром
». Регламент может принимать форму подробного изложения
той системы и практики, которых придерживается удостоверяющий
центр в работе с сертификатами. В регламенте могут фиксироваться
положения договора между удостоверяющим центром и подписчиками.
Регламент четко формулирует обязанности удостоверяющего
центра перед доверяющей стороной. Лицо, полагающееся на сертификат
при проверке цифровой подписи, должно знать или получать
информацию о содержании сертификата. Этим обусловлено требование
включения в сертификат ссылки на регламент удостоверяющего
центра, выпустившего данный сертификат. Регламент должен
отражать соответствие практики удостоверяющего центра общепризнанным
стандартам, только в этом случае может быть оценена пригодность
и принципиальная технологическая совместимость сертификатов,
выпущенных удостоверяющим центром, с другими системами
применения сертификатов.
Концепции политики применения сертификатов и регламента
имеют разное происхождение и разрабатывались по разным причинам,
но их связь чрезвычайно важна.
Регламент - это детальное изложение практики удостоверяющего
центра и всего того, что потенциально необходимо для понимания
и принятия во внимание подписчиками и пользователями сертификатов
(доверяющими сторонами). Любой регламент, независимо
от его уровня детализации, всегда более подробен, чем описание
94 Основы технологии PKI
политики применения сертификатов. Регламент должен быть совершенно
понятным, четким документом, описывающим сервисы удостоверяющего
центра и процедуры управления жизненным циклом
сертификатов. Регламент необходим для адекватной оценки надежности
удостоверяющего центра, но он не создает базис для функциональной
совместимости удостоверяющих центров, управляемых
разными организациями. Таким базисом служат политики применения
сертификатов.
Т а б л и ц а 5.1. Сравнительная характеристика формулировок
документов, описывающих отдельное положение политики PKI
Формулировка
ППС
Физический доступ
к аппаратному
обеспечению
УЦ разрешен
только лицам,
ответственным за
техническую
поддержку системы
Формулировка
регламента
Для гарантирования
физической безопасности
аппаратного обеспечения
УЦ должны
соблюдаться следующие
меры контроля:
• вход в помещение,
где размещается аппаратура
УЦ, - только по
два человека;
• контроль доступа в
помещение - биометрический;
• наблюдение за помещением
- 24 часа в
сутки 7 дней в неделю
(по системе 24/7)
Формулировка
организационных процедур
Аппаратное обеспечение
УЦ размещается в помещении
с1Т-блокировкой
на ... этаже офиса ... на
улице .... Дверь защищается
замком и устройством
биометрической аутентификации.
Ключи раздаются
лицам, перечисленным
в списке (приложение А),
биометрические профили
создаются только для этих
лиц. Камеры на северной
стене над входом в помещение
и на западной стене
за огнетушителем выполняют
наблюдение под
управлением пульта безопасности
24 часа в сутки 7
дней в неделю
Удостоверяющий центр на базе одного регламента может поддерживать
многочисленные политики применения сертификатов,
используемые для приложений разного назначения или различными
сообществами пользователей сертификатов. Многие удостоверяющие
центры с разными регламентами могут поддерживать одну и ту
5. Политика PKl 95
же политику применения сертификатов. Например, если федеральное
правительство определяет полигику применения сертификатов
для управления конфиденциальной информацией о кадрах, то описанием
политики будет служить подробное изложение ее общих характеристик
и перечисление гипов приложений, для которых она
пригодна. Разные департаменты или агентства, управляющие удостоверяющими
центрами с разными регламентами, должны поддерживать
политику федерально1о уровня, но могут^ поддерживать т-
ряду с ней и другие политики применения сертификатов.
Любой удостоверяющий центр, используя спецификатор политики,
может включить в выпускаемый им сертификат ссылку на
свой регламент. По мнению многих разработчиков политики PKI,
ППС должна описыва1ь все области применения сертификатов данного
удостоверяющего центра, в то время как регламент удостоверяющего
центра может разрабатываться без учета назначения сертификатов.
Таблица 5.1 позволяет сравнить формулировки политики
применения сертификатов, регламента и организационных процедур,
описываюпще одно и то же положение политики РКТ: защищенность
аппаратных средств удостоверяющего центра. Регламент
и политика применения сертификатов содержат достаточно обгцую
информацию и публикуются открыто, а организационные процеду-
рьг носят конфиденциапьный характер и поэтому должны оставаться
секретными. Обычно регламент и политика имеют одинаковый формат
публикации, установленный стандартом RFC 2527 [76], и взаимно
дополняют друг друга.
Трудности разработки ППС t4 регламента
Среди разработчиков политики PKI редко встречаются подлинные
специалисты, обладающие необходимым опытом и уровнем знаний.
Большинство привлекаемых к '^той работе бизнес-менеджеров
оказываются недостаточно технически образованными, чтобы участвовать
в проек! ировании РКТ, а многие менеджеры - специалисты
по информационным технологиям, не знают условий реального бизнеса
или специфики деягельности организации.
В результате документы, описывающие политику PKI, создаются
людьми, которые не представляют целостной картины функционирования
РКТ и опираются на свои предположения и допуще-
96 Основы технологии PKI
ния. Встречающиеся в тексте документов неточности и положения,
которые можно толковать двояко, подвергают серьезному риску
всех субъектов PKI. Например, недооценка важности правильного
выбора предельного значения сумм транзакций может иметь радикальные
последствия: если предел установлен слишком низким, необходимые
для ведения бизнеса транзакции могут быть отвергнуты,
если предел слишком высок, PKI подвергается риску. Лучшим решением
при отсутствии специалистов необходимой квалификации
является привлечение центра утверждения политики (Policy Approval
Authority) - организации, интегрирующей все составляющие политики
и руководства в процессе выработки политики PKI (в России такая
организация пока не создана).
Среди разработчиков политики PKI широко распространено
мнение, что полезность описывающих политику документов напрямую
зависит от их объема и степени подробности содержания. Например,
политика применения сертификатов, разработанная компанией
Verisign для PKI Trust Network, излагается на 115 страницах,
а регламент занимает 119 страниц. Более того, эти документы изобилуют
юридической лексикой. Совершенно ясно, что документы
такого объема и сложности находятся за пределами возможностей
понимания среднего человека (субъекта или доверяющей стороны)
и затрудняют разбор конфликтных ситуаций в суде. Некоторые компании,
предоставляющие услуги PKI, поняли это и ищут альтернативные
пути разработки более жизнеспособных документов. Так,
например, компания VeriSign для сопровождения больших документов
предлагает CPS Quick Summary - краткое изложение регламента.
Краткое изложение делает документ более понятным для среднего
человека, что повышает шансы компании выиграть в суде в случае
конфликта между сторонами - субъектами PKI.
5.3. Краткая характеристика политики PKI
Реальной альтернативой объемным документам, подробно описывающим
политику PKI, может стать краткая характеристика политики
- документ PDS (PKI Disclosure Statement). Документ PDS
возник как проект группы инженерной поддержки Интернет IETF,
затем Американская ассоциация юристов (American Bar Association -
5. Политика PKI 97_
ABA) воплотила его идею в соответствующее приложение к своему
руководству по оценке инфраструктур открытых ключей - PKI
Evaluation Guidelines, аналогичный документ был разработан также
техническим комитетом по безопасности Европейского института
стандартов связи (European Telecommunications Standards Institute -
ETSI).
Документ, кратко раскрывающий политику PKI, должен занимать
не более 2 страниц в отличие от политики применения сертификатов
и регламента, которые обычно излагаются на 8-10 и 40-80
страницах соответственно. PDS описывает самые существенные аспекты
деятельности РКГ. гарантии, ограничения и юридическую ответственность
сторон, он может служить контрольным списком для
проверки соответствия практик безопасности двух удостоверяющих
центров до вступления их в доверительные отношения. В целом документ
PDS больше похож на соглашение с конечным пользователем
или владельцем пластиковой карты, чем на обычный документ
о политике. Действительно, пользователя среднего уровня подготовки
обычно интересует его ответственность в различных ситуациях,
а отнюдь не используемые криптографические методы или специфические
меры безопасности PKI. Например, тот факт, что для хранения
секретного ключа удостоверяющего центра используется аппаратный
ключ (токен), скорее всего, привлечет внимание лишь ограниченного
круга лиц, а вот положение об ответственности доверяющей
стороны за проверку действительности используемых сертификатов
до проведения транзакции заинтересует всех субъектов
PKI.
PDS позволяет ограничивать ответственность удостоверяющего
центра, если сертификат использовался не по назначению. Например,
издатель сертификатов может опубликовать документ PDS, ограничивающий
использование сертификатов только целями бизнеса. Если
в дальнейшем клиент компании пожелает использовать свой сертификат
для покупки DVD-диска в Интернет-магазине, то не сможет
в этом случае рассчитывать на гарантии удостоверяющего центра.
Конкретизируя ответственность сторон, PDS не только обеспечивает
защиту издателя сертификатов, но и определяет отношения между
всеми субъектами PKL
98 Основы технологии FKI
Документ PDS должен быть адресован конечным пользователям
PKI и всем лицам, заинтересованным во взаимной сертификации.
Эффективное управление взаимной сертификацией является
общей проблемой больших компаний, предоставляющих услуги
PKI. Если клиент такой компании вступает в отношения взаимной
сертификации, например, с правительственным агентством, то должны
соблюдаться все требования политики правительства, которые
могут быть несовместимы с требованиями политики компании. Согласование
таких объемных и подробных документов, как политика
применения сертификатов и регламент, хотя и не является невозможным,
но все же вызывает значительные затруднения.
Как и все другие документы, описывающие политику PKI,
PDS не является универсальным. Но если дополнить список этих
документов стандартным шаблоном (XML-таблицей), позволяющим
характеризовать политику PKI [49], то разработка политики сведется
к выбору тех параграфов, которые пожелает зафиксировать конкретная
компания, разворачивающая PKI, и проставлению в пустых
графах соответствующих денежных сумм, временных ограничений
и т.п. Это не только даст выигрыш во времени, но и позволит сравнивать
политики разных инфраструктур открытых ключей при взаимной
сертификации. Подключение таблицы стиля политики PKI к
поисковому механизму даст возможность автоматически анализировать
ее структуру. В результате поиска и сравнительного анализа
стандартных таблиц, характеризующих политику каждой зарегистрированной
PKI, будет легко установить соответствие политик разных
инфраструктур и принять решение о безопасности взаимной
сертификации. Этот способ гораздо проще бюрократического и трудоемкого
метода синхронизации политик PKI, используемого сегодня.
Конечные пользователи могут выполнить аналогичный поиск,
просто указывая, какие пункты политики PKI должны быть представлены
и какие пределы сумм транзакций допустимы. В результате
такого поиска формируется список компаний, которые обладают, по
крайней мере, базовым уровнем защищенности и с которыми можно
вести бизнес. Для выделения сертификатов тех компаний, которые
поддерживают определенный уровень профессионализма в области
5. Политика PKI 99_
PKI, подтвержденный внешним аудитом, сейчас предлагается ввести
стандартные логотипы подобно узнаваемым логотипам (VISA, Master
Card) на пластиковых картах. Такие логотипы могут служить хорошим
ориентиром при принятии решения о доверии
к конкретной компании. Организация IETF планирует сформировать
рабочую группу для формализации процесса добавления логотипов
на сертификаты после их верификации.
5,4. Набор положений политики PKI
5.4.1. Общие разделы
Набор полоэюений - совокупность положений практики и/или
политики PKI, охватывающих круг стандартных тем для формулирования
политики применения сертификатов или регламента. Рисунок
5.1 иллюстрирует ориентировочный перечень разделов, включаемых
в описание политики применения сертификатов или регламента.
Стандарт RFC 2527 Certificate Policy and Certification Practices
Framework [93] не обязывает разработчиков политики или регламента
называть разделы определенным образом и не устанавливает никаких
правил раскрытия содержания компонентов политики или регламента.
Поэтому перечень разделов можно рассматривать как рекомендательный
список, позволяющий эффективно сравнивать различные
политики применения сертификатов и регламенты при принятии
решений о формировании политики.
В наборе положений следует прямо или косвенно (по ссылке)
задавать типы спецификаторов политики и их значения, используемые
по умолчанию.
Общие разделы в наборе положений предваряет раздел Введение,
в котором дается краткий обзор спецификации, описываются
используемые термины и идентификаторы, определяются типы
субъектов PKI и списки приложений, для которых применение вы-
п>^скаемых удостоверяющим центром сертификатов возможно, ограничено
или запрещено. Кроме того, в разделе Введение содержится
название и юридический адрес удостоверяющего центра, который
отвечает за регистрацию, интерпретацию и поддержку данной политики
применения сертификатов или регламента, а также информа-
100 Основы технологии PKI
ция о контактном лице (имя, адрес электронной почты, номер телефона
и факса).
Перечень общих разделов, представленный на рис. 5.1 охватывает
широкий круг проблем юридической и общей практики.
Раздел Обязательства регулирует обязательства субъектов
PKI: удостоверяющего и регистрационного центров, подписчиков
(владельцев сертификатов ключей подписи) и доверяющих сторон.
К ним относятся:
1) обязательства УЦ и/или РЦ:
• уведомление о выпуске сертификата других лиц помимо
субъекта сертификата;
• уведомление субъекта сертификата об аннулировании или
приостановлении действия его сертификата;
• уведомление других лиц помимо субъекта сертификата об
аннулировании или приостановлении действия сертификата данного
субъекта;
• своевременная публикация сертификатов и информации
об аннулировании;
2) обязательства подписчика (владельца сертификата):
• точное информирование о цели использования сертификата
при обращении к удостоверяющему центру с запросом о выдаче
сертификата;
• сохранение в тайне секретного ключа;
• использование секретного ключа и сертификата с учетом
ограничений политики PKJ;
• уведомление о компрометации секретного ключа;
3) обязательства доверяющей стороны:
• использование сертификата только по назначению;
• соблюдение порядка верификации ЭЦП;
• проверка статуса сертификата перед его использованием;
• подтверждение соответствующих пределов ответственности
и гарантий.
J. Политика PKI 101
Набор положений политики PKI
Общие разделы
Обязательства
Ответственность
Финансовая
ответствен ность
Интерпретация и
правоприменение
Плата за услуги
Аудит деятельности
субъектов
Конфиденциальность
Специальные
разделы
Идентификация и
I аутентификация
Операционные
требования
Управление
физической,
процедурной и
кадровой
безопасностью
Управление
технической
безопасностью
Форматы
сертификатов и САС
Администрирование
спецификации
Права на
интеллектуальную
собственность
Рис. 5.1. Набор положений политики PKI
102 Основы технологии PKI
Раздел Ответственность содержит положения, позволяющие
распределять ответственность между всеми субъектами PKI:
1) гарантии и ограничения на гарантии;
2) виды ущерба: случайный ущерб, ущерб по небрежности,
убытки (фактические, косвенные, заранее оцененные, штрафные),
мошенничество;
3) непризнание ущерба;
4) исключения (например, форс-мажорные обстоятельства, ответственность
другой стороны).
Раздел Финансовая ответственность регулирует возмещение
ущерба удостоверяющего или регистрационного центров доверяющими
сторонами, фидуциарные (между доверенными лицами)
отношения между различными субъектами и административные
процессы (бухучет, аудит). Правовые положения и процедуры решения
споров, имеющие отношение к интерпретации и исполнению
политики применения сертификатов или регламента содержатся
в одноименном разделе Интерпретация и исполнение.
В разделе Плата за услуги излагается политика компенсации
и перечисляются виды услуг, за которые взимается плата с клиентов
удостоверяющего и регистрационного центров (выпуск и повторный
выпуск сертификата, доступ к сертификату и к информации о статусе
сертификата, информирование о политике удостоверяющего центра
и др.).
Раздел Публикация и реестры содержит обязательства удостоверяющего
центра публиковать информацию о политике применения
сертификатов и регламенте, сертификатах и их статусе и контролировать
доступ к объектам публикуемой информации, информацию
о частоте публикации и требования к реестрам, управляемым
удостоверяющим центром или другими независимыми сторонами.
В раздел Аудит деятельности субъектов включены следующие
положения:
1) частота проверок для каждого субъекта PKI;
2) личность/квалификация аудитора;
3) отношение аудитора к субъекту;
4) действия, предпринимаемые после обнаружения нарушений
в деятельности субъекта;
5. Политика PKl 103
5) обеспечение и разделение ответственности за нарушения
субъекта.
В разделе Конфиденциальность указываются виды данных,
которые должны храниться удостоверяющим или регистрационным
центром конфиденциально, виды данных, не являющихся конфиденциальными,
перечисляются лица, имеющие право на получение
информации о причинах аннулирования или приостановления действия
сертификатов. Кроме того, в этом разделе излагается политика
раскрытия информации официальным представителям правоохранительных
органов, приводятся условия раскрытия конфиденциальной
информации, информации для гражданских судебных исков и информации
по запросу ее собственника.
Перечень общих разделов завершается разделом Права интеллектуальной
собственности, описывающим права интеллектуальной
собственности на сертификаты, спецификации политики
применения сертификатов и регламента, имена и ключи.
5.4.2. Специальные разделы
Изложение специальных разделов начинается с раздела Идентификация
и аутентификация, который описывает процедуры аутентификации
заявителя на сертификат, используемые удостоверяющим
или регистрационным центром перед выпуском сертификата.
Он также регламентирует порядок аутентификации лиц, обращающихся
с запросом об аннулировании или повторном выпуске
ключа, а также практику использования имен, включая признание
собственности имени и разрешение споров об имени. Этот раздел
включает следующие подразделы:
• начальная регистрация;
• обычное возобновление ключа;
• повторный выпуск ключа после аннулирования;
• запрос об аннулировании ключа.
Подраздел Начальная регистрация содержит положения, относящиеся
к процедурам идентификации и аутентификации во время
регистрации субъекта или выпуска сертификата:
1) типы имен, присваиваемых субъекту;
2) регулирование многозначности имен;
104 Основы технологии РК1
3) правила интерпретации различных форм имени;
4) регулирование уникальности имен;
5) признание, аутентификация и роль торговых марок;
6) регулирование обязанности субъекта доказывать владение
секретным ключом, составляющим пару с зарегистрированным открытым
ключом;
7) требования аутентификации организационной принадлежности
субъекта (УЦ, РЦ или конечный субъект);
8) требования аутентификации лица, действующего от имени
субъекта, в том числе:
• необходимое количество составляющих идентификации;
• порядок ратификации удостоверяющим или регистрационным
центром составляющих идентификации;
• условия персонального представления физического лица
при аутентификации в удостоверяющем или регистрационном центре;
• условия аутентификации юридического лица.
Подразделы Обычное возобновление ключа, Повторный выпуск
ключа после аннулирования и Запрос об аннулировании описывают
процедуры идентификации и аутентификации каждого
субъекта (УЦ, РЦ и конечный субъект) при обычном возобновлении
ключа, повторном выпуске сертификата и обработке запроса об аннулировании
сертификата.
Структура раздела Операционные требования представлена
на рис. 5.2. В каждом подразделе формулируются требования ко
всем субъектам PKI по различным видам операционной активности.
Подраздел Запрос о выдаче сертификата определяет требования
к процедуре регистрации субъекта и запросу о выдаче сертификата,
подраздел Выпуск сертификата - к выпуску сертификата и процедуре
уведомления об этом субъекта, подраздел Принятие сертификата
- к процедурам принятия субъектом выпускаемого сертификата
и последующей публикации сертификата.
Подраздел Прекращение деятельности УЦ описывает порядок
прекращения деятельности удостоверяющего и регистрационного
центров и уведомления об этом всех заинтересованных сторон.
5. Политика PKI 105
Операционные
требования
Запрос о выдаче
сертификата
Выпуск
сертификата
Принятие
сертификата
Приостановление
и аннулирование
сертификата
Смена
ключа
Архивные
записи
Контроль
безопасности
Прекрандение
деятельности УЦ
Восстановление
в случае
компрометации
или стихийного
бедствия
Рис. 5.2. Структура раздела «Операционные требования»
Подраздел Приостановление и аннулирование сертификата
определяет:
1) условия аннулирования сертификата;
2) круг лиц, имеющих право подавать запрос об аннулировании
сертификата субъекта;
3) процедуры формирования запроса об аннулировании сертификата;
4) условия приостановления действия сертификата;
5) круг лиц, имеющих право подавать запрос о приостановлении
сертификата субъекта;
6) процедуры формирования запроса о приостановлении сертификата;
7) срок приостановления;
8) частоту выпуска САС;
9) требования к доверяющим сторонам по проверке САС;
10) другие формы объявления об аннулировании сертификата;
106 Основы технологии РК1
11) требования к доверяющим сторонам по проверке других
форм объявления об аннулировании сертификата;
12) любые варианты перечисленных выше условий, если приостановление
или аннулирование вызваны компрометацией секретного
ключа.
Подраздел Контроль безопасности используется для описания
систем контроля и регистрации событий, обеспечивающих безопасность
среды, и включает следующие элементы:
1) типы регистрируемых событий;
2) частота обработки или проверки контрольных журналов;
3) срок хранения контрольных журналов;
4) защита контрольных журналов от модификации и уничтожения,
круг лиц, имеющих к ним доступ;
5) процедуры создания резервных копий контрольных журналов;
6) характеристика системы накопления данных контрольного
журнала (внутренняя или внешняя по отношению к субъекту);
7) уведомление об акции контроля субъекта, виновного в нарушении;
8) оценки уязвимости.
Подраздел Архивные записи регламентирует порядок хранения
записей в архиве и описывает:
1) типы фиксируемых событий;
2) срок хранения в архиве;
3) защита архива (лица, имеющие доступ к архиву; защита от
модификации и уничтожения);
4) процедуры создания резервной копии архива;
5) требования проставления метки времени записей;
6) характеристика системы сбора архива (внутренняя или
внешняя);
7) процедуры получения и проверки архивной информации.
Подраздел Смена ключа описывает процедуры обеспечения
подписчиков удостоверяющего центра новыми открытыми ключами.
Подраздел Процедуры восстановления в случае компрометации
или стихийного бедствия определяет требования к процедурам регистрации
и восстановления в случаях: порчи вычислительных ресур-
5. Политика PKI 107
сов, программного обеспечения и/или данных, аннулирования открытого
ключа субъекта, компрометации ключа субъекта. Эти процедуры
описывают для каждого случая, как переустанавливается
безопасная среда, какие сертификаты аннулируются, аннулируется
ли ключ субъекта, как пользователи получают новый открытый
ключ субъекта, как субъект вновь получает сертификат.
Процедуры удостоверяющего центра для поддержания безопасности
своего оборудования в течение определенного времени после
стихийного или иного бедствия и до переустановки безопасной
среды в первоначальном местонахождении удостоверяющего центра
или в удаленном от него месте.
Раздел Физические, процедурные и кадровые средства
управления безопасностью описывает нетехнические аспекты
управления безопасностью субъектов PKI в целях безопасного выполнения
функций генерации ключей, аутентификации субъектов,
выпуска и аннулирования сертификатов, аудита и хранения записей
в архиве. Раздел делится на три подраздела: Физические средства
управления безопасностью, Процедурный контроль и Кадровые
средства управления безопасностью.
Подраздел Физические средства управления безопасностью
задает требования к физической безопасности оборудования систем
субъектов PKI:
1) местонахождение и конструкция узла;
2) физический доступ;
3) электропитание и кондиционирование;
4) контроль риска затопления;
5) пожарная охрана и защита;
6) защита среды хранения системы;
7) размещение отходов.
Подраздел Процедурный контроль устанавливает требования к
доверительным должностям, определяет ответственность лиц, работающих
на таких должностях. Для каждого задания или процедуры
устанавливается круг исполнителей. В подразделе Кадровые средства
управления безопасностью описываются:
1) процедуры проверки уровня благонадежности и компетентности
сотрудников, занимающих доверительные должности;
108 Основы технологии PKI
2) процедуры проверки уровня благонадежности и компетентности
другого персонала, включая штат охраны;
3) требования и процедуры подготовки для каждой должности;
4) срок и процедуры переподготовки для каждой должности;
5) частота и последовательность смены деятельности внутри
должностей;
6) санкции, применяемые к персоналу за несанкционированные
действия, превышение полномочий и несанкционированное использование
систем субъектов;
7) управление персоналом, работающим по контракту (подписание
контракта, требования контракта, аудит и мониторинг деятельности
и другие виды контроля).
8) инструкции по работе персонала.
Раздел Технические средства управления безопасностью
содержит описание процедур защиты криптографических ключей
и данных активации субъектов PKI (PIN-кодов, паролей и т.д.).
Безопасное управление ключами должно гарантировать использование
всех секретных ключей, ключей шифрования и данных активации
только персоналом, имеющим на это полномочия. Раздел регламентирует
управление технической безопасностью субъектов PKI
в целях безопасного выполнения функций генерации ключей, аутентификации
пользователей, выпуска и аннулирования сертификатов,
аудита и хранения записей в архиве.
Технический контроль включает управление безопасностью
жизненного цикла сертификатов (в том числе безопасность среды
и методологии разработки надежного программного обеспечения)
и управление операционной безопасностью. Структура раздела представлена
на рис. 5.3.
Подраздел Управление компьютерной безопасностью описывает
элементы управления компьютерной безопасностью: использование
концепции надежной компьютерной базы, дискреционное и
мандатное управление доступом, метки, повторное использование
объекта, достоверный маршрут, аудит, идентификацию и аутентификацию,
тестирование безопасности и вторжений.
5. Политика PKI 109
Технические средства
управления безопасностью
Генерация и
инсталляция
пар ключей
Защита
секретного
ключа
Другие
аспекты
управления
ключами
Управление
прикладным
криптографическим
модулем
Управление
безопасностью
жизненного
цикла
Управление
компьютерной
безопасностью
Управление
сетевой
безопасностью
Данные
активации
Рис. 5.3. Структура раздела «Технические средства
управления безопасностью»
Подраздел Генерация и инсталляция пар ключей раскрывает
для всех типов субъектов PKI следующие положения:
1) генерация открытого и секретного ключа субъекта;
2) способы доставки:
• секретного ключа субъекту,
• открытого ключа субъекта издателю сертификата,
• открытого ключа удостоверяющего центра пользователям;
3) размеры ключа;
4) генерация параметров открытого ключа и проверка качества
параметров;
5) способ генерации ключа (аппаратный или программный);
6) назначение ключа и ограничения на его использование.
110 Основы технологии PKl
Подраздел Защита секретного ключа для всех субъектов PKI
устанавливает порядок обращения с секретным ключом: ввод
в криптографический модуль, контроль, депонирование, создание
резервной копии, хранение в архиве, задает стандарты на криптографический
модуль, а также способы активации, деактивации и уничтожения
секретного ключа.
Подраздел Другие аспекты управления ключами определяет
порядок хранения в архиве открытых ключей всех субъектов PKI,
агента хранения в архиве, меры контроля безопасности системы хранения
ключей в архиве, а также сроки использования (период активного
жизненного цикла) открытого и секретного ключей. В подразделе
Данные активации для всех субъектов PKI описывается весь жизненный
цикл данных активации от генерации до хранения в архиве.
К данным активации относятся данные (кроме ключей), необходимые
для работы криптографических модулей.
Подраздел Управление безопасностью жизненного цикла посвящен
контролю за разработкой систем и управлению безопасностью
среды. Контроль за разработкой систем включает безопасность
среды разработки, безопасность персонала, занимающегося разработкой,
безопасность управления конфигурацией во время технической
поддержки продукта, практику инженерии и методологию разработки
программного обеспечения, модульность, разбиение на
слои, использование определенных методов реализации (оборонительное
программирование), безопасность средств разработки.
Управление безопасностью среды заключается в выполнении процедур,
гарантирующих поддержание заданной безопасности операционных
систем и сетей. Эти процедуры реализуют проверку программного,
программно-аппаратного и аппаратного обеспечения
безопасности.
Подраздел Управление сетевой безопасностью регулирует
контроль сетевой безопасности среды.
Подраздел Управление разработкой криптографического модуля
описывает следующие аспекты разработки криптографического
модуля: идентификацию границ криптографического модуля,
ввод-вывод, функции и сервисы, конечный автомат, физическую
безопасность, безопасность программного обеспечения и операци-
5, Политика PKl 111
онной системы, согласованность алгоритма. Требования могут быть
выражены ссылкой на определенный стандарт.
В разделе Форматы сертификата и списка аннулированных
сертификатов описываются номера поддерживаемых версий сертификатов
и САС, профиль и пункт распространения САС, дополнения
сертификата, идентификаторы объектов криптографического
алгоритма и политики применения сертификатов, указываются типы
имен конечных субъектов, удостоверяющих и регистрационных
центров и ограничения на имена. Раздел раскрывает использование
ограничителей политики, синтаксис и семантику спецификаторов
политики, семантику обработки критичной для ведения бизнеса политики.
Раздел Администрирование спецификации регламентирует
порядок описания конкретной политики или регламента и задает
процедуры изменения спецификации, публикации и уведомления,
а также утверждения регламента. Подраздел Процедуры изменения
спецификации содержит следующие элементы:
1) список компонентов, подкомпонентов спецификации и/или
их элементов, которые можно изменять без уведомления об этом
заинтересованных сторон, не меняя идентификатор объекта политики
применения сертификатов {Object Identifier) или указатель регламента;
2) список компонентов, подкомпонентов спецификации и/или
их элементов, которые можно изменять после уведомления об этом
заинтересованных сторон, не меняя идентификатор объекта политики
применения сертификатов {Object Identifier) или указатель регламента;
3) список компонентов, подкомпонентов спецификации и/или
их элементов, для которых требуется внесение изменений в идентификатор
объекта политики применения сертификатов {Object Identifier)
или указатель регламента.
В подразделе Процедуры публикации и уведомления содержится
список элементов политики применения сертификатов или
регламента, не публикуемых открыто, а также раскрываются механизмы
распространения и управления доступом к документам, описывающим
политику применения сертификатов или регламент.
112 Основы технологии PKI
Подраздел Процедуры утверждения регламента регулирует согласованность
определенного регламента и политики.
В приложении 1 приведен примерный перечень набора положений,
который может служить контрольным списком или стандартным
образцом для разработчиков политики применения сертификатов
или регламента. Такой перечень можно использовать при
сравнении:
• двух регламентов;
• двух политик применения сертификатов на предмет их соответствия
во время взаимной сертификации;
• регламента и описания политики для подтверждения того,
что регламент полностью реализует политику.
5.5. Проблемы формирования политики PKI
Политика PKI во многом зависит от политики безопасности,
требований и характера деятельности конкретной организации, развертывающей
инфраструктуру, поэтому сложно предложить готовые
универсальные рекомендации по выработке политики. В данном
разделе рассматриваются потенциальные проблемы и рабочие моменты,
возникающие при формировании политики и проектировании
PKI, а также возможные варианты решения. Остановимся на
таких аспектах политики, как идентификация и аутентификация,
управление сертификатами и ключами. Проблемам проектирования
и отражения в политике PKI сферы применения, масштаба, архитектуры,
расширяемости системы, выбора физических и кадровых
средств управления безопасностью посвящена следующая глава.
5.5.1. Идентификация и аутентификация
Требования к персональным данным заявителя
Процесс регистрации конечных субъектов включает два важных
шага: обработку запроса на сертификат и аутентификацию
субъекта. Для установления идентичности пользователя используются
обычные вопросы об имени и адресе заявителя. Требования
к персональным данным заявителя зависят от типа запрашиваемого
сертификата. В одних случаях для принятия решения о выпуске сертификата
открытого ключа достаточно информации, присланной
5. Политика PKI 113
субъектом по электронной почте, в других случаях, когда владелец
сертификата наделяется особыми полномочиями, необходимо личное
присутствие заявителя и предъявление документов, подтверждающих
его личность. Если удостоверяющий центр создается для
служащих одной организации, то от заявителя может потребоваться
только обоснование своего запроса на сертификат, так как персональные
данные всех служащих имеются в отделе кадров.
Проверка идентичности субъекта
Аутентификация субъекта сертификата предполагает подтверждение
персональных данных, предоставляемых заявителем при обращении
в регистрационный или удостоверяющий центр с запросом
о выдаче сертификата. Тщательность проверки идентичности субъекта
определяется типом запрашиваемого сертификата. Обычно
взаимодействие между заявителем и удостоверяющим центром
строится на основе соглашения с подписчиком, закрепленного регламентом
удостоверяющего центра. Соглашение может содержать
пункты, предусматривающие включение в цену сертификата или
предоставление за отдельную плату больших гарантий защиты и
дополнительного страхования ущерба.
5.5.2. Управление сертификатами
Выбор способа управления сертификатами
Удостоверяющий центр отвечает за публикацию в реестре
сертификатов списка аннулированных сертификатов, сертификаты
могут публиковаться в реестре удостоверяющим центром, регистрационным
центром или конечным субъектом. В PKI может быть как
один центральный сервис каталогов, предоставляющий сертификаты
пользователям, так и несколько пунктов распространения сертификатов
и списков аннулированных сертификатов. Организация, использующая
PKI, может отделить сервисы аутентификации от сервисов
управления сертификатами, в этом случае она, действуя как
регистрационный центр, самостоятельно выполняет аутентификацию
пользователей и поддерживает защищенность базы данных
о своих служащих, а часть функций PKI по выдаче сертификатов,
обновлению ключей и возобновлению сертификатов передает третьей
стороне. В этом случае происходит и передача ответственности за
114 Основы технологии PKI
выполнение этих функций PKI, и организация минимизирует свою
активность по администрированию инфраструктуры.
Для функционирования PKI чрезвычайно важно правильное
управление списками аннулированных сертификатов. Списки аннулированных
сертификатов обеспечивают единственный способ проверки
действительности используемого сертификата, так как дата
окончания срока действия, указываемая в сертификате, не может
служить подтверждением того, что данный сертификат является
действительным.
Порядок обработки запросов об аннулировании
При формировании политики и развертывании PKI должен
быть установлен порядок обработки запросов об аннулировании
и установлен круг лиц, имеющих право обращаться с такими запросами.
Обычно запрос об аннулировании сертификата направляет его
владелец при утере или компрометации секретного ключа. В некоторых
случаях с запросом об аннулировании может обращаться не
владелец сертификата, а другое лицо. Например, при увольнении
служащего из компании запрос об аннулировании его сертификата
может поступить от начальника подразделения, в котором работал
служащий. Кроме того, запрос об аннулировании сертификата может
быть направлен из удостоверяющего центра, который выпустил
сертификат, или другого удостоверяющего центра из сети взаимной
сертификации, если обнаруживается, что владелец сертификата нарушил
требования политики безопасности или регламента.
После получения запроса об аннулировании сертификата и аутентификации
лица, направившего запрос, удостоверяющий центр
отвечает за публикацию списка аннулированных сертификатов и внесение
в него изменений. Для управления сертификатами в относительно
небольшой PKI обычно применяется прямая публикация аннулированных
сертификатов в САС и обеспечивается доступ к нему
приложений, проверяющих статус сертификата. Некоторые приложения
сохраняют в памяти компьютера последнюю версию списка,
что позволяет приложению работать в автономном режиме и повышает
его производительность. Увеличение масштаба PKI и необходимость
управлять сертификатами из нескольких доменов порождает
проблемы хранения и обработки больших списков аннулирован-
5. Политика PKI 115
ных сертификатов. В процессе выработки политики и проектирования
PKI эти обстоятельства должны быть учтены, а также выбраны
способ публикации, пункты распространения и тип списка аннулированных
сертификатов.
Выбор способа публикации САС
При выборе способа публикации следует оценить преимущества
и недостатки каждого из трех возможных способов (публикация
с опросом наличия изменений, принудительная рассылка изменений
и онлайновая верификация), характер РК1-транзакций и степень
операционного риска.
Публикация САС с опросом наличия изменений (<фи11») выполняется
в определенные запланированные моменты времени и может
привести к ситуации, когда аннулированный сертификат некоторое
время не включается в САС, а пользователи продолжают полагаться
на его действительность. Данный способ годится в большинстве
случаев, но подвергает серьезному риску клиентов, которые используют
критичные для ведения бизнеса приложения, даже если планируемые
обновления выполняются достаточно часто.
Способ принудительной рассылки изменений («push») САС
подходит для PKI небольших организаций, использующих ограниченное
количество PKI-приложений, и не годится для PKI, обслуживающих
большое сообщество пользователей и многочисленные приложения.
Распространение списка этим способом требует решения
проблем распознавания приложений, которым рассылается информация
об обновлении САС, синхронизации выпуска списка, а также
получения указанной информации приложениями, если последние
были недоступны в момент рассылки.
Важным преимуществом способа онлайновой верификации является
своевременность доставки (в реальном времени) информации
об аннулировании сертификатов, этот способ Цредпочтителен для
обслуживания приложений, требующих обязательной проверки сертификатов
до выполнения транзакции. Способ онлайновой верификации
устанавливает жесткие требования постоянной защищенности
сервера OCSP-респондера и подписания всех запросов к удостоверяющему
центру цифровыми подписями, что может создать «узкие
места» при их обработке.
116 Основы технологии PKI
Возможный путь решения проблем распространения списка
аннулированных сертификатов при развертывании PKI - дифференцировать
сертификаты по назначению и применять разные способы
публикации САС для разных типов сертификатов: онлайновую
верификацию для сертификатов, используемых в приложениях, критичных
для ведения бизнеса (например, в электронной коммерции),
и «ри11»-способ для сертификатов других типов.
5.5.3. Управление ключами
Управление ключами - существенный аспект успешного развертывания
PKI. Проблемы управления ключами особенно актуальны
для масштабных PKI с большим количеством владельцев сертификатов
и пользователей. Политика управления ключами регулирует
порядок:
1) генерации, распространения и использования,
2) обновления, уничтожения и хранения,
3) восстановления/резервного копирования, хранения
в архиве и
4) депонирования ключей.
Для достижения высокого уровня безопасности PKI необходим
продуманный выбор способа и процедуры генерации ключей,
а также длины ключа.
Выбор способа генерации пары ключей
Генерация ключей может осуществляться централизованно
(удостоверяющим центром или по его поручению регистрационным
центром) или индивидуально (конечным субъектом). В большинстве
случаев пары ключей создаются конечными субъектами, которые
должны иметь программные или аппаратные средства для создания
надежных ключей. Этот способ позволяет субъекту добиться большей
конфиденциальности при отношении с доверяющими сторонами,
поскольку секретный ключ владелец хранит сам и никогда не
предъявляет. К сожалению, большинство пользователей не принимает
достаточных мер для защиты своих секретных ключей, что
подвергает PKI серьезному риску.
К преимуществам централизованной генерации можно отнести
быстроту создания ключей, использование специализированных
средств генерации высококачественных ключей, контроль соответ-
5. Политика PKI 111
ствия алгоритмов генерации установленным стандартам, а также
хранение резервных копий секретных ключей на случай их утери
пользователями. Если ключи генерируются централизованно, то политикой
безопасности PKI должны быть предусмотрены средства их
защищенной транспортировки другим компонентам PKI, а также
гарантии того, что не будет осуществляться параллельное несанкционированное
копирование секретных ключей.
Выбор длины ключа
Выбор длины ключа зависит от типа используемых приложений
и вычислительной мощности (доступной в момент проектирования
и прогнозируемой в ближайшем будущем) компьютерной базы
конкретной организации, развертывающей PKI. Длины ключей,
обычно используемых в PKI, составляют 512, 768 и 1024 бита, такие
ключи иногда называют ключами соответственно низшей, средней
и высшей степени стойкости. Недавно доказано [64], что 512-
разрядные ключи могут быть взломаны при наличии достаточной вычислительной
мощности компьютерной техники, которая пока недоступна
большинству организаций. Тем не менее, ключи низшей
степени стойкости еще несколько лет могут считаться достаточно хорошими
для использования в приложениях, работающих с несекретными
данными, например сообщениями электронной почты. В остальных
случаях при проектировании PKI следует ориентироваться
на применение ключей средней и высшей степени стойкости.
Политика PKI должна регулировать частоту обращения пользователей
за новой парой ключей. Ключи целесообразно обновлять
через такие промежутки времени, которые позволяют избежать проблем,
возникающих при одновременном истечении сроков действия
большого количества сертификатов, и дают возможность каждому
пользователю владеть несколькими сертификатами с разными сроками
действия. Для ключей, которые используются в критичных для
ведения бизнеса приложениях, требуется более частое обновление.
Выбор срока действия ключа
Как правило, пары ключей действуют более длительное время,
нежели сертификаты, тем не менее, по ряду причин срок действия
ключей следует ограничивать. Со временем ключи становятся более
уязвимыми для атак со стороны криптоаналитиков и могут быть
118 Основы технологии PKl
скомпрометированы. Длительное использование ключа шифрования
подвергает риску раскрытия большое количество документов,
зашифрованных с его помощью. При выборе срока действия ключа
следует учитывать тот факт, что через некоторое время в связи с новыми
научно-техническими достижениями его защищенность может
оказаться существенно ниже, чем ожидалось при генерации ключа.
Так, например, недавно было продемонстрировано, что ключ, сгенерированный
в соответствии со стандартом DES, в условиях новых
технологий не является достаточно надежным, хотя в 1976 году его
надежность не подвергалась сомнению [64].
Порядок обновления ключей
Политикой PKI должен быть определен порядок действий
в случае обновления пар ключей. Пары ключей могут обновляться
вручную и автоматически. При ручном обновлении ответственность
за своевременное формирование запроса об обновлении возлагается
на конечного субъекта, который должен помнить дату истечения
срока действия сертификата. Если запрос об обновлении не будет
вовремя направлен в удостоверяющий центр, субъект лишится сервиса
PKI. При автоматическом обновлении система PKI сама отслеживает
дату истечения срока действия сертификата и инициирует
запрос об обновлении ключа соответствующему удостоверяющему
центру.
Политика безопасности организации может предусматривать,
например, чтобы все документы, зашифрованные старыми ключами,
расшифровывались и вновь зашифровывались при помощи новых
ключей или чтобы любые документы, подписанные ранее старым
ключом, подписывались при помощи нового ключа. Рациональная
политика управления ключами допускает пятилетний (и даже более)
срок действия пары ключей, но может ограничивать период действия
ключей шифрования строго конфиденциальных данных несколькими
месяцами. Иногда конкретный срок действия ключей не
устанавливается, а ключи заменяются в случае необходимости, например,
при утере секретного ключа. В этом случае следует переоценивать
уровень защищенности используемой пары ключей по
истечении пяти лет или при появлении новых криптографических
алгоритмов или других технологических достижений.
5. Политика PKI 119
Выбор способа хранения секретного ключа
При проектировании PKI должен быть выбран способ хранения
криптографических ключей, он, как правило, зависит от специфики
деятельности конкретной организации. Для ограничения доступа
к секретным ключам применяются следующие механизмы [2]:
• Защита с помощью пароля. Пароль или PIN-код используется
для шифрования секретного ключа, который хранится на локальном
жестком диске. Этот метод считается наименее безопасным,
так как проблема доступа к ключу решается подбором пароля.
• Карты PCMCIA, Ключ защищенно хранится на карте
с микрочипом, но при вводе в систему «покидает» карту, следовательно,
становится уязвимым для хищения.
• Устройства хранения секрета. Секретный ключ хранится
в зашифрованном виде в специальном устройстве и извлекается
только с помощью одноразового кода доступа, предоставляемого
устройством. Этот метод более безопасен, чем упомянутые выше, но
требует доступности устройства хранения конечному субъекту и не
исключает утери устройства.
• Биометрические средства. Ключ защищается биометрическими
средствами аутентификации владельца ключа, при этом
обеспечивается тот же самый уровень защиты, что и в предыдущем
случае, но субъект избавляется от необходимости иметь при себе
устройство хранения секрета.
• Смарт-карты. Ключ хранится на смарт-карте с чипом,
который обеспечивает возможность выполнять операции шифрования
и цифровой подписи. Ключ никогда не покидает карту, поэтому
риск его компрометации низок. Однако владелец ключа должен носить
смарт-карту с собой и заботиться о ее сохранности. При утере
смарт-карты зашифрованные при помощи секретного ключа данные
могут оказаться невосстановимыми.
Порядок восстановления, резервного копирования и хранения
ключей в архиве
Очень важными аспектами управления ключами являются
создание резервных копий и восстановление ключей, так как субъектам
любой PKI свойственно терять свои секретные ключи. В случае
утери секретного ключа конечного субъекта удостоверяющий
120 Основы технологии PKI
центр должен аннулировать соответствующий сертификат открытого
ключа, после этого должна быть сгенерирована новая пара
ключей и создан новый сертификат открытого ключа. Сервер восстановления
ключей обеспечивает копирование секретных ключей
в момент их создания и восстановление их впоследствии. В экстремальной
ситуации при утере ключа подписи самого удостоверяющего
центра становятся невозможными выпуск сертификатов и подписание
списка аннулированных сертификатов, то есть компрометируется
весь домен доверия. Политикой безопасности резервного копирования
и восстановления должен быть определен формат резервных
копий ключей (обычный текст, зашифрованный текст или ключ
по частям) и определен порядок работы с персоналом, ответственным
за процедуры резервного копирования и восстановления, ведения
контрольных журналов, материалов архива, поддержки секретных
ключей удостоверяющего и регистрационного центров и конечных
субъектов.
При разработке процедур хранения ключей и другой информации
в архиве должны быть выбраны объекты, подлежащие хранению,
период хранения и лица, ответственные за архив и имеющие
доступ к нему, детально описаны события, фиксируемые в контрольных
журналах, способы поиска и защиты от искажений архивной
информации, процедуры проставления метки времени. В силу
однотипности операций создания резервных копий, архивирования и
копирования к любым копиям данных должны применяться те же
строгие правила, которые распространяются на оригинал.
Выбор способа и агента депонирования ключей
При развертывании PKI в дополнение к функциям резервного
копирования и восстановления ключей может быть запланирована
поддержка депонирования ключей. Под депонированием ключей понимается
предоставление копий секретных ключей третьей стороне
и разрешение пользоваться ими при определенных обстоятельствах,
в качестве третьей стороны чаще всего выступают правительственные
учреждения и правоохранительные органы. Депонирование
ключей может быть возложено на независимое подразделение внутри
организации, развертывающей PKI, или на внешнее агентство.
Один из способов депонирования ключей и поддержания высокого
5. Политика PKl 121
уровня безопасности состоит в шифровании секретных ключей открытым
ключом агента депонирования и передаче их на локальное
хранение под контроль владельцев ключей или другого уполномоченного
лица. При необходимости восстановить секретный ключ
зашифрованный ключ вновь передается агенту депонирования для
расшифрования при помощи его секретного ключа.
Альтернативным способом депонирования внутри организации
является разделение ключа на две части, шифрование каждой
части открытыми ключами разных лиц (например, офицеров безопасности)
и локального хранения под контролем владельцев ключей
или уполномоченного лица. Кроме того, для депонирования и раздельного
хранения двух частей секретного ключа подписи пользователя
можно использовать смарт-карты.
Выбор способа и агента депонирования осуществляется с учетом
финансовых возможностей, требований безопасности и особенностей
деятельности организации, развертывающей PKL
5.5.4. Жизненный цикл сертификатов и ключей
Политикой PKI должно быть четко определено, в какой момент
времени сертификаты и ключи становятся действительными
и как долго сохраняют свой статус, а также когда необходимо их
заменять или восстанавливать.
Важнейшим вопросом в смысле возможных правовых последствий
применения электронной цифровой подписи является вопрос:
когда сертификат становится действительным. Выпуск сертификата
открытого ключа и подписание его удостоверяющим центром после
аутентификации лица, обращающегося с запросом о выдаче сертификата,
не являются достаточным условием для придания сертификату
статуса действительного. Как отмечалось ранее, сертификат
становится действительным только после его открытой публикации
в реестре удостоверяющего центра, и наоборот, сертификат теряет
статус действительного после его включения в список аннулированных
сертификатов и публикации последнего.
Некоторые удостоверяющие центры требуют, чтобы пользователь,
обращающийся с запросом о выдаче сертификата, стал подписчиком
удостоверяющего центра, прежде чем сертификат этого
пользователя будет опубликован в реестре.
122 Основы технологии PKI
Рис. 5.4. Жизненный цикл сертификата
На практике сертификат может быть отправлен пользователю
вместе с договором подписчика с условием, что пользователь не будет
использовать сертификат, пока формально не подпишет договор.
Как только удостоверяющий центр получает согласие пользователя,
то публикует сертификат в открытом реестре, придавая сертификату
правовую силу, после этого сертификат и открытый ключ становятся
общедоступными в PKL
5. Политика PKl 123
Пользователи нуждаются в сертификатах различных по уровню
безопасности и дополнительным возможностям управления сертификатами.
Обычно пользователь имеет, по крайней мере, две пары
ключей: одну пару для шифрования, а другую - для электронной
цифровой подписи. Политикой PKI должны быть определены типы
выпускаемых сертификатов и их сроки действия. Вообще говоря,
теоретически сертификаты могут действовать в течение длительного
времени, но из практических соображений многие сертификаты
имеют ограниченный срок действия, позволяющий уменьшить риск
их неправильного употребления.
На практике большинство персональных сертификатов действуют
в течение одного-двух лет после выпуска, а сертификаты серверов
обычно сохраняют свою силу два года и более. Для целей архивирования
и долговременного шифрования используются специальные
сертификаты с длительным периодом действия.
Рис. 5.4 иллюстрирует жизненный цикл сертификата, стрелки,
которые отображают нормальный жизненный цикл, выделены более
ярко в отличие от тех стрелок, которыми отмечены моменты вмешательства
удостоверяющего или регистрационного центров. Так, например,
в корпоративной PKI, где владельцами сертификатов являются
служащие организации, вмешательство удостоверяющего центра
в нормальный жизненный цикл сертификата требуется в случаях:
1) аннулирования сертификата при увольнении служащего,
владеющего этим сертификатом;
2) аннулирования сертификата при утере служащим своего
секретного ключа или пароля доступа к секретному ключу;
3) приостановления действия сертификата, выпущенного для
служащего, который в данный момент времени увольняется или находится
под следствием;
4) возобновления сертификата служащего при отказе от
увольнения или после прояснения обстоятельств судебного дела и т.п.
Иногда в PKI выпускаются сертификаты с различными сроками
действия для служащих в зависимости от их статуса, например,
служащие, работающие по контракту, могут иметь сертификаты на
период их запланированной работы, а постоянные работники - сертификаты,
возобновляемые через каждые 12 месяцев.
124 Основы технологии PKI
5.5.5. Примерные сценарии управления жизненным циклом
сертификатов и ключей
Рассмотрим возможные сценарии управления жизненным
циклом сертификатов и ключей на примере инфраструктуры открытых
ключей, предполагая, что политикой применения сертификатов
установлен срок действия сертификата открытого ключа - 1 год,
секретного ключа - 10 лет, цифровой подписи - 25 лет с момента
подписания электронного документа [64].
В примере 1 на рис. 5.5 секретный ключ используется для
подписания деловых контрактов. Так как срок действия секретного
ключа 10 лет, и он создавался в начале 2000 года, то должен храниться
до начала 2010 года. На рисунке символом X в середине 2001
года помечен момент подписания документа, который будет действовать
до середины 2026 года.
Цифровая подпись этого документа остается действительной
по истечении срока действия секретного ключа, использованного
для создания этой подписи, поэтому открытый ключ должен храниться
дольше секретного, так как он продолжает использоваться
для верификации цифровой подписи и после окончания действия
секретного ключа. Действительно, вполне вероятно, что другой
электронный документ будет подписан в конце 2009 года непосредственно
перед тем, как истечет срок действия секретного ключа,
следовательно, открытый ключ должен храниться, по крайней мере,
до 2035 года, потому что может потребоваться для верификации
цифровой подписи спустя 25 лет после подписания документа.
В период 2010-2035 годов секретный ключ не может быть
скомпрометирован, так как уничтожается или хранится в архиве защищенным
образом, таким образом, нет необходимости устанавливать
более длительный срок хранения сертификата открытого ключа.
Альтернативой долговременного хранения в PKI ключей, используемых
для верификации электронной цифровой подписи, может
быть организация работы надежной системы, спроектированной
по типу нотариальной.
Такая система может подтверждать действительность цифровой
подписи электронного документа в данный момент времени,
подписывая ее собственной (системы) подписью.
5. Политика PKI 125
2000 2001 2002
Секретный
ключ
Подписанный
документ
Открытый
ключ
Сертификат
Возобновленный
сертификат
2009 2010
-Al
2026 2027 2035
И—N
к
1/1
i>
И—N ь
М
гт
Рис. 5.5. Пример 1
С этого момента для верификации цифровой подписи необходим
только открытый ключ нотариальной системы, который может
быть включен в долговременный сертификат, а ключи лица, подписавшего
документ изначально, больше не требуются.
На рис. 5.6. представлен другой пример, более сложный: компрометация
секретного ключа подписи (этот момент помечен символом
X в начале 2002 года). После обнаружения компрометации
секретного ключа удостоверяющий центр вносит сертификат открытого
ключа в список аннулированных сертификатов.
126 Основы технологии PKl
2000 2001 2002 2003 2010 2026 2027 2035
Секретный
ключ
Подписанный
документ
Открытый
ключ
Сертификат
Возобновленный
сертификат
Пункт
распространения
САС
Новый секретный
ключ
Новый открытый
ключ
Новый
сертификат
Новый
возобновленный
сертификат
И—
I
4
ш к^
^
^
^
^
^
^
^
<=
"Vl
I
Рис. 5.6. Пример 2
Если последний документ был подписан при помощи секретного
ключа (до его компрометации) в начале 2002 года, то открытый
ключ должен оставаться доступным до начала 2027 года, следо-
5. Политика PKl 127
вательно, сертификат открытого ключа должен быть доступен, несмотря
на его публикацию в списке аннулированных сертификатов.
Очевидно, что политика PKI должна определять, может ли надежность
документа, подписанного до компрометации секретного ключа,
подтверждаться в результате верификации подписи при помощи
старого открытого ключа или же для этой цели должен быть создан
новый сертификат.
При развертывании PKI и выработке политики следует анализировать
все возможные сценарии управления жизненным циклом
сертификатов и ключей и оценивать последствия компрометации
ключей. Политика PKI, должна определять типы пользователей сертификатов,
типы приложений, в которых будут использоваться сертификаты,
жизненный цикл сертификатов и условия вмешательства
в него удостоверяющего или регистрационного центров, а также
учитывать требования функционирования организации или ведения
бизнеса. Все это - неотъемлемая часть политики безопасности информационных
технологий организации.
5.5.6. Аутсорсинг
Понимание важности политики PKI в сочетании с отсутствием
опыта и нехваткой специалистов в этой области представляет дилемму
для многих компаний, в результате им приходится поручать
разработку своей политики сторонним организациям [49]. В настоящее
время используются два пути для аутсорсинга.
Первый путь - выбрать в качестве разработчика политики PKI
большую бухгалтерскую или юридическую фирму. В этом случае
явное преимущество заключается в наличии сильной юридической
базы. С другой стороны, такие фирмы только начинают приобретать
опыт в области этой технологии, а подготовка юридических кадров
со знанием специфики PKI только началась.
Второй путь - прибегнуть к помощи основных поставщиков
продуктов и услуг PKI. Опыт этих компаний различен, и в разных
фирмах на аутсорсинг приходится от 50 до 3-4 % их бизнеса. Так,
например, компания Baltimore Technologies предлагает специализированную
программу Key Steps для разработчиков политики PKI,
а компания Entrust Technologies недавно свернула финансирование
своей службы, предоставляющей услуги аутсорсинга. Для исключи-
128 Основы технологии PKI
тельно опытного в области PKI консультанта написание политики
применения сертификатов занимает примерно три недели, а написание
регламента - четыре недели.
Чрезвычайно важным фактором долговременного успешного
функционирования PKI является периодическая проверка соответствия
процедур, закрепленных политическими документами, и реальной
практической деятельности. Без аудита трудно гарантировать
точное соблюдение на практике положений политики применения
сертификатов, регламента и операционных процедур, выявлять и устранять
несоответствия, подрывающие доверие к PKI.
Ясная и точная политика является основой любой PKI. Хотя
эта идея не нова, лишь недавно появилось понимание, что громоздкая
политика PKI, которую способны расшифровать только юристы,
не стоит затраченных на ее разработку сил и средств. Очевидно, что
доверительные отношения не возникают, если две стороны не способны
достаточно понять политики друг друга.
6. Проблемы и риски технологии PKI 129
6. ПРОБЛЕМЫ И РИСКИ ТЕХНОЛОГИИ PKI
Несмотря на довольно длительное (более десяти лет) существование
стандартов сертификатов открытых ключей, только в последние
годы стало заметно более широкое использование сертификатов
для идентификации и авторизации и развертывание инфраструктур
открытых ключей. Это происходит под влиянием двух
факторов [48]. Во-первых, совершенствование элементной базы
компьютеров и возросшая скорость работы микропроцессоров повысили
доступность цифровой подписи для широкого круга устройств
и приложений. Во-вторых, увеличивающаяся сложность
и широкое распространение коммуникационных систем создали необходимость
в мощных механизмах контроля доступа. Именно технология
цифровых сертификатов способна обеспечить масштабируемые
и полностью распределенные решения для управления доступом
и обеспечения безопасности электронного документооборота,
но одновременно порождает серьезные проблемы и риски.
При выпуске цифровых сертификатов, удостоверяющий центр
должен проверить личности подписчиков, определить содержание
сертификатов, создать, распространить и обеспечить принятие открытых
ключей подписи, гарантировать внутреннюю безопасность.
На каждом этапе возникает определенный риск для участников процесса
сертификации. Данный раздел обсуждает некоторые из этих
рисков и компромиссы, способные уменьшить или, наоборот, увеличить
риски.
Системы PKI можно разделить на открытые и закрытые [72].
Полностью закрытая система характеризуется наличием договоров,
определяющих права и обязанности всех участников в отношении
аутентификации сообщений или транзакций. В закрытой системе
риски в работе удостоверяющего центра несколько ниже, так как
мала неопределенность обязательств сторон. И наоборот, полностью
открытой системе PKI свойственно отсутствие формальных договоров,
регулирующих отношения субъектов, поэтому удостоверяющий
центр при аутентификации каждого сообщения или транзакции подвергают
себя риску неопределенной степени, подобно тому, как это
происходило на ранних этапах становления технологии цифровых
130 Основы технологии PKI
сертификатов. Тогда большинство систем удостоверяющих центров
не были ни полностью открытыми, ни полностью закрытыми, а договора
устанавливали права и ответственность только некоторых,
а не всех субъектов системы.
Рассмотрим проблемы и риски, возникающие на разных этапах
деятельности удостоверяющего центра и при функционировании
PKI в целом.
6.1. Риски создания, распространения
и принятия сертификатов
Идентификация подписчиков
Прежде чем выпустить сертификат, удостоверяющий центр
должен идентифицировать заявителя и определить назначение необходимого
тому сертификата. Для установления личности подписчика
удостоверяющий центр либо самостоятельно организует проверку
его документов, либо заключает договор с регистрационным центром.
Решение переложить эту функцию на регистрационный центр
подвергает удостоверяющий центр риску утраты деловой репутации.
В случае недобросовестной проверки личности или предъявления
фальшивых документов удостоверяющий центр несет убытки или
бывает вынужден защищать свои интересы в суде. Риск ложной
идентификации подписчика существенно ниже в той системе PKI,
где ответственность распределяется между некоторыми или даже
всеми ее субъектами посредством договоров.
Некоторые кредитные агентства, занимающиеся сбором
и продажей информации о людях, охотно бы взяли на себя функции
удостоверяющего центра по идентификации подписчиков, так как
обладают обширными базами данных и могут легко и оперативно
устанавливать личность человека. Но для оперативного и надежного
определения личности необходимо иметь некоторую конфиденциальную
информацию о данном субъекте, переданную им по защищенному
каналу (например, SSL). В силу того, что кредитные агентства
продают персональные данные всем желающим, они не владеют
специфической конфиденциальной информацией о конкретном
субъекте, известной только ему и не доступной через другие кредитные
агентства. Использование информации кредитных агентств
6. Проблемы и риски технологии PKI 131
для оперативной проверки личности подписчика ставит удостоверяющий
центр в рискованное положение.
Формирование содержания сертификатов
Для выпускающего удостоверяющего центра содержание и ограничения
сертификатов являются источником стратегического риска.
Стандартные сертификаты идентифицируют подписчика и выпускающий
их удостоверяющий центр, а также содержат информацию
о сроках действия. Международный стандарт Х.509 требует
указания в цифровом сертификате отличительного (т.е. уникального)
имени издателя сертификата, специфического серийного номера
и идентификатора алгоритма подписи издателя. Риск выпускающего
удостоверяющего центра снижают:
• кратковременность срока действия сертификатов;
• ограниченность периода использования программных
средств генерации цифровой подписи;
• точное указание в дополнениях сертификата его назначения.
Безопасность сертификата зависит от физической и логической
неуязвимости программного обеспечения, используемого для
генерации цифровой подписи. Чем дольше используются такие программные
средства, тем выше вероятность их порчи или несанкционированного
доступа к ним. То же самое утверждение справедливо
и в отношении срока действия сертификата. В дополнениях сертификата
могут указываться утвержденные ограничения на использование
сертификата, такие, как количество или тип транзакций или сообщений,
которые разрешено заверять электронной цифровой подписью
владельцам сертификатов. Кроме того, удостоверяющие центры
могут задавать в дополнениях классы сертификатов, используемых
для финансовых транзакций или передачи строго конфиденциальной
информации. Такие сертификаты иногда применяются даже
для единственного сообщения или одной транзакции, выполняемой
с определенной доверяющей стороной или ограниченной максимальной
суммой денег. Корректное использование дополнений сертификата
для точной характеристики его назначения снижает риск
выпускающего удостоверяющего центра.
Пользователям PKI важно понимать, что полномочия удостоверяющего
центра по выпуску сертификатов не распространяются
132 Основы технологии PKI
на их содержание. Для иллюстрации этого положения рассмотрим
следующий пример: сертификат SSL-сервера содержит два поля
данных, представляющих потенциальный интерес: имя владельца
ключа (обычно имя корпорации) и DNS-имя сервера [59]. Существуют
полномочия на регистрацию корпоративных имен. Эти имена
регистрируются при получении корпорациями лицензий на ведение
бизнеса. Также существуют полномочия по присвоению DNS-
имени. Однако ни один из известных удостоверяющих центров, выпускающих
сертификаты для SSL-серверов, ни теми, ни другими
полномочиями не обладает. Кроме того, если некоторый сервер имеет
сертификат SSL-сервера, это означает лишь то, что ему разрешено
обеспечивать защиту транзакций средствами шифрования и аутентификации
на базе протокола SSL. Очевидно, что никто не предоставлял
удостоверяющему центру полномочий контролировать
это разрешение, да в этом и нет необходимости, ведь разрешение
серверу использовать шифрование не может причинить никакого
ущерба.
Некоторые удостоверяющие центры, чтобы избежать обвинений
в отсутствии полномочий на содержание сертификата, создают
двойную структуру сертификации. Имеющий полномочия на содержание
сертификатов, регистрационный центр работает вместе с удостоверяющим
центром, который только выпускает сертификаты.
Следует учитывать, что модель РЦ+УЦ значительно менее защищена,
чем система PKI с одним удостоверяющим центром. Модель
РЦ+УЦ позволяет некоторому субъекту (УЦ), не имеющему полномочий
на содержание сертификатов, сфабриковать сертификат нужного
содержания. Обычно удостоверяющий центр подписывает обязательства
не делать этого, но, тем не менее, такая возможность сохраняется.
В силу того, что безопасность системы слабее, чем самый
слабый ее компонент, объединение РЦ+УЦ менее защищено, чем
регистрационный и удостоверяющий центры по отдельности, независимо
от степени надежности удостоверяющего центра или особенностей
договора с ним.
Создание, распространение и принятие сертификатов
При создании сертификатов операционный и стратегический
риски возникают в результате возможных ошибок при сопоставле-
6. Проблемы и риски технологии PKI 133
НИИ прав каждого владельца ключа самостоятельно генерировать
цифровую подпись и соответствующих ограничений сертификатов.
Риски бывают обусловлены недостатками политики применения
сертификатов и процедур, управляющих процессом сравнения. За
распространение и принятие сертификатов несет ответственность не
только удостоверяющий центр, так как выпуск сертификата невозможен
до тех пор, пока не становится известен способ создания
подписчиком собственной цифровой подписи. Подписчик может
использовать программные средства генерации цифровой подписи
по своему выбору. При наличии договора, определяющего функции
и ответственность сторон, операционный риск может быть разделен
между выпускающим сертификаты удостоверяющим центром, подписчиками
и доверяющими сторонами. Однако риск утраты репутации
пока полностью несет удостоверяющий центр, если на него возлагается
решение технологических проблем.
Вообще говоря, цифровой сертификат не будет работать до
тех пор, пока подписчик не примет подписанный сертификат и не
станет его владельцем. Принятие сертификата предполагает, что
подписчик согласен с политикой и регламентом удостоверяющего
центра, а также со всеми предъявляемыми к нему требованиями.
Ошибки в процессе связи с подписчиками, касающиеся принятия
сертификата и возникающие либо из-за неадекватной политики и
процедур, либо из-за технических трудностей, являются источником
операционного риска и риска утраты репутации.
6.2. Риски управления сертификатами
При выпуске сертификатов открытых ключей удостоверяющий
центр обычно взаимодействует только с подписчиками, их
представителями или агентами, действующими от имени подписчиков.
При управлении выпущенными сертификатами и поддержке
реестра сертификатов удостоверяющему центру приходится также
реагировать на запросы и сообщения доверяющих сторон. Рассмотрим
риски субъектов PKI, возникающие при информировании клиентов,
обслуживании и технической поддержке подписчиков, приостановлении
и аннулировании сертификатов и обработке запросов
доверяющих сторон.
134 Основы технологии PKl
Информирование клиентов
Клиентам PKI должна предоставляться некоторая информация
об основных услугах, а также о правах и обязанностях подписчиков
и доверяющих сторон. Подробное информирование позволяет несколько
снизить операционный риск и риск утраты репутации удостоверяющего
центра. Полное раскрытие процедур ликвидации
ошибок и политики поддержания приватности позволяет развеять
сомнения части подписчиков относительно безопасности сервисов
PKI, а ознакомление с технической документацией на системное
программное обеспечение, дает возможность клиентам дифференцировать
проблемы, возникшие по вине удостоверяющего центра
или из-за программных ошибок.
Обслу:нсивание и техническая поддержка подписчиков
Политика, процедуры и работа службы технической поддержки
являются потенциальным источником операционного и стратегического
рисков и риска утраты репутации. Удостоверяющий центр
может создать службу помощи (технического сопровождения) или
использовать некоторую другую форму прямого взаимодействия
с подписчиками и доверяющими сторонами. Решение проблем и исправление
ошибок, которые допускают подписчики и доверяющие
стороны из-за недостаточного понимания технологии PKI, требует
значительных ресурсов удостоверяющего центра или поставщика
услуг технической поддержки клиентов.
При эксплуатации программного обеспечения генерации цифровой
подписи могут возникнуть обстоятельства, при которых подписчики
возложат все трудности использования данной технологии
на удостоверяющий центр, несмотря на то, что тот обычно не является
ни продавцом, ни разработчиком используемых программных
продуктов и даже не осуществляет их техническую поддержку. При
попытке подписать электронным способом сообщение или транзакцию
у подписчиков могут возникнуть технические проблемы, которые
могли не проявляться ранее, при инсталляции программного
обеспечения. Практическое решение для РК1 может заключаться
либо во внутренней организации технического обслуживания клиентов,
либо в использовании услуг фирмы с соответствующим опытом
работы. В настоящее время некоторые фирмы предлагают смарт-
6, Проблемы и риски технологии РК1 135
карты для хранения сертификатов владельцев открытых ключей
подписи [72]. Вместо установки программного обеспечения на персональном
компьютере пользователь может применять подключенное
к компьютеру считывающее устройство для смарт-карт. Смарт-
карта и считывающее устройство должны быть предварительно запрограммированы
на загрузку информации сертификата данного
пользователя. Операционный риск и риск утраты репутации при обслуживании
и технической поддержке клиентов могут быть в некоторой
степени снижены простотой использования аппаратных
средств и отказа от самостоятельной установки клиентами на свои
компьютеры необходимого программного обеспечения.
Приостановление и аннулирование сертификатов
Так как подписчик сам несет ответственность за безопасность
средств генерации цифровой подписи, то существует потенциальный
риск их компрометации и несанкционированного использования.
Поэтому в ряде случаев удостоверяющий центр приостанавливает
действие сертификатов или аннулирует их. При несвоевременном
мониторинге может выполняться аутентификация сообщений
или транзакций, заверенных ключами подписи просроченных сертификатов.
Неудачно разработанные политики и процедуры РК1 являются
источником стратегического риска, а неправильно реализованные
- подвергают удостоверяющий центр операционному риску
и риску утраты репутации. Корректировка времени необходимого
хранения сертификатов в реестре должна выполняться в зависимости
от типа сертификатов. Несвоевременность приостановления
действия сертификата, используемого для конфиденциальных сообщений
или транзакций, повышает риск.
Удостоверяющий центр должен аннулировать сертификат, если
обнаруживается, что подписчик скомпрометировал свою цифровую
подпись. Наиболее вероятна компрометация, если подписчик не
обеспечил должной защиты своего секретного ключа. Один из самых
больших рисков в системе PKI кроется в ответственности каждого
владельца сертификата за безопасность системы хранения и
управления секретным ключом подписи. Очевидно, что у большинства
владельцев нет собственной защищенной компьютерной системы
с управлением физическим доступом, TEMPEST экранировани-
136 Основы технологии PKI
ем, с поддержкой сетевой безопасности «air wall» и другими средствами
защиты, они хранят свой секретный ключ на обычном компьютере,
где ключ потенциально является объектом атаки вирусами или
другими зловредными программами [59]. Даже применение современных
средств защиты при хранении секретного ключа не всегда
дает результат и уверенность, что никто кроме владельца не использует
его. Действительно, владелец вряд ли хранит секретный ключ
на компьютере в закрытой комнате с видеонаблюдением или на
смарт-карте, абсолютно устойчивой к атакам, лишь в редких случаях
для защиты ключа использует пароль, который нельзя подобрать
или тайно скопировать.
Проблема защищенного хранения секретного ключа тесно связана
с риском юридической ответственности владельца этого ключа.
В настоящее время в ряде стран с развитым законодательством
в области электронного документооборота представителями компаний,
занимающихся продажей программных продуктов для PKI,
лоббируются законы о юридической ответственности за использование
секретного ключа для подписи электронных документов. При
этом сторонники введения новых законов пытаются придать юридический
смысл термину «неотказуемость», предлагая законодательно
закрепить невозможность отказа владельца секретного ключа от
подписи на электронном документе, сгенерированной при помощи
этого ключа [59]. Этот термин взят из литературы по академической
криптографии и означает, что если алгоритм цифровой подписи неуязвим,
то третья сторона не может подделать цифровую подпись
владельца ключа. Следовательно, если кто-то использует секретный
ключ для заверения электронного документа, то владелец ключа не
может отказаться от этой подписи.
Другими словами, в соответствии с некоторыми законами об
ЭЦП (например, штатов Юта и Вашингтон в США), если ключ подписи
был сертифицирован удостоверяющим центром, то владелец
ключа ответственен за все, что «делает» этот секретный ключ независимо
от того, кто в действительности был за клавиатурой компьютера
или какой вирус совершил подписание электронного документа.
В любом случае владелец ключа должен нести юридическую ответственность.
Такая интерпретация «неотказуемости» явно проти-
6. проблемы и риски технологии PKI 137
воречит сложившейся практике в отношении кредитных карт. В соответствии
с международными правилами, если владелец возражает
против данных счета его кредитной карты, то имеет право отказаться
от него, не подтвердив факт покупки - и продавец должен доказать
обратное.
Если секретный ключ подписчика стал известен, злоумышленники
могут несанкционированно подписывать сообщения и транзакции.
При возникновении сомнений относительно статуса сертификата,
удостоверяющий центр может приостановить его действие до
выяснения статуса. Операционный риск и риск утраты репутации
могут возникать из-за ошибок в обработке запросов об аннулировании
или приостановлении действия сертификатов. Например, владелец
ключа, временно лишенный возможности подписывать сообщения
из-за ошибочного приостановления его сертификата, потенциально
подвергается риску ущерба или упущенной выгоды и может
обратиться в суд, тем самым подрывая репутацию удостоверяющего
центра. И наоборот, удостоверяющий центр рискует, если доверяющая
сторона принимает сообщения или акцептует транзакции, подписанные
пользователем, чей сертификат был приостановлен или
аннулирован.
Обработка запросов доверяющих сторон и верификация
сертификатов
Возникновение существенного операционного, стратегического
рисков и риска утраты репутации связано с обработкой запросов
доверяющих сторон, полагающихся на статус персональных сертификатов.
Несмотря на то, что в договоре между подписчиком и удостоверяющим
центром обычно закреплены обязательства последнего,
транзакции с доверяющими сторонами могут быть не защищены
договором, особенно в открытых системах. Например, если удостоверяющий
центр представляет доверяющей стороне аннулированный
сертификат как действующий, то рискует своей репутацией и
может быть привлечен к судебной ответственности. В открытых
системах существует дополнительный риск того, что в течение периода
действия сертификата изменятся обстоятельства подписчика
или группы подписчиков. На возрастание риска влияют любые задержки
при обработке запросов об аннулировании сертификатов
138 Основы технологии PKI
в результате неадекватных процедур или технических неполадок,
а также практика обработки запросов после их накопления группами,
а не в режиме реального времени.
Существуют два метода информирования о статусе сертификатов:
открытая публикация удостоверяющим центром информации
о статусе сертификата в реестре и открытие этой информации по
запросам заинтересованных доверяющих сторон. Наиболее распространенный
метод получения информации о статусе сертификата
заключается в поиске в реестре сертификатов длинного списка аннулированных
сертификатов и последующей верификации, то есть
проверке действительности конкретного сертификата. Каждый метод
связан с разными степенями рисков. Метод открытия статуса
сертификата по запросам позволяет удостоверяющему центру успешно
переносить часть риска утраты репутации в отношении принятия
недействительного сертификата на доверяющую сторону.
С другой стороны, метод открытой публикации статуса сертификата
возлагает всю ответственность за неаккуратное или несвоевременное
обновление списка аннулированных сертификатов на
удостоверяющий центр. Исключение ошибок и более частая генерация
САС позволяют снизить операционный риск и риск утраты репутации.
Существенное влияние на операционный риск при верификации
сертификатов оказывают способность доверяющей стороны понимать
дополнения сертификата, а главное, защищенность системы,
осуществляющей верификацию. При верификации сертификатов
используется один или несколько открытых ключей самоподписанного
сертификата удостоверяющего центра, находящегося на вершине
иерархии (в корне древовидной структуры) данной РК1. Корневой
сертификат не обладает никакой повышенной защищенностью,
а список открытых ключей не является секретом. Если злоумышленнику
удается добавить в этот список свой открытый ключ,
то он может сфабриковать свой собственный сертификат, который
получит ту же силу, что и другие законные сертификаты.
Снижению операционного риска способствует защита компьютерной
системы от физического или программного вмешательства
и верификация всех сертификатов.
6. Проблемы и риски технологии PKI 139
Операционный
риск
Стратегический
риск
Использование информации
кредитных агентств при
идентификации подписчиков
Двойная структура сертификации
УЦ4ИД
Содержание и сроки действия
сертификата
Политика, процедуры №1 и
работа службы технической
поддержки
Уязвимость программного
обеспечения генерации ЭЦП
Ошибки в процессе связи с
пользователями
Недостаточное информирование
пользователей о правах и
обязанностях субъектов ИС1
Ответственность владельцев
сертификатов за хранение и
управление секретными ключами
Метод информирования о статусе
сертификатов
Ошибки при обработке запросов о
статусе сертификатов
Защищенность системы
верификации сертификатов
Недостаточная
интероперабельность
программных и аппаратных
средств поддержки PKI
Риск утраты
репутации
Рис. 6.1 . Факторы возникновения рисков PKI.
140 Основы технологии PKI
Основные факторы, влияющие на операционный, стратегический
риски и риск утраты репутации удостоверяющего центра,
представлены на рис. 6.1. В целом, самый серьезный риск, возникающий
при использовании открытой системы PKI, заключается
в возможной неудаче при оказании РК1-услуг вследствие недостаточной
функциональной совместимости различных программных и
аппаратных средств поддержки PKI [30]. Поэтому технология PKI
должна развиваться на базе признанных стандартов с учетом опыта
успешного функционирования Интернет: применения общих протоколов
и предоставления общих услуг в глобальном масштабе.
6.3. Проблемы аутентификации и секретности
6.3.1. Проблемы аутентификации
Угрозы безопасности в процессе аутентификации
Использование цифровых сертификатов ключей подписи при
обмене электронными документами или сообщениями предполагает
Ключи А
Кэрол \
\Ключ K^
Ключ А
Ключи К
Алиса Кэрол
Рис. 6.2. Пример 1
аутентификацию сторон, согласно которой каждый участник взаимодействия
должен фактически являться именно тем, кем он себя
объявил, при этом проверяется, что данные поступили именно от
него.
Рассмотрим проблемы аутентификации на примерах взаимодействия
трех пользователей, названных, как это принято в класси-
6. Проблемы и риски технологии PKI 141
ческой криптографии, Алиса, Боб и Кэрол [59]. Простейший и самый
надежный способ аутентификации - личная встреча с участником
обмена электронными документами и установление его идентичности.
Алиса
Рис. 6.3. Пример 2
Так в примере 1 (см. рис. 6.2) проблем не возникает, так как
Алиса встречается с Кэрол и проверяет ее личность. Кэрол демонстрирует,
что она контролирует ключ К. В более трудном положении
оказывается Боб, когда пытается узнать, кто использует ключ К (см.
рис. 6.3). Он не может встретиться с Кэрол, как это сделала Алиса
в примере 7, но, тем не менее, желает выяснить, принадлежит ли Кэрол
ключ К. Для этого Боб должен установить связь А^ опираясь на
связи 5 и С, где связь В - это сертификат Алисы, а связь С - некоторое
сопоставление мысленных представлений Алисы и Боба о Кэ-
142 Основы технологии PKl
рол. В этой ситуации Боб может только полагаться на то, что Алиса
лично проверила надежность ключа Кэрол. Эта проблема усугубляется,
если Боб и Алиса вместо мысленных образов сравнивают имена,
как в примере 3, они могут использовать имя «Кэрол», имея
в виду разных людей, но, не подозревая об этом, так как имена полностью
совпадают (см. рис. 6.4). И, наконец, самый сложный случай
(пример 4\ когда Боб мысленно не представляет Кэрол и ее имя ему
ни о чем не говорит.
ff
Кэрол =—Кэрол
Алиса
1Г
Боб
Пример 3
ff
Кэрол =—Кэрол
Алиса I Боб
Пример 4
Рис.6.4. Примеры 3 и 4
Принимая во внимание проблемы, проиллюстрированные рисунками
6.2-6.4, перечислим угрозы безопасности обмена электронными
документами, возникающие при желании Боба и Алисы связаться
друг с другом (см. рис. 6.5):
1) несанкционированный доступ к компьютеру Алисы (связь
А);
2) совершение подлога: получение согласия Алисы на подпись
одного документа, присланного ей для предварительного ознакомления,
а затем отправка ей на подпись другого документа (связь В);
3) хищение ключей или пароля для доступа к ключам из компьютера
Алисы (связь С);
6. Проблемы и риски технологии РК1 143
4) атака на криптографически защищенный канал (связь D, которую
можно не учитывать, так как существует много других возможностей).
5) подмена ключа Алисы на ключ злоумышленника. Если
ключ Алисы защищен сертификатом, атакующий может подменить
корневой ключ сертификата и выпустить новые сертификаты для
своего собственного ключа (связь Е).
6) обман злоумышленником Боба, что подпись была проверена
(связь F).
Алиса Боб
Рис. 6.5. Риски при обмене документами между двумя сторонами
Итак, очевидно, что в процессе взаимной аутентификации
двух субъектов возникает много связей, которые не защищены
криптографически. Эти связи могут быть разрушены, чтобы вынудить
Алису подписать не тот документ, который она имела в виду,
или заставить Боба принять документ, который в действительности
не принадлежит Алисе.
Трудности аутентификации владельцев сертификатов с
одинаковыми фамилиями и именами
Некоторую проблему при получении сертификата ключа подписи
по электронной почте представляет аутентификация владельца
этого сертификата, если его фамилия и имя совпадают с атрибутами
других владельцев сертификатов данного удостоверяющего центра.
Если получатель сертификата лично знаком с отправителем, то чаще
всего просто верит, что полученный сертификат принадлежит именно
ему, несмотря на существование других подписчиков удостоверяющего
центра с теми же именем и фамилией. В противном случае,
144 Основы технологии PKI
чтобы определить, кому принадлежит присланный сертификат, получатель
должен обладать некоторой дополнительной информацией
о владельце сертификата. Действительно, поле Common Name сертификата
обычно содержит информацию о владельце, обеспечивающую
уникальность его имени в отличие от имен владельцев других
сертификатов, выпущенных данным удостоверяющим центром,
но не всегда подобная информация известна получателю сертификата.
6.3.2. Проблемы секретности и ответственности
Глобальный доступ к сервисам и эффективная аутентификация
пользователей имеют свою цену: они существенно облегчают
сбор информации о деятельности отдельных людей и целых корпораций.
По прогнозам специалистов, в будущем долговременное присутствие
пользователей и циркуляция персональной и корпоративной
информации в телекоммуникационных сетях еще сильнее обострят
проблемы секретности, в частности, поставят под удар доверие
к цифровым сертификатам, содержащим персональные данные
владельцев ключей [48].
Некоторые современные системы контроля доступа, такие, как
SPKI, SDSI, Policy Maker и Key Note, способны идентифицировать
субъекта без имени по ключу его подписи. Но сертификаты, используемые
в этих системах, содержат больше конфиденциальной информации,
чем обычные. Таким образом, контроль доступа, ориентированный
не на имена владельцев сертификатов, а на их ключи,
помогает решить одну проблему секретности, но одновременно создает
новые проблемы.
Существуют две основные угрозы безопасности сертификатов:
сбор содержащейся в сертификатах информации внешними наблюдателями
и сторонами, имеющими законный доступ к сертификатам,
а также анализ трафика [48]. Получение информации из обоих источников
в комплексе может нанести серьезный ущерб.
Рассмотрим проблемы, не связанные с анализом трафика. Они
возникают даже в случае плотного трафика, когда образцы доступа
отдельных пользователей смешиваются при помощи случайного
группирования запросов, а адреса источника и пункта назначения
всех связей скрываются при помощи таких надежных методов, как
6. Проблемы и риски технологии PKI 145
микширование, многослойная маршрутизация и последовательная
переадресация подключений.
Основными проблемами секретности и ответственности в системах
PKI являются следующие:
1) раскрытие персональной информации о владельцах ключей
подписи в содержании сертификатов.
2) узнаваемость уникальных ключей подписи;
3) отображение структуры корпораций и персональных контактов
в иерархии и сетях удостоверяющих центров;
4) доступ удостоверяющего центра к конфиденциальной корпоративной
информации.
Основная проблема сертификатов для идентификации (в отличие
от сертификатов для авторизации) состоит в том, что они раскрывают
имя субъекта каждому, кто видит сертификат. Если связь
не шифруется, то сертификаты позволяют постороннему наблюдателю
чрезвычайно легко идентифицировать связывающиеся стороны
и автоматически выслеживать отдельных пользователей. К сожалению,
конфиденциальность трафика компьютерных сетей, в основном,
недостаточно защищена шифрованием. Например, по протоколу
SSL сначала происходит обмен сертификатами в текстовом виде,
и только потом они зашифровываются. Даже при отсутствии внешних
наблюдателей остается внутренняя проблема: злоупотребление
содержащейся в сертификатах персональной информацией стороной,
осуществляющей их верификацию. Это - одна из причин непопулярности
клиентских SSL-сертификагов в Интернет. Пользователи
предпочитают строго отслеживать, кому раскрываются их персональные
данные. В этом смысле менее компрометирующей альтернативой
идентификации является авторизация. Проблему раскрытия
персональных данных еще более обостряет требование уникальности
имен владельцев ключей (в соответствии со стандартом Х.509
владелец должен использовать «отличительное» имя, не повторяющее
другие, содержащиеся в каталоге имена).
Вторая проблема заключается в том, что уникальность ключей
подписи делает их узнаваемыми. Даже после обмена сертификатами
аутентифицируемая связь еще остается ключом для посторонних к
информации об ее участниках и их активности. Криптографические
146 Основы технологии РК1
ключи и дайджесты в силу уникальности их природы гораздо более
надежные идентификаторы, чем имена. В сетях, где адреса получателей
и отправителей сообщений идентифицируют связывающиеся
стороны, легка корреляция ключей и их владельцев. Сторонний наблюдатель
может сопоставлять любое появление ключей и подписанных
с их помощью сообщений. Ключи часто имеют длительный
период жизни, что облегчает наблюдение за ними, несмотря на трудоемкость
процесса. Здесь скрыта внутренняя угроза: законные получатели
сертификатов могут не только проверять их подлинность,
но и запоминать ключи и отслеживать деятельность их владельцев.
Электронная коммерция сегодня не имеет должной аутентификации
клиентов и, в основном, полагается на аутентификацию
паролей. Клиентские SSL-сертификаты не были широко приняты
пользователями. Причина заключается не только в угрозе нарушения
приватности, но и в том, что централизованная модель доверия
не достаточно хорошо соответствует нуждам индивидуальных пользователей.
Сертификаты не всегда просто получить, и их стоимость
достаточно высока для большинства клиентов. Аутентификация
серверов, в основном, базируется на SSL-сертификатах сервера,
и пользователи часто не знают имени сервера, что не способствует
укреплению их доверия. Кроме того, среднему пользователю не всегда
ясно, каким удостоверяющим центрам можно действительно доверять.
Большинству пользователей и компаний неизвестен список
удостоверяющих центров, имеющих надежное программное обеспечение.
Кроме того, корпорациям, желающим контролировать свои
собственные ресурсы и связи, также не подходит централизованная
модель доверия. Очевидно, что более структурированная корпоративная
система нуждается в сертификатах различного назначения:
для индивидуальных пользователей, для низших уровней иерархии
корпорации и для доступа к корпоративной информации извне.
Стандарт Х.509 изначально задает иерархию удостоверяющих
центров. Структурированная система удостоверяющих центров, однако,
таит угрозу секретности, так как иерархия УЦ и выпускаемые
сертификаты зеркально отражают структуру корпорации и персональные
контакты. Эта проблема особенно актуальна для военных
6. Проблемы и риски технологии РК1 147
организаций и деловых компаний, имеющих закрытый доступ даже
к телефонным справочникам.
Удостоверяющие центры привлекают внимание лиц, желающих
собрать информацию о корпорации. Хорошо известно, что удостоверяющий
центр - слабое звено целостности системы, так как
скомпрометированный центр может подписывать фальшивые сертификаты.
Кроме того, удостоверяющим центрам известны все конфиденциальные
данные каждого сертификата, так как перед его выпуском
они получают доступ к достаточному объему корпоративной
информации для проверки указываемых в нем сведений. Из удостоверяющего
центра может происходить утечка информации о структуре
корпорации, использующей сертификаты, без нарушения каких-
либо ограничений целостности, поэтому доступ удостоверяющего
центра к конфиденциальной корпоративной информации можно
считать еще одной серьезной проблемой секретности в PKI.
Только тщательное проектирование систем PKI может существенно
уменьшить число сторон, способных идентифицировать владельца
сертификата, и объем раскрываемой сертификатами информации.
Основные подходы к проектированию PKI излагаются в гл. 7.
6.4. Правовые аспекты использования PKI
Во всем мире законы о цифровых подписях действуют на протяжении
почти десяти лет. Первым важным шагом в направлении
юридического признания технологии цифровых подписей стал закон
о цифровой подписи, принятый в 1995 году в США (штат Юта). В
1997 году Комиссией ООН по законодательству в области международной
торговли (United Nations Commission on International Trade
Law - UNICITRAL) был принят и вступил в действие Модельный
закон об электронной торговле (UNCITRAL Model Law on Electronic
Commerce). В нем не упоминались цифровые подписи и криптография,
но этот закон, введя в юридическую практику понятия информационного
сообщения, электронного обмена данными, юридического
признания, допустимости и доказательной силы информационных
сообщений, заложил основу использования электронных
цифровых подписей.
148 Основы технологии PKI
В последнее время наблюдается повышенная законодательная
активность в области правового регулирования электронной цифровой
подписи: в США, Австрии, Англии, Ирландии, Индии и Сингапуре
были приняты законы, посвященные электронной цифровой
подписи [42]. Некоторые из них направлены непосредственно на
нормативно-правовое регулирование применения ЭЦП, другие — на
нормативно-правовое регулирование электронной коммерции и
применения информационных технологий. Действуют также международные
правовые акты. Например, Директива Европейского
Парламента и Совета JSfc 1999/93/ЕС "Об общих рамочных условиях
для электронных подписей" 1999 г.
В России правовое регулирование электронных финансовых
и банковских технологий, электронной коммерции, электронного
документооборота и технологии PKI осуществляется на основе законодательной
и нормативной базы в области защиты информации.
К законодательной базе относятся:
• закон РФ "Об информации, информатизации и защите информации";
• закон РФ "Об электронной цифровой подписи" (принят
в январе 2001 г.);
• государственная система сертификации продуктов защиты
данных и лицензирования деятельности по представлению услуг
в области защиты информации.
Законы "Об электронном документе" и "Об электронной торговле"
пока находятся в стадии подготовки.
К нормативной базе относятся:
• стандарты криптографической защиты данных;
• требования Федерального агентства правительственной
связи и информации при Президенте РФ (ФАПСИ) по защите информации;
• требования и положения Гостехкомиссии РФ к средствам
защиты информации от НСД [25].
Российские стандарты ГОСТ Р 34.10-94 «Криптографическая
защита информации. Процедуры выработки и проверки электронной
цифровой подписи на базе асимметричного криптографического алгоритма
» [13] и ГОСТ Р 34.11-94 «Криптографическая защита ин-
6. Проблемы и риски технологии PKI 149
формации. Функция хэширования» [14] были приняты в 1994 г., новый
стандарт формирования и проверки ЭЦП на основе эллиптических
кривых (ГОСТ Р 34.10-2001) [15] появился в 2001 году. Использование
перечисленных стандартов предусматривается в качестве
алгоритмов формирования и проверки ЭЦП в законе РФ "Об
электронной цифровой подписи".
Криптографические стандарты описывают процедуры выработки
и проверки ЭЦП и хэш-функции, но за пределами их рассмотрения
остаются важные вопросы распространения и генерации ключей,
защиты от несанкционированного доступа к ключевой информации
и т.д. Вследствие этого программные продукты, реализующие
один и тот же стандарт, часто несовместимы между собой [28].
Следование стандартам должно гарантировать, что электронные
документы, заверенные ЭЦП, сформированной при помощи
стандартных алгоритмов, теоретически не могут быть подделаны за
приемлемое для злоумышленника время. Однако ошибки разработчиков
программного обеспечения при практической реализации алгоритмов
могут зачеркнуть все достоинства алгоритмов, описанных
в стандартах строгим математическим языком. Кроме того, эффективное
применение систем PKI зависит от их правильной эксплуатации
[28].
В России порядок применения средств ЭЦП по сравнению
с зарубежными странами регламентирован гораздо более жестко.
Так, например, запрещена деятельность юридических и физических
лиц, связанная с разработкой, производством, реализацией и эксплуатацией
шифровальных средств, а также защищенных средств
хранения, обработки и передачи информации, предоставлением услуг
в области шифрования информации без лицензий, выданных
ФАПСИ в соответствии с Федеральным законом "Об органах правительственной
связи и информации". Запрещается также использование
государственными организациями и предприятиями в информационно-
телекоммуникационных системах шифровальных средств,
включая криптографические средства обеспечения подлинности информации
(электронная подпись), не имеющих сертификата
ФАПСИ. Политика государства в области регулирования применения
и криптографических средств, в том числе и средств ЭЦП, на-
150 Основы технологии PKI
правлена на использование средств, сертифицированных уполномоченными
государственными органами.
Активное использование технологии PKI требует большей
гибкости правового регулирования в области применения средств
ЭЦП. По мнению юристов [42], целесообразно рассмотреть многоуровневый
подход к признанию юридической силы ЭЦП, лицензирования
ее средств и установить одни требования — для административной
сферы, другие — для корпоративной и третьи — для личного
документооборота.
Закон РФ "Об электронной цифровой подписи" фактически
описывает технологию PKI, которая имеет мировой опыт практического
внедрения и законодательного регулирования, и в последние
годы получила распространение в России. Установленные законом
требования к условиям использования ЭЦП, процедурам сертификации
открытых ключей, обязательствам во взаимоотношениях удостоверяющих
центров и владельцев сертификатов, по существу, соответствуют
описанию инфраструктуры открытых ключей, введенному
международным стандартом Х.509. Но в законе не оговаривается
формат цифрового сертификата, а лишь перечисляются его информационные
составляющие [31].
Как указывалось в разделе 6.1, самый серьезный риск при
функционировании системы PKI заключается в невозможности оказания
услуг вследствие недостаточной функциональной совместимости
различных программных и аппаратных средств поддержки
PKI, в частности криптографических приложений. Параметры сертификатов,
выпускаемых удостоверяющим центром, должны правильно
пониматься и однозначно интерпретироваться любым приложением
(независимо от производителя), пользующимся услугами
указанной системы PKI.
Эта проблема легко решается при условии, что все участники
системы PKI, включая удостоверяющий центр, придерживаются
единых форматов сертификатов и списков аннулированных сертификатов,
разработанных Международным союзом по телекоммуникациям
П'и и авторитетной общественной международной организацией
IETF (см. гл. 3).
6. Проблемы и риски технологии PKI 151
Единый стандарт на цифровые сертификаты - основа построения
систем PKI и унификации подсистем распределения криптографических
ключей в различных приложениях. В готовящихся дополнениях
и нормативных актах, регламентирующих действие российского
закона об ЭЦП, можно явно указать, что требования к формированию
сертификатов должны соответствовать стандарту Х.509
и рекомендациям RFC. В ближайшее время владельцы сертификатов
получат возможность использования единого сертификата в различных
системах PKI, что облегчит их работу и упростит процедуру
разрешения споров в судах. По прогнозам специалистов, технология
роуминга сертификатов станет эффективно развиваться и охватит
практически все инфраструктуры открытых ключей [2].
К сожалению, введение единого стандарта на цифровые сертификаты
не решает проблемы унификации систем PKI, обслуживающих
несколько приложений с разными системами криптографической
защиты информации (СКЗИ). Для России эта проблема особенно
актуальна, поскольку даже сертифицированные СКЗИ различных
производителей, реализующие единые российские криптографические
стандарты, часто несовместимы между собой. Как правило,
каждое СКЗИ использует свои собственные идентификаторы
алгоритмов, форматы представления их параметров и форматы хранения
ключевой информации [31].
Таким образом, сертификаты, выдаваемые удостоверяющими
центрами, использующими СКЗИ различных российских производителей,
оказываются несовместимыми между собой, даже если они
придерживаются единого формата Х.509 и реализуют один и тот же
криптографический стандарт ЭЦП. Соответственно сертификаты
удостоверяющего центра, построенного на базе одного СКЗИ, не
могут обслуживать криптосистемы, построенные па базе других
СКЗИ, а подпись, сформированная одним СКЗИ, не может быть
проверена другим.
Сейчас в России в связи с введением нового государственногс
стандарта на ЭЦП (ГОСТ Р 34.10-2001) представляется целесообразным
принятие единого стандарта на формат представления параметров
алгоритма ЭЦП и приведение в соответствие с международ
152 Основы технологии PKI
ными стандартами форматов цифрового сертификата (включая формат
представления открытого ключа и ЭЦП).
Совместимость СКЗИ на уровне PKI дает два важных преимущества:
приложения любых российских производителей смогут
использовать сертификаты любых удостоверяющих центров, удовлетворяющих
требованиям закона об ЭЦП; электронная подпись,
выполненная приложением одного производителя, может быть проверена
приложением другого.
По мнению специалистов [31], для дальнейшего совершенствования
законодательной базы применения технологии PKI необходимо:
• утвердить соответствие формата сертификата международному
стандарту Х.509 и рекомендациям в области ГК1;
• разработать единый государственный стандарт на форматы
представления ключей СКЗИ, хранящихся на ключевых носителях
и в составе сертификата;
• унифицировать значения и форматы представления параметров
нового алгоритма ЭЦП (ГОСТ Р 34.10-2001);
• довести до судов всех уровней перечень сертифицированных
СКЗИ, применяемых в российских РК1-системах, а также
• разработать технологические процедуры разрешения конфликтных
ситуаций и организовать обучение специалистов.
Выполнение этих рекомендаций обеспечит совместимость
форматов сертификатов, выдаваемых удостоверяющими центрами
на основе различных СКЗИ, поможет разрешению споров, связанных
с применением ЭЦП, в судах и позволит использовать сертификаты
различных удостоверяющих центров в разных РК1-системах.
7. Развертывание PKI 153
1. РАЗВЕРТЫВАНИЕ ИНФРАСТРУКТУРЫ
ОТКРЫТЫХ КЛЮЧЕЙ
Процесс развертывания PKI состоит из последовательного ряда
этапов, каждый из которых должен сопровождаться соответствующим
документированием и проверками:
1. предварительный этап;
2. проектирование;
3. создание прототипа;
4. пилотный проект;
5. внедрение.
Каждый из этапов создания PKI дает результат в виде явно
оформленного "продукта", позволяющего убедиться в законченности
и общем продвижении процесса [21].
7.1. Предварительный этап
Предварительный этап включает подготовительную работу
для принятия решения о необходимости развертывания инфраструктуры,
оценку материальных ресурсов и финансовых возможностей
организации, определение цели развертывания и сферы применения
PKI, выбор приоритетных сервисов безопасности, анализ данных
и приложений системы PKI.
Подготовка принятия решения о развертывании
При подготовке принятия решения специалисты организации,
планирующей развернуть PKI, должны изучить возможности и риски
инфраструктур открытых ключей, ознакомиться с предложениями
и РК1-решениями различных поставщиков программных продуктов
и услуг в этой области и получить их консультации относительно
целесообразности, возможной стратегии и ожидаемой эффективности
использования технологии цифровых сертификатов. На этом
шаге полезно изучение опыта развертывания или функционирования
существующих инфраструктур открытых ключей.
Оценка готовности к развертыванию
В силу того, что развертывание PKI требует значительных капиталовложений,
для принятия решения необходима оценка материальных
ресурсов и финансовых возможностей организации на на-
154 Основы технологии PKI
стоящий момент и в ближайшие годы, экономического эффекта от
использования новой технологии, начальных затрат и стоимости
функционирования системы PKL В этом процессе должны участвовать
представители администрации или бизнес-менеджеры, технические
специалисты и работники планово-финансовых подразделений.
Определение цели развертывания PKI
Проведя тщательную оценку своих потребностей, некоторые
организации вообще могут прийти к выводу, что инфраструктура
открытых ключей им не нужна. Развертывание PKI целесообразно
для крупных территориально распределенных организаций, где необходимо
наладить контролируемую защиту документов и серверов
при использовании разнообразных приложений [30]. Для решения
менее масштабных задач пригоден другой инструментарий безопасности.
Так, например, для поддержки виртуальных частных сетей
имеются специальные программные средства, как правило, уже оснащенные
надежными функциями аутентификации. Сервисы безопасности
виртуальных частных сетей используются, главным образом,
организациями, требования которых ограничены безопасным
доступом к внутренней сети через Интернет. Программы персонального
шифрования обеспечивают защиту документов и данных в локальных
системах и удобны для небольших групп пользователей.
Сервер сертификатов может решить проблемы несанкционированного
доступа к web-контенту, особенно в интрасетях, в том числе
расширенных, и на порталах. Для защиты связи с деловыми партнерами
многие поставщики РК1-услуг предлагают широкий спектр
сервисов безопасности, избавляя тем самым клиентов от необходимости
самостоятельного развертывания PKI, но предоставляя им
весьма ограниченные возможности контроля РК1-транзакций.
Любая организация при определении целей развертывания PKI
должна руководствоваться своей политикой безопасности, учитывать
специфику ведения бизнеса или характер деятельности, юридические
и административные ограничения. К потребностям ведения
бизнеса или деятельности организации можно отнести:
• поддержку аутентификации пользователей в системах
электронной коммерции;
• требований ведения бизнеса;
7. Развертывание PKI 155
• поддержку деловых коммуникаций в сделках «бизнес-
бизнес» и т.п.
Не менее важен при принятии решения о развертывании PKI и
учет потребностей безопасности, например, необходимость повысить
уровень защищенности корпоративной системы, связанной
с Интернет, или следовать требованиям безопасности, установленным
государственными органами. Кроме того, условия конкуренции
вынуждают многие компании использовать новые технологии, чтобы
соответствовать ожиданиям клиентов в отношении безопасности
используемой ими системы.
Определение сферы применения PKI
Правильное определение сферы применения является предпосылкой
успешного проектирования PKI. Возможны самые разные
варианты использования PKI. В масштабе страны может быть развернута
федеральная PKI, обеспечивающая контакты между правительственными
учреждениями и всеми гражданами посредством
сертификатов и цифровых подписей. Отдельная компания может
использовать персональные сертификаты на смарт-картах для
управления доступом штатных сотрудников в помещения и к компьютерным
системам и приложениям. При помощи персональных
сертификатов Интернет-магазин может аутентифицировать клиентов,
заказывающих товар. В финансовой сфере PKI может использоваться
в системе банковских расчетов для перевода денег корпоративным
клиентам и операций по аккредитивам.
В таблице 7.1 приводится перечень возможных сфер применения
и приложений PKI, сформированный международным объединением
пользователей и поставщиков услуг и программных продуктов
в области инфраструктур открытых ключей (PKI Форум) [73].
В зависимости от сферы применения и масштаба PKI ее конечными
субъектами или пользователями могут выступать граждане
страны, клиенты, ИТ-штат или весь персонал организации, деловые
партнеры или другие компании.
При задании сферы применения PKI необходимо определить
урЬвень взаимодействия участников системы РКЦмеждународный,
межкорпоративный, корпоративный, между несколькими подразделениями
компании и т.п.).
156 Основы технологии PKI
Т а б л и ц а 7.1. Сферы применения и категории приложений PKI
Сфера
применения
Банковская и финансовая
сферы
Страхование
Категория
приложения
Аутентификация
платежей
Контроль доступа
Защищенная электронная
почта
Защищенное хранение
и поиск документов
Цифровой нотариат
Защищенные транзакции
Электронная цифровая
подпись
Аутентификация
платежей
Контроль доступа
При1иеры объектов
и транзакций
РКЬприложений
• Покупка акций
• Денежные переводы по
кредитам на обучение
• Банковские операции в
онлайновом режиме
• Подача документов в
комиссию по ценным бумагам
и биржам
• Электронные ипотечные
кредиты
• Заявки на приобретение
ценных бумаг
• Документы 0 правовом
титуле
• Кредиты
• Гарантийные письма
Онлайновые:
• квоты;
• заявки;
• разрешения
Онлайновые платежи: 1
• страховые премии;
• компенсации по страховым
полисам
• Электронный документооборот
• Информация 0 страхователях
7. Развертывание PKl 157
Окончание табл. 7.1.
Сфера
применения
Здравоохранение
Правительство
Бизнес
Категория
приложения
Аутентификация
платежей
Защищенный обмен
i сообщениями/электронная
почта
Защищенное хранение
и поиск документов
Квалификационная
идентификация
Персональная идентификация
Контроль доступа
Аутентификация
платежей
Защищенный обмен
сообщениями
Защищенное хранение
и поиск документов
Контроль доступа
Аутентификация
платежей
Электронная цифровая
подпись
Защищенный обмен
сообщениями
Примеры объектов
и транзакций
РКЬприложений
Выплата компенсаций i
Подача заявлений на компенсацию
Информация 0 пациентах
Удостоверения врачей
Паспорта
Проход в правительствен- 1
ные здания
Выплаты органов социаль- |
ного обеспечения
Финансовые полномочия 1
администрации
Юридические документы по
судебным делам
Просмотр выбранных доку- 1
ментов деловыми партнерами
Защищенные электронные 1
платежи
Электронные контракты 1
• Соглашения о коммерческой
тайне
• Запросы с предложениями
0 поставках
• Контракты
158 Основы технологии PKl
Чрезвычайно важно выявить проблемы взаимодействия с другими
PKI и их функциональной совместимости. Это позволит очертить
круг сторон, вовлекаемых в процесс развертывания PKI. В домен
доверия PKI не входят индивидуумы или организации, не включенные
в сферу применения инфраструктуры. По мере функционирования
PKI сфера применения может быть пересмотрена и дополнена
новыми типами пользователей.
Выбор приоритетных сервисов безопасности
Как указывалось ранее (см. раздел 1), PKI обеспечивает поддержку
основных сервисов безопасности. На предварительном этапе
должны быть выбраны приоритетные направления обеспечения информационной
безопасности с учетом ожиданий заинтересованных
сторон относительно уровня безопасности проектируемой инфраструктуры
[72]. Если организации важно реализовать аутентификацию
пользователей, то должен быть выбран способ и порядок аутентификации
и средства хранения сертификатов и ключей. Если акцент
делается на конфиденциальность данных, то при проектировании
PKI следует особенно тщательно подойти к выбору криптографического
алгоритма шифрования данных. Если важна целостность
данных, то могут использоваться цифровые подписи. Если необходимо
предотвратить отказ от обязательств, то должны использоваться
сертификаты открытых ключей подписи. В силу разнообразия
требований клиентов к защищенности используемых ими приложений
решение проблем безопасности может быть найдено в результате
комбинированного применения нескольких методов и криптографических
алгоритмов.
Важными шагами предварительного этапа являются выбор
тактики введения в действие средств безопасности системы (поэтапного
наращивания возможностей или одновременной комплексной
реализации) и планирование ресурсов, согласованное со всем процессом
развертывания PKI.
Анализ данных и прилолсений
Проектирование PKI должно осуществляться на принципах
управления рисками и предваряться анализом рисков, а также данных
и приложений системы PKI, которые необходимо защитить.
Особенно важна защищенность данных, используемых во время
7. Развертывание PKl 159
функционирования системы PKI, данных на магнитных и бумажных
носителях, архивных данных, протоколов обновления, записей аудита
и документации. В числе приложений должны быть учтены приложения
локальной/сетевой связи, контроля доступа и Интернет-
приложения. Анализ должен выявить последствия компрометации
безопасности, степень риска будет определять соответствующий уровень
гарантий PKI. При выявлении большого числа рисков, связанных
с различными приложениями, возникает необходимость в разработке
нескольких политик применения сертификатов.
На предварительном этапе необходимо изучить преимущества
и риски инфраструктур открытых ключей, сформулировать потребности
безопасности и ведения бизнеса или иной деятельности, оценить
затраты и проанализировать возможные решения по развертыванию
PKI. В результате предварительного этапа, если принимается решение
о необходимости PKI, должен быть составлен разумный и приемлемый
по срокам план развертывания, учитывающий потребности
организации, а также ее материальные и финансовые возможности.
7.2. Проектирование
Этап проектирования занимает длительное время, так как на
этом этапе должна быть сформирована политика PKI и регламент,
задана архитектура PKI, определены аппаратные и программные
средства поддержки инфраструктуры, выбраны ее компоненты, сервисы,
режимы работы, протоколы и базовые стандарты [21].
Изучение политик PKI и стандартов
Проектирование PKI должно начинаться со сбора эталонных
политик и использования их в качестве шаблонов для разработки
политики данной PKI [72]. Цифровые сертификаты служат базисом
доверия при коммуникации между сторонами. Политика должна
разрабатываться с учетом всех возможных проблем безопасности в
данной среде, неадекватность и нечеткость политики ведет к ошибкам
при реализации системы безопасности и может угрожать целостности
всей PKI. При формировании политики необходимо ориентироваться
на стандарты в области PKI, позволяющие обеспечить функциональную
совместимость различных инфраструктур открытых
ключей.
160 Основы технологии PKI
Модель доверия и архитектура PKI
Фундаментом доверия PKI являются надежные сертификаты
открытых ключей. Надежность сертификатов открытых ключей зависит
от надежности удостоверяющих центров, которые их подписывают.
Это допущение формирует отношения доверия между различными
сторонами-участниками системы PKI и позволяет конечным
субъектам считать свои транзакции надежными.
Широкомасштабное развертывание PKI может вовлекать в инфраструктуру
многие удостоверяющие центры, которые выпускают
разнообразные сертификаты, создавая множественные отношения
доверия в зависимости от области применения сертификатов, типов
используемых приложений, пользователей сертификатов и видов
деловых операций. Для обеспечения функциональной совместимости
компонентов PKI должны быть определены отношения между
этими удостоверяющими центрами и задана архитектура PKI.
Отношения между взаимодействующими удостоверяющими
центрами формируют одну или несколько цепочек сертификатов,
в результате верификации которых принимается решение о доверии
к сертификату другой стороны - участника системы РК1 . Организации,
развертывающей PKI, необходимо определить, как управлять
цепочками сертификатов и подтверждать надежность сертификатов.
В PKI закрытой корпоративной системы все владельцы сертификатов
работают в одной организации, доверяют одному и тому же удостоверяющему
центру, и путь доверия строится на базе корневого
сертификата этого центра.
При развертывании PKI сложной структуры организация
должна определить, будет ли она доверять сертификатам пользователей
и приложений только своего домена доверия или других доменов
тоже. Домен доверия, или домен политики, определяется набором
политик, в соответствии с которыми выпускает сертификаты
данный удостоверяющий центр. Если принимается решение о доверии
ограниченному набору доменов, то должны быть выпущены
взаимные сертификаты, и тем самым внедрена модель доверия данной
организации в другие домены. Если организация планирует использовать,
например, приложение глобальной защищенной электронной
почты, то гютребуется более сложная структура взаимной
7. Развертывание PKl 161
сертификации всех входящих в состав PKI удостоверяющих центров,
способная обеспечить формирование цепочек сертификатов
между любыми двумя владельцами сертификатов из любых доменов
доверия.
Модель доверия важна для определения отношений не только
с внешними сторонами, но и между сторонами внутри организации.
Так, некоторым организациям традиционно свойственна сложная
корпоративная иерархия, поэтому в составе их PKI могут быть один
центральный удостоверяющий центр и множество подчиненных ему
удостоверяющих центров отделов и подразделений, то есть модель
доверия будет базироваться на традиционных для конкретной компании
правилах ведения бизнеса и отношениях между подразделениями.
Наконец, модель доверия PKI организации может строиться
на основе подписанных соглашений о политике применения сертификатов
и ответственности удостоверяюидих центров, связанных
путем доверия. В этом случае должны быть рассмотрены вопросы
о степени ответственности организации при взаимной сертификации
и ситуации, когда ответственность возлагается на пользователей
сертификатов.
Политика применения сертификатов
Политика применения сертификатов (ППС) разрабатывается
на достаточно длительный срок и должна удовлетворять строгим
требованиям, обычно она излагается в соответствии с форматом
описания политики, который задает документ RFC 2527 Certificate
Policy and Certification Practices Framework [93]. Этот документ содержит
стандартный иерархический набор положений, сгруппированный
в 8 основных разделов и 185 подразделов второго и третьего
уровней (подробное описание формата политики применения сертификатов
и регламента удостоверяющего центра см, в гл. 5). Примерный
перечень положений служит ориентиром при описании политики
применения сертификатов и помогает разработчикам политики
не упустить важные моменты.
Разработка дополнений и ограничений политики
Как правило, архитектура PKI эволюционирует от одиночных
изолированных удостоверяющих центров к более сложным формам,
устанавливающим отношения доверия между разнородными
162 Основы технологии PKl
центрами. Эти отношения закрепляются сертификатами. Каждой
политике в своем домене доверия присваивается идентификатор
объекта {Object Identifier - ОЮ). Идентификаторы ОЮ характеризуют
набор приложений, для которых пригоден данный сертификат.
Сертификат формата Х.509 v.3 в дополнении certificatePolicy может
содержать один или более идентификаторов политики в зависимости
от числа политик применения сертификатов данного удостоверяющего
центра. Идентификатор политики - это уникальный зарегистрированный
идентификатор объекта (политики применения сертификатов),
который анализируется при принятии решения о доверии
данному сертификату и возможности его использования для определенной
цели.
В том случае, если удостоверяющие центры выпускают сертификаты
в соответствии с общими политиками, в дополнении certificatePolicy
указываются идентификаторы ОЮ этих политик, и нет
необходимости использовать другие дополнения и ограничения. Когда
удостоверяющие центры работают в разных доменах политики,
то процедуры согласования политик становятся более сложными
[72] и требуется тщательный анализ соответствия политики каждого
удостоверяющего центра политикам других удостоверяющих центров.
Отношения между политиками фиксируются в дополнениях
отображения политики policy Mappings. Это дополнение сертификата
позволяет удостоверяющим центрам задавать ограниченный набор
приемлемых политик и отклонять сертификаты, выпущенные в
соответствии с неприемлемой для данного удостоверяющего центра
политикой применения сертификатов.
Процесс регистрации политик применения сертификатов осуществляется
в соответствии с процедурами, определенными совместно
Международной организацией стандартизации ISO и Международной
электротехнической комиссией ШС, а также Международным
союзом электросвязи ITU [72]. При регистрации каждый идентификатор
объекта ОЮ должен сопровождаться текстовой спецификацией
политики для ознакомления с ней пользователей сертификатов
и приложений.
7. Развертывание PKI 163
Выбор программного продукта или поставщика услуг PKI
Следующий шаг - выбор программного продукта или поставщика
услуг PKI. При выборе должны быть учтены аспекты функциональной
совместимости с другими программными продуктами/
поставщиками услуг, легкости адаптации к открытым стандартам,
удобства разработки, гибкости администрирования, расширяемости
и переносимости инсталляции [72]. Кроме того, важным критерием
является наличие интерфейсов прикладного программирования
(API) и поддержка распространенных приложений (например, виртуальных
частных сетей, управления доступом, защищенной электронной
коммерции, управления смарт-картами, сервисов каталогов,
защищенной электронной почты и др.).
Расширяемость
Функционирование PKI так или иначе затрагивает многие ресурсы
(людей, аппаратное и программное обеспечение), поэтому
нельзя не учитывать, что с течением времени масштаб системы может
существенно возрасти. Очевидно, что разнообразие практических
реализаций PKI не позволяет предложить готовое решение
поддержки масштабируемости, тем не менее, можно выделить «узкие
места» функционирования системы, влияющие на ее расширяемость:
• генерация ключей,
• хранение сертификатов,
• поддержка списков аннулированных сертификатов и
• управление жизненным циклом сертификатов и ключей.
Генерация пар ключей требует значительных вычислительных
ресурсов; если она выполняется централизованно, то существенно
увеличивает рабочую нагрузку на сервер удостоверяющего центра,
так как параллельно с ней выполняются выпуск и подписание сертификатов,
криптографические операции, организуется хранение
информации в локальной базе данных. Поэтому более рациональным
способом повышения расширяемости считается генерация пар
ключей пользователями, которая одновременно позволяет избавиться
от решения проблемы распространения ключей.
Для хранения сертификатов обычно используется общедоступный
каталог. В большинстве случаев поддерживается централи-
164 Основы технологии PKI
зованный универсальный каталог (LDAP), для которого сертификаты
являются не единственным объектом обслуживания. Для
уменьшения рабочей нагрузки на каталог сертификаты и другая информация
могут храниться в кэш-памяти приложений (быстродействующей
буферной памяти). Этот способ повышения производительности
и расширяемости в целом достаточно эффективен, но требует
документального закрепления в политике PKI ограничений на длительность
хранения сертификатов в кэш-памяти без потери статуса
действительности.
При функционировании PKI чрезвычайно важна поддержка
списков аннулированных сертификатов. Следует учитывать, что выбор
такого способа проверки статуса сертификатов, как онлайновая
верификация, значительно повышает требования к производительности
сервера каталогов, поэтому система удостоверяющего центра
должна быть способна управлять дополнительной нагрузкой при
возрастании числа пользователей PKI.
Для нормального функционирования PKI крайне нежелательно
совпадение дат окончания действия большого количества сертификатов
и ключей, поэтому их генерация и возобновление должны
происходить непрерывно, а не привязываться к определенной дате.
Это требование может быть трудно выполнимо в образовательной
среде, когда, например, требуется составить список и выдать сертификаты
учащимся в течение относительно короткого периода времени.
Кроме того, при проектировании PKI и организации ее базы
данных необходимо учитывать ежедневные часы пиковой нагрузки
в работе системы.
Интеграция PKI с действующими системами
и прило:мсениями
Большие трудности при развертывании инфраструктуры открытых
ключей вызывает интеграция соответствующих PKI-
функций во вновь создаваемые приложения, а также в уже имеющиеся
прикладные системы. PKI должна взаимодействовать с множеством
разнообразных систем и приложений, в числе которых могут
быть системы управления доступом, каталоги пользователей,
виртуальные частные сети, операционные системы, сервисы безопасности,
приложения защищенной электронной почты и web7.
Развертывание PKl 165
приложения [39]. Налаживание связи между новой инфраструктурой
и всеми этими приложениями и системами является сложной задачей,
для ее решения важно наличие интерфейсов прикладного программирования,
обеспечивающих взаимодействие существующих
корпоративных приложений с PKI и использование ее сервисов. Некоторые
программные средства поддержки PKI предоставляют API
высокого уровня для распространенных приложений, выбор программного
продукта такого типа облегчает интеграцию PKI и сокращает
время развертывания инфраструктуры.
Выбор основных средств, оборудования и персонала
Успех развертывания PKI во многом зависит от окружающей
и поддерживающей инфраструктуры. Под инфраструктурой понимаются
основные средства, оборудование и персонал, необходимые
для функционирования PKL
Серверы и криптографическое аппаратное обеспечение
Серверы, предназначенные для PKI, должны обладать высокой
производительностью, значительными системными ресурсами и
возможностями. При выборе серверов должны оцениваться точный
объем памяти центрального процессора, дискового пространства, с
учетом роста PKI следует ориентироваться на выбор аппаратного
обеспечения типа SMP-систем (с симметричной мультипроцессорной
обработкой). Такие компоненты PKI, как УЦ, РЦ и реестр сертификатов,
могут размещаться на одном сервере, или же рабочая
нагрузка может быть распределена между несколькими серверами.
Разделение функций несколько снижает производительность системы,
но позволяет распределить обязанности по поддержке отдельных
компонентов PKI между несколькими подразделениями. Для
защиты и хранения секретного ключа удостоверяющего центра, который
чаще всего является объектом внутренних и внешних атак,
должно использоваться криптографическое аппаратное обеспечение.
Смарт-карты и считыватели
Для хранения секретных ключей и сертификатов конечных
субъектов PKI целесообразно использовать такие портативные криптографические
устройства, как смарт-карты или токены безопасности.
Компактность смарт-карт делает удобным их применение в персональных
и сетевых компьютерах, киосках, считывателях жетонов
166 Основы технологии PKl
доступа и т.д. в зависимости от конкретных РК1-приложений, но при
этом возникает необходимость в дополнительных периферийных устройствах
- считывателях смарт-карт. В ряде программных продуктов
поддержки PKI для хранения ключей и сертификатов реализованы
виртуальные смарт-карты, имитирующие поведение физических
аналогов и обеспечивающие доступ пользователей без считывателей
смарт-карт.
Физическая среда
Серверы PKI должны размещаться в отдельном закрытом помещении,
доступ в которое разрешен только обслуживающему персоналу
и которое тщательно контролируется и регистрируется. Серверы
должны быть подключены к источнику бесперебойного питания,
а на время его отключения серверы должны автоматически создавать
резервные копии данных и завершать работу в штатном режиме.
Сегмент сети с серверами PKI должен быть защищен, по
крайней мере, при помощи межсетевого экрана, прозрачного только
для трафика PKI.
Требуемый уровень подготовки персонала
Персонал, обслуживающий PKI, составляет часть инфраструктуры.
Подразделение информационных технологий обеспечивает
работу по следующим направлениям: инсталляция программного
продукта, конфигурирование системы, системное администрирование,
теория и практика PKI, криптография с открытыми ключами,
информационная безопасность. Персонал подразделения поддержки
операционной работы системы должен иметь базовые знания технологии
PKI, заниматься постановкой задач и эксплуатацией системы.
Штат подразделения авторизации должен иметь представление о
концепции PKI и системном администрировании. Подразделение
аудита отвечает за правовое обеспечение системы PKI (политика,
ответственность), его персонал должен обладать знаниями в области
права и информационной безопасности.
Управление и администрирование системы PKI
При развертывании PKI должны быть определены и оформлены
в виде инструкций должностные обязанности персонала, занимающегося
управлением и администрированием системы PKI, а при
необходимости организовано дополнительное обучение служащих.
7. Развертывание PKI 167
обеспечивающих безопасность системы. В зависимости от масштаба
PKI и конкретных условий допускается совмещение должностей.
В список должностей, необходимых для поддержки системы PKI,
входят:
системный администратор;
системный оператор;
администратор УЦ;
администратор РЦ;
администратор каталога;
работник службы помощи;
менеджер по политике безопасности;
аудитор безопасности или главный администратор.
Системный администратор отвечает за функционирование
системы безопасности в целом и обычно привлекается к работе по
развертыванию PKI на самых ранних стадиях. Особенно важно участие
системного администратора в составлении плана проекта, так
как он способен дать временную оценку различным видам активности
системы. Если организация планирует работу своего собственного
удостоверяющего центра, то системный администратор отвечает
за подбор, инсталляцию и конфигурирование необходимого программного
обеспечения, а также за его поддержку и внесение изменений.
Кроме того, обязанности системного администратора состоят
в присвоении полномочий и профилей пользователям системы
и поддержке паролей.
Системный оператор должен следить за операционной работой
системы PKI, реагировать на ошибки и соблюдать установленные
регламентом процедуры. К дополнительным функциям операторов
можно отнести восстановление прежнего состояния системы и
поддержку релевантных PKI электронных документов. В зависимости
от размеров PKI к ежедневной работе привлекаются от одного
до нескольких операторов.
Администратор УЦ отвечает за поддержку всех функций
удостоверяющего центра: генерацию ключей, выпуск и подписание
сертификатов, а также обработку запросов на взаимную сертификацию
и авторизацию услуг по восстановлению ключей. Если в состав
PKI входит регистрационный центр, то на администратора РЦ
168 Основы технологии PKI
возлагаются обязанности обработки запросов на сертификаты и
принятия решения о выдаче сертификата заявителю.
Администратор каталога отвечает за поддержку каталога
(LDAP), содержащего информацию о сертификатах, и управление
правами доступа к нему внутренних и внешних для PKI пользователей.
Администратор каталога обеспечивает реализацию соглашения
об используемых в каталоге именах в соответствии с требованиями
промышленных или корпоративных стандартов.
Работники слуэюбы помощи должны реагировать на запросы
клиентов системы, руководствуясь соответствующими документами,
описывающими процедуры обслуживания пользователей.
Для поддержки защищенного и эффективного функционирования
PKI должна регулярно пересматриваться политика безопасности,
за ее обновление отвечает менедэюер по политике безопасности.
Функции аудита системы в целом и подготовки отчетов для
руководства возлагаются на аудитора безопасности или главного
администратора. Аудитор безопасности должен иметь специальную
подготовку в области информационной безопасности и криптографии
и отвечать за реализацию корпоративной политики безопасности,
в том числе политики применения сертификатов, регламента
и политики управления ключами, и документальное оформление
всех политик и процедур. На аудитора безопасности возлагается ответственность
за разработку и совершенствование процедур управления
и администрирования системой безопасности, процедур восстановления
прежнего состояния системы и восстановления после
аварии, а также процедур, которым должны следовать третьи стороны
при их обслуживании системой PKI. Аудитор обязан выполнять
регулярные и незапланированные проверки контрольных журналов
и отслеживать соответствие всех компонентов и процедур системы
безопасности PKI промышленным и корпоративным стандартам.
Завершение этапа проектирования
После документального оформления политики применения
сертификатов, выбора программного продукта или поставщика услуг,
аппаратных средств поддержки PKI и физической среды, формулировки
требований по управлению и администрированию систе-
7. Развертывание PKI 169
мой, должен быть разработан регламент удостоверяющего центра.
На этом же шаге определяются процедуры функционирования
и управления, необходимые для проверки эффективности системы
безопасности, основанной на PKI, и разрабатывается методика сопровождения
и поддержки готовой системы [21].
7.3. Создание прототипа, пилотный проект и внедрение
Создание прототипа
Для подтверждения избранной концепции PKI и подготовки
пилотного проекта целесообразно создание прототипа системы на
базе выбранного готового программного продукта. Критериями выбора,
как отмечалось выше, могут быть соответствие программного
продукта определенным стандартам в области PKI, его стоимость,
расширяемость, поддержка, интеграция с другими решениями по
безопасности, простота использования и т.п. Модификация готовых
программных приложений, а также проектирование и разработка
новых приложений, необходимых для поддержки PKI, должны выполняться
с учетом требований пользователей системы. На этом
этапе проводится независимый аудит и анализ источников рисков
и уязвимости системы для принятия соответствующих решений.
Пилотный проект
После окончания разработки программного обеспечения системы
PKI и успешного прохождения тестов всех устройств, тестов
интеграции системы и проверки возможностей работы с ней пользователей
осуществляется тестирование пилотной системы. Очень важно
сразу же определить ее масштабы и круг обслуживаемых пользователей.
Рекомендуется, чтобы работа системы начиналась с обслуживания
ограниченного числа пользователей и внутренних приложений,
но ограничивать пилотную систему пределами ИТ-
подразделения было бы ошибкой [39]. Желательно к ней сразу подключать
тех пользователей, которым предстоит активно работать
с инфраструктурой после ее полного развертывания.
Запуск пилотной системы обычно выполняется в условиях реальной
деятельности, но в определенных временных рамках и ограниченной
среде (например, на базе нескольких подразделений, отделов
или групп пользователей). Работа пилотной системы должна
170 Основы технологии РК1
быть организована параллельно работе старой системы, возможности
и уровень безопасности последней должны поддерживаться на
прежнем уровне.
На базе пилотной системы выполняется:
• тестирование всех функциональных требований, производительности
и операционных регламентов, а также всех наиболее
важных приложений защиты [21];
• опытное завершение работы системы, восстановление ее
работы и проверка функционирования системы после этих операций;
• проверка физических и кадровых средств управления
безопасностью в PKI.
Этап завершается разработкой подробного плана внедрения
системы.
Внедрение
После успешной апробации пилотной системы начинается
этап внедрения, во время которого выполняется установка и проверка
работоспособности системы PKI с последующими приемными
испытаниями, работа системы оценивается пользователями и соответствующими
специалистами на предмет защищенности и соблюдения
необходимого уровня безопасности. Отчет о соответствии
всем требованиям безопасности с описаниями тестов атак на систему
является одним из главных результатов этого этапа. Далее проводится
юридическая экспертиза и утверждение регламента PKI,
положений политики применения сертификатов и установленных
форм контрактов, организуется обучение пользователей PKI и создается
служба помощи.
Все системы изменяются с течением времени. Установка новых
версий, внедрение новых пользовательских приложений, увеличение
производительности, мощности и учет новых требований, обновление
аппаратной платформы - все это требует соответствующего
управления [21]. Для поддержки, сопровождения и модификации
системы PKI формируется подразделение технической поддержки.
Результатом этапа является функционирующая PKI, которая соответствует
всем требованиям и ограничениям, сформированным в
процессе анализа и проектирования системы.
8.Программные средства поддержки PKI 171
8. ПРОГРАММНЫЕ СРЕДСТВА ПОДДЕРЖКИ PKI
8.1. Программное обеспечение PKI
ведущих мировых производителей
В современных условиях защищенный обмен сообщениями,
надежная идентификация и электронная коммерция невозможны без
инфраструктуры открытых ключей. Продукты и услуги для поддержки
PKI предлагаются на рынке целым рядом компаний. Одни
компании производят комплексное программное обеспечение, которое
может быть использовано для организации собственного удостоверяющего
центра и управления сертификатами, другие предоставляют
услуги удостоверяющего центра, обеспечивая работу и
управляя серверами сертификатов в своих офисах, доступ к которым
клиенты получают через Интернет.
PKI представляет собой фундаментальную составляющую
корпоративной архитектуры защиты, поэтому крупные компании с
достаточными финансовыми и техническими ресурсами предпочитают
создавать свои собственные системы. Первыми осознали необходимость
полномасштабной реализации PKI представители финансового
мира, прежде всего, фирмы, занимающиеся электронной
коммерцией. Позже, оценив преимущества внедрения технологии
цифровых сертификатов в банках и других финансовых институтах,
к ним присоединились и компании из других секторов промышленности.
8.1.1. Entrust/PKI 5.0.
Компания Entrust Technologies - наиболее известный производитель
программных средств поддержки PKI. Основным предложением
компании является комплект программных продуктов под
названием Entrust/PKI, с помощью которого компании могут организовать
свои собственные удостоверяющие центры и развертывать
PKI [79]. Поддерживаемые платформы включают Microsoft Windows
NT, Sun Solaris, HP-UX и AIX. В Entrust/PKI используется сервис
ValiCert, который обеспечивает поддержку протокола OCSP (Online
Certificate Status Protocol - протокол онлайнового состояния сертификата).
Этот протокол, разработанный фирмой VeriSign Inc., широ-
172 Основы технологии PKI
ко применяется для проверки действительности сертификатов в режиме
реального времени.
Инфраструктура Entrust/PKI состоит из семи основных компонентов:
Entrust/Authority, Directory, Entrust/RA, Entrust/Auto RA,
Entrust/Profile Server, Entrust/Timestamp и Entrust/ Entelligence.
Entrust/Authority - центральный компонент системы
Entrust/PKI. Как удостоверяющий центр он используется для выдачи
Х.509-совместимых цифровых сертификатов, создания пар ключей
и управления этими ключами и сертификатами. Он поддерживает
защищенную базу данных резервных копий пар ключей шифрования,
управляет инициализацией пользователей и запросов на обновление
ключей, выпускает списки аннулированных сертификатов
и выполняет операции взаимной сертификации с другими удостоверяющими
центрами. Модуль обеспечивает автоматическое и прозрачное
обновление ключей пользователей и ключа подписи УЦ.
В системе Entrust/PKI поддерживается иерархическая, одноуровневая
и гибридная формы взаимной сертификации, что позволяет
организациям формировать архитектуру PKI по своему выбору.
В системе предусмотрен небольшой набор «ролей» с разными полномочиями,
включая специалиста службы безопасности, администратора,
администратора каталога, аудитора и конечного пользователя.
Каталог Directory обеспечивает хранение сертификатов открытых
ключей и списков аннулированных сертификатов и открытый
доступ к ним. Связь с каталогом Directory клиентских рабочих
станций. Entrust/Authority, Entrust/Auto RA и Entrust/RA осуществляется
через протокол LDAP.
Entrust/RA выполняет функции регистрационного центра и
поддерживает выполнение заданий администраторов с разными
полномочиями. Представляет собой графический интерфейс системы
Entrust/PKI, используемый администраторами и лицами, ответственными
за информационную безопасность, для управления пользователями
и сертификатами, обновления и восстановления пар
ключей, обработки запросов на сертификаты, аннулирования сертификатов,
формирования отчетов, аудита и т.п. Благодаря удобному
интерфейсу администратор может изменять отличительные имена
пользователей, добавлять группы новых пользователей, аннулиро-
<^. Программные средства поддерэюки РК1 173
вать их и исключать из списков, изменять некоторые параметры сертификатов
(например, сроки действия), а также добавлять и аннулировать
имена других администраторов.
Признанный современными стандартами в области РК1 способ
поддержки, распространения и проверки списков аннулированных
сертификатов при помощи пунктов распространения САС впервые
был предложен компанией Entrust Technologies. Он заключается
в следующем: весь список состоит только из серийных номеров сертификатов
и делится на небольшие блоки (максимум по 750 сертификатов),
каждому блоку в момент формирования САС отводится
определенное место, а каждый сертификат содержит указатель на
эту точку входа в список. Таким образом, для проверки статуса сертификата
по указанному в нем пункту распространения САС необходимо
выгрузить лишь небольшое подмножество данных об аннулировании.
Entrust/RA реализует этот способ управления списками
аннулированных сертификатов, а также может выпускать полный
САС для обеспечения совместимости с другими программными
продуктами.
Новые средства управления политикой Entrust/PKI 5.0 позволяют
создавать должности операторов РЦ с определенными полномочиями.
Управление политикой включает:
• контроль полномочий операторов РЦ по отношению к определенным
пользователям или группам пользователей;
• ограничение функций операторов определенными операциями;
• контроль выполнения операций, которые считаются конфиденциальными
(разделение ответственности между несколькими
операторами РЦ);
• контроль доступа операторов к контрольному журналу;
• контроль возможности операторов делегировать свои полномочия
другим операторам РЦ.
Entrust/Auto RA позволяет исключить администратора из процесса
регистрации и аутентификации пользователей, предоставляя
удаленным пользователям возможности получения цифровых сертификатов
и гибкие средства регистрации и аутентификации через
174 Основы технологии PKI
web-браузеры. Auto RA поддерживает выполнение следующих операций
без участия администратора:
• добавление/восстановление корпоративных пользователей
в Entrust/PKI;
• добавление/восстановление web-пользователей;
• добавление корпоративных пользователей и создание
профилей на сервере;
• создание профилей на сервере для ранее добавленных пользователей;
• создание профилей на сервере по номерам ссылок и кодам
авторизации;
• создание/восстановление профилей для роуминга сертификатов
и ключей.
Auto RA обеспечивает автоматическую регистрацию, предлагая
пользователям заполнить определенные поля формы, представленной
на web-сервере. При обработке запросов от пользователей
выполняется сравнение соответствующих полей формы, заполненной
пользователем, и полей записей, с которыми работает сервис
аутентификации пользователей (через разделенный секрет). Если
сравнение завершается удачно, выполняется регистрация и соответствующие
данные: номер ссылки и код авторизации для создания
Entrust-профиля, возвращаются пользователю Java-сервлетом.
Entrust/Profile Server обеспечивает хранение профилей пользователей
Entrust/PKI и защищенный доступ к ним по названиям и
паролям, вводимым пользователями. После завершения работы в
системе данные пользователя (название профиля и пароль) автоматически
удаляются из памяти его персонального компьютера.
Entrust/Timestamp - модуль, реализующий защищенное проставление
меток времени, то есть позволяющий точно фиксировать
время любых событий в системе Entrust/PKI. Это особенно актуально
для приложений обработки финансовых транзакций и для поддержки
сервисов нотаризации.
Предлагаемая компанией Entrust Technologies инфраструктура
открытых ключей представляет собой хорошо проработанную
систему, но лишь при использовании вместе с клиентским приложением
для настольных систем Entelligence [43].
8. Программные средства поддержки PKI 175
Entrust/Entelligence обеспечивает связь £л^гм5/-совместимых
приложений с основными компонентами системы Entrust: RA, Auto
RA и Directory, предоставляет возможности однократной регистрации
пользователей при работе с этими приложениями и единого
входа в Entrust/PKI, а также поддержки журнала аудита с указанием
времени событий. Клиентский компонент Entelligence автоматически
и прозрачно управляет сертификатами, шифрованием, цифровыми
подписями и выполняет другие функции защиты от имени
пользователя.
Иногда бывает необходимо обеспечить полностью управляемое
РК1-решение для Web, не предусматривающее развертывания
клиентского программного обеспечения. Это может быть достигнуто
при помощи модуля Entrust/True Pass, который поддерживает
шифрование, операции с цифровой подписью и роуминг сертификатов
при помощи браузера. Применение True Pass целесообразно при
решении задач взаимодействия «бизнес-бизнес» и «бизнес-
заказчики», где отсутствует контроль за рабочим местом пользователя
и не используется корпоративный межсетевой экран.
Основным пунктом администрирования в системе Entrust/PKI
является Entrust/Master Control, он позволяет главному администратору
выполнять все необходимые функции по администрированию
базы данных, такие, как резервное копирование, проверка информационного
наполнения и, если необходимо, повторное шифрование.
Помимо перечисленных компонентов в Entrust/PKI возможно
использование ряда дополняющих программных продуктов:
Entrust/Web Connector - позволяет администраторам выпускать
web-сертификаты для стандартных web-браузеров и серверов
приложений, которые применяют протоколы S/MIME и SSL;
Entrust/Commerce Connector - позволяет администраторам
выпускать SET-сертификаты для участников системы расчетов по
платежным картам через Интернет;
Entrust/VPN Connector - распространяет сертификаты для
устройств виртуальных частных сетей, таких, как маршрутизаторы,
VPN-шлюзы, межсетевые экраны и устройства удаленного доступа,
которые используют стандартные запросы на сертификаты (формата
PKCS#10) или протоколы Cisco CEP/SCEP;
176 Основы технологии PKI
Entrust/WAP Connector - обеспечивает выпуск сертификатов
WAP-серверов и других цифровых сертификатов для обеспечения
безопасности мобильных устройств и ряда приложений, например
серверов электронной коммерции;
Entrust/Desktop Designer - позволяет администратору полностью
настроить установки настольной системы и создать отдельный
файл установок.
В качестве дополнения Entrust Technologies предлагает также
семейство интерфейсов прикладного программирования высокого
уровня и инструментальные средства разработки для встраивания
функций защиты в различные приложения.
Итак, по оценкам специалистов [79], сильной стороной
Entrust/PKI является прозрачность интерфейса между системой и конечным
пользователем. Интерфейс обеспечивает единую точку входа
для пользователей и любых приложений, реализующих криптографические
функции и операции с цифровыми подписями.
Entrust/PKI полностью интегрирует клиента в PKI, гарантируя прозрачность
обновления ключей, автоматическое управление жизненным
циклом сертификатов и ключей, легкость восстановления ключей
и тщательную проверку списков аннулированных сертификатов.
Модули Auto RA и True Pass привлекательны для компаний, желающих
предоставлять PKI-сервисы для внешних пользователей,
в тех случаях, когда не может использоваться клиентское программное
обеспечение и должна быть обеспечена автоматическая регистрация.
Определенный интерес для больших корпораций представляет
роуминг клиентов, позволяющий пользователям Entrust/PKI перемещаться
с компьютера на компьютер без необходимости переносить
за собой Етш81-профили. Важным достоинством программного
продукта Entrust/PKI 5.0. является его интеграция с аппаратными
средствами аутентификации, например, с устройствами считывания
смарт-карт и биометрическими устройствами.
8.1.2. Baltimore UniCERT 5.0
Компания Baltimore Technologies LTD, известная своими работами
в области алгоритмов шифрования и защищенного обмена
сообщениями, предлагает свое программное обеспечение инфраструктуры
открытых ключей. Программный комплекс UniCERT 5.0
8. Программные средства поддерэюки PKI 177
позволяет обеспечить работу корпоративного УЦ, поддерживает
управление ключами, аутентификацию, реализует функции неотка-
зуемости в системах электронной почты, Интернет-коммерции, Интернет-
банкинга, в виртуальных частных сетях. Кроме перечисленных
функций UniCERT предлагает и ряд дополнительных механизмов
[37]:
• создание цифровых сертификатов на физических носителях
(например, смарт-картах или токенах SecurlD);
• использование современного протокола OCSP, значительно
ускоряющего процесс проверки сертификатов;
• совместную работу с различными системами документооборота
(например, с Lotus Notes);
• использование шаблонов сертификатов для различных
приложений; интеграцию с решениями компании Cisco.
Своей высокой эффективностью система Baltimore UniCERT
во многом обязана модульной структуре, обеспечивающей гибкость
благодаря возможности добавлять и изменять компоненты в зависимости
от потребностей организации. Программный комплекс
Baltimore UniCERT (см. рис. 8.1) подразделяется на базовое программное
обеспечение UniCERT Core и усовершенствованное -
UniCERT Advanced [143].
В состав UniCERT Core входят все необходимые для развертывания
PKI программные модули: компоненты удостоверяющего
(Certificate Authority, Certification Authority Operator и Publisher) и
регистрационного (Registration Authority, Web Registration Authority
Operator, Protocol Handlers и Utilities) центров.
Главным модулем, реализующим функции УЦ по генерации
сертификатов и пар ключей, является Certificate Authority (СА).
Графический пользовательский интерфейс системы облегчает интеграцию
в существующую инфраструктуру, а ее открытый, опирающийся
на стандарты формат улучшает функциональную совместимость.
СА получает одобренные запросы на выдачу и аннулирование
сертификатов от регистрационного центра и операторов УЦ,
подписывает и публикует сертификаты конечных пользователей и
субъектов инфраструктуры, а также списки аннулированных сертификатов
и аннулированных центров в PKI-системе. Кроме того, СА
178 Основы технологии PKI
подписывает все сообщения УЦ и сертификаты для других удостоверяющих
центров (подчиненных или связанных с ним отношениями
взаимной сертификации), политика его операционной работы
контролируется оператором удостоверяющего центра.
UniCERT Core
Рис. 8.1. Структура Baltimore UniCERT
При конфигурировании УЦ генерируются пары ключей для
самого удостоверяющего центра и его оператора, формируется профиль
УЦ. Профиль УЦ задает отличительное имя УЦ, длину ключей,
алгоритмы шифрования и цифровой подписи, формат сертификата,
опции каталога и т.д. Пары ключей могут генерироваться программно
или на смарт-картах/токенах. СА осуществляет верификацию
всех получаемых удостоверяющим центром сообщений, данные
и журналы аудита хранятся в базе данных УЦ.
8. Программные средства поддерэюки PKI 179
Модуль Certification Authority Operator (CAO) - оператор УЦ,
контролирует безопасность PKI, все функции администрирования и
управляет привилегиями других модулей и операторов UniCERT.
В системе PKI может работать несколько операторов САО. На оператора
УЦ возлагаются следующие обязанности:
• разработка политики регистрации;
• поддержка групп авторизации и операционных политик
основных модулей инфраструктуры (СА, RA);
• добавление новых субъектов в инфраструктуру (регистрационных
центров, подчиненных УЦ);
• управление выпуском сертификатов ддя субъектов PKJ (других
операторов УЦ и регистрационных центров, подчиненных УЦ);
• аннулирование любого сертификата в системе;
• просмотр всех выпущенных УЦ сертификатов и журналов
аудита.
Модуль Publisher управляет публикациями СА, поддерживает
множественные удостоверяющие центры и каталоги (LDAP), реализует
гибкие схемы публикации в различных каталогах сертификатов
удостоверяющих центров и конечных пользователей, списков аннулированных
сертификатов и аннулированных центров, создает точки
входа в кататюги в соответствии с отличительными именами субъектов
сертификатов.
Модуль регистрационного центра Registration Authority (RA)
осуществляет связь между операторами Web RAO, модулями управления
протоколами Protocol Handlers и модулем СА. RA направляет
удостоверяющему центру полученные от Web RAO и Protocol
Handlers запросы о выдаче и аннулировании сертификатов, а также
получает от СА сертификаты и сообщения и делает их доступными
для Web RAO и Protocol Handlers. Модуль RA делит систему PKI на
операционные домены - отдельные структуры, связанные с УЦ. Каждый
РЦ руководствуется своей операционной политикой, которая
поддерживается централизованно (через УЦ). Модуль RA инициирует
возобновление сертификата, если срок действия сертификата
конечного пользователя истекает и соответствующая политика диктует
необходимость выпуска нового сертификата. RA подписывает
180 Основы технологии PKI
цифровым образом все отправляемые им сообщения и проверяет на
целостность и аутентичность все получаемые сообщения.
Операторы регистрационного центра Web Registration Authority
Operators (Web RAO) выполняют авторизацию запросов о выдаче и
аннулировании сертификатов и управляют регистрацией «лицом к
лицу» (в личном присутствии заявителей). Оператор РЦ должен гарантировать
подлинность информации и документов, представленных
лицом, запрашивающим сертификат. Если в подлинности документов
нет сомнений, то запрос принимается и размещается в базе
данных РЦ, а затем направляется на подпись в удостоверяющий
центр. Если представленные документы не удовлетворяют оператора
РЦ, то запрос на сертификат отвергается. Операторы Web RAO
принадлежат к одной или нескольким группам авторизации и могут
обрабатывать только те запросы, которые соответствуют политикам
регистрации, установленным операторами удостоверяющего центра
САО для этих групп авторизации.
Модули Protocol Handlers управляют запросами на базе протоколов
Web, SCEP, PKIX CMP и электронной почты. Запросы о
выдаче или аннулировании сертификатов передаются RA для дальнейшей
обработки.
Кроме того, UniCERT Core содержит ряд утилит Utilities для
управления токенами и сервисами, генерации ключей и настройки
базы данных.
UniCERT Advanced объединяет модули, разработанные с учетом
специфических требований крупных предприятий и поставщиков
услуг: Advanced Registration Module, Key Archive Server,
Roaming, XKMS Server, Timestamp Server и Telepathy Registration
System.
Advanced Registration Module (ARM) представляет собой автоматизированную
систему регистрации, позволяющую полностью
интегрировать РК1-решение с системами управления базами данных
и системами электронного документооборота. Для автоматизации
процесса регистрации модуль ARM поддерживает систему предварительной
аутентификации на базе предварительно подписанных
цифровыми подписями РЕЧ-кодов и паролей пользователей. Модуль
ARM интегрирован с модулями UniCERT СА и RA, модулями кор-
8. Программные средства поддерэюки PKI 181
поративных баз данных (например, базой данных отдела кадров)
и систем управления смарт-картами.
Другой необходимый для серьезной реализации PKI компонент
UniCERT — Key Archive Server служит для резервного копирования,
защищенного хранения и восстановления секретных ключей
шифрования владельцев сертификатов.
Модуль UniCERT Roaming позволяет конечным пользователям
получать доступ к своим РПЧ-кодам и паролям и цифровым образом
подписывать электронные транзакции без использования аппаратных
криптографических ключей, например смарт-карт, посредством
практически любого web-браузера.
Модуль Roaming содержит следующие компоненты:
• Credential Server, который контролирует и координирует
работу других компонентов роуминга;
• Protection Encryption Key (РЕК) Server, который гарантирует
безопасность системы;
• Proxy Server, маскирующий местоположение серверов
Credential Server и РЕК Server;
• апплеты роуминга - программы, которые выгружаются
конечными пользователями и от их имени выполняют все операции
по обеспечению безопасности.
Использование модуля позволяет поддерживать защищенную
электронную среду, в которой пользователи имеют доступ к своим
PIN-кодам и паролям для выполнения аутентификации, шифрования
или подписания электронных документов, а клиентские приложения
защищены независимо от их аппаратного и программного обеспечения,
платформы и размещения.
Сервер XKMS (XML Key Management Specification) Server
обеспечивает интерфейс web-сервисов для регистрации, размещения,
аннулирования и проверки подлинности сертификатов ключей
пользователей и способствует интеграции UniCERT PKI с XML-
приложениями.
Сервер Timestamp Server обеспечивает проставление меток
времени и поддерживает сервис неотказуемости, то есть позволяет
доказать всем сторонам-участникам, что транзакция имела место
в определенное время (день и час), одновременно гарантируя циф-
182 Основы технологии PKI
ровую идентичность сторон. Сервер принимает запросы на проставление
меток времени и возвращает метки через Интернет, его работа
полностью автоматизирована и не требует от пользователей специальных
знаний технологии цифровых подписей или меток времени.
Для идентификации пользователей мобильных телефонов в
UniCERT Advanced предлагается система Telepathy Registration System
(TRS), позволяющая абонентам мобильной связи применять
цифровые сертификаты, хранимые в РК1-системе, для доступа к сервисам
и приложениям беспроводной связи и участия в мобильной
коммерции (для оплаты различных товаров и услуг посредством мобильного
телефона).
В силу того, что Baltimore UniCERT разрабатывался как открытый
программный продукт для поддержки работы удостоверяющего
центра, в нем не предусмотрено специфическое клиентское
программное обеспечение, а предполагается использование клиентами
для взаимодействия с удостоверяющим и регистрационным
центрами стандартной модели web-браузера или РК1-приложений
третьей стороны.
К достоинствам программного продукта Baltimore UniCERT
5.0 эксперты относят разнообразие функций модуля удостоверяющего
центра Certificate Authority, удобство администрирования,
способность работать со многими операционными системами [43].
Многофункциональный графический интерфейс пользователя позволяет
просматривать всю структуру удостоверяющих и регистрационных
центров. В системе Baltimore UniCERT на высоком уровне
организован процесс обновления сертификатов и эффективно используются
централизованно разрабатываемые правила для распределенного
администрирования.
8.1.3. ВТ TrustWise Onsite 4.5
Компания Verisign Inc., бесспорный лидер среди независимых
общедоступных удостоверяющих центров, предоставляет сервисы
цифровой аутентификации и имеет большой опыт выпуска
цифровых сертификатов для частных лиц и корпоративных web-
серверов [24]. Большинство web-браузеров принимают выданные
Verisign сертификаты, даже если они представлены неизвестным
web-сервером, и это доверие к компании позволяет ей сохранять ли-
8. Программные средства поддерэюки PKI 183
дерство среди независимых удостоверяющих центров. В области
услуг аутсорсинга компания VeriSign имеет репутацию надежного
партнера [43]. VeriSign предлагает свои услуги по поддержке PKI
вместе с возможностью доступа компаний к своим данным. Вместо
приобретения специальных систем и найма соответствующих специалистов
компании могут подключиться к одному из центров обработки
данных VeriSign, который берет на себя заботу об обслуживании
клиентов, восстановлении ключей, обработке сертификатов,
резервном копировании информации и других операциях.
Для организаций, желающих реализовать полную инфраструктуру
открытых ключей, VeriSign предлагает гибридный сервис, который
сочетает элементы управления «по месту» с защищенностью
базы PKI. Этот сервис предоставляется компанией VeriSign самостоятельно
и через партнеров. VeriSign является производителем
полностью интегрированной платформы PKI OnSite для администрирования
сертификатов, управления и восстановления ключей
и поддержки приложений (интранет, экстранет, виртуальных частных
сетей и электронной коммерции) других компаний.
Партнер VeriSign, компания British Telecom, распространяет
последнюю версию этого программного продукта под названием ВТ
TrustWise OnSite 4.5, применение которого решает проблему развертывания
PKI, полностью управляемой самой организацией, без инвестиций
в инфраструктуру серверов, необходимых для поддержки
PKI [79]. При помощи OnSite 4.5 организация контролирует работу
УЦ и непрерывно осуществляет администрирование и аудит операций.
Криптографические функции, подписание сертификатов и хранение
данных делегируются центру защиты данных компании British
Telecom. В состав WorldTrust входят следующие модули: Subscriber
Manager, RA Control Center, CA Control Center, Certificate
Processing, Certificate Manager (рис. 8.2).
Модуль Subscriber Manager поддерживает регистрацию конечных
пользователей и обновление сертификатов, как правило, через
корпоративные web-серверы или серверы ВТ центра.
Модуль RA Control Center реализует функции управления
жизненным циклом сертификатов, обеспечивая полный контроль
процессов регистрации и аутентификации. Модуль обеспечивает
184 Основы технологии PKl
принятие и аннулирование запросов на сертификаты, аудит и управление
неограниченным количеством администраторов (с разными
полномочиями), полную автономность функций администрирования,
ведение контрольных журналов, генерацию отчетов, а также
реализует сервис невозможности отказа от электронных транзакций
с использованием сертификатов.
Модуль СА Control Center поддерживает web-конфигурацию
инструментальных средств поддержки, администрирования и помощи,
генераторы отчетов и модули интеграции приложений предоставляют
организации полный контроль своего удостоверяющего
центра и связь с центром обработки ВТ, СА Control Center дает возможность
организации самостоятельно формировать политику локального
удостоверяющего центра (содержание сертификатов и полномочия
администрирования).
Модуль Certificate Processing обеспечивает выпуск сертификатов
и управление их жизненным циклом, поддержку протоколов
управления криптографическими ключами, защищенное хранение и
резервное копирование данных.
Модуль Certificate Manager позволяет пользователю выбирать
тип необходимого ему сертификата (SSL, S/MIME, IPSec
TrustGateWay).
Секретные ключи пользователей хранятся в цифровых конвертах
в организации, это избавляет компанию British Telecom от ответственности
за их хранение. Клиентское программное обеспечение
Key Manager генерирует и восстанавливает секретные ключи, создает
их резервные копии, направляет запросы на выпуск сертификатов
и доставляет ключи и сертификаты конечным пользователям.
Каждый секретный ключ шифруется уникальным сеансовым
ключом (алгоритм шифрования triple-DES), который, в свою очередь,
шифруется открытым ключом удостоверяющего центра ^ВГ для
создания блока восстановления ключа (Key Recovery Block - KRB).
Процедуры восстановления ключей гарантируют безопасность
секретных ключей, даже в том случае, если база данных ключей похищена
или скопирована. Доступ к секретным ключам возможен
только после расшифрования сеансовых ключей уполномоченными
администраторами при помощи ВТ TrustWise OnSite 4.5. В системе
8. Программные средства поддерэюки PKI 185
поддерживается полностью автоматизированная среда аннулирования
сертификатов через стандартные web-браузеры, списки аннулированных
сертификатов формируются ежедневно каждый час.
Организация Центр BTA^erisign
Сервис
восстановления
ключей
Клиенты:
конечные
пользователи
Корпоративные серверы
Администратор
корпоративного
УЦ О-
Администратор ^^__^
корпоративного | |
РЦ
Корпоративный Корпоративная
каталог база данных
сертификатов реп1страции
Управление ключами
Certificate Processing
2 о 5г:
11 Йсо сi о (шО ЬJ?Ь Еь- 11
Certificate
Manager
Crypto
S
Рис. 8.2. Архитектура BT/VeriSign WorldTrust
Программные модули Enterprise Integration Software Modules
обеспечивают интерфейс с корпоративными базами данных для
поддержки автоматизированного выпуска сертификатов и других
функций администрирования, их размещения в корпоративном ката-
186 Основы технологии PKI
логе и организации доступа к информации об аннулировании сертификатов
через корпоративные web-серверы.
Инструментальные средства интеграции приложений Application
Integration Toolkits используются поставщиками коммерческих
приложений или корпоративными заказчиками для интеграции готовых
РК1-приложений.
Специалисты компании NSS Group, тестировавшие ВТ Trust-
Wise OnSite 4.5, отмечают [79а], что этот программный продукт
поддерживает функции PKI, полностью управляемой из организации.
OnSite 4,5 - одна из наиболее совершенных инсталляций удостоверяющего
центра, обеспечивающая меры физической безопасности,
защиты данных, процедуры восстановления сертификатов, а
также средства формирования политики безопасности и возможности
модификации регистрационных форм и профилей сертификатов.
Автоматическая генерация и возобновление сертификатов не вызывают
никаких трудностей и проводятся очень эффективно. Разработанный
Verisign протокол OCSP является для OnSite 4,5 «родным» и
используется для проверки статуса сертификатов в реальном времени
[43].
К недостаткам OnSite 4.5 относят невозможность администрирования
PKI через внутреннюю корпоративную сеть (а только через
Интернет) и некоторое запаздывание уведомления пользователей о
принятии их запросов на сертификаты. Задачи администрирования
становятся громоздкими и медленно выполняются при возрастании
Интернет-трафика в течение рабочего дня.
Благодаря тому, что компания VeriSign и ее партнеры берут
всю организацию системы PKI на себя, компании-заказчики могут
достаточно быстро реализовать пилотную систему PKI [43]. Фирмы
же, предъявляющие к процедуре сертификации минимальные требования
и имеющие разработанные средства интеграции со всеми необходимыми
приложениями, могут получить работоспособную инфраструктуру
за несколько месяцев. Тем не менее, этот программный
продукт может быть рекомендован для пилотных проектов и
реализаций PKI с числом пользователей до 1000, так как с ростом
масштаба PKI стоимость ВТ TrustWise OnSite 4.5 растет высокими
темпами.
8. Программные средства поддерэюки PKI 187
8.1.4. IBM Trust Authority 3.1
IBM SecureWay Trust Authority 3.1 входит в семейство программных
продуктов IBM First Secure, предназначенных для комплексного
обеспечения информационной безопасности: защиты от
вирусов, обнаружения вторжений, управления доступом, контроля
контента трафика шифрования, управления цифровыми сертификатами,
межсетевого экранирования. Trust Authority реализует функции
шифрования и цифровой сертификации для обеспечения аутентификации
пользователей и гарантированной защиты коммуникаций
[79].
Система Trust Authority работает на серверных платформах
ШМ AIX/6000 и Microsoft Windows NT. К основным компонентам
системы Trust Authority относятся:
Trust Authority Server - центральный сервер, который связывает
вместе другие компоненты системы, обеспечивает ее администрирование
и поддерживает базу данных;
Certification Authority (СА) - серверный компонент, выполняет
функции удостоверяющего центра и управляет процессом сертификации;
Registration Authority (RA) - серверный компонент, выполняет
функции регистрационного центра и управляет процессом регистрации;
Audit Server - подсистема аудита, обеспечивающая регистрацию
действий, имеющих отношение к безопасности;
WebSphere Application Server - сервер web-приложений,
предоставляет среду для развертывания приложений регистрации
системы Trust Authority,
Database system - в качестве системы управления базами
данных используется универсальная СУБД ЮМ DB2. Серверные
компоненты поддерживают отдельные базы для данных регистрации,
аудита, каталога и информации о сертификатах;
Directory Server - сервер каталога ШМ SecureWay Directory,
интегрируется с DB2 для централизованного хранения информации
о сертификатах;
Client - клиентское программное обеспечение (на платформе
Microsoft Windows 95, 98 или NT) используется тогда, когда для ре-
188 Основы технологии PKI
гистрации пользователи не могут воспользоваться стандартными
web-браузерами.
При развертывании небольших PKI все основные компоненты
могут размещаться на одном компьютере. В крупномасштабных
реализациях для более высокой производительности и расширяемости
основные компоненты Trust Authority/RA, Directory и С А/Audit
Server следует размещать на отдельных компьютерах. Безопасность
в системе Trust Authority обеспечивается подписанием программного
кода и сообщений, шифрованием данных и защищенным хранением
ключей и паролей.
Подписание кода. Базовый код системы Trust Authority подписывается
при изготовлении. После подписания сгенерированным
изготовителем секретным ключом код становится статичным и защищенным
объектом, который не может быть несанкционированно
модифицирован или заменен.
Подписание сообщений. В процессе конфигурирования системы
генерируются ключи подписи для серверов регистрационного и
удостоверяющего центров и аудита. Все сообщения, которыми обмениваются
внутренние модули системы при коммуникации, подписываются
и на основании электронной цифровой подписи каждого
компонента могут быть аутентифицированы.
Шифрование данных. Большинство данных, хранимых в базах
данных Trust Authority, и вся информация, размещенная в защищенных
областях хранения Key Stores^ шифруется.
Trust Authority обеспечивает поддержку Key Stores, защищенных
областей хранения секретных ключей, сертификатов, кодов аутентификации
сообщений (MAC) и других объектов, имеющих отношение
к безопасности. Для компонентов Л4, Audit и нескольких
серверных агентов существуют различные области Key Stores. Защищенное
хранение объектов в Key Stores гарантирует целостность
системы. Конфиденциальность объектов обеспечивается регулированием
доступа к защищенным областям хранения и зашифрованным
данным: доступ к ним разрешается только тому компоненту
системы, код которого был подписан при помощи ключа, сгенерированного
изготовителем программного обеспечения.
8. Программные средства поддерэюки РК1 189
Trust Authority поддерживает следующие категории сертификатов
формата Х.509 v3:
• сертификаты браузеров;
• сертификаты серверов;
• сертификаты устройств;
• сертификаты для доступа к PKIX-совместимым приложениям;
• взаимные сертификаты для удостоверяющих центров.
Для защиты ключа корневого УЦ компания IBM предлагает
аппаратное решение - криптографический сопроцессор ШМ SecureWay
4758 PCI. Сопроцессор выполняет криптографические
функции (алгоритмы RSA и DES, алгоритмы хэширования MD5 и
SHA-1), обеспечивает криптографическую защиту данных, управление
ключами, поддержку приложений заказчика. В Trust Authority
сопроцессор генерирует ключи подписи УЦ.
В системе Trust Authority 3.1 предусматривается отдельный
домен регистрации и один сервер РЦ. Большинство конечных пользователей
обращаются с запросами на сертификаты через свои web-
браузеры, на сервере RA поддерживается набор web-страниц, позволяющий
пройти регистрацию через Интернет. Пользователю предлагается
загрузить сертификат корневого удостоверяющего центра
в браузер и заполнить запрос на сертификат. Как только запрос
одобрен регистрационным центром, пользователь получает уникальный
цифровой паспорт запроса. Если политикой безопасности
разрешена автоматическая регистрация, запрос авторизуется и обрабатывается
удостоверяющим центром. В противном случае запрос
остается в очереди РЦ до тех пор, пока не будет авторизован администратором.
Как только сертификат выпущен, он автоматически загружается
в браузер пользователя. В процессе регистрации выполняется
аутентификация клиента и сервера, доставка сертификатов
субъектам и осуществляется сквозное шифрование всех данных.
Другой формой регистрации может быть так называемая
«предварительная» регистрация, когда запрос на сертификат для одного
пользователя поступает от другого пользователя, обычно администратора.
Администратор ищет РЦ по идентификатору транзакции,
паролю или унифицированному указателю ресурсов (URL)
190 Основы технологии PKI
и направляет запрос на сертификат, после одобрения регистрационным
центром запрос передается пользователю в личном присутствии,
по телефону, по электронной почте или в виде файла предварительной
регистрации. При помощи клиентского приложения Trust
Authority Client конечный пользователь может легко получить сертификат
без использования браузера или необходимости что-либо
знать о процессе регистрации.
Процедуры обработки запросов об обновлении или аннулировании
сертификата выполняются аналогично процедуре регистрации.
Приложение Trust Authority Client позволяет пользователям
просматривать информацию обо всех сертификатах системы, в том
числе их статус, назначение и дату окончания срока действия, информацию
о персональных сертификатах (алгоритм шифрования,
размер ключа и период действия сертификата, информацию об УЦ,
который выпустил данный сертификат), а также экспортировать
сертификаты в существующие РК1-приложения.
Сервер аудита Audit Server обеспечивает выполнение следующих
действий:
• получение информации о событиях, подлежащих аудиту,
от клиентов аудита, таких, как РЦ и УЦ;
• фиксирование событий в журнале аудита (для каждого события
формируется одна запись);
• обеспечение возможности клиентов маскировать (фильтровать)
события аудита для управления размером журнала аудита;
• вычисление кода аутентификации сообщения для каждой
записи аудита;
• проверка целостности базы данных аудита и записей аудита,
хранимых в архиве;
• архивирование и подписание текущего состояния базы
данных аудита (изоляция целостности).
По оценкам специалистов компании NSS Group [79], IBM
Trust Authority - функциональное PKI-решение с гибким и удобным
для пользователя интерфейсом. Благодаря тому, что регистрационный
центр представлен набором Java-скриптов, web-страниц и текстовых
файлов конфигурации. Trust Authority предлагает расширенные
возможности настройки. С другой стороны, использование Java8.
Программные средства поддероюки PKI 191
технологии порождает проблемы совместимости браузеров (это относится
только к компонентам RA Desktops и Client). Существенным
недостатком является не очень удобное администрирование УЦ
и необходимость использовать сервисные программы с большим
количеством командных строк для изменения установок САС, генерации
запросов на взаимную сертификацию и проверки журналов
регистрации, а также отсутствие в текущей версии автоматического
возобновления, резервного копирования, восстановления ключей и
управления их историями. Стоимость программного продукта Trust
Authority выгодна для небольшого числа пользователей, но быстро
растет при увеличении масштаба реализации.
8.1.5. RSA Кеоп Certification Authority 6.5
Компания RSA Security Inc. предлагает свое программное
обеспечение инфраструктур открытых ключей - программный комплекс
Кеоп Certification Authority 6.5 и модули Registration Authority,
WebSentry, Key Recovery Module, Secure E-mail Module. Подобно
компаниям Baltimore Technologies и Entrust Technologies, компания
RSA разработала систему PKI для тех организаций, которые хотят
самостоятельно управлять своей инфраструктурой открытых
ключей и сопровождать ее. RSA Кеоп Certification Authority может
использоваться для развертывания корпоративной PKI или встраивания
существующей инфраструктуры в новую, более масштабную
PKI.
Комплекс RSA Кеоп Certification Authority (СА) предназначен
для выпуска, управления и проверки действительности сертификатов.
Он разрабатывался как интегрированное хранилище системных
данных и информации о сертификатах и их статусе, может использоваться
для публикации каталогов LDAP или внешних баз данных
(для хранения сертификатов). RSA Кеоп С А поддерживает стандарт
Х.509, криптографические аппаратные токены, онлайновый протокол
проверки статуса сертификата OCSP.
Центральными компонентами архитектуры RSA Кеоп СА являются
серверы администрирования Administration Server, регистрации
Enrollment Server, защищенного каталога Secure Directory Server и
протоколирования событий Logging Server [81]. Серверы обычно
размещаются на одном компьютере. Administration Server использу-
192 Основы технологии PKI
ется для администрирования PKI. Пользователи обращаются с запросами
на сертификаты через сервер регистрации. Запросы на сертификаты,
выпущенные сертификаты и списки управления доступом
хранятся в Secure Directory Server. Сервер протоколирования событий
регистрирует действия администраторов, лиц, обращающихся с
запросами на сертификаты, и других пользователей.
Administration Server
Для защищенной связи с сервером администрирования (по
протоколу HTTPS) и доступа к функциям RSA Кеоп СА администраторы
PKI используют web-браузер. Интерфейс администратора
содержит четыре отдельных компонента, называемых автоматизированными
рабочими местами (АРМ), они позволяют администраторам
выполнять операции с сертификатами, операции с удостоверяющими
центрами, операции администрирования и конфигурирование
системы.
При помощи АРМ оперирования с сертификатами администраторы
могут просматривать все запросы на сертификаты, принимать
решение об одобрении, удалении или отсрочке запроса, а также
просматривать выпущенные сертификаты и управлять ими: возобновлять,
аннулировать или приостанавливать их действие. RSA Кеоп
СА поддерживает проверку статуса сертификатов не только в онлайновом
режиме, но даже в реальном времени.
АРМ оперирования с удостоверяющими центрами позволяет
администраторам обеспечивать взаимодействие между удостоверяющими
центрами: создавать новые локальные удостоверяющие
центры, просматривать информацию о них, оценивать надежность
внешних удостоверяющих центров и импортировать их в PKI. АРМ
обеспечивает доступ к сертификатам удостоверяющих центров,
а также их замену или экспорт в другую инфраструктуру открытых
ключей.
АРМ конфигурирования системы предоставляет администраторам
средства генерации списков управления доступом и настройки
режимов протоколирования. Списки управления доступом к каждому
сертификату или группе сертификатов по выбору администратора
задаются непосредственно им самим или генерируются автоматически.
Настройка режимов протоколирования заключается в зада-
8. Программные средства поддержки РК1 193
НИИ администратором тех событий в системе, которые должны регистрироваться,
например, доступ к определенным файлам или каталогам
УЦ.
АРМ администрирования обеспечивает работу администраторов
с учетом их полномочий. В RSA Кеоп С А реализован «ролевой»
подход к администрированию PKL Так, например, администраторам,
ответственным за верификацию запросов пользователей на сертификаты,
может быть не разрешен доступ к АРМ конфигурирования
системы. Тем не менее, в системе допускается делегирование полномочий.
Enrollment Server
Сервер регистрации является самым видимым для конечного
пользователя компонентом RSA Кеоп СА. Пользователь, желающий
получить сертификат открытого ключа, связывается с сервером регистрации
через web-браузер (по протоколу HTTPS), вводит свои
данные в форму запроса на сертификат и подписывает запрос. Пара
ключей пользователя генерируется на компьютере, смарт-карте или
токене пользователя, и открытый ключ отправляется серверу регистрации.
Секретный ключ всегда хранится на компьютере или токене
владельца и никому не передается. Подписанный запрос на сертификат
обрабатывается администратором через сервер администрирования,
в случае одобрения запроса пользователю направляется
по электронной почте сообщение с URL-адресом подписанного сертификата.
Сервер защищенного каталога Secure Directory Server предназначен
для хранения объектов, к которым обеспечен доступ RSA
Кеоп СА: сертификатов, запросов на сертификаты и списков управления
доступом. Внешним приложениям разрешен доступ к этим
объектам (по протоколу LDAP) только для чтения. К функциям сервера
Secure Directory Server относится также поддержка токенов для
использования аппаратных модулей безопасности и механизма электронной
цифровой подписи, правила доступа к которому устанавливаются
для каждого удостоверяющего центра в системе PKL
Logging Server используется для протоколирования активности
серверов администрирования, регистрации и защищенного каталога
по правилам, установленным администратором PKI в соответствии
194 Основы технологии PKI
с требованиями аудита в организации. Сведения об активности каждого
сервера регистрируются в отдельной области сервера протоколирования
событий.
Механизм ЭЦП
Secure Directory
Server
SSL-LDAP SSL-LDAP
OSCP
Responder
Logging Server • SSL
SSL-LDAP
Web-сервер
Administration
Server
https
Enrollment
Server
https
SCEP Server
Ад1м и н истр атор Пользователь
Рис. 8.3. Архитектура RSA Кеоп С А
Необязательный модуль RSA Кеоп Registration Authority (RA)
предназначен для верификации идентификационных данных пользователей
(имен и паролей), содержащихся в запросах на сертификаты,
и доставки сертификатов пользователям. RSA Кеоп RA реализует
те же функции, что и RSA Кеоп СА, за исключением подписания
запросов на сертификаты. Один модуль RSA Кеоп RA может обрабатывать
запросы на сертификаты только для одного удостоверяющего
центра.
Модуль RSA Кеоп Key Recovery Module (KRM), который может
использоваться вместе с RSA Кеоп СА, предназначен для защищенного
хранения в архиве и восстановления ключей шифрования
пользователей. RSA Кеоп KRM предоставляет возможности автома-
8. Программные средства поддерэюки PKI 195
тического формирования ключа шифрования в процессе регистрации
пользователей. После получения сертификата открытого ключа
подписи пользователь выбирает через web-браузер режим формирования
ключа шифрования. Секретный ключ шифрования централизованно
генерируется аппаратным криптографическим модулем
nCipher и защищенным образом передается конечному пользователю
вместе с сертификатом ключа шифрования.
Для контроля доступа к web-сайту или его определенным областям
организации часто используют ограничения на IP-адреса,
имена и пароли пользователей. Вместо устаревших методов интеллектуального
1Р-спуфинга (средств имитации соединений) и использования
списков распределения имен и паролей пользователей, компания
RSA Security Inc. предлагает другое решение - модуль RSA
Кеоп WebSentry Plug-in. Это опциональное решение для работы с
RSA Кеоп СА позволяет расширить возможности web-сервера по
управлению сертификатами. При помощи RSA Кеоп СА модуль
WebSentry (см. рис. 8.4) проверяет действительность сертификата,
причем проверка выполняется всякий раз, когда требуется доступ к
web-сайту. Это позволяет обеспечить подход «нулевой толерантности
» к аутентификации и управлению доступом пользователей.
Программный комплекс RSA Кеоп СА обеспечивает поддержку
интеграции с Microsoft Exchange Server и клиентским почтовым
приложением Microsoft Outlook. Использование RSA Кеоп СА вместе
с модулем защищенной электронной почты RSA Secure E-mail
Module позволяет конечным пользователям шифровать и подписывать
важные почтовые сообщения (в том числе и вложения) таким
образом, чтобы их могли прочитать только получатели-адресаты.
Модуль Secure E-mail Module предоставляет организациям возможности:
• поддержки интегрированного решения защищенной электронной
почты на базе стандартного клиентского программного
обеспечения Microsoft Outlook E-mail client;
• автоматического конфигурирования приложения электронной
почты и использования цифровых сертификатов, полученных
пользователями при регистрации в системе PKI, для подписания
и шифрования почтовых сообщений;
196 Основы технологии PKI
• публикации сертификатов в списке глобальных адресов
(Global Address List - GAL) сервера Microsoft Exchange Server, обеспечивающей
доставку защищенных почтовых сообщений любого
пользователя системы другим пользователям без предварительного
взаимодействия.
коммуникации по
протоколу Hi IPS
Web-серверы
коммуникации по
SSL-LDAP
VVeb-бр аузер ы
RSA Кеоп
WebSentry
i
\
|^^3:|
« h ^ !• i
Рис. 8.4. Взаимодействие компонентов RSA Кеоп С А и WebSentry
Шифрование сообщений электронной почты может быть первым
шагом на пути использования функций PKI в корпоративной
информационной системе. Важным преимуществом программного
комплекса RSA Кеоп СА является недавно реализованная поддержка
российских алгоритмов шифрования и электронной цифровой подписи.
Сравнительная характеристика описанных программных продуктов
с учетом результатов их тестирования специалистами NSS
Group [79] представлена в приложении 2.
8.1.6. Интеграция функций PKI в операционные системы
Современной тенденцией является интеграция функции PKI в
серверные операционные системы. Это движение было начато компанией
Novell с сервисами Public Key Infrastructure Services (PKIS) 2.0,
8. Программные средства поддерэюки PKI 197
поставляемыми вместе с сетевой операционной системой NetWare.
PKIS позволяют использовать цифровые сертификаты и шифрование
с открытыми ключами внутри сети на базе Novell Directory
Services (NDS). NDS - многоплатформенная служба каталога для
распределенной сети, которая предоставляет в распоряжение пользователей,
разработчиков и администраторов инструмент доступа ко
всем сетевым ресурсам через одну точку регистрации, одну точку
управления сетью, дает возможность пользоваться гибкой и масштабируемой
схемой базы данных каталога и гарантирует высокий уровень
безопасности.
Управление сертификатами осуществляется с помощью утилиты
NWAdmin в составе операционной системы NetWare. Утилита
обеспечивает единую точку администрирования открытых ключей и
сертификатов. PKIS поддерживают корпоративный удостоверяющий
центр и может передавать выданные внутри компании сертификаты
третьим лицам, например, компаниям VeriSign или GTE
Cybertrust, для получения дополнительной цифровой подписи, но
вместе с тем возможности продукта позволяют обойтись без участия
независимых удостоверяющих центров [24].
PKIS обеспечивают хранение и управление жизненным циклом
ключей и сертификатов с помощью NDS.
В операционной системе Microsoft Windows 2000 в полном
объеме реализована иерархическая инфраструктура открытых ключей,
главным компонентом которой являются службы сертификации
Microsoft Certificate Services. Они позволяют развернуть на предприятии
или в организации один или несколько удостоверяющих
центров. Удостоверяющие центры могут быть интегрированы со
службой каталогов Active Directory, которая обеспечивает их информацией
о выпуске и аннулировании сертификатов, пользователях
и политике УЦ. PKI взаимодействует с существующими механизмами
доверия и аутентификации доменов Windows 2000, в основе
которых лежат контроллер домена и центр распределения ключей
Kerberos.
Службы сертификации содержат применяемый по умолчанию
модуль политики, который можно использовать для выдачи сертификатов
пользователям, компьютерам и службам. На всех рабочих
198 Основы технологии PKl
станциях и серверах, которые работают под управлением операционных
систем Microsoft Windows, обеспечена поддержка приложений,
использующих криптографию с открытыми ключами. Криптографический
интерфейс CryptoAPI 2.0 обеспечивает стандартный
доступ к функциям криптографических модулей CSP (Cryptographic
Service Provider). Модули CSP могут быть программными или работающими
совместно с аппаратными криптографическими устройствами,
они способны генерировать ключи и управлять ими, а также
реализуют разнообразные криптографические алгоритмы. В инфраструктуре
открытых ключей Windows 2000 сертификаты хранятся
и поддерживаются подсистемой CryptoAPI. Административные
средства управления сертификатами обеспечивают возможность архивирования
и восстановления сертификатов и ключей.
PKI Microsoft Windows 2000 поддерживает подачу и обработку
запросов на сертификаты в корпоративный УЦ или независимые
удостоверяющие.центры в соответствии со стандартами PKCS. Реализовано
два метода подачи запросов: через web-страницы с помощью
соответствующего мастера или автоматическое получение сертификатов
при входе в систему и регистрации пользователя.
Пользователям Windows теперь доступно применение сертифицированных
средств криптографической защиты информации в составе
операционной системы Windows. Средство криптографической
защиты Крипто-Про CSP, разработанное совместно компанией
Крипто-Про [147] и государственным унитарным предприятием -
научно-техническим центром «Атлас», реализовано в соответствии
с криптографическим интерфейсом корпорации Microsoft - CSP
и российскими криптографическими алгоритмами (см. раздел 8.2.2).
8.2. Программное обеспечение PKI
российских компаний
Основным препятствием для использования зарубежного программного
обеспечения инфраструктур открытых ключей на российском
рынке является необходимость при выработке РК1-решений
следовать отечественным криптографическим стандартам и требованиям
государственных органов, предъявляемым к средствам защиты
информации.
8. Программные средства поддерэюки PKI 199
Исторически сложилось так, что инфраструктура открытых
ключей создавалась на базе зарубежных криптостандартов (RSA,
DES). Быстрое развитие технологии PKI за рубежом связано с поддержкой
со стороны таких крупных западных производителей программного
обеспечения, как Microsoft Corp., RSA Security Inc.,
Entrust Technologies, IBM, Xcert Software Inc., Baltimore
Technologies, и др. Исходя из высших государственных интересов
США, крупные корпорации при поставках своих продуктов за рубеж
часто используют в них слабую криптографию (имеются в виду
и малая длина ключа - не более 128 бит и устаревшие стандарты).
Таким образом, широкое использование программного обеспечения
известных зарубежных компаний, с одной стороны, позволяет автоматизировать
и повышает эффективность практически любого вида
деятельности, а с другой - ставит отечественных потребителей данной
продукции в неравное положение (в части защиты информации)
с американскими, так как подобные программные продукты не всегда
могут гарантировать полноценную защиту информации [40].
Правда, в последнее время некоторые западные компании стали
предлагать на российском рынке локализованные версии своих программных
продуктов, в которых реализованы российские криптографические
алгоритмы.
Чтобы избежать правовых проблем, которые возникают при
использовании зарубежных программных продуктов, российские
разработчики направили усилия на создание программного обеспечения
PKI с учетом российских требований к средствам обеспечения
информационной безопасности. Несмотря на то, что пока отечественный
опыт развертывания PKI не велик, на рынке программных
продуктов появились программные средства российских производителей
для реализации РК1-решений, в частности, сертифицированное
ФАПСИ средство криптографической защиты КриптоПро CSP
и программные комплексы VCERT PKI и «Вепрь».
8.2.1. Программный комплекс VCERT PKI
Программный продукт VCERT PKI является результатом совместной
работы компаний ЗАО «МО ПНИЭИ» и ООО
<^ВАЛИДАТА» [173]. Система управления сертификатами VCERT
PKI - это многокомпонентная система, использующая инфраструк-
200 Основы технологии PKI
туру открытых ключей для обеспечения конфиденциальности информации,
контроля целостности и подтверждения авторства электронных
документов на основе использования криптографических
процедур, реализованных в соответствии с российскими стандартами
(ГОСТ 28147-89, ГОСТ Р34.10-94 и ГОСТ Р34.11-94) и международными
рекомендациями.
VCERT PKI условно можно разделить на два компонента:
систему управления сертификатами - инфраструктуру открытых
ключей (ИОК) и программный интерфейс к криптографическим
функциям для РК1-приложений.
Система VCERT PKI обеспечивает защиту информации на основе
реализации инфраструктуры открытых ключей с использованием
международных стандартов Х.509, RFC 2459, PKCS#10, PKCS#7,
реализована на платформах Windows NT, Windows 95/98. В состав
системы входит Центр Сертификации (СА), Центр Регистрации (RA),
Справочник Сертификатов (CS) и инструментарий разработчика.
Программное обеспечение VCERT PKI реализовано по модульному
принципу, в его состав входят следующие программные
комплексы и модули:
УСА (VCERT Certification Authority) — программный комплекс
Центр Сертификации (ЦС), предназначенный для создания на
основе информации, предоставляемой Центром Регистрации, сертификатов
открытых ключей, списков аннулированных сертификатов
и их бумажных копий, а также хранения эталонной базы сертификатов
и списков аннулированных сертификатов;
VltA (VCERT Registration Authority) — программный комплекс
Центр Регистрации (ЦР), предназначенный для регистрации
пользователей и обеспечения взаимодействия пользователя с Центром
Сертификации;
VReferee — программный комплекс разбора конфликтных ситуаций,
предназначенный для проверки ЭЦП под электронными документами
и сертификатами открытых ключей;
VCS (VCERT Certificates Store) — программный комплекс
Справочник Сертификатов, обеспечивающий администрирование
справочника сертификатов, формирование служебных сообщений на
рабочем месте пользователя, а также генерацию секретных и откры-
<^. Программные средства поддержки PKI 201
тых ключей на рабочем месте пользователя и запись их на ключевые
носители;
VPKI — программная библиотека работы с сертификатами
и другими объектами VCERT PKJ, реализующая интерфейс к криптографическому
модулю;
VPKITest — тестовое программное обеспечение, реализованное
на основе программной библиотеки;
VCrypt — программный модуль реализации криптографических
функций и генерации ключевой информации.
Программная библиотека работы с сертификатами содержит
в своем составе модули, которые в зависимости от типа операционной
системы могут быть реализованы как в виде единой библиотеки,
так и в виде отдельных библиотек или исполняемых модулей.
В качестве программного модуля, реализующего криптографические
функции, используется СКЗИ "Верба-OW". Криптографический
модуль VCrypt функционирует в операционных системах
Windows 95, Windows 98, Windows NT на персональных компьютерах
типа IBM PC/AT.
Цифровая подпись соответствует требованиям ГОСТ Р 34.10-94
"Информационная технология. Криптографическая защита информации.
Система электронной цифровой подписи на базе асимметричного
криптографического алгоритма". Функция хэширования
выполнена в соответствии с требованиями ГОСТ Р 34.11-94 "Информационная
технология. Криптографическая защита информации.
Функция хэширования", а алгоритм шифрования реализован в соответствии
с требованиями ГОСТ 28147-89 "Системы обработки информации.
Защита криптографическая".
Длины секретного и открытого ключей электронной цифровой
подписи составляют соответственно 256 бит и 512 бит (или 1024 бита),
такие же длины имеют секретный и открытый ключи шифрования.
Вероятность того, что искажения, вносимые в зашифрованную
информацию злоумышленниками или вирусами, не будут обнаружены,
составляет 10"^. Секретные ключи подписи могут храниться
на ключевых носителях — дискетах 3.5" , носителях Touch-Memory
или смарт-картах.
202 Основы технологии PKI
Система VCERT PKI обеспечивает:
• генерацию и верификацию электронных цифровых подписей
под файлом или областью памяти в соответствии
с ГОСТ Р34Л0-94 и ГОСТ Р34.11-94;
• конфиденциальность и контроль целостности информации
посредством ее шифрования и имитозащиты в соответствии
с ГОСТ 28147-89;
• регистрацию электронных запросов пользователей на сертификаты
открытых ключей подписи;
• формирование электронных сертификатов открытых ключей
подписи пользователей.
Клиентское программное обеспечение VCERT PKI позволяет
пользователям на своих рабочих местах формировать запросы на
сертификаты открытых ключей, генерировать секретные и открытые
ключи подписи и шифрования, а также получать сообщения о компрометации
секретных ключей и информацию из справочника сертификатов.
Инструментарий разработчика дает возможность встраивать
в прикладное программное обеспечение криптографические функции
генерации/верификации цифровой подписи, шифрования/ расшифрования
информации.
8.2.2. Средство криптографической защиты информации
КриптоПро CSP
Пользователи Windows теперь могут применять сертифицированные
средства криптографической защиты информации в составе
операционной системы Microsoft Windows. Средство криптографической
защиты информации КриптоПро CSP, разработанное совместно
компанией «Крипто-Про» и государственным унитарным предприятием
научно-техническим центром «Атлас», реализовано в соответствии
с криптографическим интерфейсом корпорации Microsoft
- CSP (Cryptographic Service Provider) и российскими криптографическими
алгоритмами электронной цифровой подписи (ГОСТ
Р34.10-94), хэширования (ГОСТ Р34.11-94) и шифрования и имитозащиты
данных (ГОСТ 28147-89).
8. Программные средства поддерэюки РК1 203
Программный комплекс Удостоверяющий центр - Крипто-
Про УЦ позволяет в полном объеме реализовать инфраструктуру
открытых ключей.
В состав КриптоПро УЦ входят следующие компоненты (см.
рис. 8.5):
• Центр сертификации (ЦС);
• Центр регистрации (ЦР);
• АРМ администратора ЦР;
• АРМ пользователя;
• Программный интерфейс взаимодействия с УЦ.
Центр сертификации - базовый компонент подсистемы,
предназначенный для формирования сертификатов открытых ключей
пользователей и администраторов Удостоверяющего центра,
списков аннулированных сертификатов, хранения эталонной базы
сертификатов и САС. Центр сертификации реализован на платформе
Microsoft Windows 2000 Server и взаимодействует только
с Центром регистрации на базе защищенного сетевого протокола.
В программный комплекс ЦС входят базовый набор СОМ-
компонентов и интерфейс взаимодействия с сервером ЦР - SOAP
(Simple Object Access Protocol).
Базовый набор СОМ-компонентов реализует основные функции
ЦС, взаимодействуя со следующими программными модулями:
• Microsoft Certificate Services - для выполнения функций
управления сертификатами пользователей;
• Microsoft Internet Information Server 5.0 - для обеспечения
SOAP-интерфейса с Центром регистрации;
CryptoAPI 2.0 - для выполнения функций проверки электронной
цифровой подписи ЦР с использованием СКЗИ КриптоПро CSP.
SOAP-интерфейс взаимодействия с сервером ЦР реализован
в виде комплекса ASP-страниц, которые используют в своей работе
базовый набор СОМ-компонент ЦС.
Центр регистрации - компонент УЦ, предназначенный для
хранения регистрационных данных пользователей, запросов на сертификаты,
обеспечения взаимодействия пользователей и Удостоверяющего
центра.
204 Основы технологии PKl
Центр
сертификации
Администратор
т—Г КриптоПро TLS
Двусторонняя аутентификация
Шифрование трафика Г 1 Центр
регистрации Администр атор
Программный интерфейс
Двусторонняя аутентификация
Шифрование трафика
/flt, ^В\
Регистрация
Взаимодействие с Центром
Регистрации
Внешние приложения
Пользователи
Рис.8.5. Архитектура КриптоПро УЦ
Центр регистрации работает на платформе Microsoft
Windows 2000 Server и использует базу данных Microsoft SQL 2000.
ЦР взаимодействует с Удостоверяющим центром в отдельном
сегменте локальной сети на базе защищенного сетевого протокола.
Взаимодействие пользователей с Удостоверяющим центром осуществляется
через АРМ пользователя. ЦР является единственной
точкой входа (регистрации) пользователей в системе. Только зарегистрированный
пользователь может получить сертификат открытого
ключа в Удостоверяющем центре.
Программное обеспечение ЦР состоит из базового набора
СОМ-компонентов, интерфейсов взаимодействия с АРМ администратора
и внешними приложениями. Базовые СОМ-компоненты ЦР
8. Программные средства поддерэюки PKI 205
реализуют основную логику работы ЦР, взаимодействуя со следующими
программными модулями:
• Microsoft Internet Information Server 5.0 - для обеспечения
интерфейса со всеми типами пользователей системы.
• Microsoft SQL Server 2000 - для выполнения функций
управления БД ЦР, протоколирования работы ЦР.
• CryptoAPI 2.0 - для выполнения функций шифрования, аутентификации
и проверки электронной цифровой подписи, используя
алгоритмы криптографической защиты, реализованные в составе
СКЗИ КриптоПро CSP.
Интерфейсы взаимодействия с АРМ администратора ЦР
и внешними приложениями реализуются в виде комплекта ASP-
страниц, использующих в своей работе базовые СОМ-компоненты ЦР.
Компонент АРМ Администратора ЦР предназначен для выполнения
организационно-технических мероприятий, связанных
с регистрацией пользователей, генерацией ключей и сертификатов
пользователей и взаимодействием с Центром регистрации. АРМ
администратора ЦР функционирует в ОС Microsoft Windows 2000
Professional. АРМ администратора взаимодействует с Центром регистрации
в отдельном сегменте локальной сети на базе защищенного
сетевого протокола.
АРМ администратора ЦР является приложением, разработанным
посредством Microsoft Management Console, и может быть
использован в интегрированной среде совместно с другими приложениями
администрирования, такими, как Microsoft SQL Server
Enteфrise Manager, Microsoft Internet Information Server Manager и др.
АРМ администратора ЦР обеспечивает проверку состояния
и обработку запросов пользователей на регистрацию, выдачу и аннулирование
сертификатов открытых ключей, просмотр протоколов
работы ЦР и поиск информации в базе данных ЦР, относящейся
к зарегистрированным пользователям.
АРМ пользователя ~ это web-приложение, размещенное на
сервере ЦР. АРМ пользователя функционирует в ОС Microsoft
Windows 95 и выше (браузер - MS IE 5.0 и выше). АРМ пользователя
обеспечивает шифрование информации, передаваемой ЦР
с использованием протокола TLS с двусторонней аутентификацией.
206 Основы технологии PKI
К основным функциям АРМ пользователя относятся:
• обеспечение взаимодействия пользователя с ЦР;
• заполнение форм запросов на сертификаты;
• выбор типа сертификата;
• проверка состояния запросов на сертификаты и статуса
сертификатов;
• генерация секретных ключей;
• получение сертификатов.
Программный интерфейс пользователя предназначен для просмотра
персональной информации из базы данных ЦР, списка сертификатов,
полученных пользователем, и запросов на сертификаты
для загрузки, получения и аннулирования сертификатов.
Интеграция российских средств криптографической защиты
информации со средствами операционной системы и приложениями,
использование инфраструктуры открытых ключей позволяет пользователям
и разработчикам обеспечить конфиденциальность, авторство
и целостность информации. Применяя средство криптографической
защиты информации КриптоПро CSP, пользователи операционной
системы MS Windows могут воспользоваться стандартными
программными средствами корпорации Microsoft для реализации
решений, основанных на инфраструктуре открытых ключей. К этим
средствам относятся: Центр сертификации (MS Certification
Authority), Инструментарий разработчика CryptoAPI 2.0, Инструментарий
разработчика CAPICOM 1.0, Certificate Enrollment Control
(xenroll), Microsoft Outlook, Microsoft Outlook Express и Microsoft
Authenticode.
8.2.3. Программный комплекс «Вепрь»
Руководствуясь требованиями «Доктрины информационной
безопасности РФ» в плане замещения зарубежных технических
и программных средств в российских информационных системах,
российская компания «Новый Адам» разработала программный
комплекс Удостоверяющий Центр «Вепрь», способный стать базовым
компонентом корпоративных систем, использующих в целях
обеспечения информационной безопасности технологию PKI (в частности,
систем электронного документооборота Интернет-
8. Программные средства поддерэюки PKI 207
банкинга, электронной коммерции, билинговых систем, и т.п.) [142].
Функционально Удостоверяющий Центр реализован в соответствии
с требованиями Федерального Закона РФ «Об электронной цифровой
подписи».
Удостоверяющий Центр (рис. 8.6) построен по модульному
принципу и содержит следующие компоненты:
• Службу Реестра (СР);
• Центр регистрации (ЦР);
• Центр сертификации (ЦС);
• Центр арбитража (ЦА);
• Криптографический Процессор (КП);
• Абонентские пункты (АП).
Служба Реестра обеспечивает публикацию, организацию свободного
доступа и хранение электронных сертификатов и списков
аннулированных сертификатов, выпущенных ЦС. Доступ к хранилищу
сертификатов осуществляется по протоколу LDAP. Служба
Реестра взаимодействует с Центром сертификации для поддержания
актуальности базы данных и вносит информацию о сертификатах
и изменении их статуса в сетевые справочники сертификатов
и списки аннулированных сертификатов.
Центр регистрации обеспечивает получение, предварительную
обработку и хранение внешних запросов о выдаче и аннулировании
сертификатов, а также их передачу Центру сертификации.
Для обслуживания запросов на разбор конфликтных ситуаций
Центр регистрации взаимодействует с Центром арбитража, причем
верификация цифровой подписи на электронном документе
трактуется как конфликтная ситуация.
К функциям Центра регистрации также относятся хранение
журналов событий в течение срока, предусмотренного регламентом
системы, и резервное копирование на внешние носители локального
архива. Центр регистрации - это единственный управляющий компонент
системы, имеющий непосредственный выход в публичную
сеть.
Центр сертификации взаимодействует с Криптографическим
Процессором для генерации секретных и открытых ключей
пользователей, выпуска сертификатов формата Х.509 v3 и измене-
208 Основы технологии PKI
ния их статуса, проверки подлинности цифровых подписей на электронных
документах и проставления меток времени.
Центр сертификации выполняет обработку запросов от Центра
регистрации на создание ключей и сертификатов, обеспечивает
управление жизненным циклом ключей и сертификатов, доступ к
базе данных Центра арбитража при разборе конфликтных ситуаций,
подготовку информации о сертификатах и списках аннулированных
сертификатов к ее опубликованию Службой Реестра.
1
N
Т
Е
R
N
Е
Т
Служба реестра
(LDAP)
^
Центр
регистрации
Абонентский
пункт 1
Абонентский
пункт N
Центр
арбитража
Центр
сертификации
I
Абонентский
I пункт 1 I
Крипто-
процессор
Абонентский
пункт N
Абонентский
пункт 1
Рис. 8.6. Структурная схема УЦ
Центр сертификации поддерживает в системе установленную
регламентом политику безопасности, в том числе управление
доступом обслуживающего персонала к данным и программным модулям
системы на базе устанавливающих полномочия атрибутных
сертификатов, хранение журналов событий в течение установленного
срока, резервное копирование локального архива на внешние носители.
Центр арбитража выполняет обработку запросов из Центра
регистрации на разбор конфликтных ситуаций, поддерживает базу
данных «историй» разбора конфликтов, а также по обращениям абонентов
официально подтверждает подлинность цифровых подписей
8. Программные средства поддерэюки PKI 209
на тех электронных документах, которые подписаны при помощи
ключей подписи сертификатов, выданных Центром сертификации.
Для верификации цифровых подписей Центр арбитража взаимодействует
с Криптографическим Процессором (через Центр сертификации).
Центр арбитража обеспечивает регистрацию и принятие решений
по конфликтным и спорным ситуациям в процессе использования
сертификатов, а также формирование структурированных
данных о результатах разбора конфликтных и спорных ситуаций.
К функциям Центра регистрации также относятся ведение журнала
работы, хранение «историй» разбора конфликтных ситуаций и журналов
событий в течение срока, предусмотренного регламентом системы,
и резервное копирование локального архива на внешние носители.
Криптографический Процессор - автономный модуль, который
принимает заявки на выполнение криптографических процедур
и взаимодействует с Центром сертификации через отдельный физический
интерфейс. Сервис, обслуживающий запросы от Центра
сертификации, предоставляет строго определенный, ограниченный
набор функций. Функциональное обособление Криптографического
Процессора обеспечивает независимость системы от криптографических
алгоритмов, поставщика криптографических средств
и уровня требований к криптографической подсистеме.
Криптографический Процессор выполняет генерацию собственной
пары ключей подписи и создание самоподписанного корневого
сертификата, секретный ключ всегда хранится под защитой
Криптографического Процессора. По запросам от Центра сертификации
осуществляется:
1) генерация и передача секретных ключей и сертификатов
ключей подписи пользователей. Секретные ключи пользователей
шифруются при помощи ключей, поступающих из Центра сертификации
вместе с запросом.
2) создание и подписание сертификатов открытых ключей
подписи пользователей. Открытые ключи пользователей поступают
вместе с запросами на сертификаты из Центра сертификации.
210 Основы технологии PKl
3) создание электронной цифровой подписи на блоке данных
при помощи секретного ключа Криптографического Процессора.
4) проверка электронной цифровой подписи на блоке данных
для известного открытого ключа, который поступил вместе с запросом
на верификацию подписи из Центра сертификации.
В Криптографическом Процессоре реализованы алгоритмы:
• электронной цифровой подписи: RSA (PKCS#1, RFC 2437),
DSA (FIPS 186-1) и ГОСТ Р 34.10-94;
• хэширования: MD5 (RFC 1321), SHA-1 (FIPS 181, RFC 3174)
и ГОСТ Р 34.11-94;
• согласования ключей Диффи-Хеллмана.
Средства электронной цифровой подписи встроены в Криптографический
Процессор и по требованиям регламента системы
Удостоверяющий Центр могут встраиваться в другие компоненты
комплекса, например абонентские пункты.
Абонентский пункт предназначен для административного
управления компонентами Удостоверяющего Центра, кроме того,
может выступать клиентской частью РКГсистемы на базе программного
комплекса «Вепрь». Абонентский пункт позволяет формировать
запросы на выдачу сертификатов и списков аннулированных
сертификатов из базы данных Службы Реестра, просматривать
содержание сертификатов и САС, осуществлять поддержку локальной
базы сертификатов и функций экспорта/импорта сертификатов,
создавать бумажные копии сертификатов ключей подписи, а также
выполняет дополнительные функции наложения цифровой подписи
на блок данных и проверки ЭЦП на блоке данных. Абонентский
пункт может использоваться в качестве рабочего места администратора
ЦА, ЦР и ЦС.
Циркуляция информации между компонентами УЦ осуществляется
на базе заверенных цифровой подписью запросов в формате
CMC [98].
Удостоверяющий Центр корпоративной информационной
системы реализован на платформах Unix и Linux и обеспечивает:
1. Регистрацию и обслуживание запросов пользователей на
создание цифровых сертификатов, секретных и открытых ключей.
8. Программные средства поддержки РК1 211
Запрос может быть представлен в гипертекстовой форме (онлайновая
регистрация), в форматах PKCS#10 и CRMF [92].
2. Создание цифрового сертификата пользователя и его подписание
секретным ключом УЦ на базе российских криптографических
алгоритмов (функции хэширования - ГОСТ Р34.] 1-94, цифровой
подписи - ГОСТ Р34.10-94, шифрования и выработки имитов-
ставки - ГОСТ 28147-89). Возможен раздельный выпуск сертификатов
ключей подписи и шифрования. Цифровые сертификаты соответствуют
международным рекомендациям Х.509 v.3 и могут выдаваться
в форматах PKCS#12, DER или РЕМ.
3. Ведение реестра сертификатов открытых ключей и списка
аннулированных сертификатов на базе каталога LDAP и организация
свободного доступа к нему пользователей.
4. Оперативное управление сертификатами (ввод в действие,
приостановление и возобновление действия, аннулирование). Разграничение
доступа к административным ресурсам осуществляется
на основе анализа содержания цифровых сертификатов лиц, ответственных
за информационную безопасность (офицеров безопасности).
Сертификаты офицеров безопасности содержат специальные
мандатные метки, характеризующие полномочия конкретного лица
и уровень принятия решения.
5. Техническую поддержку разбора конфликтных ситуаций.
УЦ обеспечивает ведение заверенной «истории жизни» сертификата.
Любое событие в жизненном цикле сертификата, будь то централизованное
принятие решения о выпуске сертификата или изменение
статуса уже выпущенного сертификата, оформляется в виде специальной
записи (в формате CMC) в «истории» сертификата и имеет
ЭЦП инициатора принятия решения. Взаимосвязанные записи характеризуют
всю «историю жизни» сертификата. Управление историями
сертификатов позволяет эффективно решать задачи разбора
конфликтных ситуаций.
Дополнительно УЦ предоставляет общедоступный сервис
«службы времени», обеспечивает проставление меток времени на
электронных документах и верификацию цифровых подписей на
электронных документах в отношении сертификатов, выпущенных
этим центром.
212 Основы технологии PKI
Заключение
В современных условиях защищенный обмен сообщениями,
надежная идентификация и электронная коммерция невозможны без
инфраструктуры безопасности. В настоящее время наиболее успешным
методом обеспечения цифровой идентичности является использование
цифровых сертификатов в соответствии с международным
стандартом Х.509 и стандартами Интернет. Инфраструктура безопасности
для распространения открытых ключей, управления электронными
сертификатами и ключами пользователей получила название
инфраструктуры открытых ключей.
Инфраструктура открытых ключей представляет собой комплексную
систему, обеспечивающую все необходимые сервисы для
использования технологии открытых ключей. Цель PKI состоит
в управлении ключами и сертификатами, посредством которого
корпорация может поддерживать надежную сетевую среду. PKI
позволяет использовать сервисы шифрования и выработки
цифровой подписи согласованно с широким кругом приложений,
функционирующих в среде открытых ключей. Технология PKI считается
единственной позволяющей применять методы подтверждения
цифровой тождественности при работе в открытых сетях [30].
Концепция инфраструктуры открытых ключей сама по себе не
нова. Международный союз по телекоммуникациям уже много лет
назад разработал стандарты на структуру баз данных, записи в которых
содержали информацию о пользователях. Стандарты играют
существенную роль в развертывании и использовании PKI. Стандартный
подход особенно важен при регулировании процедур регистрации
и выработки ключа, задании формата сертификата и списка
аннулированных сертификатов, формата криптографически защищенных
данных и описании онлайновых протоколов.
Во многих странах происходит пересмотр законодательства
в сфере инфраструктур открытых ключей и цифровых подписей.
Основной смысл предложений заключается в повышении доверия к
использованию цифровых подписей в качестве юридического инструмента.
Заключение 213
Следование стандартам технологии цифровых сертификатов
является необходимым условием успешного проектирования и развертывания
эффективных инфраструктур открытых ключей, обеспечивающих
масштабируемые и полностью распределенные решения
для управления доступом и безопасности электронного документооборота.
Развертывание PKI целесообразно для крупных территориально
распределенных организаций, где необходимо наладить контролируемую
защиту документов и серверов при использовании разнообразных
приложений.
Основной риск, возникающий при использовании PKI, заключается
в возможной неудаче при оказании РК1-услуг вследствие недостаточной
функциональной совместимости программных и аппаратных
продуктов различных производителей. Система PKI должна
легко интегрироваться с технологиями браузеров, а также прикладными
системами, которые она должна поддерживать. Ключевой
проблемой при этом является степень сложности интеграции соответствующих
PKI-функций во вновь создаваемые приложения,
а также в уже имеющиеся прикладные системы.
Продукты и услуги для поддержки PKI предлагаются на рынке
целым рядом компаний. Одни компании производят комплексное
программное обеспечение, которое может быть использовано для организации
собственного удостоверяющего центра и управления сертификатами,
другие предоставляют услуги удостоверяющего центра,
обеспечивая работу и управляя серверами сертификатов в своих
офисах, доступ к которым клиенты получают через Интернет.
С каждым годом возрастает важность технологии PKI для
корпоративной среды, для реализации компаниями защищенного
обмена сообщениями, электронной коммерции, виртуальных частных
сетей и даже однократной регистрации. Сегодняшний бизнес
все в большей степени начинает использовать эту технологию, обеспечивающую
высокий уровень безопасности и способствующую
более тесному взаимодействию с партнерами, поставщиками и потребителями.
214 Основы технологии PKI
ПРИЛОЖЕНИЕ 1.
НАБОР ПОЛОЖЕНИЙ ПОЛИТИКИ PKI
1. Введение
1 1.1. Краткий обзор
1 1.2. Идентификация
1 1.3. Сообщество и сфера приложения
1.3.1. Удостоверяющие центры
1.3.2. Регистрационные центры
1.3.3. Конечные субъекты
1.3.4. Сфера приложения
1.4. Контактная информация
1.4.1. Спецификация администрации организации
1.4.2. Контактное лицо
1.4.3. Лицо, определяющее соответствие регламента политике
1
2. Основные положения |
2.1. Обязательства
2.1.1. Обязательства УЦ
2.1.2. Обязательства РЦ
2.1.3. Обязательства подписчика
2.1.4. Обязательства доверяющей стороны
2.2. Ответственность 1
2.2.1. Ответственность УЦ
2.2.2. Ответственность РЦ
2.3. Финансовая ответственность 1
2.3.1. Возмещение ущерба доверяющими сторонами
2.3.2. Фидуциарные отношения
2.3.3. Административные процессы
2.4. Интерпретация и исполнение 1
2.4.1. Государственное право
2.4.2. Раздельность положений
2.4.3. Процедуры решения споров
2.5. Плата за услуги 1
2.5.1. Плата за выпуск и повторный выпуск сертификата
2.5.2. Плата за доступ к сертификату
2.5.3. Плата за доступ к информации об аннулировании и
статусе сертификата
2.5.4. Плата за другие услуги
2.5.5. Политика компенсации |
Приложение 1 215
2.6. Публикация и реестр
2.6.1. Публикация информации УЦ
2.6.2. Частота публикации
2.6.3. Контроль доступа
2.6.4. Реестры
2.7. Аудит деятельности субъектов
2.7.1. Частота проверок для каждого субъекта
2.7.2. Личность/квалификация аудитора
2.7.3. Отношение аудитора к субъекту
2.7.4. Темы, охватываемые аудитом
2.7.5. Действия в результате обнаружения нарушений
2.7.6. Анализ результатов
2.8. Конфиденциальность
2.8.1. Виды данных, хранимых конфиденциально
2.8.2. Виды данных, не относящихся к конфиденциальной
информации
2.8.3. Раскрытие информации о причинах аннулирования
или приостановления действия сертификатов
2.8.4. Политика раскрытия информации официальным
представителям правоохранительных органов
2.8.5. Раскрытие информации для гражданских судебных
исков
2.8.6. Раскрытие информации по запросу ее собственника
2.8.7. Другие обстоятельства раскрытия информации
2.9. Права на интеллектуальную собственность
3. Идентификация и аутентификация
3.1. Начальная регистрация
3.1.1. Типы имен
3.1.2. Многозначность имен
3.1.3. Правила интерпретации различных форм имени
3.1.4. Уникальность имен
3.1.5. Процедура разрешения споров о праве на имя
3.1.6. Признание, аутентификация и роль торговых марок
3.1.7. Доказательство владения секретным ключом
3.1.8. Аутентификация юридического лица
3.1.9. Аутентификация физического лица
3.2. Обычное возобновление ключа
3.3. Повторный выпуск ключа после аннулирования
3.4. Запрос об аннулировании ключа
216 Основы технологии PKI
4. Операционные требования
4.1. Запрос о выдаче сертификата
4.2. Выпуск сертификата
4.3. Принятие сертификата
4.4. Приостановление и аннулирование сертификата
4.4.1. Обстоятельства аннулирования сертификата
4.4.2. Круг лиц, имеющих право подавать запрос об аннулировании
4.4.3. Процедуры запроса об аннулировании
4.4.4. Срок запроса об аннулировании
4.4.5. Обстоятельства приостановления сертификата
4.4.6. Круг лиц, имеющих право подавать запрос о приостановлении
4.4.7. Процедуры формирования запроса о приостановлении
4.4.8. Ограничения на срок приостановления
4.4.9. Частота выпуска САС
4.4.10. Требования к проверке САС
4.4.11. Возможность проверки аннулирования/статуса
сертификата в оперативном режиме
4.4.12. Требования к проверке аннулирования в оперативном
режиме
4.4.13. Другие формы объявления об аннулировании
4.4.14. Требования к проверке других форм объявления
об аннулировании
4.4.15. Специальные требования в случае компрометации
ключа
4.5. Процедуры контроля безопасности
4.5.1. Типы регистрируемых событий
4.5.2. Частота обработки контрольных журналов
4.5.3. Срок хранения контрольных журналов
4.5.4. Защита контрольных журналов
4.5.5. Процедуры создания резервных копий контрольных
журналов
4.5.6. Характеристика системы накопления данных контрольного
журнала
4.5.7. Уведомление субъекта, виновного в нарушении
4.5.8. Оценки уязвимости
Приложение I 217
4.6. Архивные записи
4.6.1. Типы фиксируемых событий
4.6.2. Срок хранения в архиве
4.6.3. Защита архива
4.6.4. Процедуры создания резервной копии архива
4.6.5. Требования проставления метки времени записей
4.6.6. Характеристика системы сбора архива (внутренняя
или внешняя)
4.6.7. Процедуры получения и проверки архивной ин-
формации
4.7. Смена ключа
4.8. Процедуры восстановления в случае компрометации или стихийного
бедствия
4.8.1. Порча вычислительных ресурсов, программного
обеспечения и/или данных
4.8.2. Аннулирование открытого ключа субъекта
4.8.3. Компрометация ключа субъекта
4.8.4. Меры безопасности в случае стихийного или иного
бедствия
4.9. Прекращение деятельности УЦ
5. Физические, процедурные и кадровые средства управления
безопасностью
5.1. Физические средства управления безопасностью
5.1.1. Местонахождение и конструкция узла
5.1.2. Физический доступ
5.1.3. Электропитание и кондиционирование
5.1.4. Контроль риска затопления
5.1.5. Пожарная охрана и защита
5.1.6. Защита среды хранения системы
5.1.7. Размещение отходов
5.2. Процедурный контроль
5.2.1. Доверительные должности
5.2.2. Количество лиц, требуемых для выполнения задания
5.2.3. Идентификация и аутентификация для каждой
должности
218 Основы технологии PKI
5.3. Кадровые средства управления безопасностью
5.3.1. Требования к проверке уровня благонадежности и
компетентности персонала
5.3.2. Процедуры проверки уровня благонадежности и
компетентности персонала
5.3.3. Требования к подготовке
5.3.4. Частота переподготовки и требования к ней
5.3.5 Частота и последовательность смены деятельности
5.3.6. Санкции за несанкционированные действия
5.3.7. Требования к персоналу, работающему по контракту
5.3.8. Документация для работы персонала
6. Технические средства управления безопасностью
6.1. Генерация и инсталляция пар ключей
6.1.1. Генерация пары ключей
6.1.2. Доставка секретного ключа субъекту
6.1.3. Доставка открытого ключа субъекта издателю сертификата
6.1.4. Доставка открытого ключа УЦ пользователям
6.1.5. Размеры ключа
6.1.6. Генерация параметров открытого ключа
6.1.7. Проверка качества параметров
6.1.8. Аппаратная / программная генерация ключа
6.1.9. Назначение ключа
6.2. Защита секретного ключа
6.2.1. Стандарты на криптографический модуль
6.2.2. Контроль секретного ключа несколькими лицами
6.2.3. Депонирование секретного ключа
6.2.4. Создание резервной копии секретного ключа
6.2.5. Хранение секретного ключа в архиве
6.2.6. Ввод секретного ключа в криптографический модуль
6.2.7. Способ активации секретного ключа
6.2.8. Способ деактивации секретного ключа
6.2.9. Способ уничтожения секретного ключа
6.3. Другие аспекты управления ключами
6.3.1. Хранение в архиве открытого ключа
6.3.2. Периоды использования открытых и секретных
ключей
Прилоэюеиие 1 219
6.4. Данные активации
6.4.1. Генерация и инсталляция данных активации
6.4.2. Защита данных активации
6.4.3. Другие аспекты активации данных
6.5. Управление компьютерной безопасностью
6.5.1. Специфические технические требования компьютерной
безопасности
6.5.2. Рейтинг компьютерной безопасности
в.в. Технический контроль жизненного цикла
6.6.1. Контроль разработки системы
6.6.2. Контроль управления безопасностью
6.6.3. Рейтинги безопасности жизненного цикла
6.7. Контроль сетевой безопасности
6.8. Контроль поддержки криптографического модуля
7. Форматы сертификата и списка аннулированных сертификатов
7.1. Формат сертификата
7.1.1. Номер версии
7.1.2. Дополнения сертификата
7.1.3. Идентификаторы объекта криптографического алгоритма
7.1.4. Типы имен
7.1.5. Ограничения на имена
7.1.6. Идентификатор объекта ППС
7.1.7. Использование ограничителей политики
7.1.8. Синтаксис и семантика спецификаторов политики
7.1.9. Семантика обработки критичной для ведения биз-
неса политики применения сертификатов
7.2. Формат списка аннулированных сертификатов
7.2.1. Номера поддерживаемых версий списка аннулированных
сертификатов
7.2.2. Список аннулированных сертификатов и пункт
распространения САС
8. Администрирование спецификации
8.1. Процедуры изменения спецификации
8.2. Политика публикации и уведомления
8.3. Процедуры утверждения регламента
220 Основы технологии PKI
ПРИЛОЖЕНИЕ 2. СРАВНИТЕЛЬНАЯ
ХАРАКТЕРИСТИКА ПРОГРАММНЫХ ПРОДУКТОВ
Программный
продукт
Baltimore
UniCERT
5.0
Поддержка се
Формат
сертификата
Дополнения
сертификата
стандартные/
частные
ртификато!
X.509V3
Почти
все
Дополнения
заказчика
Методы аннулирования
САС
Протокол
OCSP
Пункты
распространения
САС
Да
Да
Да
Расширяемость
Модульность
Максимальное
количество
сертификатов
1
Отдельные
модули,
которые
могут быть
размещены
вместе
и на отдельных
компьютерах
Нет ограничений
на количество
сертификатов
1
ВТ
TRUST
ONSITE
4.5
1
X.509v3
Да
Да/да
Через
файлы
LDIFv3
Да
(Verisign)
Да
Модули
УЦиРЦ
размещаются
на
разных
компьютерах
Нет ограничений
на количество
сертификатов
1
ENTRUST
/
PKI 5.0
X.509v3
X.509v3,
PKIX,
FPKI
Enterprise,
Web, SET,
VPN,
PKIX,
FPKI
Да
Да
Да
Модуль
УЦ работает
на
отдельной
рабочей
станции и
одновременно
взаимодействует
со мно гимн
РЦ
Сертификаты
для 1
млн пользователей
ЮМ Trust
Authority
3.1.
X.509v3
Да
Да/да
Да
Да
Нет
Модули
CA/Audit
Server, RA
Server и
Directory
размещаются
на
разных
компьютерах
Свыше 30
млн
RSAKeon
Certification
Authority
6.5.
X.509v3
Да, в том
числе дополнения.
определяемые
пользователем
Да
Да
Нет
Модули
УЦ и РЦ
могут размещаться
вместе,
для других
модулей
требуются
отдельные
компьютеры
Нет ограничений
на количество
сертификатов
1
Приложение 2 111
Программный
продукт
Безопасное!
Коммуникации
с
клиентом
Коммуникации
между
YLVPU
Защита
УЦ/РЦ
Аппаратная
защита
корневых
ключей
УЦ
Топология ]
Способы
сертификации
Глубина
иерархии
Множественные
УЦ/РЦ
Baltimore
UniCERT
5.0
ъ
PKCS#10/7
PKCS#12
Подписанные
сообщения
PKIX CMP
Программные
или аппаратные
модули
безопасности
с контролем
доступа
Да
'KI
Сетевая,
иерархическая
Любая
Да, максимальное
число РЦ
для одного
УЦ-255
ВТ
TRUST
ONSITE
4.5
Через считывание
PIN-кода
или по эл.
Почте
Защищенные
транзакции
Смарт-
карты
Да
Только
иерархические
PKI
Любая
Да, без
ограничений
ENTRUST
/
PKI 5.0
PKIX-CMP
PKIX#7/10
Защищенный
SPKM/GS
S-API сеанс
связи
Цифровые
удостоверения
личности
администраторов,
токены
Устройства
Chrysalis,
Zaxus
(Racal) и
Alalia
Сетевая,
иерархическая
и
гибридная
PKIX СМР
PKCS#10/7
Любая
Да, без
ограничений.
IBM Trust
Authority
3.1.
SSL
Подписанные
сообщения
PKIX CMP
Пароли
или смарт-
карты,
списки
управления
доступом,
аппаратные
устройства
Криптографический
сопроцессор
IBM 4758,
смарт-
карты
Двусторонняя
PKIX СМР
Любая
Нет
1 RSAKeon
Certification
Authority
6.5.
SSL
PKIX CMP
Смарт-
карты
/токены
Нет
Сетевая и
иерархическая
Любая 1
Да, без 1
ограничений
222 Основы технологии PKI
Программный
продукт
Baltimore
UniCERT
5.0
Механизмы регистрации
1 Личное
присутствие
Web
1 Электронная
почта
VPN
1 Поддержка
Собственный
каталог
или
каталог
третьей
стороны
Поддержка
Устройства/
Стандарты
Да
Да
Да
Да
каталога
Собственный
каталог
и каталог
третьей
стороны
смарт-карт
Смарт-
карты:
Datacard
320/310,
Gempuls,
Luna
tokens
Стандарт
для смарт-
карт -
PKCS#11
1 ВТ
TRUST
ONSITE
4.5
Да
Да
Да
Да
Собственный
и через
модуль
интеграции
в любой
LDIFv3 -
совместимый
каталог
Стандарты
для смарт-
карт: ISO
7816-1/2/3,
PKCS,
PC/SC
Workgroup
Specifications,
Х.509
ENTRUST
/
PKI 5.0
Да
Да
Да
Да
Поддержка
любого
каталога
LDAP v2
или v3,
специфических
каталогов
(Compaq,
Lx)tus
Domino,
Novell,
Oracle и
др.)
Смарт-
карты:
ActivCard,
DataKey,
Gempuls,
NDS, Sony
(стандарт
PKCS#11)
Биометр.
устройства
и смарт-
карты:
Amer.Biom
etric Company,
Bio-
Metrix и
др.
IBM Trust
Authority
3.1.
Да
Да
Да
Да
Собственный
каталог
и каталог
третьей
стороны
(LDAP)
Стандарты
для смарт-
карт
PKCS#11,
MSCAPI
RSAKeon
Certification
Authority
6.5.
Да
Да
Да
Да
Собствен- j
ный каталог
и каталог
третьей
стороны
(LDAP)
Смарт-
карты/
аппаратные
ключи:
Setec
RSA crypto
card, RSA
SecurlD
token
Стандарты:
PC/SC,
PKCS#11
Приложение 2 223
Программный
продукт
Поддержка
1 Защита
клиентского
ПО
1 Защита
администратора
УЦ
1 Защита
администратора
РЦ
Управление
1 Автоматическое
обновление
ключей
1 Автоматическое
управление
историями
ключей
1 Восста- 1
новле-
ние/резерв
ное копи-
1 рование
ключей
Baltimore
UniCERT
5.0
смарт-карт
Обычно
PIN-коды
и пароли
Программ-
ная/смарт-
кар-
ты/токены
Программ-
ная/смарт-
кар-
ты/токены
ключами
Нет
Нет
Да - через i
сервер
архива
ВТ
TRUST
ONSITE
4.5
Смарт-
карты
Смарт-
карты
Смарт-
карты
Нет
Нет
Да
ENTRUST
/
PKI 5.0
Смарт-
карты и
биометрические
устройства
Аппаратные
устройства
Смарт-
карты
Да, в том
числе обновление
пары ключей
УЦ
Да
Резервное
копирование
только
ключей
шифрования
IBM Trust
Authority
3.1.
Смарт-
карты
(обычные
и виртуальные)
Только
средствами
» операционной
системы
Смарт-
карты
(PKCS#11,
MS CAPI)
Нет
Нет
Нет
RSAKeon
Certification
Authority
6.5.
Смарт-
карты,
аппаратные
ключи
Смарт-
карты,
аппаратные
ключи
Смарт- 1
карты,
аппаратные
ключи
Нет 1
Нет
Резервное 1
копирование
ключей
шифрования
модулем
RSA Кеоп
BCRM 1
224 Основы технологии PKI
Программный
продукт
Baltimore
UniCERT
1 5.0
ВТ
TRUST
ONSITE
4.5
Функциональная совместимость
УЦ
(поддерживаемые
стандарты)
РЦ
(поддерживаемые
стандарты)
1 Крипто-
графиче- 1
ское аппаратное
обеспечение
Каталоги 1
Протоко- 1
лы сертификатов
PKIX,
RSA, DSA,
ECDSA,
устройства
через
PKCS#11
PKIX,
RSA, DSA,
ECDSA,
устройства
через
PKCS#11
PKCS#11
LDAP,
DAP
X.509v3
X.509v3
X.509v3
FIPS 140-
level 2
LDAP
X.509v3
ENTRUST
! /
i PKI 5.0
X.509v3,
PKIX,
RSA, DSA,
ECDSA,
ЮЕА,
CAST,
DES, 3-
DES, SHA-
1, MD-2,
MD-5,
RIPEMD,
RC2, AES,
PKCS#1,
#3, #5, #7,
#8, #10 #12
X.509v3,
PKIX,
PKIX
CMP, CEP,
GSSAPI/
SPKM
SSL,
PKCS#1,
#3, #5, #7,
#8, #10 #12
PKCS#11
LDAP 1
X.509v3
IBM Trust
Authority
3.1.
X.509v3,
PKIX,
CMMF,
RSA, MD-
5, SHA-1,
PKIX
CMP,
CMMF,
SSL,
PKCS#7,
#10#11
IBM 4758,
PKCS#1
LDAP i
X.509v3
RSA Keen
Certification
Autliority6.5.
X.509v3, !
RSA, DSA, 1
ECDSA,
российские
ГОСТы
X.509v3,
RSA, DSA,
ECDSA,
российские
ГОСТы
PKCS#11,
FIPS 140-1
level 1
LDAP
X.509v3
Глоссарий 225
ГЛОССАРИИ
Авторство информации
Однозначное соответствие между содержанием и/или формой
информации и субъектом (объектом), сформировавшим эту информацию.
Для пользователя авторство полученной им из системы или
по каналу связи информации означает однозначное установление
источника, сформировавшего эту информацию (ее автора).
Аннулирование сертификата
Признание сертификата недействительным в период его действия
в случаях компрометации секретного ключа или изменения
атрибутов сертификата с момента его выпуска (например, при изменении
имени пользователя).
Аутентификация
Проверка принадлежности субъекту доступа предъявленного
им идентификатора, подтверждение подлинности. Аутентификация
осуществляется на основании того или иного секретного элемента
(аутентификатора), которым располагают как субъект, так и информационная
система.
Аутентификация информации
Установление подлинности информации исключительно на
основе внутренней структуры самой информации независимо от источника
этой информации, установление законным получателем
(возможно арбитром) факта, что полученная информация наиболее
вероятно была передана законным отправителем (источником) и при
этом не была заменена или искажена.
Аутсорсинг
Выполнение отдельных задач проекта компании сторонними
организациями, специализирующимися в этой области.
Биометрическая аутентификация
Аутентификация, опирающаяся на уникальные биологические
показатели человека. К основным биометрическим идентификаторам
относятся отпечатки пальцев, рукописные подписи, образцы
голоса, результаты сканирования сетчатки и радужной оболочки
глаза, формы ладони или черт лица.
226 Основы технологии PKI
Браузер
Программа, обеспечивающая доступ к текстовым и графическим
страницам World Wide Web.
Верификация (проверка) электронной подписи документа
Проверка соотношения, связывающего хэш-функцию документа,
подпись под этим документом и открытый ключ подписавшего
пользователя. Если рассматриваемое соотношение оказывается
выполненным, то подпись признается действительной, а сам документ
- подлинным, в противном случае документ считается измененным,
а подпись под ним - недействительной.
Взаимная (перекрестная) сертификация
Двусторонний процесс сертификации двух доверенных центров.
Владелец информации
Субъект, осуществляющий владение и пользование информацией
и реализующий полномочия распоряжения в пределах прав,
установленных законом и/или собственником информации.
Выпуск сертификата
Генерация сертификата и уведомление владельца, зафиксированного
в нем, о подробном содержании этого сертификата.
Депонирование ключей
Предоставление копий секретных ключей третьей стороне и
разрешение пользоваться ими при определенных обстоятельствах,
в качестве третьей стороны чаще всего выступают правительственные
учреждения и правоохранительные органы. Депонирование
ключей может быть возложено на независимое подразделение внутри
организации, развертывающей PKI, или на внешнее агентство.
Доверяющая сторона
Лицо, которое получает сертификат и полагается на него при
совершении сделок или обмене сообщениями.
Доказательство доставки данных
Атрибут сервиса неотказуемости. Гарантирует, что сторона,
принимающая информацию, не сможет отрицать того, что получила
сообщение.
Глоссарий 227
Доказательство происхоэюдения данных
Атрибут сервиса неотказуемости. Гарантирует, что сторона,
отправляющая информацию, не сможет отрицать того, что сообщение
отправлено ей.
Документ
Документированная информация, снабженная определенными
реквизитами.
Документированная информация
Зафиксированная на материальном носителе информация с реквизитами,
позволяющими ее идентифицировать.
Домен безопасности
Группа (компания, рабочая группа или коллектив), сертификаты
которой выпущены одним и тем же удостоверяющим центром.
Домен доверия
Множество субъектов, сертификаты которых выпущены одним
и тем же удостоверяющим центром. Пользователи, чьи сертификаты
подписаны данным удостоверяющим центром, могут полагаться
на идентичность другого пользователя, который владеет сертификатом,
выпущенным тем же удостоверяющим центром.
Дополнения сертификата
Необязательные атрибуты сертификата, позволяющие включать
в сертификат информацию, которая отсутствует в основном
содержании сертификата.
Заверение (нотаризация)
Регистрация данных у доверенного третьего лица для повышения
уверенности в правильности таких характеристик, как содержание,
источник данных, время доставки.
Закрытая система PKI
Характеризуется наличием договоров, определяющих права
и обязанности всех участников системы в отношении аутентификации
сообщений или транзакций.
Идентификация
Идентификацией субъекта называется процесс сопоставления
введенной им своей характеристики с некоторым хранимым системой
идентификатором. В дальнейшем идентификатор субъекта ис-
228 Основы технологии PKI
пользуется для предоставления субъекту определенного уровня прав
и полномочий.
Иерархия доверия
Система проверки цифровых сертификатов. Каждый сертификат
связан с сертификатом подписи того субъекта, который снабдил
его цифровой подписью. Так, сертификат абонента связан с сертификатом
УЦ низшего уровня, который, в свою очередь, связан с сертификатом
УЦ более высокого уровня и так далее до УЦ высшего
уровня. Следуя по цепочке доверия до известной доверенной стороны,
можно убедиться в действительности сертификата.
Инфраструктура открытых ключей (ИОК)
Технологическая инфраструктура и сервисы, гарантирующие
безопасность информационных и коммуникационных систем, использующих
алгоритм с открытыми ключами.
Криптографическая защита
Защита данных при помощи криптографического преобразования
данных.
Криптографический ключ
Последовательность символов, которая контролирует криптографические
операции (шифрование, расшифрование, вычисление
хэш-функции, вычисление или проверку цифровой подписи).
Криптографический модуль
Комплекс программных, программно-аппаратных и аппаратных
средств, используемый с целью гарантирования безопасности
при генерации, хранении и применении криптографического ключа.
Криптографические операции
К криптографическим операциям относятся:
• шифрование и (или) расшифрование данных;
• генерация и (или) верификация цифровых подписей;
• генерация криптографических контрольных сумм;
• верификация контрольных сумм;
• безопасное хэширование;
• шифрование и (или) расшифрование криптографических
ключей.
Глоссарий 229
Криптографическое преобразование
Преобразование данных при помощи шифрования и (или) выработки
имитовставки.
Криптосистема с открытыми ключами
Один из асимметричных криптографических алгоритмов, использующих
два ключа (открытый ключ и секретный ключ), соответствующих
друг другу. Если информация зашифровывается одним
ключом (открытым), система может расшифровать ее при помощи
другого ключа (секретного). Аналогично, если информация подписывается
одним ключом (секретным), абонент может использовать
другой ключ (открытый) для аутентификации лица, поставившего
подпись. Атрибуты этих двух ключей не позволяют вычислить секретный
ключ, даже если известен открытый ключ.
Компрометация ключей
Утрата доверия к тому, что используемые ключи обеспечивают
безопасность информации.
Контроль доступа (управление доступом)
Процесс ограничения доступа к ресурсам системы только разрешенным
субъектам или объектам.
Корневой удостоверяющий центр
Удостоверяющий центр, находящийся на вершине иерархии в
инфраструктуре открытых ключей, выпускает самоподписанный
сертификат и сертификаты для подчиненных удостоверяющих центров.
Модель доверия
Модель, задающая порядок сертификации одних удостоверяющих
центров другими.
Мостовой удостоверяющий центр
Удостоверяющий центр, предназначенный для установления
связей между разнородными инфраструктурами открытых ключей.
Набор полоэюений PKI
Совокупность положений практики и/или политики PKI, охватывающих
круг стандартных тем для формулирования политики
применения сертификатов или регламента.
230 Основы технологии PKI
Некорректный электронный документ
Электронный документ, не прошедший процедуры расшифрования
данных, проверки электронной цифровой подписи информации,
контроля формата документов, а также документ, имеющий
искажения в тексте сообщения (наличие символов, букв или цифр в
расшифрованном (открытом) тексте документа, не позволяющих
понять его смысл).
Неотказуемостъ получения
Невозможность для получателя отрицать прием информации,
поскольку свидетельство получения (например, цифровая подпись)
доказывает связь между атрибутами получателя и информацией.
Открытая система PKI
Характеризуется отсутствием формальных договоров, регулирующих
отношения субъектов системы.
Открытый ключ
Криптографический ключ, который связан с секретным с помощью
особого математического соотношения. Открытый ключ известен
всем другим пользователям системы и предназначен для проверки
электронной цифровой подписи и расшифрования, позволяет
определить автора подписи и достоверность электронного документа,
но не позволяет вычислить секретный ключ.
Оцифрованная подпись
Подпись, получаемая в результате сканирования рукописной
подписи и используемая в качестве заменителя собственноручной
подписи.
Пара ключей (ключевая пара)
Открытый ключ, используемый в криптосистеме с открытыми
ключами, и соответствующий ему секретный ключ.
Приостановление сертификата
Временное аннулирование сертификата в период его действия.
Подписчик (абонент) сертификата
Лицо, которое заключает с удостоверяющим центром договор
об обслуживании и становится владельцем сертификатов, выпущенных
УЦ.
Глоссарий 231
Политика применения сертификатов
Установленный набор правил, характеризующих возможность
применения сертификата определенным сообществом и/или для
класса приложений с определенными требованиями безопасности.
Политика применения сертификатов позволяет доверяющей стороне
оценить надежность использования сертификата для определенного
приложения.
Пользователь сертификата
Лицо, которое использует сертификат, например, подписчик
сертификата, его агент или доверяющая сторона.
Профиль сертификата
Набор характеристик, которые задают тип данного сертификата.
Путь доверия
Связывает доверяющую сторону с одной или многими третьими
доверенными сторонами и позволяет конфиденциально проверять
законность используемого доверяющей стороной сертификата.
Разностный список аннулированных сертификатов
Список, фиксирующий изменения списка аннулированных
сертификатов, произошедшие с момента выпуска последнего.
Расшифрование данных
Процесс преобразования зашифрованных данных в открытые
при помощи шифра.
Регистрационный центр (РЦ)
Лицо (физическое или юридическое), которое с санкции удостоверяющего
центра выполняет функции аутентификации в процессе
выпуска или аннулирования сертификата. Регистрационный
центр не выпускает сертификаты и не ведет списки аннулированных
сертификатов.
Регламент УЦ
Документ, который устанавливает процедуры сертификации
в соответствии с политикой конкретного удостоверяющего центра.
Роуминг сертификатов и открытых ключей
Технология, обеспечивающая свободу применения пользователями
своих сертификатов и ключей на разных компьютерах. Реализуется
через программное обеспечение третьей стороны. Серти-
232 Основы технологии PKI
фикаты и секретные ключи пользователей размещаются на защищенном
центральном сервере. Будучи соответствующим образом
сконфигурированным в любой системе, программное обеспечение
дает возможность пользователю осуществлять доступ к своей паре
ключей.
Секретный (закрытый) ключ
Ключ асимметричной ключевой пары, который доступен
только одному пользователю системы и хранится им в тайне. В системе
цифровой подписи определяет преобразование подписи,
в асимметричной системе шифрования определяет преобразование
расшифрования.
Сервис безопасности
Совокупность механизмов, процедур и других средств управления
для снижения рисков, связанных с угрозой утраты или раскрытия
данных.
Сервис неотказуемости
Распространенное название сервиса предотвращения отказа от
участия в обмене информацией, гарантирующего, что стороны, отправляющие
и принимающие электронные сообщения или документы,
не смогут отрицать свое участие в информационном обмене в
целом или на отдельных его этапах.
Сертификат
Цифровой документ, подтверждающий соответствие между
открытым ключом и информацией, идентифицирующей владельца
ключа. Содержит определенную, цифровым образом подписанную
информацию о владельце ключа, сведения об открытом ключе, его
назначении и области применения, название доверенного центра
и т.д.
Сертификат сервера
Цифровой сертификат, выпущенный удостоверяющим центром
для web-сервера. Предназначен для аутентификации web-
сервера при выполнении транзакций, основанных на протоколе SSL.
Сертификация
Процесс выпуска сертификатов для физических и юридических
лиц, оборудования и т.д.
Глоссарий 233
Список аннулированных сертификатов (САС)
Список недействительных сертификатов, в большинстве случаев
генерируется доверенным центром.
Сервер восстановления ключей
Сервер инфраструктуры открытых ключей, который поддерживает
создание резервных копий и восстановление ключей шифрования
конечных субъектов.
Сервер каталогов
Сервер инфраструктуры открытых ключей, который хранит
информацию о сертификатах и атрибутах субъектов сертификатов
открытых ключей.
Сервер сертификатов
Сервер инфраструктуры открытых ключей, на который возлагаются
функции выпуска и управления сертификатами, защищенного
хранения секретного ключа удостоверяющего центра, поддержки
жизненного цикла сертификатов и ключей, восстановления данных,
ведения контрольного журнала и регистрации всех операций удостоверяющего
центра.
Система асимметричного шифрования
Система, основанная на асимметричных методах, когда открытое
преобразование используется для шифрования, а соответствующее
секретное преобразование - для расшифрования.
Согласование ключа
Процесс установления общего ключа для взаимодействия между
пользователями, при котором ни один из пользователей не может
предопределять значение этого ключа.
Сообщение
Строка битов некоторой длины.
Токен
Устройство хранения криптографических ключей, аппаратный
ключ.
Транспортировка ключа
Защищенный процесс передачи ключа от одного пользователя
к другому.
234 Основы технологии PKI
Управление ключами
Создание (генерация) ключей, их хранение, распространение,
удаление (уничтожение), учет и применение в соответствии с политикой
безопасности.
Удостоверяющий центр (УЦ)
Доверенное лицо (физическое или юридическое), которое выпускает,
публикует, аннулирует сертификаты, приостанавливает их
действие.
Хэш-код (дайдлсест)
Строка битов фиксированной длины, полученная из строки
битов произвольной длины при помощи математической операции
над данными, является выходом хэш-функции.
Хэш-функция (функция хэширования)
Функция, которая переводит строку битов произвольной длины
в строку битов фиксированной длины. По данному значению
хэш-функции вычислительно невозможно найти аргумент, а по данному
аргументу хэш-функции вычислительно невозможно найти
другой аргумент, дающий такое же значение функции.
Цифровая подпись
Результат криптографического преобразования, при котором
дайджест подписываемого сообщения шифруется секретным ключом.
Цифровая подпись может быть проверена путем сопоставления
значения, расшифрованного при помощи открытого ключа, и дайджеста
исходного сообщения. Так как цифровая подпись может
быть выработана только лицом, имеющим секретный ключ, то результат
ее использования аналогичен эффекту собственноручной
подписи на бумажном документе.
Шифровальный ключ
Параметр, используемый в симметричном криптографическом
алгоритме, позволяющий отправителю и получателю использовать
один и тот же криптографический ключ для шифрования и расшифрования
данных.
Шифрование
Шифрование информации - взаимнооднозначное математическое
(криптографическое) преобразование, зависящее от ключа (секретный
параметр преобразования), которое ставит в соответствие
Глоссарий 235
блоку открытой информации, представленной в некоторой цифровой
кодировке, блок шифрованной информации, также представленной
в цифровой кодировке.
Шифрование документов (текстов)
Преобразование формы исходных (открытых) текстов сообщений
таким образом, что их смысл становится непонятным для
любого лица, не владеющего секретом обратного преобразования.
Шифротекст
Зашифрованная информация
Электронный документ
Представляет собой задокументированную совокупность данных,
зафиксированных на материальном носителе (магнитном или
бумажном) с реквизитами, позволяющими идентифицировать эту
информацию и авторов документа. Идентификация электронного
документа обеспечивается средствами защиты на основе алгоритмов
шифрования, электронной цифровой подписи и защиты от несанкционированного
доступа.
Электронная цифровая подпись (ЭЦП)
Данные, добавляемые к блоку данных, полученные в результате
его криптографического преобразования, зависящего от секретного
ключа и блока данных, которые позволяют приемнику данных
удостовериться в целостности блока данных и подлинности источника
данных, а также обеспечить защиту от подлога со стороны
приемника данных.
AES (Advanced Encryption Standard)
Симметричный криптографический алгоритм.
ARL (Authority Revocation List)
Список аннулированных удостоверяющих центров, то есть тех
удостоверяющих центров, сертификаты которых недействительны.
ASN.] (Abstract Syntax Notation One)
Абстрактная синтаксическая нотация, которая была предложена
комитетом разработчиков стандартов взаимодействия открытых
систем для использования с протоколами Х.500. ASN.1 описывает
синтаксис различных структур данных, предоставляя четко определенные
примитивные объекты и средства описания комбинаций
примитивных объектов.
236 Основы технологии PKI
DES (Digital Encryption Standard)
Симметричный алгоритм шифрования, разработанный специалистами
компании IBM и Управлении национальной безопасности
США.
DH (Diffie-Hellman)
Алгоритм Диффи-Хэллмана, используется для согласования
ключей (обмена ключами). Две стороны могут сформировать один и
тот же секрет, а затем использовать его для построения сеансового
ключа, используемого в симметричном алгоритме.
DNS (Domain Name System)
Защищенная система доменных имен
DSA (Digital Signature Algorithm)
Алгоритм цифровой подписи, разработанный Дэвидом Крави-
цем. Официальный алгоритм цифровой подписи правительственных
учреждений США.
ECDH (Elliptic Curve Diffie-Hellman)
Алгоритм эллиптических кривых Диффи-Хэллмана, используется
для решения проблемы распределения ключей.
ECDSA
Алгоритм цифровой подписи, использующий эллиптические
кривые.
ETSI (European Telecommunications Standards Institute)
Европейский институт стандартов связи.
1Р-спуфинг
Преднамеренная подмена (имитация) системы с использованием
ее сетевого IP-адреса.
НМАС (Hash Message Authentication Checksum)
Код аутентификации сообщения на основе вычисления хэша.
HTTP (HyperText Transfer Protocol)
Протокол обмена гипертекстовыми документами между
HTTP-сервером и браузером клиента.
IETF (Inernet Engineering Task Force)
Группа инженерной поддержки Интернет - интернациональное
сообщество разработчиков, производителей и исследователей,
занимающихся обеспечением функционирования и эволюции Интернет.
Глоссарий 237
IPSec
Стандарты, описывающие архитектуру безопасности Интернет-
протоколов (IP), регламентирующие контроль целостности на
уровне IP-пакетов, аутентификацию источника данных и защиту от
воспроизведения ранее посланных IP-пакетов, обеспечение конфиденциальности:
шифрование содержимого IP-пакетов, а также частичную
защиту от анализа трафика путем применения туннельного
режима.
ITU (International Telecommunication Union)
Международный союз по телекоммуникациям - международная
организация, занимающаяся координацией функционирования
телекоммуникационных сетей и сервисов, а также публикацией
стандартов и рекомендаций в сфере телекоммуникационных технологий.
IP (Internet Protocol)
Протокол передачи данных сетевого уровня группы протоколов
TCP/IP, базовый протокол передачи данных в Интернет.
MD2
Алгоритм вычисления дайджеста сообщения, разработанный
Роном Ривестом. Выдает 128-битный (16-байтный) дайджест сообщения
произвольной длины.
MD5
Алгоритм вычисления дайджеста сообщения, разработанный
Роном Ривестом для усовершенствования алгоритма MD2
Object Identifier
Идентификатор объекта - указатель, характеризующий политику
применения сертификатов, используется в сертификате формата
X. 5 09 версии 3.
OCSP (Online Certificate Status Protocol)
Онлайновый протокол статуса сертификата, применяется для
проверки действительности сертификатов в режиме реального времени.
PKCS (Public Key Cryptography Standards)
Стандарты криптографии с открытым ключом - неформальные
стандарты, разработанные в 1991 году компанией RSA Laboratories
совместно с представителями компьютерных компаний.
238 Основы технологии PKl
PGP (Pretty Good Privacy)
Система для защиты секретности файлов и сообщений электронной
почты в глобальных вычислительных и коммуникационных
средах. Полное название системы - Pretty Good Privacy (конфиденциальность
- без проблем), была разработана американским программистом
Филом Циммерманном.
PKIX СМР (PKIX certificate management protocol)
Протокол управления сертификатами стандарта PKIX, обеспечивает
связь с PKIX-совместимыми приложениями.
RSA
Асимметричный алгоритм шифрования, получил название по
инициалам его авторов: Рона Ривеста, Ади Шамира и Лена Элдмана.
Данные, зашифрованные с помощью открытого ключа, могут быть
расшифрованы только с помощью секретного ключа. Используется
для решения проблемы распределения ключей и для вычисления
цифровой подписи (дайджест сообщения шифруется с помощью
секретного ключа).
SET (Secure Electronic Transaction)
Протокол защиты платежей по кредитным картам в Интернет.
SSL (Secure Sockets Layer)
Протокол, обеспечивающий защиту транзакций в Интернет за
счет поддержки шифрования и аутентификации.
SHTTP (Secure HyperText Transfer Protocol)
Расширенный вариант протокола HTTP, который обеспечивает
шифрование данных, передаваемых между web-сайтом и web-
браузером, а также аутентификацию сервера и клиента.
Triple-DES
Симметричный криптографический алгоритм, который выполняет
алгоритм DES три раза.
Список использованной литературы 239
Список использованной литературы
1. Балакирский В.Б. Безопасность электронных платежей //
Защита информации. Конфидент. 1996. № 5.
2. Бернет С, Пэйн С. Криптография: Официальное руководство
RSA Security. М.: Бином-Пресс, 2002.
3. Бруно Л. Certificate Authorities: Кому Вы доверяете? // Data
Communications (Russian edition). 1998. № 3.
4. Варфоломеев A.Д., Пеленицын М.Б. Методы криптографии
и их применение в банковских технологиях. М.: МИФИ, 1995.
5. Варфоломеев А.Д., Домнина О.С, Пеленицын М.Б. Управление
ключами в системах криптографической защиты банковской
информации. М.: МИФИ, 1996.
6. Вонг У. Обслуживание цифровых сертификатов // LAN/
Журн. сетевых решений. 1998. № 7-8.
7. Галатенко В.А. Информационная безопасность: Обзор основных
положений // Информ. бюлл. Jet Info. 1996. № 1-3.
8. Галатенко В.А. «Стандарты в области безопасности распределенных
систем // Информ. бюлл. Jet Info. 1999. № 5.
9. Горбатов B.C., Полянская О.Ю. Доверенные центры как
звено системы обеспечения безопасности корпоративных информационных
ресурсов // Информ. бюлл. Jet Info. 1999. № 11 (78).
10. Горбатов B.C., Полянская О.Ю. Программная поддержка
инфраструктуры с открытыми ключами // Безопасность информ.
технологий. Вып.2. МИФИ, 2001.
11. ГОСТ 34.003-90. Информационная технология. Комплекс
стандартов на автоматизированные системы. Автоматизированные
системы. Термины и определения.
12. ГОСТ 28147-89. Государственный стандарт Российской
Федерации. Системы обработки информации. Защита криптографическая.
Алгоритм криптографического преобразования.
13. ГОСТ Р 34.10-94. Государственный стандарт Российской
Федерации. Информационная технология. Криптографическая защита
информации. Процедуры выработки и проверки электронной
подписи на базе асимметричного криптографического алгоритма.
240 Основы технологии PKI
14. ГОСТ Р 34.11-94. Государственный стандарт Российской
Федерации. Информационная технология. Криптографическая защита
информации. Функция хеширования.
15. ГОСТ Р 34.10-2001 Государственный стандарт Российской
Федерации. Информационная технология. Криптографическая защита
информации. Процессы формирования и проверки электронной
цифровой подписи
16. Давыдов А.Н. Обзор инфраструктур открытых ключей /
Пензен. гос. ун-т. Тр. науч.-техн. конф. Безопасность информ. технологий.
Т. 1. Пенза, июнь 2001. www.beda.stup.ac.ru/RVconf/
vOl/015/.
17. Дэлтон Куртис Е. PKI в Windows 2000: вызов или призыв?
// LAN/ Журнал сетевых решений. 2001. № 1.
www.osp.ru/lan/2001/01/096.htm.
18. Дубова Н. От TrustedWeb к «защищенному предприятию //
Открытые системы.. 2000. № 5-6
19. Закон РФ «Об электронной цифровой подписи»
20. Зиммерман Ф.Р. PGP: концепция безопасности и уязвимые
места // Компьютерра. 1997. № 48.
www.computerra.ru/offline/1997/225/925/
21. Кадощук И. Как нам организовать PKI // Сетевой журн.
2000. № 9. www.setevoj.ru.
22. Карве А. Инфраструктура с открытыми ключами // LAN/
Журн. сетевых решений. 1997. № 8.
23. Карве А. Защищенный обмен сообщениями // LAN/ Журн.
сетевых решений. 1998. № 12.
24. Карве А. PKI - инфраструктура защиты следующего поколения
// LAN/ Журн. сетевых решений. 1999. № 7.
25. Карпов А. Г. достоверяющий центр в системе электронного
документооборота. Опыт построения открытых систем.
www.aladdin.ru/infocom2002_tesis.html#4
26. Карр Д. Биометрические устройства новой волны // LAN/
Журн/ сетевых решений. 2001. № 12. www.osp.ru/lan/2001/12/072.htm
27. Купи Т. Серверы сертификатов, или Общение без страха //
Сети. 1997. №9.
Список использованной литературы 241
28. Лукацкий А.В. Как обеспечить подлинность электронных
документов, www.infosec.ru/press/pub/p50.htm.
29. Месмер Э. Сертификаты достойны вашего внимания //
Computerworld Россия. 1998. № 21.
30. Мэтью С. Инфраструктура открытых ключей: состояние и
перспективы // Сетевой журн. 2000. № 9. www.setevoj.ru.
31. Никонова Е., Смирнов В., Копылов Д. Некоторые технологические
аспекты реализации закона об ЭЦП // PC Week. 2002. № 15.
23 апр. www.pcweek.ru.
32. Описание решений компании Baltimore Technologies.
www.weekly.cnews.ru.
33. Пешин Н.Л. Правовые проблемы применения компьютерных
технологий в системе российского права.
www.conf3.parkmedia.ru.
34. Погуляев В., Теренин А. «Информационная безопасность
экономических субъектов, zi.nm.ru/publ/is/confident_2_2003.htm.
35. Полянская О.Ю. Проблемы и риски в работе удостоверяющих
центров / Тезисы X всерос. науч. конф. «Проблемы информационной
безопасности в системе высшей школы». МИФИ, 2003.
36. Полянская О.Ю. Стандарты и спецификации в области инфраструктур
открытых ключей // Безопасность информационных
технологий. Вып.1. МИФИ, 2003.
37. Попов В., Лукацкий А. PKI- технология массового продвижения
// PCWeek/RE. июнь 2001. www.pcweek.ru.
38. Приказчикова А. О реальном лице юзера.
www.computery.ru.
39. Рапоза Д. Незнакомая PKI // PCWeek/RE. январь 2001.
www.pcweek.ru.
40. Саввин И. Перспективы использования защищенного документооборота
// Рынок ценных бумаг, www.rcb/archive.
41. Семенов Г. Не только шифрование, или Обзор криптотех-
нологий // Информ. бюлл. Jet Info2001. № 3 (94).
42. Симонович П.С. Регулирование электронной цифровой
подписи нормами права: международный опыт // Журн. рос. права.
2002. № 3. www.xxp-design.ru.
242 Основы технологии PKI
43. Стардеван К. PKI заступает на дежурство // PCWeek/RE,
Netweek. 2 0 0 1 . № 6 ( 2 7 6 ) .
www.pcweek.ru/Year2001/N6/CP1251/NetWeek/chaptl.htm
44. Чакон М. Службы каталогов: в единстве - сила //
LAN/Журн. сетевых решений. 1999. №10.
45. Че Ли. Задраить люки // LAN/ Журн. сетевых решений.
1996. № 4. www.osp.ru/lan/1996/04/89.htm.
46. Advances and Remaining Challenges to Adoption of Public
Key Infrastructure Technology. U.S. General Accounting Office. GAO-
01-277. February, 2001.
47. Architecture for Public-Key Infrastructure (APKI). Open
Group Guide. G801. The Open Group. 1998.
www.opengroup.org/onlinepubs/009219899/toc.htm.
48. Aura Tuomas, Ellison Carl. Privacy and Accountability in Certification
Systems. Helsinki University of Technology, Laboratory for
Theoretical Computer Science. Research Report. April 2000.
49. Bobbit Mike. PKI Policy Pitfalls // Information Security Magazine.
July 2001.
50. Brink Derek. PKI and Financial Return on Investment/ A PKI
Forum Note. August 2002. www.pkiforum.org/resourcees.html.
51. Burr William, Dodson Donna, Nazario Noel, Polk W. Timothy.
Minimum Interoperability Specification for PKI Components (MISPC),
Version 1. NIST SP 800-15. January, 1998.
52. Certification Authority Guidelines. Electronic Commerce Promotion
Council of Japan (ECOM). 1997-1998. www.ecom.or.jp.
53. CCITT (International Telegraph and Telephone Consultative
Committee). Recommendation X.208: Specification of Abstract Syntax
Notation One (ASN.l). Geneva. 1988.
54. CCITT. Recommendation X.209: Specification of Basic Encoding
Rules for Abstract Syntax Notation One (ASN.l). Geneva. 1988
55. CCITT Recommendation X.500: The Directory. Geneva. 1993
56. CCITT, Recommendation X.501: The Directory - Models. Geneva.
1988.
57. CCITT. Recommendation X.800: Security Architecture for
Open Systems Interconnection for CCITT Applications. Geneva. 1991.
Список использованной литературы 243
58. Certification Authority Systems. ОСС 99-20, Office of Comptroller
of the Currency. May 4. 1999.
59. Ellison Carl, Schneier Bruce. Ten Risks of PKI: What You're
not Being Told about Public Key Infrastructure // Computer Security
Journal, vol. XVI. number 1. 2000.
60. European Trusted Services (ETS) - results of 1995 TTPS projects.
A. Nilson. Marinade Limited. April 1997.
61. German Draft Digital Signature Law (SigG), English translation
by Christopher Kuner. 1996.
www.ourworld.compuserve.com/homepages/ckuner/digsig.htm
62. Guideline for Implementing Cryptography in the Federal Government.
NIST SP 800-21. November 1999.
63. Housley R., Polk W. Timothy. Planning for PKI: Best practices
for PKI Deployment. Wiley & Sons. 2001
64. Johner H., Fujiwara S., Sm Yeung A., Stephanou A., Whitmore
Deploying a Public Key Infrastructure. International Technical Support
Organization. SG24-5512-00. February 2000. www.redbooks.ibm.com.
65. ISO/IEC 8824 Object Identifiers (Oms).
66. ISO/IEC JT1/SC27 WD 14516-1. Guidelines for the use and
management of Trusted Third Party services - Part 1: General Overview.
1995. 11.
67. ISO/IEC JT1/SC27 WD 14516-2. Guidelines for the use and
management of Trusted Third Party services - Part 2: Technical aspects.
1996.6.21.
68. ITU-T (International Telecommunications Union) Recommendation
X.509: Information Technology - Open Systems Interconnection -
The Directory: Authentication Framework. 2000.
69. ITU-T Recommendation X.509. Information Technology -
Open Systems Interconnection - The Directory Public Key and Attribute
Certificate Frameworks. June 2000 (документ эквивалентен ISO/IEC
9594-8 Directory Services, 2000).
70. King Christopher M. Building a Coфorate Public Key Infrastructure.
INFOSEC Engineering, Inc. 1997. www.infoseceng.com.
71. Kiran S., Lareau P., L Lloyd S. PKI Basics - A Technical Introduction
// A PKI Forum Note. November 2002.
www.pkiforum.org/resourcees.html
244 Основы технологии РК1
72. Kuhn D.Richard, Ни Vincent С, Polk W.Timothy, Chang Shu-
Jen. Introduction to Public Key Technology and the Federal PKI Infrastructure.
National Institute of Standards and Technology. February.
2001.
73. Lareau P. PKI Basics - A Business Perspective // A PKI Forum
Note. April 2002. www.pkiforum.org/resourcees.html.
74. Legal and Regulatory Issues for the European Trusted Services
Infrastructure - ETS. ISTEV. June 1997
75. Lloyd Steve. Understanding Certification Path Construction //
A PKI Forum White Paper. September 2002.
www.pkiforum.org/resources.html.
76. Masse David. G., Fernandes Andrew D. Economic Modelling
and Risk Management in Public Key Infrastructures. 1999.
www.masse.org/rsa97/index.html.
77. O'Higgins B. What is the Difference Between a Public Key Infrastructure
and a Certification Authority.
www.ema.org/html/pubs/mmv4n2/pki.htm.
78. Polk W.Timothy, Hastings Nelson E. Bridge Certification Authorities:
Connecting B2B Public Key Infrastructures. NIST.
79. Public Key Infrastructure: Group Test (Edition 3), NSS Group
Report. December 2000. www.NSS.co.uk.
80. Public Key Infrastructure Standards.
www.wiltsec.co.uk/standards/pki.htm.
81. RSA Keon Certificate Authority Product Overview. Technology
White Paper, www.rsasecurity.com.
82. Secure Electronic Transaction Specification. The Business Description.
www.setco.org/set_specifications.html.
83. Secure Electronic Transaction Specification. Formal Protocol
Definition, www.setco.org/set_specifications.html.
84. Secure Electronic Transaction. The Specification Programmer's
Guide, www.setco.org/set_specifications.html.
85. Stapleton Jeff. CA Trust // A PKI Forum Note. July 2001.
www.pkiforum.org/resourcees.html.
86. Synopsis of PKI and Related Standards / The Center For Information
Technology Standards. 2000. www.itsi.disa.mil.
Список использованной литературы 245
87. Understanding Public Key Infrastructure (PKI), Technology
White Paper. PKI WP 0999. RSA Security Inc. 1999.
www.rsasecurity.com,
88. Utah Digital Signature Act (1996).
www.gvnfo.state.ut.us/ccjj/digsig/dsut-act.htm.
89. Xenitellis Symeon (Symos). The Open-source PKI Book.
OpenCATeam. 1999-2000. ospkibook.sourceforge.net.
90. Younglove Roger. PKI: How It Works NetworkCare Whitepaper.
Lucent Technologies Inc. 2000.
www.lucent.com/knowledge/documentdetail.
Документы IETF PKIX RFC no номерам: www.rfceditor.
org/cgi-bin/rfcsearch.pl и www.imc.org/ietf-pkix :
91. RFC 2510 Certificate Management Protocols (CMP).
92. RFC2511 Certificate Request Protocol.
93. RFC2527 Certificate Policy and Certification Practices Framework.
94. RFC2559 LDAP V2 Operational Protocols.
95. RFC2560 Online Certificate Status Protocol (OCSP).
96. RFC2585 HTTP/FTP Operations.
97. RFC2587 LDAP V2 Schema.
98. RFC2797 Certificate Management Messages over CMS (CMC).
99. RFC2875 Diffie-Hellman Proof-of-Possession (POP) Algorithms.
100. RFC 3029 Data Validation and Certification Server Protocols.
101. RFC 3039 Qualified Certificates Profile.
102. RFC 3161 Time-Stamp Protocol (TSP).
103. RFC 3279 Algorithms and Identifiers for the Internet X.509
Public Key Infrastructure Certificate and Certificate Revocation List
(CRL) Profile.
104. RFC 3280 Certificate & CRL Profile.
105. RFC 3281 An Internet Attribute Certificate Profile for Authorization.
106. RFC 2311 S/MIME Version 2 Message Specification.
107. RFC 2312 S/MIMEv2 Certificate Handling.
108. RFC 2630 Cryptographic Message Syntax (CMS).
109. RFC 2632 S/MIME V3 Certificate Handling.
246 Основы технологии PKl
110. RFC 2633 S/MIME V3 Message Specification.
111. RFC 2634 Enhanced Security Services for S/MIME.
112. RFC 2785 Methods for Avoiding the "Small-Subgroup" Attacks
on the Diffie-Hellman Key Agreement Method for S/MIME.
113. RFC 2246 TLS Protocol Version 1.0.
114. RFC 2659 Security Extensions For HTML.
115. RFC 2660 The Secure HyperText Transfer Protocol.
116. RFC 2817 Upgrading to TLS Within HTTP.
117. RFC 2818 HTTP Over TLS.
118. RFC 2401 Security Architecture for the Internet Protocol.
119. RFC 2402 IP Authentication Header.
120. RFC 2406 IP Encapsulating Security Payload (ESP).
121. RFC 2408 Internet Security Association and Key Management
Protocol (ISAKMP).
122. RFC 2137 Secure Domain Name System Dynamic Update.
123. RFC 2535 Domain Name System Security Extensions.
124. RFC 2536 DSA KEYs and SIGs in the Domain Name System.
125. RFC 2537 RSA/MD5 KEYs and SIGs in the Domain Name
System.
126. RFC 2538 Storing Certificates in the Domain Name System.
127. RFC 2539 Storage of Diffie-Hellman Keys in the Domain
Name System.
128. RFC 2540 Detached Domain Name System Information.
129. RFC 2541 DNS Security Operational Considerations.
Документы PKCS no номерам:
www.rsasecurity.com/rsalabs/pkcs/:
130. PKCS#1 RSA Cryptography.
131. PKCS #3 Diffie-Hellman Key Agreement.
132. PKCS #5 Password-Based Cryptography.
133. PKCS #6 Extended-Certificate Syntax.
134. PKCS#7 Cryptographic Message Syntax.
135. PKCS #8 Private-Key Information Syntax.
136. PKCS #9 Selected Attribute Types.
137. PKCS#10 Certification Request Syntax.
138. PKCS#11 Cryptographic Token Interface (Cryptoki).
139. PKCS #12 Personal Information Exchange Syntax.
Список использованной литературы 247
40. PKCS #13 Elliptic Curve Cryptography.
41. PKCS #15 Cryptographic Token Information Format.
42. www.adam.ru/Pki/Vepr/
43. www.baltimore.com
44. beda.stup.ac.ru/RV-conf/
45. www.computery.ru
46. www.cryptography.ru
47. www.cryptopro.ru
48. www.digsig.com
49. www.enrtust.com
50. www.finestreet.ru/magazins/electronica
51. www.imc.org/ietf-pkix
52. www.infoseceng.com
53. www.ip6.msu.ru/probl7.htm
54. www.iso.ch
55. www.ispras.ru
56. www.itsi.disa.mil
57.www.keon.ru/WIN/GLOSSARY/pkcs.htm
58. www.lucent.com/knowledge/documentdetail
59. www.masse.org/rsa97/index.html
60. www.opengroup.org
61. www.osp.ru
62. www.pgpi.org
63. www.pkiforum.org/resources.html
64. www.pki-page.com
65. www.pgp2all.org.ru/data/tech/howpgp.html#basic
66. www.racal.ru/rsp/glossary.htm
67. www.rfc-editor.org/cgi-bin/rfcsearch.pl
68. www.rsasecurity.com/rsalabs/pkcs/
69. www.security.mari-el.ru
70. www.setco.org/set_specifications.html
71. www.setevoj.ru
72. www.verisign.com
73. www.x509.ru
74. www.weekly.cnews.ru
75. www.wiltsec.co.uk/standards/pki.htm
ОГЛАВЛЕНИЕ
Сокращения, принятые в книге 3
Введение 4
1. СЕРВИСЫ И МЕХАНИЗМЫ БЕЗОПАСНОСТИ 9
1.1. Сервисы безопасности 9
1.2. Некриптографические механизмы безопасности 11
1.3. Криптографические механизмы безопасности 15
2. СТРУКТУРА, СЕРВИСЫ И АРХИТЕКТУРА PKI 23
2.1. Основные подходы к реализации PKI 23
2.2. Компоненты и сервисы инфраструктуры открытых ключей 32
2.3. Архитектура и топология PKI 40
3. СТАНДАРТЫ И СПЕЦИФИКАЦИИ PKI 50
3.1. Стандарты в области PKI 50
3.2. Стандарты Internet Х.509 PKI (PKIX) 59
4. СТРУКТУРЫ ДАННЫХ PKI 70
4.1. Сертификаты открытых ключей Х.509 70
4.2. Списки аннулированных сертификатов 80
4.3. Атрибутные сертификаты 86
5. ПОЛИТИКА PKI 89
5.1. Основные требования к политике PKI 89
5.2. Политика применения сертификатов и регламент 91
5.3. Краткая характеристика политики PKI 96
5.4. Набор положений политики PKI 99
5.5. Проблемы формирования политики PKI 112
6. ПРОБЛЕМЫ И РИСКИ ТЕХНОЛОГИИ PKI 129
6.1. Риски создания, распространения и принятия сертификатов 130
6.2. Риски управления сертификатами 133
6.3. Проблемы аутентификации и секретности 140
6.4. Правовые аспекты использования PKI 147
7. РАЗВЕРТЫВАНИЕ ИНФРАСТРУКТУРЫ ОТКРЫТЫХ КЛЮЧЕЙ 153
7.1. Предварительный этап 153
7.2. Проектирование 159
7.3.Создание прототипа, пилотный проект и внедрение 169
8. ПРОГРАММНЫЕ СРЕДСТВА ПОДДЕРЖКИ PKI 171
8.1. Программное обеспечение PKI ведущих мировых
производителей 171
8.2. Программное обеспечение PKI российских компаний 198
Заключение 212
Приложение 1. Набор положений политики PKI 214
Приложение 2. Сравнительная характеристика программных продуктов...220
Глоссарий 225
Список использованной литературы 239